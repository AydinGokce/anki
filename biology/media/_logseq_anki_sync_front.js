(()=>{var iE=Object.create;var Nv=Object.defineProperty;var nE=Object.getOwnPropertyDescriptor;var rE=Object.getOwnPropertyNames;var sE=Object.getPrototypeOf,oE=Object.prototype.hasOwnProperty;var Uv=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var ue=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var aE=(e,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of rE(t))!oE.call(e,n)&&n!==i&&Nv(e,n,{get:()=>t[n],enumerable:!(o=nE(t,n))||o.enumerable});return e};var Mi=(e,t,i)=>(i=e!=null?iE(sE(e)):{},aE(t||!e||!e.__esModule?Nv(i,"default",{value:e,enumerable:!0}):i,e));var Od=ue(()=>{});var kd=ue(()=>{});var Pd=ue(()=>{});var Wv=ue(Ct=>{var D=D||{version:"5.2.4"};typeof Ct<"u"?Ct.fabric=D:typeof define=="function"&&define.amd&&define([],function(){return D});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?D.document=document:D.document=document.implementation.createHTMLDocument(""),D.window=window):(zv=Od(),Id=new zv.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,D.document=Id.document,D.jsdomImplForWrapper=kd().implForWrapper,D.nodeCanvas=Pd().Canvas,D.window=Id,DOMParser=D.window.DOMParser);var zv,Id;D.isTouchSupported="ontouchstart"in D.window||"ontouchstart"in D.document||D.window&&D.window.navigator&&D.window.navigator.maxTouchPoints>0;D.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";D.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];D.DPI=96;D.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";D.commaWsp="(?:\\s+,?\\s*|,\\s*)";D.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;D.reNonWord=/[ \n\.,;!\?\-]/;D.fontPaths={};D.iMatrix=[1,0,0,1,0,0];D.svgNS="http://www.w3.org/2000/svg";D.perfLimitSizeTotal=2097152;D.maxCacheSideLimit=4096;D.minCacheSideLimit=256;D.charWidthsCache={};D.textureSize=2048;D.disableStyleCopyPaste=!1;D.enableGLFiltering=!0;D.devicePixelRatio=D.window.devicePixelRatio||D.window.webkitDevicePixelRatio||D.window.mozDevicePixelRatio||1;D.browserShadowBlurConstant=1;D.arcToSegmentsCache={};D.boundsOfCurveCache={};D.cachesBoundsOfCurve=!0;D.forceGLPutImageData=!1;D.initFilterBackend=function(){if(D.enableGLFiltering&&D.isWebglSupported&&D.isWebglSupported(D.textureSize))return console.log("max texture size: "+D.maxTextureSize),new D.WebglFilterBackend({tileSize:D.textureSize});if(D.Canvas2dFilterBackend)return new D.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=D);(function(){function e(r,a){if(this.__eventListeners[r]){var l=this.__eventListeners[r];a?l[l.indexOf(a)]=!1:D.util.array.fill(l,!1)}}function t(r,a){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var l in r)this.on(l,r[l]);else this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(a);return this}function i(r,a){var l=function(){a.apply(this,arguments),this.off(r,l)}.bind(this);this.on(r,l)}function o(r,a){if(arguments.length===1)for(var l in r)i.call(this,l,r[l]);else i.call(this,r,a);return this}function n(r,a){if(!this.__eventListeners)return this;if(arguments.length===0)for(r in this.__eventListeners)e.call(this,r);else if(arguments.length===1&&typeof arguments[0]=="object")for(var l in r)e.call(this,l,r[l]);else e.call(this,r,a);return this}function s(r,a){if(!this.__eventListeners)return this;var l=this.__eventListeners[r];if(!l)return this;for(var u=0,c=l.length;u<c;u++)l[u]&&l[u].call(this,a||{});return this.__eventListeners[r]=l.filter(function(h){return h!==!1}),this}D.Observable={fire:s,on:t,once:o,off:n}})();D.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,i){var o=this._objects;return i?o[t]=e:o.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e=this._objects,t,i=!1,o=0,n=arguments.length;o<n;o++)t=e.indexOf(arguments[o]),t!==-1&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var i=this.getObjects(),o=0,n=i.length;o<n;o++)e.call(t,i[o],o,i);return this},getObjects:function(e){return typeof e>"u"?this._objects.concat():this._objects.filter(function(t){return t.type===e})},item:function(e){return this._objects[e]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(e,t){return this._objects.indexOf(e)>-1?!0:t?this._objects.some(function(i){return typeof i.contains=="function"&&i.contains(e,!0)}):!1},complexity:function(){return this._objects.reduce(function(e,t){return e+=t.complexity?t.complexity():0,e},0)}};D.CommonMethods={_setOptions:function(e){for(var t in e)this.set(t,e[t])},_initGradient:function(e,t){e&&e.colorStops&&!(e instanceof D.Gradient)&&this.set(t,new D.Gradient(e))},_initPattern:function(e,t,i){e&&e.source&&!(e instanceof D.Pattern)?this.set(t,new D.Pattern(e,i)):i&&i()},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this},_set:function(e,t){this[e]=t},toggle:function(e){var t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this},get:function(e){return this[e]}};(function(e){var t=Math.sqrt,i=Math.atan2,o=Math.pow,n=Math.PI/180,s=Math.PI/2;D.util={cos:function(r){if(r===0)return 1;r<0&&(r=-r);var a=r/s;switch(a){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},sin:function(r){if(r===0)return 0;var a=r/s,l=1;switch(r<0&&(l=-1),a){case 1:return l;case 2:return 0;case 3:return-l}return Math.sin(r)},removeFromArray:function(r,a){var l=r.indexOf(a);return l!==-1&&r.splice(l,1),r},getRandomInt:function(r,a){return Math.floor(Math.random()*(a-r+1))+r},degreesToRadians:function(r){return r*n},radiansToDegrees:function(r){return r/n},rotatePoint:function(r,a,l){var u=new D.Point(r.x-a.x,r.y-a.y),c=D.util.rotateVector(u,l);return new D.Point(c.x,c.y).addEquals(a)},rotateVector:function(r,a){var l=D.util.sin(a),u=D.util.cos(a),c=r.x*u-r.y*l,h=r.x*l+r.y*u;return{x:c,y:h}},createVector:function(r,a){return new D.Point(a.x-r.x,a.y-r.y)},calcAngleBetweenVectors:function(r,a){return Math.acos((r.x*a.x+r.y*a.y)/(Math.hypot(r.x,r.y)*Math.hypot(a.x,a.y)))},getHatVector:function(r){return new D.Point(r.x,r.y).multiply(1/Math.hypot(r.x,r.y))},getBisector:function(r,a,l){var u=D.util.createVector(r,a),c=D.util.createVector(r,l),h=D.util.calcAngleBetweenVectors(u,c),d=D.util.calcAngleBetweenVectors(D.util.rotateVector(u,h),c),g=h*(d===0?1:-1)/2;return{vector:D.util.getHatVector(D.util.rotateVector(u,g)),angle:h}},projectStrokeOnPoints:function(r,a,l){var u=[],c=a.strokeWidth/2,h=a.strokeUniform?new D.Point(1/a.scaleX,1/a.scaleY):new D.Point(1,1),d=function(g){var m=c/Math.hypot(g.x,g.y);return new D.Point(g.x*m*h.x,g.y*m*h.y)};return r.length<=1||r.forEach(function(g,m){var y=new D.Point(g.x,g.y),C,w;m===0?(w=r[m+1],C=l?d(D.util.createVector(w,y)).addEquals(y):r[r.length-1]):m===r.length-1?(C=r[m-1],w=l?d(D.util.createVector(C,y)).addEquals(y):r[0]):(C=r[m-1],w=r[m+1]);var F=D.util.getBisector(y,C,w),B=F.vector,U=F.angle,R,W;if(a.strokeLineJoin==="miter"&&(R=-c/Math.sin(U/2),W=new D.Point(B.x*R*h.x,B.y*R*h.y),Math.hypot(W.x,W.y)/c<=a.strokeMiterLimit)){u.push(y.add(W)),u.push(y.subtract(W));return}R=-c*Math.SQRT2,W=new D.Point(B.x*R*h.x,B.y*R*h.y),u.push(y.add(W)),u.push(y.subtract(W))}),u},transformPoint:function(r,a,l){return l?new D.Point(a[0]*r.x+a[2]*r.y,a[1]*r.x+a[3]*r.y):new D.Point(a[0]*r.x+a[2]*r.y+a[4],a[1]*r.x+a[3]*r.y+a[5])},makeBoundingBoxFromPoints:function(r,a){if(a)for(var l=0;l<r.length;l++)r[l]=D.util.transformPoint(r[l],a);var u=[r[0].x,r[1].x,r[2].x,r[3].x],c=D.util.array.min(u),h=D.util.array.max(u),d=h-c,g=[r[0].y,r[1].y,r[2].y,r[3].y],m=D.util.array.min(g),y=D.util.array.max(g),C=y-m;return{left:c,top:m,width:d,height:C}},invertTransform:function(r){var a=1/(r[0]*r[3]-r[1]*r[2]),l=[a*r[3],-a*r[1],-a*r[2],a*r[0]],u=D.util.transformPoint({x:r[4],y:r[5]},l,!0);return l[4]=-u.x,l[5]=-u.y,l},toFixed:function(r,a){return parseFloat(Number(r).toFixed(a))},parseUnit:function(r,a){var l=/\D{0,2}$/.exec(r),u=parseFloat(r);switch(a||(a=D.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return u*D.DPI/25.4;case"cm":return u*D.DPI/2.54;case"in":return u*D.DPI;case"pt":return u*D.DPI/72;case"pc":return u*D.DPI/72*12;case"em":return u*a;default:return u}},falseFunction:function(){return!1},getKlass:function(r,a){return r=D.util.string.camelize(r.charAt(0).toUpperCase()+r.slice(1)),D.util.resolveNamespace(a)[r]},getSvgAttributes:function(r){var a=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"]);break}return a},resolveNamespace:function(r){if(!r)return D;var a=r.split("."),l=a.length,u,c=e||D.window;for(u=0;u<l;++u)c=c[a[u]];return c},loadImage:function(r,a,l,u){if(!r){a&&a.call(l,r);return}var c=D.util.createImage(),h=function(){a&&a.call(l,c,!1),c=c.onload=c.onerror=null};c.onload=h,c.onerror=function(){D.log("Error loading "+c.src),a&&a.call(l,null,!0),c=c.onload=c.onerror=null},r.indexOf("data")!==0&&u!==void 0&&u!==null&&(c.crossOrigin=u),r.substring(0,14)==="data:image/svg"&&(c.onload=null,D.util.loadImageInDom(c,h)),c.src=r},loadImageInDom:function(r,a){var l=D.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(r),D.document.querySelector("body").appendChild(l),r.onload=function(){a(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(r,a,l,u){r=r||[];var c=[],h=0,d=r.length;function g(){++h===d&&a&&a(c.filter(function(m){return m}))}if(!d){a&&a(c);return}r.forEach(function(m,y){if(!m||!m.type){g();return}var C=D.util.getKlass(m.type,l);C.fromObject(m,function(w,F){F||(c[y]=w),u&&u(m,w,F),g()})})},enlivenObjectEnlivables:function(r,a,l){var u=D.Object.ENLIVEN_PROPS.filter(function(c){return!!r[c]});D.util.enlivenObjects(u.map(function(c){return r[c]}),function(c){var h={};u.forEach(function(d,g){h[d]=c[g],a&&(a[d]=c[g])}),l&&l(h)})},enlivenPatterns:function(r,a){r=r||[];function l(){++c===h&&a&&a(u)}var u=[],c=0,h=r.length;if(!h){a&&a(u);return}r.forEach(function(d,g){d&&d.source?new D.Pattern(d,function(m){u[g]=m,l()}):(u[g]=d,l())})},groupSVGElements:function(r,a,l){var u;return r&&r.length===1?(typeof l<"u"&&(r[0].sourcePath=l),r[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),u=new D.Group(r,a),typeof l<"u"&&(u.sourcePath=l),u)},populateWithProperties:function(r,a,l){if(l&&Array.isArray(l))for(var u=0,c=l.length;u<c;u++)l[u]in r&&(a[l[u]]=r[l[u]])},createCanvasElement:function(){return D.document.createElement("canvas")},copyCanvasElement:function(r){var a=D.util.createCanvasElement();return a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),a},toDataURL:function(r,a,l){return r.toDataURL("image/"+a,l)},createImage:function(){return D.document.createElement("img")},multiplyTransformMatrices:function(r,a,l){return[r[0]*a[0]+r[2]*a[1],r[1]*a[0]+r[3]*a[1],r[0]*a[2]+r[2]*a[3],r[1]*a[2]+r[3]*a[3],l?0:r[0]*a[4]+r[2]*a[5]+r[4],l?0:r[1]*a[4]+r[3]*a[5]+r[5]]},qrDecompose:function(r){var a=i(r[1],r[0]),l=o(r[0],2)+o(r[1],2),u=t(l),c=(r[0]*r[3]-r[2]*r[1])/u,h=i(r[0]*r[2]+r[1]*r[3],l);return{angle:a/n,scaleX:u,scaleY:c,skewX:h/n,skewY:0,translateX:r[4],translateY:r[5]}},calcRotateMatrix:function(r){if(!r.angle)return D.iMatrix.concat();var a=D.util.degreesToRadians(r.angle),l=D.util.cos(a),u=D.util.sin(a);return[l,u,-u,l,0,0]},calcDimensionsMatrix:function(r){var a=typeof r.scaleX>"u"?1:r.scaleX,l=typeof r.scaleY>"u"?1:r.scaleY,u=[r.flipX?-a:a,0,0,r.flipY?-l:l,0,0],c=D.util.multiplyTransformMatrices,h=D.util.degreesToRadians;return r.skewX&&(u=c(u,[1,0,Math.tan(h(r.skewX)),1],!0)),r.skewY&&(u=c(u,[1,Math.tan(h(r.skewY)),0,1],!0)),u},composeMatrix:function(r){var a=[1,0,0,1,r.translateX||0,r.translateY||0],l=D.util.multiplyTransformMatrices;return r.angle&&(a=l(a,D.util.calcRotateMatrix(r))),(r.scaleX!==1||r.scaleY!==1||r.skewX||r.skewY||r.flipX||r.flipY)&&(a=l(a,D.util.calcDimensionsMatrix(r))),a},resetObjectTransform:function(r){r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},saveObjectTransform:function(r){return{scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}},isTransparent:function(r,a,l,u){u>0&&(a>u?a-=u:a=0,l>u?l-=u:l=0);var c=!0,h,d,g=r.getImageData(a,l,u*2||1,u*2||1),m=g.data.length;for(h=3;h<m&&(d=g.data[h],c=d<=0,c!==!1);h+=4);return g=null,c},parsePreserveAspectRatioAttribute:function(r){var a="meet",l="Mid",u="Mid",c=r.split(" "),h;return c&&c.length&&(a=c.pop(),a!=="meet"&&a!=="slice"?(h=a,a="meet"):c.length&&(h=c.pop())),l=h!=="none"?h.slice(1,4):"none",u=h!=="none"?h.slice(5,8):"none",{meetOrSlice:a,alignX:l,alignY:u}},clearFabricFontCache:function(r){r=(r||"").toLowerCase(),r?D.charWidthsCache[r]&&delete D.charWidthsCache[r]:D.charWidthsCache={}},limitDimsByArea:function(r,a){var l=Math.sqrt(a*r),u=Math.floor(a/l);return{x:Math.floor(l),y:u}},capValue:function(r,a,l){return Math.max(r,Math.min(a,l))},findScaleToFit:function(r,a){return Math.min(a.width/r.width,a.height/r.height)},findScaleToCover:function(r,a){return Math.max(a.width/r.width,a.height/r.height)},matrixToSVG:function(r){return"matrix("+r.map(function(a){return D.util.toFixed(a,D.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(r,a){var l=D.util.invertTransform(a),u=D.util.multiplyTransformMatrices(l,r.calcOwnMatrix());D.util.applyTransformToObject(r,u)},addTransformToObject:function(r,a){D.util.applyTransformToObject(r,D.util.multiplyTransformMatrices(a,r.calcOwnMatrix()))},applyTransformToObject:function(r,a){var l=D.util.qrDecompose(a),u=new D.Point(l.translateX,l.translateY);r.flipX=!1,r.flipY=!1,r.set("scaleX",l.scaleX),r.set("scaleY",l.scaleY),r.skewX=l.skewX,r.skewY=l.skewY,r.angle=l.angle,r.setPositionByOrigin(u,"center","center")},sizeAfterTransform:function(r,a,l){var u=r/2,c=a/2,h=[{x:-u,y:-c},{x:u,y:-c},{x:-u,y:c},{x:u,y:c}],d=D.util.calcDimensionsMatrix(l),g=D.util.makeBoundingBoxFromPoints(h,d);return{x:g.width,y:g.height}},mergeClipPaths:function(r,a){var l=r,u=a;l.inverted&&!u.inverted&&(l=a,u=r),D.util.applyTransformToObject(u,D.util.multiplyTransformMatrices(D.util.invertTransform(l.calcTransformMatrix()),u.calcTransformMatrix()));var c=l.inverted&&u.inverted;return c&&(l.inverted=u.inverted=!1),new D.Group([l],{clipPath:u,inverted:c})},hasStyleChanged:function(r,a,l){return l=l||!1,r.fill!==a.fill||r.stroke!==a.stroke||r.strokeWidth!==a.strokeWidth||r.fontSize!==a.fontSize||r.fontFamily!==a.fontFamily||r.fontWeight!==a.fontWeight||r.fontStyle!==a.fontStyle||r.deltaY!==a.deltaY||l&&(r.overline!==a.overline||r.underline!==a.underline||r.linethrough!==a.linethrough)},stylesToArray:function(l,a){for(var l=D.util.object.clone(l,!0),u=a.split(`
`),c=-1,h={},d=[],g=0;g<u.length;g++){if(!l[g]){c+=u[g].length;continue}for(var m=0;m<u[g].length;m++){c++;var y=l[g][m];if(y){var C=D.util.hasStyleChanged(h,y,!0);C?d.push({start:c,end:c+1,style:y}):d[d.length-1].end++}h=y||{}}}return d},stylesFromArray:function(r,a){if(!Array.isArray(r))return r;for(var l=a.split(`
`),u=-1,c=0,h={},d=0;d<l.length;d++)for(var g=0;g<l[d].length;g++)u++,r[c]&&r[c].start<=u&&u<r[c].end&&(h[d]=h[d]||{},h[d][g]=Object.assign({},r[c].style),u===r[c].end-1&&c++);return h}}})(Ct);(function(){var e=Array.prototype.join,t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},i={m:"l",M:"L"};function o(x,P,I,k,K,S,_,O,j,q,N){var H=D.util.cos(x),Q=D.util.sin(x),ot=D.util.cos(P),Y=D.util.sin(P),z=I*K*ot-k*S*Y+_,it=k*K*ot+I*S*Y+O,Z=q+j*(-I*K*Q-k*S*H),J=N+j*(-k*K*Q+I*S*H),nt=z+j*(I*K*Y+k*S*ot),lt=it+j*(k*K*Y-I*S*ot);return["C",Z,J,nt,lt,z,it]}function n(x,P,I,k,K,S,_){var O=Math.PI,j=_*O/180,q=D.util.sin(j),N=D.util.cos(j),H=0,Q=0;I=Math.abs(I),k=Math.abs(k);var ot=-N*x*.5-q*P*.5,Y=-N*P*.5+q*x*.5,z=I*I,it=k*k,Z=Y*Y,J=ot*ot,nt=z*it-z*Z-it*J,lt=0;if(nt<0){var At=Math.sqrt(1-nt/(z*it));I*=At,k*=At}else lt=(K===S?-1:1)*Math.sqrt(nt/(z*Z+it*J));var wt=lt*I*Y/k,et=-lt*k*ot/I,yt=N*wt-q*et+x*.5,Tt=q*wt+N*et+P*.5,It=s(1,0,(ot-wt)/I,(Y-et)/k),jt=s((ot-wt)/I,(Y-et)/k,(-ot-wt)/I,(-Y-et)/k);S===0&&jt>0?jt-=2*O:S===1&&jt<0&&(jt+=2*O);for(var Mt=Math.ceil(Math.abs(jt/O*2)),se=[],Jt=jt/Mt,Le=8/3*Math.sin(Jt/4)*Math.sin(Jt/4)/Math.sin(Jt/2),qe=It+Jt,Ce=0;Ce<Mt;Ce++)se[Ce]=o(It,qe,N,q,I,k,yt,Tt,Le,H,Q),H=se[Ce][5],Q=se[Ce][6],It=qe,qe+=Jt;return se}function s(x,P,I,k){var K=Math.atan2(P,x),S=Math.atan2(k,I);return S>=K?S-K:2*Math.PI-(K-S)}function r(x,P,I,k,K,S,_,O){var j;if(D.cachesBoundsOfCurve&&(j=e.call(arguments),D.boundsOfCurveCache[j]))return D.boundsOfCurveCache[j];var q=Math.sqrt,N=Math.min,H=Math.max,Q=Math.abs,ot=[],Y=[[],[]],z,it,Z,J,nt,lt,At,wt;it=6*x-12*I+6*K,z=-3*x+9*I-9*K+3*_,Z=3*I-3*x;for(var et=0;et<2;++et){if(et>0&&(it=6*P-12*k+6*S,z=-3*P+9*k-9*S+3*O,Z=3*k-3*P),Q(z)<1e-12){if(Q(it)<1e-12)continue;J=-Z/it,0<J&&J<1&&ot.push(J);continue}At=it*it-4*Z*z,!(At<0)&&(wt=q(At),nt=(-it+wt)/(2*z),0<nt&&nt<1&&ot.push(nt),lt=(-it-wt)/(2*z),0<lt&&lt<1&&ot.push(lt))}for(var yt,Tt,It=ot.length,jt=It,Mt;It--;)J=ot[It],Mt=1-J,yt=Mt*Mt*Mt*x+3*Mt*Mt*J*I+3*Mt*J*J*K+J*J*J*_,Y[0][It]=yt,Tt=Mt*Mt*Mt*P+3*Mt*Mt*J*k+3*Mt*J*J*S+J*J*J*O,Y[1][It]=Tt;Y[0][jt]=x,Y[1][jt]=P,Y[0][jt+1]=_,Y[1][jt+1]=O;var se=[{x:N.apply(null,Y[0]),y:N.apply(null,Y[1])},{x:H.apply(null,Y[0]),y:H.apply(null,Y[1])}];return D.cachesBoundsOfCurve&&(D.boundsOfCurveCache[j]=se),se}function a(x,P,I){for(var k=I[1],K=I[2],S=I[3],_=I[4],O=I[5],j=I[6],q=I[7],N=n(j-x,q-P,k,K,_,O,S),H=0,Q=N.length;H<Q;H++)N[H][1]+=x,N[H][2]+=P,N[H][3]+=x,N[H][4]+=P,N[H][5]+=x,N[H][6]+=P;return N}function l(x){var P=0,I=0,k=x.length,K=0,S=0,_,O,j,q=[],N,H,Q;for(O=0;O<k;++O){switch(j=!1,_=x[O].slice(0),_[0]){case"l":_[0]="L",_[1]+=P,_[2]+=I;case"L":P=_[1],I=_[2];break;case"h":_[1]+=P;case"H":_[0]="L",_[2]=I,P=_[1];break;case"v":_[1]+=I;case"V":_[0]="L",I=_[1],_[1]=P,_[2]=I;break;case"m":_[0]="M",_[1]+=P,_[2]+=I;case"M":P=_[1],I=_[2],K=_[1],S=_[2];break;case"c":_[0]="C",_[1]+=P,_[2]+=I,_[3]+=P,_[4]+=I,_[5]+=P,_[6]+=I;case"C":H=_[3],Q=_[4],P=_[5],I=_[6];break;case"s":_[0]="S",_[1]+=P,_[2]+=I,_[3]+=P,_[4]+=I;case"S":N==="C"?(H=2*P-H,Q=2*I-Q):(H=P,Q=I),P=_[3],I=_[4],_[0]="C",_[5]=_[3],_[6]=_[4],_[3]=_[1],_[4]=_[2],_[1]=H,_[2]=Q,H=_[3],Q=_[4];break;case"q":_[0]="Q",_[1]+=P,_[2]+=I,_[3]+=P,_[4]+=I;case"Q":H=_[1],Q=_[2],P=_[3],I=_[4];break;case"t":_[0]="T",_[1]+=P,_[2]+=I;case"T":N==="Q"?(H=2*P-H,Q=2*I-Q):(H=P,Q=I),_[0]="Q",P=_[1],I=_[2],_[1]=H,_[2]=Q,_[3]=P,_[4]=I;break;case"a":_[0]="A",_[6]+=P,_[7]+=I;case"A":j=!0,q=q.concat(a(P,I,_)),P=_[6],I=_[7];break;case"z":case"Z":P=K,I=S;break;default:}j||q.push(_),N=_[0]}return q}function u(x,P,I,k){return Math.sqrt((I-x)*(I-x)+(k-P)*(k-P))}function c(x){return x*x*x}function h(x){return 3*x*x*(1-x)}function d(x){return 3*x*(1-x)*(1-x)}function g(x){return(1-x)*(1-x)*(1-x)}function m(x,P,I,k,K,S,_,O){return function(j){var q=c(j),N=h(j),H=d(j),Q=g(j);return{x:_*q+K*N+I*H+x*Q,y:O*q+S*N+k*H+P*Q}}}function y(x,P,I,k,K,S,_,O){return function(j){var q=1-j,N=3*q*q*(I-x)+6*q*j*(K-I)+3*j*j*(_-K),H=3*q*q*(k-P)+6*q*j*(S-k)+3*j*j*(O-S);return Math.atan2(H,N)}}function C(x){return x*x}function w(x){return 2*x*(1-x)}function F(x){return(1-x)*(1-x)}function B(x,P,I,k,K,S){return function(_){var O=C(_),j=w(_),q=F(_);return{x:K*O+I*j+x*q,y:S*O+k*j+P*q}}}function U(x,P,I,k,K,S){return function(_){var O=1-_,j=2*O*(I-x)+2*_*(K-I),q=2*O*(k-P)+2*_*(S-k);return Math.atan2(q,j)}}function R(x,P,I){var k={x:P,y:I},K,S=0,_;for(_=1;_<=100;_+=1)K=x(_/100),S+=u(k.x,k.y,K.x,K.y),k=K;return S}function W(x,P){for(var I=0,k=0,K=x.iterator,S={x:x.x,y:x.y},_,O,j=.01,q=x.angleFinder,N;k<P&&j>1e-4;)_=K(I),N=I,O=u(S.x,S.y,_.x,_.y),O+k>P?(I-=j,j/=2):(S=_,I+=j,k+=O);return _.angle=q(N),_}function X(x){for(var P=0,I=x.length,k,K=0,S=0,_=0,O=0,j=[],q,N,H,Q=0;Q<I;Q++){switch(k=x[Q],N={x:K,y:S,command:k[0]},k[0]){case"M":N.length=0,_=K=k[1],O=S=k[2];break;case"L":N.length=u(K,S,k[1],k[2]),K=k[1],S=k[2];break;case"C":q=m(K,S,k[1],k[2],k[3],k[4],k[5],k[6]),H=y(K,S,k[1],k[2],k[3],k[4],k[5],k[6]),N.iterator=q,N.angleFinder=H,N.length=R(q,K,S),K=k[5],S=k[6];break;case"Q":q=B(K,S,k[1],k[2],k[3],k[4]),H=U(K,S,k[1],k[2],k[3],k[4]),N.iterator=q,N.angleFinder=H,N.length=R(q,K,S),K=k[3],S=k[4];break;case"Z":case"z":N.destX=_,N.destY=O,N.length=u(K,S,_,O),K=_,S=O;break}P+=N.length,j.push(N)}return j.push({length:P,x:K,y:S}),j}function $(x,P,I){I||(I=X(x));for(var k=0;P-I[k].length>0&&k<I.length-2;)P-=I[k].length,k++;var K=I[k],S=P/K.length,_=K.command,O=x[k],j;switch(_){case"M":return{x:K.x,y:K.y,angle:0};case"Z":case"z":return j=new D.Point(K.x,K.y).lerp(new D.Point(K.destX,K.destY),S),j.angle=Math.atan2(K.destY-K.y,K.destX-K.x),j;case"L":return j=new D.Point(K.x,K.y).lerp(new D.Point(O[1],O[2]),S),j.angle=Math.atan2(O[2]-K.y,O[1]-K.x),j;case"C":return W(K,P);case"Q":return W(K,P)}}function st(x){var P=[],I=[],k,K,S=D.rePathCommand,_="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",O="("+_+")"+D.commaWsp,j="([01])"+D.commaWsp+"?",q=O+"?"+O+"?"+O+j+j+O+"?("+_+")",N=new RegExp(q,"g"),H,Q,ot;if(!x||!x.match)return P;ot=x.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var Y=0,z,it=ot.length;Y<it;Y++){k=ot[Y],Q=k.slice(1).trim(),I.length=0;var Z=k.charAt(0);if(z=[Z],Z.toLowerCase()==="a")for(var J;J=N.exec(Q);)for(var nt=1;nt<J.length;nt++)I.push(J[nt]);else for(;H=S.exec(Q);)I.push(H[0]);for(var nt=0,lt=I.length;nt<lt;nt++)K=parseFloat(I[nt]),isNaN(K)||z.push(K);var At=t[Z.toLowerCase()],wt=i[Z]||Z;if(z.length-1>At)for(var et=1,yt=z.length;et<yt;et+=At)P.push([Z].concat(z.slice(et,et+At))),Z=wt;else P.push(z)}return P}function pt(x,P){var I=[],k,K=new D.Point(x[0].x,x[0].y),S=new D.Point(x[1].x,x[1].y),_=x.length,O=1,j=0,q=_>2;for(P=P||0,q&&(O=x[2].x<S.x?-1:x[2].x===S.x?0:1,j=x[2].y<S.y?-1:x[2].y===S.y?0:1),I.push(["M",K.x-O*P,K.y-j*P]),k=1;k<_;k++){if(!K.eq(S)){var N=K.midPointFrom(S);I.push(["Q",K.x,K.y,N.x,N.y])}K=x[k],k+1<x.length&&(S=x[k+1])}return q&&(O=K.x>x[k-2].x?1:K.x===x[k-2].x?0:-1,j=K.y>x[k-2].y?1:K.y===x[k-2].y?0:-1),I.push(["L",K.x+O*P,K.y+j*P]),I}function dt(x,P,I){return I&&(P=D.util.multiplyTransformMatrices(P,[1,0,0,1,-I.x,-I.y])),x.map(function(k){for(var K=k.slice(0),S={},_=1;_<k.length-1;_+=2)S.x=k[_],S.y=k[_+1],S=D.util.transformPoint(S,P),K[_]=S.x,K[_+1]=S.y;return K})}D.util.joinPath=function(x){return x.map(function(P){return P.join(" ")}).join(" ")},D.util.parsePath=st,D.util.makePathSimpler=l,D.util.getSmoothPathFromPoints=pt,D.util.getPathSegmentsInfo=X,D.util.getBoundsOfCurve=r,D.util.getPointOnPath=$,D.util.transformPath=dt})();(function(){var e=Array.prototype.slice;function t(r,a){for(var l=e.call(arguments,2),u=[],c=0,h=r.length;c<h;c++)u[c]=l.length?r[c][a].apply(r[c],l):r[c][a].call(r[c]);return u}function i(r,a){return s(r,a,function(l,u){return l>=u})}function o(r,a){return s(r,a,function(l,u){return l<u})}function n(r,a){for(var l=r.length;l--;)r[l]=a;return r}function s(r,a,l){if(!(!r||r.length===0)){var u=r.length-1,c=a?r[u][a]:r[u];if(a)for(;u--;)l(r[u][a],c)&&(c=r[u][a]);else for(;u--;)l(r[u],c)&&(c=r[u]);return c}}D.util.array={fill:n,invoke:t,min:o,max:i}})();(function(){function e(i,o,n){if(n)if(!D.isLikelyNode&&o instanceof Element)i=o;else if(o instanceof Array){i=[];for(var s=0,r=o.length;s<r;s++)i[s]=e({},o[s],n)}else if(o&&typeof o=="object")for(var a in o)a==="canvas"||a==="group"?i[a]=null:o.hasOwnProperty(a)&&(i[a]=e({},o[a],n));else i=o;else for(var a in o)i[a]=o[a];return i}function t(i,o){return e({},i,o)}D.util.object={extend:e,clone:t},D.util.object.extend(D.util,D.Observable)})();(function(){function e(s){return s.replace(/-+(.)?/g,function(r,a){return a?a.toUpperCase():""})}function t(s,r){return s.charAt(0).toUpperCase()+(r?s.slice(1):s.slice(1).toLowerCase())}function i(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(s){var r=0,a,l=[];for(r=0,a;r<s.length;r++)(a=n(s,r))!==!1&&l.push(a);return l}function n(s,r){var a=s.charCodeAt(r);if(isNaN(a))return"";if(a<55296||a>57343)return s.charAt(r);if(55296<=a&&a<=56319){if(s.length<=r+1)throw"High surrogate without following low surrogate";var l=s.charCodeAt(r+1);if(56320>l||l>57343)throw"High surrogate without following low surrogate";return s.charAt(r)+s.charAt(r+1)}if(r===0)throw"Low surrogate without preceding high surrogate";var u=s.charCodeAt(r-1);if(55296>u||u>56319)throw"Low surrogate without preceding high surrogate";return!1}D.util.string={camelize:e,capitalize:t,escapeXml:i,graphemeSplit:o}})();(function(){var e=Array.prototype.slice,t=function(){},i=function(){for(var a in{toString:1})if(a==="toString")return!1;return!0}(),o=function(a,l,u){for(var c in l)c in a.prototype&&typeof a.prototype[c]=="function"&&(l[c]+"").indexOf("callSuper")>-1?a.prototype[c]=function(h){return function(){var d=this.constructor.superclass;this.constructor.superclass=u;var g=l[h].apply(this,arguments);if(this.constructor.superclass=d,h!=="initialize")return g}}(c):a.prototype[c]=l[c],i&&(l.toString!==Object.prototype.toString&&(a.prototype.toString=l.toString),l.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=l.valueOf))};function n(){}function s(a){for(var l=null,u=this;u.constructor.superclass;){var c=u.constructor.superclass.prototype[a];if(u[a]!==c){l=c;break}u=u.constructor.superclass.prototype}return l?arguments.length>1?l.apply(this,e.call(arguments,1)):l.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}function r(){var a=null,l=e.call(arguments,0);typeof l[0]=="function"&&(a=l.shift());function u(){this.initialize.apply(this,arguments)}u.superclass=a,u.subclasses=[],a&&(n.prototype=a.prototype,u.prototype=new n,a.subclasses.push(u));for(var c=0,h=l.length;c<h;c++)o(u,l[c],a);return u.prototype.initialize||(u.prototype.initialize=t),u.prototype.constructor=u,u.prototype.callSuper=s,u}D.util.createClass=r})();(function(){var e=!!D.document.createElement("div").attachEvent,t=["touchstart","touchmove","touchend"];D.util.addListener=function(o,n,s,r){o&&o.addEventListener(n,s,e?!1:r)},D.util.removeListener=function(o,n,s,r){o&&o.removeEventListener(n,s,e?!1:r)};function i(o){var n=o.changedTouches;return n&&n[0]?n[0]:o}D.util.getPointer=function(o){var n=o.target,s=D.util.getScrollLeftTop(n),r=i(o);return{x:r.clientX+s.left,y:r.clientY+s.top}},D.util.isTouchEvent=function(o){return t.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function e(r,a){var l=r.style;if(!l)return r;if(typeof a=="string")return r.style.cssText+=";"+a,a.indexOf("opacity")>-1?s(r,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):r;for(var u in a)if(u==="opacity")s(r,a[u]);else{var c=u==="float"||u==="cssFloat"?typeof l.styleFloat>"u"?"cssFloat":"styleFloat":u;l.setProperty(c,a[u])}return r}var t=D.document.createElement("div"),i=typeof t.style.opacity=="string",o=typeof t.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(r){return r};i?s=function(r,a){return r.style.opacity=a,r}:o&&(s=function(r,a){var l=r.style;return r.currentStyle&&!r.currentStyle.hasLayout&&(l.zoom=1),n.test(l.filter)?(a=a>=.9999?"":"alpha(opacity="+a*100+")",l.filter=l.filter.replace(n,a)):l.filter+=" alpha(opacity="+a*100+")",r}),D.util.setStyle=e})();(function(){var e=Array.prototype.slice;function t(g){return typeof g=="string"?D.document.getElementById(g):g}var i,o=function(g){return e.call(g,0)};try{i=o(D.document.childNodes)instanceof Array}catch{}i||(o=function(g){for(var m=new Array(g.length),y=g.length;y--;)m[y]=g[y];return m});function n(g,m){var y=D.document.createElement(g);for(var C in m)C==="class"?y.className=m[C]:C==="for"?y.htmlFor=m[C]:y.setAttribute(C,m[C]);return y}function s(g,m){g&&(" "+g.className+" ").indexOf(" "+m+" ")===-1&&(g.className+=(g.className?" ":"")+m)}function r(g,m,y){return typeof m=="string"&&(m=n(m,y)),g.parentNode&&g.parentNode.replaceChild(m,g),m.appendChild(g),m}function a(g){for(var m=0,y=0,C=D.document.documentElement,w=D.document.body||{scrollLeft:0,scrollTop:0};g&&(g.parentNode||g.host)&&(g=g.parentNode||g.host,g===D.document?(m=w.scrollLeft||C.scrollLeft||0,y=w.scrollTop||C.scrollTop||0):(m+=g.scrollLeft||0,y+=g.scrollTop||0),!(g.nodeType===1&&g.style.position==="fixed")););return{left:m,top:y}}function l(g){var m,y=g&&g.ownerDocument,C={left:0,top:0},w={left:0,top:0},F,B={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!y)return w;for(var U in B)w[B[U]]+=parseInt(u(g,U),10)||0;return m=y.documentElement,typeof g.getBoundingClientRect<"u"&&(C=g.getBoundingClientRect()),F=a(g),{left:C.left+F.left-(m.clientLeft||0)+w.left,top:C.top+F.top-(m.clientTop||0)+w.top}}var u;D.document.defaultView&&D.document.defaultView.getComputedStyle?u=function(g,m){var y=D.document.defaultView.getComputedStyle(g,null);return y?y[m]:void 0}:u=function(g,m){var y=g.style[m];return!y&&g.currentStyle&&(y=g.currentStyle[m]),y},function(){var g=D.document.documentElement.style,m="userSelect"in g?"userSelect":"MozUserSelect"in g?"MozUserSelect":"WebkitUserSelect"in g?"WebkitUserSelect":"KhtmlUserSelect"in g?"KhtmlUserSelect":"";function y(w){return typeof w.onselectstart<"u"&&(w.onselectstart=D.util.falseFunction),m?w.style[m]="none":typeof w.unselectable=="string"&&(w.unselectable="on"),w}function C(w){return typeof w.onselectstart<"u"&&(w.onselectstart=null),m?w.style[m]="":typeof w.unselectable=="string"&&(w.unselectable=""),w}D.util.makeElementUnselectable=y,D.util.makeElementSelectable=C}();function c(g){var m=D.jsdomImplForWrapper(g);return m._canvas||m._image}function h(g){if(D.isLikelyNode){var m=D.jsdomImplForWrapper(g);m&&(m._image=null,m._canvas=null,m._currentSrc=null,m._attributes=null,m._classList=null)}}function d(g,m){g.imageSmoothingEnabled=g.imageSmoothingEnabled||g.webkitImageSmoothingEnabled||g.mozImageSmoothingEnabled||g.msImageSmoothingEnabled||g.oImageSmoothingEnabled,g.imageSmoothingEnabled=m}D.util.setImageSmoothing=d,D.util.getById=t,D.util.toArray=o,D.util.addClass=s,D.util.makeElement=n,D.util.wrapElement=r,D.util.getScrollLeftTop=a,D.util.getElementOffset=l,D.util.getNodeCanvas=c,D.util.cleanUpJsdomNode=h})();(function(){function e(o,n){return o+(/\?/.test(o)?"&":"?")+n}function t(){}function i(o,n){n||(n={});var s=n.method?n.method.toUpperCase():"GET",r=n.onComplete||function(){},a=new D.window.XMLHttpRequest,l=n.body||n.parameters;return a.onreadystatechange=function(){a.readyState===4&&(r(a),a.onreadystatechange=t)},s==="GET"&&(l=null,typeof n.parameters=="string"&&(o=e(o,n.parameters))),a.open(s,o,!0),(s==="POST"||s==="PUT")&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(l),a}D.util.request=i})();D.log=console.log;D.warn=console.warn;(function(){var e=D.util.object.extend,t=D.util.object.clone,i=[];D.util.object.extend(i,{cancelAll:function(){var c=this.splice(0);return c.forEach(function(h){h.cancel()}),c},cancelByCanvas:function(c){if(!c)return[];var h=this.filter(function(d){return typeof d.target=="object"&&d.target.canvas===c});return h.forEach(function(d){d.cancel()}),h},cancelByTarget:function(c){var h=this.findAnimationsByTarget(c);return h.forEach(function(d){d.cancel()}),h},findAnimationIndex:function(c){return this.indexOf(this.findAnimation(c))},findAnimation:function(c){return this.find(function(h){return h.cancel===c})},findAnimationsByTarget:function(c){return c?this.filter(function(h){return h.target===c}):[]}});function o(){return!1}function n(c,h,d,g){return-d*Math.cos(c/g*(Math.PI/2))+d+h}function s(c){c||(c={});var h=!1,d,g=function(){var m=D.runningAnimations.indexOf(d);return m>-1&&D.runningAnimations.splice(m,1)[0]};return d=e(t(c),{cancel:function(){return h=!0,g()},currentValue:"startValue"in c?c.startValue:0,completionRate:0,durationRate:0}),D.runningAnimations.push(d),l(function(m){var y=m||+new Date,C=c.duration||500,w=y+C,F,B=c.onChange||o,U=c.abort||o,R=c.onComplete||o,W=c.easing||n,X="startValue"in c?c.startValue.length>0:!1,$="startValue"in c?c.startValue:0,st="endValue"in c?c.endValue:100,pt=c.byValue||(X?$.map(function(dt,x){return st[x]-$[x]}):st-$);c.onStart&&c.onStart(),function dt(x){F=x||+new Date;var P=F>w?C:F-y,I=P/C,k=X?$.map(function(S,_){return W(P,$[_],pt[_],C)}):W(P,$,pt,C),K=Math.abs(X?(k[0]-$[0])/pt[0]:(k-$)/pt);if(d.currentValue=X?k.slice():k,d.completionRate=K,d.durationRate=I,!h){if(U(k,K,I)){g();return}if(F>w){d.currentValue=X?st.slice():st,d.completionRate=1,d.durationRate=1,B(X?st.slice():st,1,1),R(st,1,1),g();return}else B(k,K,I),l(dt)}}(y)}),d.cancel}var r=D.window.requestAnimationFrame||D.window.webkitRequestAnimationFrame||D.window.mozRequestAnimationFrame||D.window.oRequestAnimationFrame||D.window.msRequestAnimationFrame||function(c){return D.window.setTimeout(c,1e3/60)},a=D.window.cancelAnimationFrame||D.window.clearTimeout;function l(){return r.apply(D.window,arguments)}function u(){return a.apply(D.window,arguments)}D.util.animate=s,D.util.requestAnimFrame=l,D.util.cancelAnimFrame=u,D.runningAnimations=i})();(function(){function e(i,o,n){var s="rgba("+parseInt(i[0]+n*(o[0]-i[0]),10)+","+parseInt(i[1]+n*(o[1]-i[1]),10)+","+parseInt(i[2]+n*(o[2]-i[2]),10);return s+=","+(i&&o?parseFloat(i[3]+n*(o[3]-i[3])):1),s+=")",s}function t(i,o,n,s){var r=new D.Color(i).getSource(),a=new D.Color(o).getSource(),l=s.onComplete,u=s.onChange;return s=s||{},D.util.animate(D.util.object.extend(s,{duration:n||500,startValue:r,endValue:a,byValue:a,easing:function(c,h,d,g){var m=s.colorEasing?s.colorEasing(c,g):1-Math.cos(c/g*(Math.PI/2));return e(h,d,m)},onComplete:function(c,h,d){if(l)return l(e(a,a,0),h,d)},onChange:function(c,h,d){if(u){if(Array.isArray(c))return u(e(c,c,0),h,d);u(c,h,d)}}}))}D.util.animateColor=t})();(function(){function e(x,P,I,k){return x<Math.abs(P)?(x=P,k=I/4):P===0&&x===0?k=I/(2*Math.PI)*Math.asin(1):k=I/(2*Math.PI)*Math.asin(P/x),{a:x,c:P,p:I,s:k}}function t(x,P,I){return x.a*Math.pow(2,10*(P-=1))*Math.sin((P*I-x.s)*(2*Math.PI)/x.p)}function i(x,P,I,k){return I*((x=x/k-1)*x*x+1)+P}function o(x,P,I,k){return x/=k/2,x<1?I/2*x*x*x+P:I/2*((x-=2)*x*x+2)+P}function n(x,P,I,k){return I*(x/=k)*x*x*x+P}function s(x,P,I,k){return-I*((x=x/k-1)*x*x*x-1)+P}function r(x,P,I,k){return x/=k/2,x<1?I/2*x*x*x*x+P:-I/2*((x-=2)*x*x*x-2)+P}function a(x,P,I,k){return I*(x/=k)*x*x*x*x+P}function l(x,P,I,k){return I*((x=x/k-1)*x*x*x*x+1)+P}function u(x,P,I,k){return x/=k/2,x<1?I/2*x*x*x*x*x+P:I/2*((x-=2)*x*x*x*x+2)+P}function c(x,P,I,k){return-I*Math.cos(x/k*(Math.PI/2))+I+P}function h(x,P,I,k){return I*Math.sin(x/k*(Math.PI/2))+P}function d(x,P,I,k){return-I/2*(Math.cos(Math.PI*x/k)-1)+P}function g(x,P,I,k){return x===0?P:I*Math.pow(2,10*(x/k-1))+P}function m(x,P,I,k){return x===k?P+I:I*(-Math.pow(2,-10*x/k)+1)+P}function y(x,P,I,k){return x===0?P:x===k?P+I:(x/=k/2,x<1?I/2*Math.pow(2,10*(x-1))+P:I/2*(-Math.pow(2,-10*--x)+2)+P)}function C(x,P,I,k){return-I*(Math.sqrt(1-(x/=k)*x)-1)+P}function w(x,P,I,k){return I*Math.sqrt(1-(x=x/k-1)*x)+P}function F(x,P,I,k){return x/=k/2,x<1?-I/2*(Math.sqrt(1-x*x)-1)+P:I/2*(Math.sqrt(1-(x-=2)*x)+1)+P}function B(x,P,I,k){var K=1.70158,S=0,_=I;if(x===0)return P;if(x/=k,x===1)return P+I;S||(S=k*.3);var O=e(_,I,S,K);return-t(O,x,k)+P}function U(x,P,I,k){var K=1.70158,S=0,_=I;if(x===0)return P;if(x/=k,x===1)return P+I;S||(S=k*.3);var O=e(_,I,S,K);return O.a*Math.pow(2,-10*x)*Math.sin((x*k-O.s)*(2*Math.PI)/O.p)+O.c+P}function R(x,P,I,k){var K=1.70158,S=0,_=I;if(x===0)return P;if(x/=k/2,x===2)return P+I;S||(S=k*(.3*1.5));var O=e(_,I,S,K);return x<1?-.5*t(O,x,k)+P:O.a*Math.pow(2,-10*(x-=1))*Math.sin((x*k-O.s)*(2*Math.PI)/O.p)*.5+O.c+P}function W(x,P,I,k,K){return K===void 0&&(K=1.70158),I*(x/=k)*x*((K+1)*x-K)+P}function X(x,P,I,k,K){return K===void 0&&(K=1.70158),I*((x=x/k-1)*x*((K+1)*x+K)+1)+P}function $(x,P,I,k,K){return K===void 0&&(K=1.70158),x/=k/2,x<1?I/2*(x*x*(((K*=1.525)+1)*x-K))+P:I/2*((x-=2)*x*(((K*=1.525)+1)*x+K)+2)+P}function st(x,P,I,k){return I-pt(k-x,0,I,k)+P}function pt(x,P,I,k){return(x/=k)<1/2.75?I*(7.5625*x*x)+P:x<2/2.75?I*(7.5625*(x-=1.5/2.75)*x+.75)+P:x<2.5/2.75?I*(7.5625*(x-=2.25/2.75)*x+.9375)+P:I*(7.5625*(x-=2.625/2.75)*x+.984375)+P}function dt(x,P,I,k){return x<k/2?st(x*2,0,I,k)*.5+P:pt(x*2-k,0,I,k)*.5+I*.5+P}D.util.ease={easeInQuad:function(x,P,I,k){return I*(x/=k)*x+P},easeOutQuad:function(x,P,I,k){return-I*(x/=k)*(x-2)+P},easeInOutQuad:function(x,P,I,k){return x/=k/2,x<1?I/2*x*x+P:-I/2*(--x*(x-2)-1)+P},easeInCubic:function(x,P,I,k){return I*(x/=k)*x*x+P},easeOutCubic:i,easeInOutCubic:o,easeInQuart:n,easeOutQuart:s,easeInOutQuart:r,easeInQuint:a,easeOutQuint:l,easeInOutQuint:u,easeInSine:c,easeOutSine:h,easeInOutSine:d,easeInExpo:g,easeOutExpo:m,easeInOutExpo:y,easeInCirc:C,easeOutCirc:w,easeInOutCirc:F,easeInElastic:B,easeOutElastic:U,easeInOutElastic:R,easeInBack:W,easeOutBack:X,easeInOutBack:$,easeInBounce:st,easeOutBounce:pt,easeInOutBounce:dt}})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.parseUnit,r=t.util.multiplyTransformMatrices,a=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],l=["symbol","image","marker","pattern","view","svg"],u=["pattern","defs","symbol","metadata","clipPath","mask","desc"],c=["symbol","g","a","svg","clipPath","defs"],h={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},d={stroke:"strokeOpacity",fill:"fillOpacity"},g="font-size",m="clip-path";t.svgValidTagNamesRegEx=w(a),t.svgViewBoxElementsRegEx=w(l),t.svgInvalidAncestorsRegEx=w(u),t.svgValidParentsRegEx=w(c),t.cssRules={},t.gradientDefs={},t.clipPaths={};function y(S){return S in h?h[S]:S}function C(S,_,O,j){var q=Array.isArray(_),N;if((S==="fill"||S==="stroke")&&_==="none")_="";else{if(S==="strokeUniform")return _==="non-scaling-stroke";if(S==="strokeDashArray")_==="none"?_=null:_=_.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(S==="transformMatrix")O&&O.transformMatrix?_=r(O.transformMatrix,t.parseTransformAttribute(_)):_=t.parseTransformAttribute(_);else if(S==="visible")_=_!=="none"&&_!=="hidden",O&&O.visible===!1&&(_=!1);else if(S==="opacity")_=parseFloat(_),O&&typeof O.opacity<"u"&&(_*=O.opacity);else if(S==="textAnchor")_=_==="start"?"left":_==="end"?"right":"center";else if(S==="charSpacing")N=s(_,j)/j*1e3;else if(S==="paintFirst"){var H=_.indexOf("fill"),Q=_.indexOf("stroke"),_="fill";(H>-1&&Q>-1&&Q<H||H===-1&&Q>-1)&&(_="stroke")}else{if(S==="href"||S==="xlink:href"||S==="font")return _;if(S==="imageSmoothing")return _==="optimizeQuality";N=q?_.map(s):s(_,j)}}return!q&&isNaN(N)?_:N}function w(S){return new RegExp("^("+S.join("|")+")\\b","i")}function F(S){for(var _ in d)if(!(typeof S[d[_]]>"u"||S[_]==="")){if(typeof S[_]>"u"){if(!t.Object.prototype[_])continue;S[_]=t.Object.prototype[_]}if(S[_].indexOf("url(")!==0){var O=new t.Color(S[_]);S[_]=O.setAlpha(n(O.getAlpha()*S[d[_]],2)).toRgba()}}return S}function B(S,_){var O,j=[],q,N,H;for(N=0,H=_.length;N<H;N++)O=_[N],q=S.getElementsByTagName(O),j=j.concat(Array.prototype.slice.call(q));return j}t.parseTransformAttribute=function(){function S(et,yt){var Tt=t.util.cos(yt[0]),It=t.util.sin(yt[0]),jt=0,Mt=0;yt.length===3&&(jt=yt[1],Mt=yt[2]),et[0]=Tt,et[1]=It,et[2]=-It,et[3]=Tt,et[4]=jt-(Tt*jt-It*Mt),et[5]=Mt-(It*jt+Tt*Mt)}function _(et,yt){var Tt=yt[0],It=yt.length===2?yt[1]:yt[0];et[0]=Tt,et[3]=It}function O(et,yt,Tt){et[Tt]=Math.tan(t.util.degreesToRadians(yt[0]))}function j(et,yt){et[4]=yt[0],yt.length===2&&(et[5]=yt[1])}var q=t.iMatrix,N=t.reNum,H=t.commaWsp,Q="(?:(skewX)\\s*\\(\\s*("+N+")\\s*\\))",ot="(?:(skewY)\\s*\\(\\s*("+N+")\\s*\\))",Y="(?:(rotate)\\s*\\(\\s*("+N+")(?:"+H+"("+N+")"+H+"("+N+"))?\\s*\\))",z="(?:(scale)\\s*\\(\\s*("+N+")(?:"+H+"("+N+"))?\\s*\\))",it="(?:(translate)\\s*\\(\\s*("+N+")(?:"+H+"("+N+"))?\\s*\\))",Z="(?:(matrix)\\s*\\(\\s*("+N+")"+H+"("+N+")"+H+"("+N+")"+H+"("+N+")"+H+"("+N+")"+H+"("+N+")\\s*\\))",J="(?:"+Z+"|"+it+"|"+z+"|"+Y+"|"+Q+"|"+ot+")",nt="(?:"+J+"(?:"+H+"*"+J+")*)",lt="^\\s*(?:"+nt+"?)\\s*$",At=new RegExp(lt),wt=new RegExp(J,"g");return function(et){var yt=q.concat(),Tt=[];if(!et||et&&!At.test(et))return yt;et.replace(wt,function(jt){var Mt=new RegExp(J).exec(jt).filter(function(Le){return!!Le}),se=Mt[1],Jt=Mt.slice(2).map(parseFloat);switch(se){case"translate":j(yt,Jt);break;case"rotate":Jt[0]=t.util.degreesToRadians(Jt[0]),S(yt,Jt);break;case"scale":_(yt,Jt);break;case"skewX":O(yt,Jt,2);break;case"skewY":O(yt,Jt,1);break;case"matrix":yt=Jt;break}Tt.push(yt.concat()),yt=q.concat()});for(var It=Tt[0];Tt.length>1;)Tt.shift(),It=t.util.multiplyTransformMatrices(It,Tt[0]);return It}}();function U(S,_){var O,j;S.replace(/;\s*$/,"").split(";").forEach(function(q){var N=q.split(":");O=N[0].trim().toLowerCase(),j=N[1].trim(),_[O]=j})}function R(S,_){var O,j;for(var q in S)typeof S[q]>"u"||(O=q.toLowerCase(),j=S[q],_[O]=j)}function W(S,_){var O={};for(var j in t.cssRules[_])if(X(S,j.split(" ")))for(var q in t.cssRules[_][j])O[q]=t.cssRules[_][j][q];return O}function X(S,_){var O,j=!0;return O=st(S,_.pop()),O&&_.length&&(j=$(S,_)),O&&j&&_.length===0}function $(S,_){for(var O,j=!0;S.parentNode&&S.parentNode.nodeType===1&&_.length;)j&&(O=_.pop()),S=S.parentNode,j=st(S,O);return _.length===0}function st(S,_){var O=S.nodeName,j=S.getAttribute("class"),q=S.getAttribute("id"),N,H;if(N=new RegExp("^"+O,"i"),_=_.replace(N,""),q&&_.length&&(N=new RegExp("#"+q+"(?![a-zA-Z\\-]+)","i"),_=_.replace(N,"")),j&&_.length)for(j=j.split(" "),H=j.length;H--;)N=new RegExp("\\."+j[H]+"(?![a-zA-Z\\-]+)","i"),_=_.replace(N,"");return _.length===0}function pt(S,_){var O;if(S.getElementById&&(O=S.getElementById(_)),O)return O;var j,q,N,H=S.getElementsByTagName("*");for(q=0,N=H.length;q<N;q++)if(j=H[q],_===j.getAttribute("id"))return j}function dt(S){for(var _=B(S,["use","svg:use"]),O=0;_.length&&O<_.length;){var j=_[O],q=j.getAttribute("xlink:href")||j.getAttribute("href");if(q===null)return;var N=q.slice(1),H=j.getAttribute("x")||0,Q=j.getAttribute("y")||0,ot=pt(S,N).cloneNode(!0),Y=(ot.getAttribute("transform")||"")+" translate("+H+", "+Q+")",z,it=_.length,Z,J,nt,lt,At=t.svgNS;if(P(ot),/^svg$/i.test(ot.nodeName)){var wt=ot.ownerDocument.createElementNS(At,"g");for(J=0,nt=ot.attributes,lt=nt.length;J<lt;J++)Z=nt.item(J),wt.setAttributeNS(At,Z.nodeName,Z.nodeValue);for(;ot.firstChild;)wt.appendChild(ot.firstChild);ot=wt}for(J=0,nt=j.attributes,lt=nt.length;J<lt;J++)Z=nt.item(J),!(Z.nodeName==="x"||Z.nodeName==="y"||Z.nodeName==="xlink:href"||Z.nodeName==="href")&&(Z.nodeName==="transform"?Y=Z.nodeValue+" "+Y:ot.setAttribute(Z.nodeName,Z.nodeValue));ot.setAttribute("transform",Y),ot.setAttribute("instantiated_by_use","1"),ot.removeAttribute("id"),z=j.parentNode,z.replaceChild(ot,j),_.length===it&&O++}}var x=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function P(S){if(!t.svgViewBoxElementsRegEx.test(S.nodeName))return{};var _=S.getAttribute("viewBox"),O=1,j=1,q=0,N=0,H,Q,ot,Y,z=S.getAttribute("width"),it=S.getAttribute("height"),Z=S.getAttribute("x")||0,J=S.getAttribute("y")||0,nt=S.getAttribute("preserveAspectRatio")||"",lt=!_||!(_=_.match(x)),At=!z||!it||z==="100%"||it==="100%",wt=lt&&At,et={},yt="",Tt=0,It=0;if(et.width=0,et.height=0,et.toBeParsed=wt,lt&&(Z||J)&&S.parentNode&&S.parentNode.nodeName!=="#document"&&(yt=" translate("+s(Z)+" "+s(J)+") ",ot=(S.getAttribute("transform")||"")+yt,S.setAttribute("transform",ot),S.removeAttribute("x"),S.removeAttribute("y")),wt)return et;if(lt)return et.width=s(z),et.height=s(it),et;if(q=-parseFloat(_[1]),N=-parseFloat(_[2]),H=parseFloat(_[3]),Q=parseFloat(_[4]),et.minX=q,et.minY=N,et.viewBoxWidth=H,et.viewBoxHeight=Q,At?(et.width=H,et.height=Q):(et.width=s(z),et.height=s(it),O=et.width/H,j=et.height/Q),nt=t.util.parsePreserveAspectRatioAttribute(nt),nt.alignX!=="none"&&(nt.meetOrSlice==="meet"&&(j=O=O>j?j:O),nt.meetOrSlice==="slice"&&(j=O=O>j?O:j),Tt=et.width-H*O,It=et.height-Q*O,nt.alignX==="Mid"&&(Tt/=2),nt.alignY==="Mid"&&(It/=2),nt.alignX==="Min"&&(Tt=0),nt.alignY==="Min"&&(It=0)),O===1&&j===1&&q===0&&N===0&&Z===0&&J===0)return et;if((Z||J)&&S.parentNode.nodeName!=="#document"&&(yt=" translate("+s(Z)+" "+s(J)+") "),ot=yt+" matrix("+O+" 0 0 "+j+" "+(q*O+Tt)+" "+(N*j+It)+") ",S.nodeName==="svg"){for(Y=S.ownerDocument.createElementNS(t.svgNS,"g");S.firstChild;)Y.appendChild(S.firstChild);S.appendChild(Y)}else Y=S,Y.removeAttribute("x"),Y.removeAttribute("y"),ot=Y.getAttribute("transform")+ot;return Y.setAttribute("transform",ot),et}function I(S,_){for(;S&&(S=S.parentNode);)if(S.nodeName&&_.test(S.nodeName.replace("svg:",""))&&!S.getAttribute("instantiated_by_use"))return!0;return!1}t.parseSVGDocument=function(S,_,O,j){if(S){dt(S);var q=t.Object.__uid++,N,H,Q=P(S),ot=t.util.toArray(S.getElementsByTagName("*"));if(Q.crossOrigin=j&&j.crossOrigin,Q.svgUid=q,ot.length===0&&t.isLikelyNode){ot=S.selectNodes('//*[name(.)!="svg"]');var Y=[];for(N=0,H=ot.length;N<H;N++)Y[N]=ot[N];ot=Y}var z=ot.filter(function(Z){return P(Z),t.svgValidTagNamesRegEx.test(Z.nodeName.replace("svg:",""))&&!I(Z,t.svgInvalidAncestorsRegEx)});if(!z||z&&!z.length){_&&_([],{});return}var it={};ot.filter(function(Z){return Z.nodeName.replace("svg:","")==="clipPath"}).forEach(function(Z){var J=Z.getAttribute("id");it[J]=t.util.toArray(Z.getElementsByTagName("*")).filter(function(nt){return t.svgValidTagNamesRegEx.test(nt.nodeName.replace("svg:",""))})}),t.gradientDefs[q]=t.getGradientDefs(S),t.cssRules[q]=t.getCSSRules(S),t.clipPaths[q]=it,t.parseElements(z,function(Z,J){_&&(_(Z,Q,J,ot),delete t.gradientDefs[q],delete t.cssRules[q],delete t.clipPaths[q])},o(Q),O,j)}};function k(S,_){var O=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],j="xlink:href",q=_.getAttribute(j).slice(1),N=pt(S,q);if(N&&N.getAttribute(j)&&k(S,N),O.forEach(function(Q){N&&!_.hasAttribute(Q)&&N.hasAttribute(Q)&&_.setAttribute(Q,N.getAttribute(Q))}),!_.children.length)for(var H=N.cloneNode(!0);H.firstChild;)_.appendChild(H.firstChild);_.removeAttribute(j)}var K=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");i(t,{parseFontDeclaration:function(S,_){var O=S.match(K);if(O){var j=O[1],q=O[3],N=O[4],H=O[5],Q=O[6];j&&(_.fontStyle=j),q&&(_.fontWeight=isNaN(parseFloat(q))?q:parseFloat(q)),N&&(_.fontSize=s(N)),Q&&(_.fontFamily=Q),H&&(_.lineHeight=H==="normal"?1:H)}},getGradientDefs:function(S){var _=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],O=B(S,_),j,q=0,N={};for(q=O.length;q--;)j=O[q],j.getAttribute("xlink:href")&&k(S,j),N[j.getAttribute("id")]=j;return N},parseAttributes:function(S,_,O){if(S){var j,q={},N,H;typeof O>"u"&&(O=S.getAttribute("svgUid")),S.parentNode&&t.svgValidParentsRegEx.test(S.parentNode.nodeName)&&(q=t.parseAttributes(S.parentNode,_,O));var Q=_.reduce(function(nt,lt){return j=S.getAttribute(lt),j&&(nt[lt]=j),nt},{}),ot=i(W(S,O),t.parseStyleAttribute(S));Q=i(Q,ot),ot[m]&&S.setAttribute(m,ot[m]),N=H=q.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,Q[g]&&(Q[g]=N=s(Q[g],H));var Y,z,it={};for(var Z in Q)Y=y(Z),z=C(Y,Q[Z],q,N),it[Y]=z;it&&it.font&&t.parseFontDeclaration(it.font,it);var J=i(q,it);return t.svgValidParentsRegEx.test(S.nodeName)?J:F(J)}},parseElements:function(S,_,O,j,q){new t.ElementsParser(S,_,O,j,q).parse()},parseStyleAttribute:function(S){var _={},O=S.getAttribute("style");return O&&(typeof O=="string"?U(O,_):R(O,_)),_},parsePointsAttribute:function(S){if(!S)return null;S=S.replace(/,/g," ").trim(),S=S.split(/\s+/);var _=[],O,j;for(O=0,j=S.length;O<j;O+=2)_.push({x:parseFloat(S[O]),y:parseFloat(S[O+1])});return _},getCSSRules:function(S){var _=S.getElementsByTagName("style"),O,j,q={},N;for(O=0,j=_.length;O<j;O++){var H=_[O].textContent;H=H.replace(/\/\*[\s\S]*?\*\//g,""),H.trim()!==""&&(N=H.split("}"),N=N.filter(function(Q){return Q.trim()}),N.forEach(function(Q){var ot=Q.split("{"),Y={},z=ot[1].trim(),it=z.split(";").filter(function(lt){return lt.trim()});for(O=0,j=it.length;O<j;O++){var Z=it[O].split(":"),J=Z[0].trim(),nt=Z[1].trim();Y[J]=nt}Q=ot[0].trim(),Q.split(",").forEach(function(lt){lt=lt.replace(/^svg/i,"").trim(),lt!==""&&(q[lt]?t.util.object.extend(q[lt],Y):q[lt]=t.util.object.clone(Y))})}))}return q},loadSVGFromURL:function(S,_,O,j){S=S.replace(/^\n\s*/,"").trim(),new t.util.request(S,{method:"get",onComplete:q});function q(N){var H=N.responseXML;if(!H||!H.documentElement)return _&&_(null),!1;t.parseSVGDocument(H.documentElement,function(Q,ot,Y,z){_&&_(Q,ot,Y,z)},O,j)}},loadSVGFromString:function(S,_,O,j){var q=new t.window.DOMParser,N=q.parseFromString(S.trim(),"text/xml");t.parseSVGDocument(N.documentElement,function(H,Q,ot,Y){_(H,Q,ot,Y)},O,j)}})})(Ct);D.ElementsParser=function(e,t,i,o,n,s){this.elements=e,this.callback=t,this.options=i,this.reviver=o,this.svgUid=i&&i.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s};(function(e){e.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},e.createObjects=function(){var t=this;this.elements.forEach(function(i,o){i.setAttribute("svgUid",t.svgUid),t.createObject(i,o)})},e.findTag=function(t){return D[D.util.string.capitalize(t.tagName.replace("svg:",""))]},e.createObject=function(t,i){var o=this.findTag(t);if(o&&o.fromElement)try{o.fromElement(t,this.createCallback(i,t),this.options)}catch(n){D.log(n)}else this.checkIfDone()},e.createCallback=function(t,i){var o=this;return function(n){var s;o.resolveGradient(n,i,"fill"),o.resolveGradient(n,i,"stroke"),n instanceof D.Image&&n._originalElement&&(s=n.parsePreserveAspectRatioAttribute(i)),n._removeTransformMatrix(s),o.resolveClipPath(n,i),o.reviver&&o.reviver(i,n),o.instances[t]=n,o.checkIfDone()}},e.extractPropertyDefinition=function(t,i,o){var n=t[i],s=this.regexUrl;if(s.test(n)){s.lastIndex=0;var r=s.exec(n)[1];return s.lastIndex=0,D[o][this.svgUid][r]}},e.resolveGradient=function(t,i,o){var n=this.extractPropertyDefinition(t,o,"gradientDefs");if(n){var s=i.getAttribute(o+"-opacity"),r=D.Gradient.fromElement(n,t,s,this.options);t.set(o,r)}},e.createClipPathCallback=function(t,i){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,i.push(o)}},e.resolveClipPath=function(t,i){var o=this.extractPropertyDefinition(t,"clipPath","clipPaths"),n,s,r,a,l,u;if(o){a=[],r=D.util.invertTransform(t.calcTransformMatrix());for(var c=o[0].parentNode,h=i;h.parentNode&&h.getAttribute("clip-path")!==t.clipPath;)h=h.parentNode;h.parentNode.appendChild(c);for(var d=0;d<o.length;d++)n=o[d],s=this.findTag(n),s.fromElement(n,this.createClipPathCallback(t,a),this.options);a.length===1?o=a[0]:o=new D.Group(a),l=D.util.multiplyTransformMatrices(r,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,h);var u=D.util.qrDecompose(l);o.flipX=!1,o.flipY=!1,o.set("scaleX",u.scaleX),o.set("scaleY",u.scaleY),o.angle=u.angle,o.skewX=u.skewX,o.skewY=0,o.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),t.clipPath=o}else delete t.clipPath},e.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(t){return t!=null}),this.callback(this.instances,this.elements))}})(D.ElementsParser.prototype);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Point){t.warn("fabric.Point is already defined");return}t.Point=i;function i(o,n){this.x=o,this.y=n}i.prototype={type:"point",constructor:i,add:function(o){return new i(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new i(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new i(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new i(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new i(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new i(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new i(this.x+(o.x-this.x)*n,this.y+(o.y-this.y)*n)},distanceFrom:function(o){var n=this.x-o.x,s=this.y-o.y;return Math.sqrt(n*n+s*s)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new i(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new i(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,n){return this.x=o,this.y=n,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var n=this.x,s=this.y;this.x=o.x,this.y=o.y,o.x=n,o.y=s},clone:function(){return new i(this.x,this.y)}}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Intersection){t.warn("fabric.Intersection is already defined");return}function i(o){this.status=o,this.points=[]}t.Intersection=i,t.Intersection.prototype={constructor:i,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},t.Intersection.intersectLineLine=function(o,n,s,r){var a,l=(r.x-s.x)*(o.y-s.y)-(r.y-s.y)*(o.x-s.x),u=(n.x-o.x)*(o.y-s.y)-(n.y-o.y)*(o.x-s.x),c=(r.y-s.y)*(n.x-o.x)-(r.x-s.x)*(n.y-o.y);if(c!==0){var h=l/c,d=u/c;0<=h&&h<=1&&0<=d&&d<=1?(a=new i("Intersection"),a.appendPoint(new t.Point(o.x+h*(n.x-o.x),o.y+h*(n.y-o.y)))):a=new i}else l===0||u===0?a=new i("Coincident"):a=new i("Parallel");return a},t.Intersection.intersectLinePolygon=function(o,n,s){var r=new i,a=s.length,l,u,c,h;for(h=0;h<a;h++)l=s[h],u=s[(h+1)%a],c=i.intersectLineLine(o,n,l,u),r.appendPoints(c.points);return r.points.length>0&&(r.status="Intersection"),r},t.Intersection.intersectPolygonPolygon=function(o,n){var s=new i,r=o.length,a;for(a=0;a<r;a++){var l=o[a],u=o[(a+1)%r],c=i.intersectLinePolygon(l,u,n);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},t.Intersection.intersectPolygonRectangle=function(o,n,s){var r=n.min(s),a=n.max(s),l=new t.Point(a.x,r.y),u=new t.Point(r.x,a.y),c=i.intersectLinePolygon(r,l,o),h=i.intersectLinePolygon(l,a,o),d=i.intersectLinePolygon(a,u,o),g=i.intersectLinePolygon(u,r,o),m=new i;return m.appendPoints(c.points),m.appendPoints(h.points),m.appendPoints(d.points),m.appendPoints(g.points),m.points.length>0&&(m.status="Intersection"),m}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Color){t.warn("fabric.Color is already defined.");return}function i(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}t.Color=i,t.Color.prototype={_tryParsingColor:function(n){var s;n in i.colorNameMap&&(n=i.colorNameMap[n]),n==="transparent"&&(s=[255,255,255,0]),s||(s=i.sourceFromHex(n)),s||(s=i.sourceFromRgb(n)),s||(s=i.sourceFromHsl(n)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(n,s,r){n/=255,s/=255,r/=255;var a,l,u,c=t.util.array.max([n,s,r]),h=t.util.array.min([n,s,r]);if(u=(c+h)/2,c===h)a=l=0;else{var d=c-h;switch(l=u>.5?d/(2-c-h):d/(c+h),c){case n:a=(s-r)/d+(s<r?6:0);break;case s:a=(r-n)/d+2;break;case r:a=(n-s)/d+4;break}a/=6}return[Math.round(a*360),Math.round(l*100),Math.round(u*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),s,r,a;return s=n[0].toString(16),s=s.length===1?"0"+s:s,r=n[1].toString(16),r=r.length===1?"0"+r:r,a=n[2].toString(16),a=a.length===1?"0"+a:a,s.toUpperCase()+r.toUpperCase()+a.toUpperCase()},toHexa:function(){var n=this.getSource(),s;return s=Math.round(n[3]*255),s=s.toString(16),s=s.length===1?"0"+s:s,this.toHex()+s.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var s=this.getSource();return s[3]=n,this.setSource(s),this},toGrayscale:function(){var n=this.getSource(),s=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),r=n[3];return this.setSource([s,s,s,r]),this},toBlackWhite:function(n){var s=this.getSource(),r=(s[0]*.3+s[1]*.59+s[2]*.11).toFixed(0),a=s[3];return n=n||127,r=Number(r)<Number(n)?0:255,this.setSource([r,r,r,a]),this},overlayWith:function(n){n instanceof i||(n=new i(n));var s=[],r=this.getAlpha(),a=.5,l=this.getSource(),u=n.getSource(),c;for(c=0;c<3;c++)s.push(Math.round(l[c]*(1-a)+u[c]*a));return s[3]=r,this.setSource(s),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(n,s,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(s-n)*6*r:r<1/2?s:r<2/3?n+(s-n)*(2/3-r)*6:n}t.Color.fromRgb=function(n){return i.fromSource(i.sourceFromRgb(n))},t.Color.sourceFromRgb=function(n){var s=n.match(i.reRGBa);if(s){var r=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),a=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),l=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(r,10),parseInt(a,10),parseInt(l,10),s[4]?parseFloat(s[4]):1]}},t.Color.fromRgba=i.fromRgb,t.Color.fromHsl=function(n){return i.fromSource(i.sourceFromHsl(n))},t.Color.sourceFromHsl=function(n){var s=n.match(i.reHSLa);if(s){var r=(parseFloat(s[1])%360+360)%360/360,a=parseFloat(s[2])/(/%$/.test(s[2])?100:1),l=parseFloat(s[3])/(/%$/.test(s[3])?100:1),u,c,h;if(a===0)u=c=h=l;else{var d=l<=.5?l*(a+1):l+a-l*a,g=l*2-d;u=o(g,d,r+1/3),c=o(g,d,r),h=o(g,d,r-1/3)}return[Math.round(u*255),Math.round(c*255),Math.round(h*255),s[4]?parseFloat(s[4]):1]}},t.Color.fromHsla=i.fromHsl,t.Color.fromHex=function(n){return i.fromSource(i.sourceFromHex(n))},t.Color.sourceFromHex=function(n){if(n.match(i.reHex)){var s=n.slice(n.indexOf("#")+1),r=s.length===3||s.length===4,a=s.length===8||s.length===4,l=r?s.charAt(0)+s.charAt(0):s.substring(0,2),u=r?s.charAt(1)+s.charAt(1):s.substring(2,4),c=r?s.charAt(2)+s.charAt(2):s.substring(4,6),h=a?r?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(l,16),parseInt(u,16),parseInt(c,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},t.Color.fromSource=function(n){var s=new i;return s.setSource(n),s}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],n={},s="left",r="top",a="right",l="bottom",u="center",c={top:l,bottom:r,left:a,right:s,center:u},h=t.util.radiansToDegrees,d=Math.sign||function(Y){return(Y>0)-(Y<0)||+Y};function g(Y,z){var it=Y.angle+h(Math.atan2(z.y,z.x))+360;return Math.round(it%360/45)}function m(Y,z){var it=z.transform.target,Z=it.canvas,J=t.util.object.clone(z);J.target=it,Z&&Z.fire("object:"+Y,J),it.fire(Y,z)}function y(Y,z){var it=z.canvas,Z=it.uniScaleKey,J=Y[Z];return it.uniformScaling&&!J||!it.uniformScaling&&J}function C(Y){return Y.originX===u&&Y.originY===u}function w(Y,z,it){var Z=Y.lockScalingX,J=Y.lockScalingY;return!!(Z&&J||!z&&(Z||J)&&it||Z&&z==="x"||J&&z==="y")}function F(Y,z,it){var Z="not-allowed",J=y(Y,it),nt="";if(z.x!==0&&z.y===0?nt="x":z.x===0&&z.y!==0&&(nt="y"),w(it,nt,J))return Z;var lt=g(it,z);return i[lt]+"-resize"}function B(Y,z,it){var Z="not-allowed";if(z.x!==0&&it.lockSkewingY||z.y!==0&&it.lockSkewingX)return Z;var J=g(it,z)%4;return o[J]+"-resize"}function U(Y,z,it){return Y[it.canvas.altActionKey]?n.skewCursorStyleHandler(Y,z,it):n.scaleCursorStyleHandler(Y,z,it)}function R(Y,z,it){var Z=Y[it.canvas.altActionKey];if(z.x===0)return Z?"skewX":"scaleY";if(z.y===0)return Z?"skewY":"scaleX"}function W(Y,z,it){return it.lockRotation?"not-allowed":z.cursorStyle}function X(Y,z,it,Z){return{e:Y,transform:z,pointer:{x:it,y:Z}}}function $(Y){return function(z,it,Z,J){var nt=it.target,lt=nt.getCenterPoint(),At=nt.translateToOriginPoint(lt,it.originX,it.originY),wt=Y(z,it,Z,J);return nt.setPositionByOrigin(At,it.originX,it.originY),wt}}function st(Y,z){return function(it,Z,J,nt){var lt=z(it,Z,J,nt);return lt&&m(Y,X(it,Z,J,nt)),lt}}function pt(Y,z,it,Z,J){var nt=Y.target,lt=nt.controls[Y.corner],At=nt.canvas.getZoom(),wt=nt.padding/At,et=nt.toLocalPoint(new t.Point(Z,J),z,it);return et.x>=wt&&(et.x-=wt),et.x<=-wt&&(et.x+=wt),et.y>=wt&&(et.y-=wt),et.y<=wt&&(et.y+=wt),et.x-=lt.offsetX,et.y-=lt.offsetY,et}function dt(Y){return Y.flipX!==Y.flipY}function x(Y,z,it,Z,J){if(Y[z]!==0){var nt=Y._getTransformedDimensions()[Z],lt=J/nt*Y[it];Y.set(it,lt)}}function P(Y,z,it,Z){var J=z.target,nt=J._getTransformedDimensions(0,J.skewY),lt=pt(z,z.originX,z.originY,it,Z),At=Math.abs(lt.x*2)-nt.x,wt=J.skewX,et;At<2?et=0:(et=h(Math.atan2(At/J.scaleX,nt.y/J.scaleY)),z.originX===s&&z.originY===l&&(et=-et),z.originX===a&&z.originY===r&&(et=-et),dt(J)&&(et=-et));var yt=wt!==et;if(yt){var Tt=J._getTransformedDimensions().y;J.set("skewX",et),x(J,"skewY","scaleY","y",Tt)}return yt}function I(Y,z,it,Z){var J=z.target,nt=J._getTransformedDimensions(J.skewX,0),lt=pt(z,z.originX,z.originY,it,Z),At=Math.abs(lt.y*2)-nt.y,wt=J.skewY,et;At<2?et=0:(et=h(Math.atan2(At/J.scaleY,nt.x/J.scaleX)),z.originX===s&&z.originY===l&&(et=-et),z.originX===a&&z.originY===r&&(et=-et),dt(J)&&(et=-et));var yt=wt!==et;if(yt){var Tt=J._getTransformedDimensions().x;J.set("skewY",et),x(J,"skewX","scaleX","x",Tt)}return yt}function k(Y,z,it,Z){var J=z.target,nt=J.skewX,lt,At=z.originY;if(J.lockSkewingX)return!1;if(nt===0){var wt=pt(z,u,u,it,Z);wt.x>0?lt=s:lt=a}else nt>0&&(lt=At===r?s:a),nt<0&&(lt=At===r?a:s),dt(J)&&(lt=lt===s?a:s);z.originX=lt;var et=st("skewing",$(P));return et(Y,z,it,Z)}function K(Y,z,it,Z){var J=z.target,nt=J.skewY,lt,At=z.originX;if(J.lockSkewingY)return!1;if(nt===0){var wt=pt(z,u,u,it,Z);wt.y>0?lt=r:lt=l}else nt>0&&(lt=At===s?r:l),nt<0&&(lt=At===s?l:r),dt(J)&&(lt=lt===r?l:r);z.originY=lt;var et=st("skewing",$(I));return et(Y,z,it,Z)}function S(Y,z,it,Z){var J=z,nt=J.target,lt=nt.translateToOriginPoint(nt.getCenterPoint(),J.originX,J.originY);if(nt.lockRotation)return!1;var At=Math.atan2(J.ey-lt.y,J.ex-lt.x),wt=Math.atan2(Z-lt.y,it-lt.x),et=h(wt-At+J.theta),yt=!0;if(nt.snapAngle>0){var Tt=nt.snapAngle,It=nt.snapThreshold||Tt,jt=Math.ceil(et/Tt)*Tt,Mt=Math.floor(et/Tt)*Tt;Math.abs(et-Mt)<It?et=Mt:Math.abs(et-jt)<It&&(et=jt)}return et<0&&(et=360+et),et%=360,yt=nt.angle!==et,nt.angle=et,yt}function _(Y,z,it,Z,J){J=J||{};var nt=z.target,lt=nt.lockScalingX,At=nt.lockScalingY,wt=J.by,et,yt,Tt,It,jt=y(Y,nt),Mt=w(nt,wt,jt),se,Jt,Le=z.gestureScale;if(Mt)return!1;if(Le)yt=z.scaleX*Le,Tt=z.scaleY*Le;else{if(et=pt(z,z.originX,z.originY,it,Z),se=wt!=="y"?d(et.x):1,Jt=wt!=="x"?d(et.y):1,z.signX||(z.signX=se),z.signY||(z.signY=Jt),nt.lockScalingFlip&&(z.signX!==se||z.signY!==Jt))return!1;if(It=nt._getTransformedDimensions(),jt&&!wt){var qe=Math.abs(et.x)+Math.abs(et.y),Ce=z.original,Ei=Math.abs(It.x*Ce.scaleX/nt.scaleX)+Math.abs(It.y*Ce.scaleY/nt.scaleY),Ft=qe/Ei;yt=Ce.scaleX*Ft,Tt=Ce.scaleY*Ft}else yt=Math.abs(et.x*nt.scaleX/It.x),Tt=Math.abs(et.y*nt.scaleY/It.y);C(z)&&(yt*=2,Tt*=2),z.signX!==se&&wt!=="y"&&(z.originX=c[z.originX],yt*=-1,z.signX=se),z.signY!==Jt&&wt!=="x"&&(z.originY=c[z.originY],Tt*=-1,z.signY=Jt)}var Bt=nt.scaleX,Gt=nt.scaleY;return wt?(wt==="x"&&nt.set("scaleX",yt),wt==="y"&&nt.set("scaleY",Tt)):(!lt&&nt.set("scaleX",yt),!At&&nt.set("scaleY",Tt)),Bt!==nt.scaleX||Gt!==nt.scaleY}function O(Y,z,it,Z){return _(Y,z,it,Z)}function j(Y,z,it,Z){return _(Y,z,it,Z,{by:"x"})}function q(Y,z,it,Z){return _(Y,z,it,Z,{by:"y"})}function N(Y,z,it,Z){return Y[z.target.canvas.altActionKey]?n.skewHandlerX(Y,z,it,Z):n.scalingY(Y,z,it,Z)}function H(Y,z,it,Z){return Y[z.target.canvas.altActionKey]?n.skewHandlerY(Y,z,it,Z):n.scalingX(Y,z,it,Z)}function Q(Y,z,it,Z){var J=z.target,nt=pt(z,z.originX,z.originY,it,Z),lt=J.strokeWidth/(J.strokeUniform?J.scaleX:1),At=C(z)?2:1,wt=J.width,et=Math.abs(nt.x*At/J.scaleX)-lt;return J.set("width",Math.max(et,0)),wt!==et}function ot(Y,z,it,Z){var J=z.target,nt=it-z.offsetX,lt=Z-z.offsetY,At=!J.get("lockMovementX")&&J.left!==nt,wt=!J.get("lockMovementY")&&J.top!==lt;return At&&J.set("left",nt),wt&&J.set("top",lt),(At||wt)&&m("moving",X(Y,z,it,Z)),At||wt}n.scaleCursorStyleHandler=F,n.skewCursorStyleHandler=B,n.scaleSkewCursorStyleHandler=U,n.rotationWithSnapping=st("rotating",$(S)),n.scalingEqually=st("scaling",$(O)),n.scalingX=st("scaling",$(j)),n.scalingY=st("scaling",$(q)),n.scalingYOrSkewingX=N,n.scalingXOrSkewingY=H,n.changeWidth=st("resizing",$(Q)),n.skewHandlerX=k,n.skewHandlerY=K,n.dragHandler=ot,n.scaleOrSkewActionName=R,n.rotationStyleHandler=W,n.fireEvent=m,n.wrapWithFixedAnchor=$,n.wrapWithFireEvent=st,n.getLocalPoint=pt,t.controlsUtils=n})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians,o=t.controlsUtils;function n(r,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=a,w=l,F;r.save(),r.fillStyle=u.cornerColor||c.cornerColor,r.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,h>d?(F=h,r.scale(1,d/h),w=l*h/d):d>h?(F=d,r.scale(h/d,1),C=a*d/h):F=h,r.lineWidth=1,r.beginPath(),r.arc(C,w,F/2,0,2*Math.PI,!1),r[m](),y&&r.stroke(),r.restore()}function s(r,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=h/2,w=d/2;r.save(),r.fillStyle=u.cornerColor||c.cornerColor,r.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,r.lineWidth=1,r.translate(a,l),r.rotate(i(c.angle)),r[m+"Rect"](-C,-w,h,d),y&&r.strokeRect(-C,-w,h,d),r.restore()}o.renderCircleControl=n,o.renderSquareControl=s})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={});function i(o){for(var n in o)this[n]=o[n]}t.Control=i,t.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,n){return n.cursorStyle},getActionName:function(o,n){return n.actionName},getVisibility:function(o,n){var s=o._controlsVisibility;return s&&typeof s[n]<"u"?s[n]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,n){var s=t.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},n);return s},calcCornerCoords:function(o,n,s,r,a){var l,u,c,h,d=a?this.touchSizeX:this.sizeX,g=a?this.touchSizeY:this.sizeY;if(d&&g&&d!==g){var m=Math.atan2(g,d),y=Math.sqrt(d*d+g*g)/2,C=m-t.util.degreesToRadians(o),w=Math.PI/2-m-t.util.degreesToRadians(o);l=y*t.util.cos(C),u=y*t.util.sin(C),c=y*t.util.cos(w),h=y*t.util.sin(w)}else{var F=d&&g?d:n;y=F*.7071067812;var C=t.util.degreesToRadians(45-o);l=c=y*t.util.cos(C),u=h=y*t.util.sin(C)}return{tl:{x:s-h,y:r-c},tr:{x:s+l,y:r-u},bl:{x:s-l,y:r+u},br:{x:s+h,y:r+c}}},render:function(o,n,s,r,a){switch(r=r||{},r.cornerStyle||a.cornerStyle){case"circle":t.controlsUtils.renderCircleControl.call(this,o,n,s,r,a);break;default:t.controlsUtils.renderSquareControl.call(this,o,n,s,r,a)}}}})(Ct);(function(){function e(s,r){var a=s.getAttribute("style"),l=s.getAttribute("offset")||0,u,c,h,d;if(l=parseFloat(l)/(/%$/.test(l)?100:1),l=l<0?0:l>1?1:l,a){var g=a.split(/\s*;\s*/);for(g[g.length-1]===""&&g.pop(),d=g.length;d--;){var m=g[d].split(/\s*:\s*/),y=m[0].trim(),C=m[1].trim();y==="stop-color"?u=C:y==="stop-opacity"&&(h=C)}}return u||(u=s.getAttribute("stop-color")||"rgb(0,0,0)"),h||(h=s.getAttribute("stop-opacity")),u=new D.Color(u),c=u.getAlpha(),h=isNaN(parseFloat(h))?1:parseFloat(h),h*=c*r,{offset:l,color:u.toRgb(),opacity:h}}function t(s){return{x1:s.getAttribute("x1")||0,y1:s.getAttribute("y1")||0,x2:s.getAttribute("x2")||"100%",y2:s.getAttribute("y2")||0}}function i(s){return{x1:s.getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}}var o=D.util.object.clone;D.Gradient=D.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(s){s||(s={}),s.coords||(s.coords={});var r,a=this;Object.keys(s).forEach(function(l){a[l]=s[l]}),this.id?this.id+="_"+D.Object.__uid++:this.id=D.Object.__uid++,r={x1:s.coords.x1||0,y1:s.coords.y1||0,x2:s.coords.x2||0,y2:s.coords.y2||0},this.type==="radial"&&(r.r1=s.coords.r1||0,r.r2=s.coords.r2||0),this.coords=r,this.colorStops=s.colorStops.slice()},addColorStop:function(s){for(var r in s){var a=new D.Color(s[r]);this.colorStops.push({offset:parseFloat(r),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(s){var r={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return D.util.populateWithProperties(this,r,s),r},toSVG:function(s,c){var a=o(this.coords,!0),l,u,c=c||{},h,d,g=o(this.colorStops,!0),m=a.r1>a.r2,y=this.gradientTransform?this.gradientTransform.concat():D.iMatrix.concat(),C=-this.offsetX,w=-this.offsetY,F=!!c.additionalTransform,B=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(g.sort(function($,st){return $.offset-st.offset}),B==="objectBoundingBox"?(C/=s.width,w/=s.height):(C+=s.width/2,w+=s.height/2),s.type==="path"&&this.gradientUnits!=="percentage"&&(C-=s.pathOffset.x,w-=s.pathOffset.y),y[4]-=C,y[5]-=w,d='id="SVGID_'+this.id+'" gradientUnits="'+B+'"',d+=' gradientTransform="'+(F?c.additionalTransform+" ":"")+D.util.matrixToSVG(y)+'" ',this.type==="linear"?h=["<linearGradient ",d,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`">
`]:this.type==="radial"&&(h=["<radialGradient ",d,' cx="',m?a.x1:a.x2,'" cy="',m?a.y1:a.y2,'" r="',m?a.r1:a.r2,'" fx="',m?a.x2:a.x1,'" fy="',m?a.y2:a.y1,`">
`]),this.type==="radial"){if(m)for(g=g.concat(),g.reverse(),l=0,u=g.length;l<u;l++)g[l].offset=1-g[l].offset;var U=Math.min(a.r1,a.r2);if(U>0){var R=Math.max(a.r1,a.r2),W=U/R;for(l=0,u=g.length;l<u;l++)g[l].offset+=W*(1-g[l].offset)}}for(l=0,u=g.length;l<u;l++){var X=g[l];h.push("<stop ",'offset="',X.offset*100+"%",'" style="stop-color:',X.color,typeof X.opacity<"u"?";stop-opacity: "+X.opacity:";",`"/>
`)}return h.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),h.join("")},toLive:function(s){var r,a=D.util.object.clone(this.coords),l,u;if(this.type){for(this.type==="linear"?r=s.createLinearGradient(a.x1,a.y1,a.x2,a.y2):this.type==="radial"&&(r=s.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),l=0,u=this.colorStops.length;l<u;l++){var c=this.colorStops[l].color,h=this.colorStops[l].opacity,d=this.colorStops[l].offset;typeof h<"u"&&(c=new D.Color(c).setAlpha(h).toRgba()),r.addColorStop(d,c)}return r}}}),D.util.object.extend(D.Gradient,{fromElement:function(s,r,a,l){var u=parseFloat(a)/(/%$/.test(a)?100:1);u=u<0?0:u>1?1:u,isNaN(u)&&(u=1);var c=s.getElementsByTagName("stop"),h,d=s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",g=s.getAttribute("gradientTransform")||"",m=[],y,C,w=0,F=0,B;for(s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?(h="linear",y=t(s)):(h="radial",y=i(s)),C=c.length;C--;)m.push(e(c[C],u));B=D.parseTransformAttribute(g),n(r,y,l,d),d==="pixels"&&(w=-r.left,F=-r.top);var U=new D.Gradient({id:s.getAttribute("id"),type:h,coords:y,colorStops:m,gradientUnits:d,gradientTransform:B,offsetX:w,offsetY:F});return U}});function n(s,r,a,l){var u,c;Object.keys(r).forEach(function(h){u=r[h],u==="Infinity"?c=1:u==="-Infinity"?c=0:(c=parseFloat(r[h],10),typeof u=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(u)&&(c*=.01,l==="pixels"&&((h==="x1"||h==="x2"||h==="r2")&&(c*=a.viewBoxWidth||a.width),(h==="y1"||h==="y2")&&(c*=a.viewBoxHeight||a.height)))),r[h]=c})}})();(function(){"use strict";var e=D.util.toFixed;D.Pattern=D.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,i){if(t||(t={}),this.id=D.Object.__uid++,this.setOptions(t),!t.source||t.source&&typeof t.source!="string"){i&&i(this);return}else{var o=this;this.source=D.util.createImage(),D.util.loadImage(t.source,function(n,s){o.source=n,i&&i(o,s)},null,this.crossOrigin)}},toObject:function(t){var i=D.Object.NUM_FRACTION_DIGITS,o,n;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),n={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:e(this.offsetX,i),offsetY:e(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},D.util.populateWithProperties(this,n,t),n},toSVG:function(t){var i=typeof this.source=="function"?this.source():this.source,o=i.width/t.width,n=i.height/t.height,s=this.offsetX/t.width,r=this.offsetY/t.height,a="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,r&&(n+=Math.abs(r))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,s&&(o+=Math.abs(s))),i.src?a=i.src:i.toDataURL&&(a=i.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+r+'" width="'+o+'" height="'+n+`">
<image x="0" y="0" width="`+i.width+'" height="'+i.height+'" xlink:href="'+a+`"></image>
</pattern>
`},setOptions:function(t){for(var i in t)this[i]=t[i]},toLive:function(t){var i=this.source;return!i||typeof i.src<"u"&&(!i.complete||i.naturalWidth===0||i.naturalHeight===0)?"":t.createPattern(i,this.repeat)}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.toFixed;if(t.Shadow){t.warn("fabric.Shadow is already defined.");return}t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var n in o)this[n]=o[n];this.id=t.Object.__uid++},_parseShadow:function(o){var n=o.trim(),s=t.Shadow.reOffsetsAndBlur.exec(n)||[],r=n.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:r.trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var n=40,s=40,r=t.Object.NUM_FRACTION_DIGITS,a=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-o.angle)),l=20,u=new t.Color(this.color);return o.width&&o.height&&(n=i((Math.abs(a.x)+this.blur)/o.width,r)*100+l,s=i((Math.abs(a.y)+this.blur)/o.height,r)*100+l),o.flipX&&(a.x*=-1),o.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+i(this.blur?this.blur/2:0,r)+`"></feGaussianBlur>
	<feOffset dx="`+i(a.x,r)+'" dy="'+i(a.y,r)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+u.toRgb()+'" flood-opacity="'+u.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},n=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==n[s]&&(o[s]=this[s])},this),o}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(Ct);(function(){"use strict";if(D.StaticCanvas){D.warn("fabric.StaticCanvas is already defined.");return}var e=D.util.object.extend,t=D.util.getElementOffset,i=D.util.removeFromArray,o=D.util.toFixed,n=D.util.transformPoint,s=D.util.invertTransform,r=D.util.getNodeCanvas,a=D.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");D.StaticCanvas=D.util.createClass(D.CommonMethods,{initialize:function(u,c){c||(c={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(u,c)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:D.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(u,c){var h=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(u),this._initOptions(c),this.interactive||this._initRetinaScaling(),c.overlayImage&&this.setOverlayImage(c.overlayImage,h),c.backgroundImage&&this.setBackgroundImage(c.backgroundImage,h),c.backgroundColor&&this.setBackgroundColor(c.backgroundColor,h),c.overlayColor&&this.setOverlayColor(c.overlayColor,h),this.calcOffset()},_isRetinaScaling:function(){return D.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,D.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var u=D.devicePixelRatio;this.__initRetinaScaling(u,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(u,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(u,c,h){c.setAttribute("width",this.width*u),c.setAttribute("height",this.height*u),h.scale(u,u)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(u,c,h){return this.__setBgOverlayImage("overlayImage",u,c,h)},setBackgroundImage:function(u,c,h){return this.__setBgOverlayImage("backgroundImage",u,c,h)},setOverlayColor:function(u,c){return this.__setBgOverlayColor("overlayColor",u,c)},setBackgroundColor:function(u,c){return this.__setBgOverlayColor("backgroundColor",u,c)},__setBgOverlayImage:function(u,c,h,d){return typeof c=="string"?D.util.loadImage(c,function(g,m){if(g){var y=new D.Image(g,d);this[u]=y,y.canvas=this}h&&h(g,m)},this,d&&d.crossOrigin):(d&&c.setOptions(d),this[u]=c,c&&(c.canvas=this),h&&h(c,!1)),this},__setBgOverlayColor:function(u,c,h){return this[u]=c,this._initGradient(c,u),this._initPattern(c,u,h),this},_createCanvasElement:function(){var u=a();if(!u||(u.style||(u.style={}),typeof u.getContext>"u"))throw l;return u},_initOptions:function(u){var c=this.lowerCanvasEl;this._setOptions(u),this.width=this.width||parseInt(c.width,10)||0,this.height=this.height||parseInt(c.height,10)||0,this.lowerCanvasEl.style&&(c.width=this.width,c.height=this.height,c.style.width=this.width+"px",c.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(u){u&&u.getContext?this.lowerCanvasEl=u:this.lowerCanvasEl=D.util.getById(u)||this._createCanvasElement(),D.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(u,c){return this.setDimensions({width:u},c)},setHeight:function(u,c){return this.setDimensions({height:u},c)},setDimensions:function(u,c){var h;c=c||{};for(var d in u)h=u[d],c.cssOnly||(this._setBackstoreDimension(d,u[d]),h+="px",this.hasLostContext=!0),c.backstoreOnly||this._setCssDimension(d,h);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),c.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(u,c){return this.lowerCanvasEl[u]=c,this.upperCanvasEl&&(this.upperCanvasEl[u]=c),this.cacheCanvasEl&&(this.cacheCanvasEl[u]=c),this[u]=c,this},_setCssDimension:function(u,c){return this.lowerCanvasEl.style[u]=c,this.upperCanvasEl&&(this.upperCanvasEl.style[u]=c),this.wrapperEl&&(this.wrapperEl.style[u]=c),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(u){var c=this._activeObject,h=this.backgroundImage,d=this.overlayImage,g,m,y;for(this.viewportTransform=u,m=0,y=this._objects.length;m<y;m++)g=this._objects[m],g.group||g.setCoords(!0);return c&&c.setCoords(),h&&h.setCoords(!0),d&&d.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(u,c){var h=u,d=this.viewportTransform.slice(0);u=n(u,s(this.viewportTransform)),d[0]=c,d[3]=c;var g=n(u,d);return d[4]+=h.x-g.x,d[5]+=h.y-g.y,this.setViewportTransform(d)},setZoom:function(u){return this.zoomToPoint(new D.Point(0,0),u),this},absolutePan:function(u){var c=this.viewportTransform.slice(0);return c[4]=-u.x,c[5]=-u.y,this.setViewportTransform(c)},relativePan:function(u){return this.absolutePan(new D.Point(-u.x-this.viewportTransform[4],-u.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(u){this.stateful&&u.setupState(),u._set("canvas",this),u.setCoords(),this.fire("object:added",{target:u}),u.fire("added")},_onObjectRemoved:function(u){this.fire("object:removed",{target:u}),u.fire("removed"),delete u.canvas},clearContext:function(u){return u.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var u=this.contextContainer;return this.renderCanvas(u,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=D.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var u={},c=this.width,h=this.height,d=s(this.viewportTransform);return u.tl=n({x:0,y:0},d),u.br=n({x:c,y:h},d),u.tr=new D.Point(u.br.x,u.tl.y),u.bl=new D.Point(u.tl.x,u.br.y),this.vptCoords=u,u},cancelRequestedRender:function(){this.isRendering&&(D.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(u,c){var h=this.viewportTransform,d=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(u),D.util.setImageSmoothing(u,this.imageSmoothingEnabled),this.fire("before:render",{ctx:u}),this._renderBackground(u),u.save(),u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._renderObjects(u,c),u.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),d&&(d.canvas=this,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(u)),this._renderOverlay(u),this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),this.fire("after:render",{ctx:u})},drawClipPathOnCanvas:function(u){var c=this.viewportTransform,h=this.clipPath;u.save(),u.transform(c[0],c[1],c[2],c[3],c[4],c[5]),u.globalCompositeOperation="destination-in",h.transform(u),u.scale(1/h.zoomX,1/h.zoomY),u.drawImage(h._cacheCanvas,-h.cacheTranslationX,-h.cacheTranslationY),u.restore()},_renderObjects:function(u,c){var h,d;for(h=0,d=c.length;h<d;++h)c[h]&&c[h].render(u)},_renderBackgroundOrOverlay:function(u,c){var h=this[c+"Color"],d=this[c+"Image"],g=this.viewportTransform,m=this[c+"Vpt"];if(!(!h&&!d)){if(h){u.save(),u.beginPath(),u.moveTo(0,0),u.lineTo(this.width,0),u.lineTo(this.width,this.height),u.lineTo(0,this.height),u.closePath(),u.fillStyle=h.toLive?h.toLive(u,this):h,m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),u.transform(1,0,0,1,h.offsetX||0,h.offsetY||0);var y=h.gradientTransform||h.patternTransform;y&&u.transform(y[0],y[1],y[2],y[3],y[4],y[5]),u.fill(),u.restore()}d&&(u.save(),m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),d.render(u),u.restore())}},_renderBackground:function(u){this._renderBackgroundOrOverlay(u,"background")},_renderOverlay:function(u){this._renderBackgroundOrOverlay(u,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new D.Point(this.width/2,this.height/2)},centerObjectH:function(u){return this._centerObject(u,new D.Point(this.getCenterPoint().x,u.getCenterPoint().y))},centerObjectV:function(u){return this._centerObject(u,new D.Point(u.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(u){var c=this.getCenterPoint();return this._centerObject(u,c)},viewportCenterObject:function(u){var c=this.getVpCenter();return this._centerObject(u,c)},viewportCenterObjectH:function(u){var c=this.getVpCenter();return this._centerObject(u,new D.Point(c.x,u.getCenterPoint().y)),this},viewportCenterObjectV:function(u){var c=this.getVpCenter();return this._centerObject(u,new D.Point(u.getCenterPoint().x,c.y))},getVpCenter:function(){var u=this.getCenterPoint(),c=s(this.viewportTransform);return n(u,c)},_centerObject:function(u,c){return u.setPositionByOrigin(c,"center","center"),u.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(u){return this.toDatalessObject(u)},toObject:function(u){return this._toObjectMethod("toObject",u)},toDatalessObject:function(u){return this._toObjectMethod("toDatalessObject",u)},_toObjectMethod:function(u,c){var h=this.clipPath,d={version:D.version,objects:this._toObjects(u,c)};return h&&!h.excludeFromExport&&(d.clipPath=this._toObject(this.clipPath,u,c)),e(d,this.__serializeBgOverlay(u,c)),D.util.populateWithProperties(this,d,c),d},_toObjects:function(u,c){return this._objects.filter(function(h){return!h.excludeFromExport}).map(function(h){return this._toObject(h,u,c)},this)},_toObject:function(u,c,h){var d;this.includeDefaultValues||(d=u.includeDefaultValues,u.includeDefaultValues=!1);var g=u[c](h);return this.includeDefaultValues||(u.includeDefaultValues=d),g},__serializeBgOverlay:function(u,c){var h={},d=this.backgroundImage,g=this.overlayImage,m=this.backgroundColor,y=this.overlayColor;return m&&m.toObject?m.excludeFromExport||(h.background=m.toObject(c)):m&&(h.background=m),y&&y.toObject?y.excludeFromExport||(h.overlay=y.toObject(c)):y&&(h.overlay=y),d&&!d.excludeFromExport&&(h.backgroundImage=this._toObject(d,u,c)),g&&!g.excludeFromExport&&(h.overlayImage=this._toObject(g,u,c)),h},svgViewportTransformation:!0,toSVG:function(u,c){u||(u={}),u.reviver=c;var h=[];return this._setSVGPreamble(h,u),this._setSVGHeader(h,u),this.clipPath&&h.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(h,"background"),this._setSVGBgOverlayImage(h,"backgroundImage",c),this._setSVGObjects(h,c),this.clipPath&&h.push(`</g>
`),this._setSVGBgOverlayColor(h,"overlay"),this._setSVGBgOverlayImage(h,"overlayImage",c),h.push("</svg>"),h.join("")},_setSVGPreamble:function(u,c){c.suppressPreamble||u.push('<?xml version="1.0" encoding="',c.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(u,c){var h=c.width||this.width,d=c.height||this.height,g,m='viewBox="0 0 '+this.width+" "+this.height+'" ',y=D.Object.NUM_FRACTION_DIGITS;c.viewBox?m='viewBox="'+c.viewBox.x+" "+c.viewBox.y+" "+c.viewBox.width+" "+c.viewBox.height+'" ':this.svgViewportTransformation&&(g=this.viewportTransform,m='viewBox="'+o(-g[4]/g[0],y)+" "+o(-g[5]/g[3],y)+" "+o(this.width/g[0],y)+" "+o(this.height/g[3],y)+'" '),u.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',h,'" ','height="',d,'" ',m,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",D.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(c),`</defs>
`)},createSVGClipPathMarkup:function(u){var c=this.clipPath;return c?(c.clipPathId="CLIPPATH_"+D.Object.__uid++,'<clipPath id="'+c.clipPathId+`" >
`+this.clipPath.toClipPathSVG(u.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var u=this,c=["background","overlay"].map(function(h){var d=u[h+"Color"];if(d&&d.toLive){var g=u[h+"Vpt"],m=u.viewportTransform,y={width:u.width/(g?m[0]:1),height:u.height/(g?m[3]:1)};return d.toSVG(y,{additionalTransform:g?D.util.matrixToSVG(m):""})}});return c.join("")},createSVGFontFacesMarkup:function(){var u="",c={},h,d,g,m,y,C,w,F,B,U=D.fontPaths,R=[];for(this._objects.forEach(function X($){R.push($),$._objects&&$._objects.forEach(X)}),F=0,B=R.length;F<B;F++)if(h=R[F],d=h.fontFamily,!(h.type.indexOf("text")===-1||c[d]||!U[d])&&(c[d]=!0,!!h.styles)){g=h.styles;for(y in g){m=g[y];for(w in m)C=m[w],d=C.fontFamily,!c[d]&&U[d]&&(c[d]=!0)}}for(var W in c)u+=[`		@font-face {
`,"			font-family: '",W,`';
`,"			src: url('",U[W],`');
`,`		}
`].join("");return u&&(u=['	<style type="text/css">',`<![CDATA[
`,u,"]]>",`</style>
`].join("")),u},_setSVGObjects:function(u,c){var h,d,g,m=this._objects;for(d=0,g=m.length;d<g;d++)h=m[d],!h.excludeFromExport&&this._setSVGObject(u,h,c)},_setSVGObject:function(u,c,h){u.push(c.toSVG(h))},_setSVGBgOverlayImage:function(u,c,h){this[c]&&!this[c].excludeFromExport&&this[c].toSVG&&u.push(this[c].toSVG(h))},_setSVGBgOverlayColor:function(u,c){var h=this[c+"Color"],d=this.viewportTransform,g=this.width,m=this.height;if(h)if(h.toLive){var y=h.repeat,C=D.util.invertTransform(d),w=this[c+"Vpt"],F=w?D.util.matrixToSVG(C):"";u.push('<rect transform="'+F+" translate(",g/2,",",m/2,')"',' x="',h.offsetX-g/2,'" y="',h.offsetY-m/2,'" ','width="',y==="repeat-y"||y==="no-repeat"?h.source.width:g,'" height="',y==="repeat-x"||y==="no-repeat"?h.source.height:m,'" fill="url(#SVGID_'+h.id+')"',`></rect>
`)}else u.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',h,'"',`></rect>
`)},sendToBack:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=g.length;h--;)d=g[h],i(this._objects,d),this._objects.unshift(d);else i(this._objects,u),this._objects.unshift(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=0;h<g.length;h++)d=g[h],i(this._objects,d),this._objects.push(d);else i(this._objects,u),this._objects.push(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,w=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=0;d<C.length;d++)g=C[d],m=this._objects.indexOf(g),m>0+w&&(y=m-1,i(this._objects,g),this._objects.splice(y,0,g)),w++;else m=this._objects.indexOf(u),m!==0&&(y=this._findNewLowerIndex(u,m,c),i(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(u,c,h){var d,g;if(h)for(d=c,g=c-1;g>=0;--g){var m=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(m){d=g;break}}else d=c-1;return d},bringForward:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,w=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=C.length;d--;)g=C[d],m=this._objects.indexOf(g),m<this._objects.length-1-w&&(y=m+1,i(this._objects,g),this._objects.splice(y,0,g)),w++;else m=this._objects.indexOf(u),m!==this._objects.length-1&&(y=this._findNewUpperIndex(u,m,c),i(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(u,c,h){var d,g,m;if(h)for(d=c,g=c+1,m=this._objects.length;g<m;++g){var y=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(y){d=g;break}}else d=c+1;return d},moveTo:function(u,c){return i(this._objects,u),this._objects.splice(c,0,u),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(D.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),D.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),D.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),e(D.StaticCanvas.prototype,D.Observable),e(D.StaticCanvas.prototype,D.Collection),e(D.StaticCanvas.prototype,D.DataURLExporter),e(D.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(u){var c=a();if(!c||!c.getContext)return null;var h=c.getContext("2d");if(!h)return null;switch(u){case"setLineDash":return typeof h.setLineDash<"u";default:return null}}}),D.StaticCanvas.prototype.toJSON=D.StaticCanvas.prototype.toObject,D.isLikelyNode&&(D.StaticCanvas.prototype.createPNGStream=function(){var u=r(this.lowerCanvasEl);return u&&u.createPNGStream()},D.StaticCanvas.prototype.createJPEGStream=function(u){var c=r(this.lowerCanvasEl);return c&&c.createJPEGStream(u)})})();D.BaseBrush=D.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(e){var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var e=this.canvas,t=this.shadow,i=e.contextTop,o=e.getZoom();e&&e._isRetinaScaling()&&(o*=D.devicePixelRatio),i.shadowColor=t.color,i.shadowBlur=t.blur*o,i.shadowOffsetX=t.offsetX*o,i.shadowOffsetY=t.offsetY*o}},needsFullRender:function(){var e=new D.Color(this.color);return e.getAlpha()<1||!!this.shadow},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0},_isOutSideCanvas:function(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}});(function(){D.PencilBrush=D.util.createClass(D.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(e){this.canvas=e,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(e,t,i){var o=t.midPointFrom(i);return e.quadraticCurveTo(t.x,t.y,o.x,o.y),o},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],this._prepareForDrawing(e),this._captureDrawingPath(e),this._render())},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e))&&this._captureDrawingPath(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var i=this._points,o=i.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,i[o-2],i[o-1],!0),n.stroke(),n.restore()}},onMouseUp:function(e){return this.canvas._isMainEvent(e.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(e){var t=new D.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){return this._points.length>1&&e.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(e){var t=new D.Point(e.x,e.y);return this._addPoint(t)},_render:function(e){var t,i,o=this._points[0],n=this._points[1];if(e=e||this.canvas.contextTop,this._saveAndTransform(e),e.beginPath(),this._points.length===2&&o.x===n.x&&o.y===n.y){var s=this.width/1e3;o=new D.Point(o.x,o.y),n=new D.Point(n.x,n.y),o.x-=s,n.x+=s}for(e.moveTo(o.x,o.y),t=1,i=this._points.length;t<i;t++)this._drawSegment(e,o,n),o=this._points[t],n=this._points[t+1];e.lineTo(o.x,o.y),e.stroke(),e.restore()},convertPointsToSVGPath:function(e){var t=this.width/1e3;return D.util.getSmoothPathFromPoints(e,t)},_isEmptySVGPath:function(e){var t=D.util.joinPath(e);return t==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(e){var t=new D.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new D.Shadow(this.shadow)),t},decimatePoints:function(e,t){if(e.length<=2)return e;var i=this.canvas.getZoom(),o=Math.pow(t/i,2),n,s=e.length-1,r=e[0],a=[r],l;for(n=1;n<s-1;n++)l=Math.pow(r.x-e[n].x,2)+Math.pow(r.y-e[n].y,2),l>=o&&(r=e[n],a.push(r));return a.push(e[s]),a},_finalizeAndAddPath:function(){var e=this.canvas.contextTop;e.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(t)){this.canvas.requestRenderAll();return}var i=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:i}),this.canvas.add(i),this.canvas.requestRenderAll(),i.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:i})}})})();D.CircleBrush=D.util.createClass(D.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),i=this.canvas.contextTop;this._saveAndTransform(i),this.dot(i,t),i.restore()},dot:function(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,Math.PI*2,!1),e.closePath(),e.fill()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},_render:function(){var e=this.canvas.contextTop,t,i,o=this.points;for(this._saveAndTransform(e),t=0,i=o.length;t<i;t++)this.dot(e,o[t]);e.restore()},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove,t,i;this.canvas.renderOnAddRemove=!1;var o=[];for(t=0,i=this.points.length;t<i;t++){var n=this.points[t],s=new D.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(s.shadow=new D.Shadow(this.shadow)),o.push(s)}var r=new D.Group(o);r.canvas=this.canvas,this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.fire("path:created",{path:r}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},addPoint:function(e){var t=new D.Point(e.x,e.y),i=D.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new D.Color(this.color).setAlpha(D.util.getRandomInt(0,100)/100).toRgba();return t.radius=i,t.fill=o,this.points.push(t),t}});D.SprayBrush=D.util.createClass(D.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.render(this.sprayChunkPoints))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],i=0,o=this.sprayChunks.length;i<o;i++)for(var n=this.sprayChunks[i],s=0,r=n.length;s<r;s++){var a=new D.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});t.push(a)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var l=new D.Group(t);this.shadow&&l.set("shadow",new D.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},_getOptimizedRects:function(e){var t={},i,o,n;for(o=0,n=e.length;o<n;o++)i=e[o].left+""+e[o].top,t[i]||(t[i]=e[o]);var s=[];for(i in t)s.push(t[i]);return s},render:function(e){var t=this.canvas.contextTop,i,o;for(t.fillStyle=this.color,this._saveAndTransform(t),i=0,o=e.length;i<o;i++){var n=e[i];typeof n.opacity<"u"&&(t.globalAlpha=n.opacity),t.fillRect(n.x,n.y,n.width,n.width)}t.restore()},_render:function(){var e=this.canvas.contextTop,t,i;for(e.fillStyle=this.color,this._saveAndTransform(e),t=0,i=this.sprayChunks.length;t<i;t++)this.render(this.sprayChunks[t]);e.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,i,o,n=this.width/2,s;for(s=0;s<this.density;s++){t=D.util.getRandomInt(e.x-n,e.x+n),i=D.util.getRandomInt(e.y-n,e.y+n),this.dotWidthVariance?o=D.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var r=new D.Point(t,i);r.width=o,this.randomOpacity&&(r.opacity=D.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(r)}this.sprayChunks.push(this.sprayChunkPoints)}});D.PatternBrush=D.util.createClass(D.PencilBrush,{getPatternSrc:function(){var e=20,t=5,i=D.util.createCanvasElement(),o=i.getContext("2d");return i.width=i.height=e+t,o.fillStyle=this.color,o.beginPath(),o.arc(e/2,e/2,e/2,0,Math.PI*2,!1),o.closePath(),o.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(e){this.callSuper("_setBrushStyles",e),e.strokeStyle=this.getPattern(e)},createPath:function(e){var t=this.callSuper("createPath",e),i=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new D.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),t}});(function(){var e=D.util.getPointer,t=D.util.degreesToRadians,i=D.util.isTouchEvent;D.Canvas=D.util.createClass(D.StaticCanvas,{initialize:function(n,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=D.PencilBrush&&new D.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),s,r,a;if(n.length>0&&!this.preserveObjectStacking){r=[],a=[];for(var l=0,u=this._objects.length;l<u;l++)s=this._objects[l],n.indexOf(s)===-1?r.push(s):a.push(s);n.length>1&&(this._activeObject._objects=a),r.push.apply(r,a)}else r=this._objects;return r},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,s){var r=n.calcTransformMatrix(),a=D.util.invertTransform(r),l=this.restorePointerVpt(s);return D.util.transformPoint(l,a)},isTargetTransparent:function(n,s,r){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var a=this._normalizePointer(n,{x:s,y:r}),l=Math.max(n.cacheTranslationX+a.x*n.zoomX,0),u=Math.max(n.cacheTranslationY+a.y*n.zoomY,0),g=D.util.isTransparent(n._cacheContext,Math.round(l),Math.round(u),this.targetFindTolerance);return g}var c=this.contextCache,h=n.selectionBackgroundColor,d=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(c),c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),n.render(c),c.restore(),n.selectionBackgroundColor=h;var g=D.util.isTransparent(c,s,r,this.targetFindTolerance);return g},_isSelectionKeyPressed:function(n){var s=!1;return Array.isArray(this.selectionKey)?s=!!this.selectionKey.find(function(r){return n[r]===!0}):s=n[this.selectionKey],s},_shouldClearSelection:function(n,s){var r=this.getActiveObjects(),a=this._activeObject;return!s||s&&a&&r.length>1&&r.indexOf(s)===-1&&a!==s&&!this._isSelectionKeyPressed(n)||s&&!s.evented||s&&!s.selectable&&a&&a!==s},_shouldCenterTransform:function(n,s,r){if(n){var a;return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?a=this.centeredScaling||n.centeredScaling:s==="rotate"&&(a=this.centeredRotation||n.centeredRotation),a?!r:r}},_getOriginFromCorner:function(n,s){var r={x:n.originX,y:n.originY};return s==="ml"||s==="tl"||s==="bl"?r.x="right":(s==="mr"||s==="tr"||s==="br")&&(r.x="left"),s==="tl"||s==="mt"||s==="tr"?r.y="bottom":(s==="bl"||s==="mb"||s==="br")&&(r.y="top"),r},_getActionFromCorner:function(n,s,r,a){if(!s||!n)return"drag";var l=a.controls[s];return l.getActionName(r,l,a)},_setupCurrentTransform:function(n,s,r){if(s){var a=this.getPointer(n),l=s.__corner,u=s.controls[l],c=r&&l?u.getActionHandler(n,s,u):D.controlsUtils.dragHandler,h=this._getActionFromCorner(r,l,n,s),d=this._getOriginFromCorner(s,l),g=n[this.centeredKey],m={target:s,action:h,actionHandler:c,corner:l,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:a.x-s.left,offsetY:a.y-s.top,originX:d.x,originY:d.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:t(s.angle),width:s.width*s.scaleX,shiftKey:n.shiftKey,altKey:g,original:D.util.saveObjectTransform(s)};this._shouldCenterTransform(s,h,g)&&(m.originX="center",m.originY="center"),m.original.originX=d.x,m.original.originY=d.y,this._currentTransform=m,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var s=this._groupSelector,r=new D.Point(s.ex,s.ey),a=D.util.transformPoint(r,this.viewportTransform),l=new D.Point(s.ex+s.left,s.ey+s.top),u=D.util.transformPoint(l,this.viewportTransform),c=Math.min(a.x,u.x),h=Math.min(a.y,u.y),d=Math.max(a.x,u.x),g=Math.max(a.y,u.y),m=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(c,h,d-c,g-h)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,c+=m,h+=m,d-=m,g-=m,D.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(c,h,d-c,g-h))},findTarget:function(n,s){if(!this.skipTargetFind){var r=!0,a=this.getPointer(n,r),l=this._activeObject,u=this.getActiveObjects(),c,h,d=i(n),g=u.length>1&&!s||u.length===1;if(this.targets=[],g&&l._findTargetCorner(a,d)||u.length>1&&!s&&l===this._searchPossibleTargets([l],a))return l;if(u.length===1&&l===this._searchPossibleTargets([l],a))if(this.preserveObjectStacking)c=l,h=this.targets,this.targets=[];else return l;var m=this._searchPossibleTargets(this._objects,a);return n[this.altSelectionKey]&&m&&c&&m!==c&&(m=c,this.targets=h),m}},_checkTarget:function(n,s,r){if(s&&s.visible&&s.evented&&s.containsPoint(n))if((this.perPixelTargetFind||s.perPixelTargetFind)&&!s.isEditing){var a=this.isTargetTransparent(s,r.x,r.y);if(!a)return!0}else return!0},_searchPossibleTargets:function(n,s){for(var r,a=n.length,l;a--;){var u=n[a],c=u.group?this._normalizePointer(u.group,s):s;if(this._checkTarget(c,u,s)){r=n[a],r.subTargetCheck&&r instanceof D.Group&&(l=this._searchPossibleTargets(r._objects,s),l&&this.targets.push(l));break}}return r},restorePointerVpt:function(n){return D.util.transformPoint(n,D.util.invertTransform(this.viewportTransform))},getPointer:function(n,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var r=e(n),a=this.upperCanvasEl,l=a.getBoundingClientRect(),u=l.width||0,c=l.height||0,h;(!u||!c)&&("top"in l&&"bottom"in l&&(c=Math.abs(l.top-l.bottom)),"right"in l&&"left"in l&&(u=Math.abs(l.right-l.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,s||(r=this.restorePointerVpt(r));var d=this.getRetinaScaling();return d!==1&&(r.x/=d,r.y/=d),u===0||c===0?h={width:1,height:1}:h={width:a.width/u,height:a.height/c},{x:r.x*h.width,y:r.y*h.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,r=this.upperCanvasEl;r?r.className="":(r=this._createCanvasElement(),this.upperCanvasEl=r),D.util.addClass(r,"upper-canvas "+n),this.wrapperEl.appendChild(r),this._copyCanvasStyle(s,r),this._applyCanvasStyle(r),this.contextTop=r.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=D.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),D.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),D.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var s=this.width||n.width,r=this.height||n.height;D.util.setStyle(n,{position:"absolute",width:s+"px",height:r+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=s,n.height=r,D.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,s){s.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,s){var r=!1,a=this.getActiveObjects(),l=[],u=[];n.forEach(function(c){a.indexOf(c)===-1&&(r=!0,c.fire("deselected",{e:s,target:c}),u.push(c))}),a.forEach(function(c){n.indexOf(c)===-1&&(r=!0,c.fire("selected",{e:s,target:c}),l.push(c))}),n.length>0&&a.length>0?r&&this.fire("selection:updated",{e:s,selected:l,deselected:u}):a.length>0?this.fire("selection:created",{e:s,selected:l}):n.length>0&&this.fire("selection:cleared",{e:s,deselected:u})},setActiveObject:function(n,s){var r=this.getActiveObjects();return this._setActiveObject(n,s),this._fireSelectionEvents(r,s),this},_setActiveObject:function(n,s){return this._activeObject===n||!this._discardActiveObject(s,n)||n.onSelect({e:s})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,s){var r=this._activeObject;if(r){if(r.onDeselect({e:n,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var s=this.getActiveObjects(),r=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:r,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(s,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){D.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,D.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var s=this._activeObject;s&&s._renderControls(n)},_toObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(n),l=this.callSuper("_toObject",n,s,r);return this._unwindGroupTransformOnObject(n,a),l},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var s=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],r={};return s.forEach(function(a){r[a]=n[a]}),D.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),r}else return null},_unwindGroupTransformOnObject:function(n,s){s&&n.set(s)},_setSVGObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",n,s,r),this._unwindGroupTransformOnObject(s,a)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),D.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var o in D.StaticCanvas)o!=="prototype"&&(D.Canvas[o]=D.StaticCanvas[o])})();(function(){var e=D.util.addListener,t=D.util.removeListener,i=3,o=2,n=1,s={passive:!1};function r(a,l){return a.button&&a.button===l-1}D.util.object.extend(D.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,l){var u=this.upperCanvasEl,c=this._getEventPrefix();a(D.window,"resize",this._onResize),a(u,c+"down",this._onMouseDown),a(u,c+"move",this._onMouseMove,s),a(u,c+"out",this._onMouseOut),a(u,c+"enter",this._onMouseEnter),a(u,"wheel",this._onMouseWheel),a(u,"contextmenu",this._onContextMenu),a(u,"dblclick",this._onDoubleClick),a(u,"dragover",this._onDragOver),a(u,"dragenter",this._onDragEnter),a(u,"dragleave",this._onDragLeave),a(u,"drop",this._onDrop),this.enablePointerEvents||a(u,"touchstart",this._onTouchStart,s),typeof eventjs<"u"&&l in eventjs&&(eventjs[l](u,"gesture",this._onGesture),eventjs[l](u,"drag",this._onDrag),eventjs[l](u,"orientation",this._onOrientationChange),eventjs[l](u,"shake",this._onShake),eventjs[l](u,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(t,"remove");var a=this._getEventPrefix();t(D.document,a+"up",this._onMouseUp),t(D.document,"touchend",this._onTouchEnd,s),t(D.document,a+"move",this._onMouseMove,s),t(D.document,"touchmove",this._onMouseMove,s)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,l){this.__onTransformGesture&&this.__onTransformGesture(a,l)},_onDrag:function(a,l){this.__onDrag&&this.__onDrag(a,l)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var l=this._hoveredTarget;this.fire("mouse:out",{target:l,e:a}),this._hoveredTarget=null,l&&l.fire("mouseout",{e:a});var u=this;this._hoveredTargets.forEach(function(c){u.fire("mouse:out",{target:l,e:a}),c&&l.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,l){this.__onOrientationChange&&this.__onOrientationChange(a,l)},_onShake:function(a,l){this.__onShake&&this.__onShake(a,l)},_onLongPress:function(a,l){this.__onLongPress&&this.__onLongPress(a,l)},_onDragOver:function(a){a.preventDefault();var l=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(l,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var l=a.changedTouches;return l?l[0]&&l[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return a.isPrimary===!0?!0:a.isPrimary===!1?!1:a.type==="touchend"&&a.touches.length===0?!0:a.changedTouches?a.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(a){a.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();e(D.document,"touchend",this._onTouchEnd,s),e(D.document,"touchmove",this._onMouseMove,s),t(l,u+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();t(l,u+"move",this._onMouseMove,s),e(D.document,u+"up",this._onMouseUp),e(D.document,u+"move",this._onMouseMove,s)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var l=this._getEventPrefix();t(D.document,"touchend",this._onTouchEnd,s),t(D.document,"touchmove",this._onMouseMove,s);var u=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){e(u.upperCanvasEl,l+"down",u._onMouseDown),u._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();this._isMainEvent(a)&&(t(D.document,u+"up",this._onMouseUp),t(D.document,u+"move",this._onMouseMove,s),e(l,u+"move",this._onMouseMove,s))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var l=this._activeObject;return!!l!=!!a||l&&a&&l!==a?!0:(l&&l.isEditing,!1)},__onMouseUp:function(a){var l,u=this._currentTransform,c=this._groupSelector,h=!1,d=!c||c.left===0&&c.top===0;if(this._cacheTransformEventData(a),l=this._target,this._handleEvent(a,"up:before"),r(a,i)){this.fireRightClick&&this._handleEvent(a,"up",i,d);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"up",o,d),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(a);return}if(this._isMainEvent(a)){if(u&&(this._finalizeCurrentTransform(a),h=u.actionPerformed),!d){var g=l===this._activeObject;this._maybeGroupObjects(a),h||(h=this._shouldRender(l)||!g&&l===this._activeObject)}var m,y;if(l){if(m=l._findTargetCorner(this.getPointer(a,!0),D.util.isTouchEvent(a)),l.selectable&&l!==this._activeObject&&l.activeOn==="up")this.setActiveObject(l,a),h=!0;else{var C=l.controls[m],w=C&&C.getMouseUpHandler(a,l,C);w&&(y=this.getPointer(a),w(a,u,y.x,y.y))}l.isMoving=!1}if(u&&(u.target!==l||u.corner!==m)){var F=u.target&&u.target.controls[u.corner],B=F&&F.getMouseUpHandler(a,l,C);y=y||this.getPointer(a),B&&B(a,u,y.x,y.y)}this._setCursorFromEvent(a,l),this._handleEvent(a,"up",n,d),this._groupSelector=null,this._currentTransform=null,l&&(l.__corner=0),h?this.requestRenderAll():d||this.renderTop()}},_simpleEventHandler:function(a,l){var u=this.findTarget(l),c=this.targets,h={e:l,target:u,subTargets:c};if(this.fire(a,h),u&&u.fire(a,h),!c)return u;for(var d=0;d<c.length;d++)c[d].fire(a,h);return u},_handleEvent:function(a,l,u,c){var h=this._target,d=this.targets||[],g={e:a,target:h,subTargets:d,button:u||n,isClick:c||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};l==="up"&&(g.currentTarget=this.findTarget(a),g.currentSubTargets=this.targets),this.fire("mouse:"+l,g),h&&h.fire("mouse"+l,g);for(var m=0;m<d.length;m++)d[m].fire("mouse"+l,g)},_finalizeCurrentTransform:function(a){var l=this._currentTransform,u=l.target,c={e:a,target:u,transform:l,action:l.action};u._scaling&&(u._scaling=!1),u.setCoords(),(l.actionPerformed||this.stateful&&u.hasStateChanged())&&this._fire("modified",c)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var l=this.getPointer(a);this.freeDrawingBrush.onMouseDown(l,{e:a,pointer:l}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var l=this.getPointer(a);this.freeDrawingBrush.onMouseMove(l,{e:a,pointer:l})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var l=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:l}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var l=this._target;if(r(a,i)){this.fireRightClick&&this._handleEvent(a,"down",i);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(a);return}if(this._isMainEvent(a)&&!this._currentTransform){var u=this._pointer;this._previousPointer=u;var c=this._shouldRender(l),h=this._shouldGroup(a,l);if(this._shouldClearSelection(a,l)?this.discardActiveObject(a):h&&(this._handleGrouping(a,l),l=this._activeObject),this.selection&&(!l||!l.selectable&&!l.isEditing&&l!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),l){var d=l===this._activeObject;l.selectable&&l.activeOn==="down"&&this.setActiveObject(l,a);var g=l._findTargetCorner(this.getPointer(a,!0),D.util.isTouchEvent(a));if(l.__corner=g,l===this._activeObject&&(g||!h)){this._setupCurrentTransform(a,l,d);var m=l.controls[g],u=this.getPointer(a),y=m&&m.getMouseDownHandler(a,l,m);y&&y(a,this._currentTransform,u.x,u.y)}}this._handleEvent(a,"down"),(c||h)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var l=this._currentTransform;this.stateful&&l.target.saveState(),this.fire("before:transform",{e:a,transform:l})},__onMouseMove:function(a){this._handleEvent(a,"move:before"),this._cacheTransformEventData(a);var l,u;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(a);return}if(this._isMainEvent(a)){var c=this._groupSelector;c?(u=this._absolutePointer,c.left=u.x-c.ex,c.top=u.y-c.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(l=this.findTarget(a)||null,this._setCursorFromEvent(a,l),this._fireOverOutEvents(l,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,l){var u=this._hoveredTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,l){var u=this._draggedoverTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"dragleave",evtIn:"dragenter"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,l,u){var c,h,d=u.oldTarget,g,m,y=d!==a,C=u.canvasEvtIn,w=u.canvasEvtOut;y&&(c={e:l,target:a,previousTarget:d},h={e:l,target:d,nextTarget:a}),m=a&&y,g=d&&y,g&&(w&&this.fire(w,h),d.fire(u.evtOut,h)),m&&(C&&this.fire(C,c),a.fire(u.evtIn,c))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var l=this.getPointer(a),u=this._currentTransform;u.reset=!1,u.shiftKey=a.shiftKey,u.altKey=a[this.centeredKey],this._performTransformAction(a,u,l),u.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,l,u){var c=u.x,h=u.y,d=l.action,g=!1,m=l.actionHandler;m&&(g=m(a,l,c,h)),d==="drag"&&g&&(l.target.isMoving=!0,this.setCursor(l.target.moveCursor||this.moveCursor)),l.actionPerformed=l.actionPerformed||g},_fire:D.controlsUtils.fireEvent,_setCursorFromEvent:function(a,l){if(!l)return this.setCursor(this.defaultCursor),!1;var u=l.hoverCursor||this.hoverCursor,c=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,h=(!c||!c.contains(l))&&l._findTargetCorner(this.getPointer(a,!0));h?this.setCursor(this.getCornerCursor(h,l,a)):(l.subTargetCheck&&this.targets.concat().reverse().map(function(d){u=d.hoverCursor||u}),this.setCursor(u))},getCornerCursor:function(a,l,u){var c=l.controls[a];return c.cursorStyleHandler(u,c,l)}})})();(function(){var e=Math.min,t=Math.max;D.util.object.extend(D.Canvas.prototype,{_shouldGroup:function(i,o){var n=this._activeObject;return n&&this._isSelectionKeyPressed(i)&&o&&o.selectable&&this.selection&&(n!==o||n.type==="activeSelection")&&!o.onSelect({e:i})},_handleGrouping:function(i,o){var n=this._activeObject;n.__corner||o===n&&(o=this.findTarget(i,!0),!o||!o.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(o,i):this._createActiveSelection(o,i))},_updateActiveSelection:function(i,o){var n=this._activeObject,s=n._objects.slice(0);n.contains(i)?(n.removeWithUpdate(i),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),o)):(n.addWithUpdate(i),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(s,o)},_createActiveSelection:function(i,o){var n=this.getActiveObjects(),s=this._createGroup(i);this._hoveredTarget=s,this._setActiveObject(s,o),this._fireSelectionEvents(n,o)},_createGroup:function(i){var o=this._objects,n=o.indexOf(this._activeObject)<o.indexOf(i),s=n?[this._activeObject,i]:[i,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new D.ActiveSelection(s,{canvas:this})},_groupSelectedObjects:function(i){var o=this._collectObjects(i),n;o.length===1?this.setActiveObject(o[0],i):o.length>1&&(n=new D.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(n,i))},_collectObjects:function(i){for(var o=[],n,s=this._groupSelector.ex,r=this._groupSelector.ey,a=s+this._groupSelector.left,l=r+this._groupSelector.top,u=new D.Point(e(s,a),e(r,l)),c=new D.Point(t(s,a),t(r,l)),h=!this.selectionFullyContained,d=s===a&&r===l,g=this._objects.length;g--&&(n=this._objects[g],!(!(!n||!n.selectable||!n.visible)&&(h&&n.intersectsWithRect(u,c,!0)||n.isContainedWithinRect(u,c,!0)||h&&n.containsPoint(u,null,!0)||h&&n.containsPoint(c,null,!0))&&(o.push(n),d))););return o.length>1&&(o=o.filter(function(m){return!m.onSelect({e:i})})),o},_maybeGroupObjects:function(i){this.selection&&this._groupSelector&&this._groupSelectedObjects(i),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){D.util.object.extend(D.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",i=e.quality||1,o=(e.multiplier||1)*(e.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(o,e);return D.util.toDataURL(n,t,i)},toCanvasElement:function(e,t){e=e||1,t=t||{};var i=(t.width||this.width)*e,o=(t.height||this.height)*e,n=this.getZoom(),s=this.width,r=this.height,a=n*e,l=this.viewportTransform,u=(l[4]-(t.left||0))*e,c=(l[5]-(t.top||0))*e,h=this.interactive,d=[a,0,0,a,u,c],g=this.enableRetinaScaling,m=D.util.createCanvasElement(),y=this.contextTop;return m.width=i,m.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=d,this.width=i,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),this._objects),this.viewportTransform=l,this.width=s,this.height=r,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=g,this.contextTop=y,m}})})();D.util.object.extend(D.StaticCanvas.prototype,{loadFromJSON:function(e,t,i){if(e){var o=typeof e=="string"?JSON.parse(e):D.util.object.clone(e),n=this,s=o.clipPath,r=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(a){n.clear(),n._setBgOverlay(o,function(){s?n._enlivenObjects([s],function(l){n.clipPath=l[0],n.__setupCanvas.call(n,o,a,r,t)}):n.__setupCanvas.call(n,o,a,r,t)})},i),this}},__setupCanvas:function(e,t,i,o){var n=this;t.forEach(function(s,r){n.insertAt(s,r)}),this.renderOnAddRemove=i,delete e.objects,delete e.backgroundImage,delete e.overlayImage,delete e.background,delete e.overlay,this._setOptions(e),this.renderAll(),o&&o()},_setBgOverlay:function(e,t){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!e.backgroundImage&&!e.overlayImage&&!e.background&&!e.overlay){t&&t();return}var o=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",e.backgroundImage,i,o),this.__setBgOverlay("overlayImage",e.overlayImage,i,o),this.__setBgOverlay("backgroundColor",e.background,i,o),this.__setBgOverlay("overlayColor",e.overlay,i,o)},__setBgOverlay:function(e,t,i,o){var n=this;if(!t){i[e]=!0,o&&o();return}e==="backgroundImage"||e==="overlayImage"?D.util.enlivenObjects([t],function(s){n[e]=s[0],i[e]=!0,o&&o()}):this["set"+D.util.string.capitalize(e,!0)](t,function(){i[e]=!0,o&&o()})},_enlivenObjects:function(e,t,i){if(!e||e.length===0){t&&t([]);return}D.util.enlivenObjects(e,function(o){t&&t(o)},null,i)},_toDataURL:function(e,t){this.clone(function(i){t(i.toDataURL(e))})},_toDataURLWithMultiplier:function(e,t,i){this.clone(function(o){i(o.toDataURLWithMultiplier(e,t))})},clone:function(e,t){var i=JSON.stringify(this.toJSON(t));this.cloneWithoutData(function(o){o.loadFromJSON(i,function(){e&&e(o)})})},cloneWithoutData:function(e){var t=D.util.createCanvasElement();t.width=this.width,t.height=this.height;var i=new D.Canvas(t);this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),e&&e(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):e&&e(i)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.string.capitalize,r=t.util.degreesToRadians,a=!t.isLikelyNode,l=2;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(u){u&&this.setOptions(u)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(u){var c=t.perfLimitSizeTotal,h=u.width,d=u.height,g=t.maxCacheSideLimit,m=t.minCacheSideLimit;if(h<=g&&d<=g&&h*d<=c)return h<m&&(u.width=m),d<m&&(u.height=m),u;var y=h/d,C=t.util.limitDimsByArea(y,c),w=t.util.capValue,F=w(m,C.x,g),B=w(m,C.y,g);return h>F&&(u.zoomX/=h/F,u.width=F,u.capped=!0),d>B&&(u.zoomY/=d/B,u.height=B,u.capped=!0),u},_getCacheCanvasDimensions:function(){var u=this.getTotalObjectScaling(),c=this._getTransformedDimensions(0,0),h=c.x*u.scaleX/this.scaleX,d=c.y*u.scaleY/this.scaleY;return{width:h+l,height:d+l,zoomX:u.scaleX,zoomY:u.scaleY,x:h,y:d}},_updateCacheCanvas:function(){var u=this.canvas;if(this.noScaleCache&&u&&u._currentTransform){var c=u._currentTransform.target,h=u._currentTransform.action;if(this===c&&h.slice&&h.slice(0,5)==="scale")return!1}var d=this._cacheCanvas,g=this._limitCacheSize(this._getCacheCanvasDimensions()),m=t.minCacheSideLimit,y=g.width,C=g.height,w,F,B=g.zoomX,U=g.zoomY,R=y!==this.cacheWidth||C!==this.cacheHeight,W=this.zoomX!==B||this.zoomY!==U,X=R||W,$=0,st=0,pt=!1;if(R){var dt=this._cacheCanvas.width,x=this._cacheCanvas.height,P=y>dt||C>x,I=(y<dt*.9||C<x*.9)&&dt>m&&x>m;pt=P||I,P&&!g.capped&&(y>m||C>m)&&($=y*.1,st=C*.1)}return this instanceof t.Text&&this.path&&(X=!0,pt=!0,$+=this.getHeightOfLine(0)*this.zoomX,st+=this.getHeightOfLine(0)*this.zoomY),X?(pt?(d.width=Math.ceil(y+$),d.height=Math.ceil(C+st)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,d.width,d.height)),w=g.x/2,F=g.y/2,this.cacheTranslationX=Math.round(d.width/2-w)+w,this.cacheTranslationY=Math.round(d.height/2-F)+F,this.cacheWidth=y,this.cacheHeight=C,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(B,U),this.zoomX=B,this.zoomY=U,!0):!1},setOptions:function(u){this._setOptions(u),this._initGradient(u.fill,"fill"),this._initGradient(u.stroke,"stroke"),this._initPattern(u.fill,"fill"),this._initPattern(u.stroke,"stroke")},transform:function(u){var c=this.group&&!this.group._transformDone||this.group&&this.canvas&&u===this.canvas.contextTop,h=this.calcTransformMatrix(!c);u.transform(h[0],h[1],h[2],h[3],h[4],h[5])},toObject:function(u){var c=t.Object.NUM_FRACTION_DIGITS,h={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:n(this.left,c),top:n(this.top,c),width:n(this.width,c),height:n(this.height,c),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,c),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,c),scaleX:n(this.scaleX,c),scaleY:n(this.scaleY,c),angle:n(this.angle,c),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,c),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,c),skewY:n(this.skewY,c)};return this.clipPath&&!this.clipPath.excludeFromExport&&(h.clipPath=this.clipPath.toObject(u),h.clipPath.inverted=this.clipPath.inverted,h.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,h,u),this.includeDefaultValues||(h=this._removeDefaultValues(h)),h},toDatalessObject:function(u){return this.toObject(u)},_removeDefaultValues:function(u){var c=t.util.getKlass(u.type).prototype,h=c.stateProperties;return h.forEach(function(d){d==="left"||d==="top"||(u[d]===c[d]&&delete u[d],Array.isArray(u[d])&&Array.isArray(c[d])&&u[d].length===0&&c[d].length===0&&delete u[d])}),u},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var u=t.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(u.scaleX),scaleY:Math.abs(u.scaleY)}},getTotalObjectScaling:function(){var u=this.getObjectScaling(),c=u.scaleX,h=u.scaleY;if(this.canvas){var d=this.canvas.getZoom(),g=this.canvas.getRetinaScaling();c*=d*g,h*=d*g}return{scaleX:c,scaleY:h}},getObjectOpacity:function(){var u=this.opacity;return this.group&&(u*=this.group.getObjectOpacity()),u},_set:function(u,c){var h=u==="scaleX"||u==="scaleY",d=this[u]!==c,g=!1;return h&&(c=this._constrainScale(c)),u==="scaleX"&&c<0?(this.flipX=!this.flipX,c*=-1):u==="scaleY"&&c<0?(this.flipY=!this.flipY,c*=-1):u==="shadow"&&c&&!(c instanceof t.Shadow)?c=new t.Shadow(c):u==="dirty"&&this.group&&this.group.set("dirty",c),this[u]=c,d&&(g=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(u)>-1?(this.dirty=!0,g&&this.group.set("dirty",!0)):g&&this.stateProperties.indexOf(u)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(u){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(u.save(),this._setupCompositeOperation(u),this.drawSelectionBackground(u),this.transform(u),this._setOpacity(u),this._setShadow(u,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(u)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(u),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),u.restore())},renderCache:function(u){u=u||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,u.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(u,c){if(u.save(),c.inverted?u.globalCompositeOperation="destination-out":u.globalCompositeOperation="destination-in",c.absolutePositioned){var h=t.util.invertTransform(this.calcTransformMatrix());u.transform(h[0],h[1],h[2],h[3],h[4],h[5])}c.transform(u),u.scale(1/c.zoomX,1/c.zoomY),u.drawImage(c._cacheCanvas,-c.cacheTranslationX,-c.cacheTranslationY),u.restore()},drawObject:function(u,c){var h=this.fill,d=this.stroke;c?(this.fill="black",this.stroke="",this._setClippingProperties(u)):this._renderBackground(u),this._render(u),this._drawClipPath(u,this.clipPath),this.fill=h,this.stroke=d},_drawClipPath:function(u,c){c&&(c.canvas=this.canvas,c.shouldCache(),c._transformDone=!0,c.renderCache({forClipping:!0}),this.drawClipPathOnCache(u,c))},drawCacheOnCanvas:function(u){u.scale(1/this.zoomX,1/this.zoomY),u.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(u){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!u&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!u){var c=this.cacheWidth/this.zoomX,h=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-c/2,-h/2,c,h)}return!0}return!1},_renderBackground:function(u){if(this.backgroundColor){var c=this._getNonTransformedDimensions();u.fillStyle=this.backgroundColor,u.fillRect(-c.x/2,-c.y/2,c.x,c.y),this._removeShadow(u)}},_setOpacity:function(u){this.group&&!this.group._transformDone?u.globalAlpha=this.getObjectOpacity():u.globalAlpha*=this.opacity},_setStrokeStyles:function(u,c){var h=c.stroke;h&&(u.lineWidth=c.strokeWidth,u.lineCap=c.strokeLineCap,u.lineDashOffset=c.strokeDashOffset,u.lineJoin=c.strokeLineJoin,u.miterLimit=c.strokeMiterLimit,h.toLive?h.gradientUnits==="percentage"||h.gradientTransform||h.patternTransform?this._applyPatternForTransformedGradient(u,h):(u.strokeStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,h)):u.strokeStyle=c.stroke)},_setFillStyles:function(u,c){var h=c.fill;h&&(h.toLive?(u.fillStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,c.fill)):u.fillStyle=h)},_setClippingProperties:function(u){u.globalAlpha=1,u.strokeStyle="transparent",u.fillStyle="#000000"},_setLineDash:function(u,c){!c||c.length===0||(1&c.length&&c.push.apply(c,c),u.setLineDash(c))},_renderControls:function(u,c){var h=this.getViewportTransform(),d=this.calcTransformMatrix(),g,m,y;c=c||{},m=typeof c.hasBorders<"u"?c.hasBorders:this.hasBorders,y=typeof c.hasControls<"u"?c.hasControls:this.hasControls,d=t.util.multiplyTransformMatrices(h,d),g=t.util.qrDecompose(d),u.save(),u.translate(g.translateX,g.translateY),u.lineWidth=1*this.borderScaleFactor,this.group||(u.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(g.angle-=180),u.rotate(r(this.group?g.angle:this.angle)),c.forActiveSelection||this.group?m&&this.drawBordersInGroup(u,g,c):m&&this.drawBorders(u,c),y&&this.drawControls(u,c),u.restore()},_setShadow:function(u){if(this.shadow){var c=this.shadow,h=this.canvas,d,g=h&&h.viewportTransform[0]||1,m=h&&h.viewportTransform[3]||1;c.nonScaling?d={scaleX:1,scaleY:1}:d=this.getObjectScaling(),h&&h._isRetinaScaling()&&(g*=t.devicePixelRatio,m*=t.devicePixelRatio),u.shadowColor=c.color,u.shadowBlur=c.blur*t.browserShadowBlurConstant*(g+m)*(d.scaleX+d.scaleY)/4,u.shadowOffsetX=c.offsetX*g*d.scaleX,u.shadowOffsetY=c.offsetY*m*d.scaleY}},_removeShadow:function(u){this.shadow&&(u.shadowColor="",u.shadowBlur=u.shadowOffsetX=u.shadowOffsetY=0)},_applyPatternGradientTransform:function(u,c){if(!c||!c.toLive)return{offsetX:0,offsetY:0};var h=c.gradientTransform||c.patternTransform,d=-this.width/2+c.offsetX||0,g=-this.height/2+c.offsetY||0;return c.gradientUnits==="percentage"?u.transform(this.width,0,0,this.height,d,g):u.transform(1,0,0,1,d,g),h&&u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),{offsetX:d,offsetY:g}},_renderPaintInOrder:function(u){this.paintFirst==="stroke"?(this._renderStroke(u),this._renderFill(u)):(this._renderFill(u),this._renderStroke(u))},_render:function(){},_renderFill:function(u){this.fill&&(u.save(),this._setFillStyles(u,this),this.fillRule==="evenodd"?u.fill("evenodd"):u.fill(),u.restore())},_renderStroke:function(u){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(u),u.save(),this.strokeUniform&&this.group){var c=this.getObjectScaling();u.scale(1/c.scaleX,1/c.scaleY)}else this.strokeUniform&&u.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(u,this.strokeDashArray),this._setStrokeStyles(u,this),u.stroke(),u.restore()}},_applyPatternForTransformedGradient:function(u,c){var h=this._limitCacheSize(this._getCacheCanvasDimensions()),d=t.util.createCanvasElement(),g,m=this.canvas.getRetinaScaling(),y=h.x/this.scaleX/m,C=h.y/this.scaleY/m;d.width=y,d.height=C,g=d.getContext("2d"),g.beginPath(),g.moveTo(0,0),g.lineTo(y,0),g.lineTo(y,C),g.lineTo(0,C),g.closePath(),g.translate(y/2,C/2),g.scale(h.zoomX/this.scaleX/m,h.zoomY/this.scaleY/m),this._applyPatternGradientTransform(g,c),g.fillStyle=c.toLive(u),g.fill(),u.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),u.scale(m*this.scaleX/h.zoomX,m*this.scaleY/h.zoomY),u.strokeStyle=g.createPattern(d,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var u=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",u.scaleX),this.set("scaleY",u.scaleY),this.angle=u.angle,this.skewX=u.skewX,this.skewY=0}},_removeTransformMatrix:function(u){var c=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),c=t.util.transformPoint(c,this.transformMatrix)),this.transformMatrix=null,u&&(this.scaleX*=u.scaleX,this.scaleY*=u.scaleY,this.cropX=u.cropX,this.cropY=u.cropY,c.x+=u.offsetLeft,c.y+=u.offsetTop,this.width=u.width,this.height=u.height),this.setPositionByOrigin(c,"center","center")},clone:function(u,c){var h=this.toObject(c);this.constructor.fromObject?this.constructor.fromObject(h,u):t.Object._fromObject("Object",h,u)},cloneAsImage:function(u,c){var h=this.toCanvasElement(c);return u&&u(new t.Image(h)),this},toCanvasElement:function(u){u||(u={});var c=t.util,h=c.saveObjectTransform(this),d=this.group,g=this.shadow,m=Math.abs,y=(u.multiplier||1)*(u.enableRetinaScaling?t.devicePixelRatio:1);delete this.group,u.withoutTransform&&c.resetObjectTransform(this),u.withoutShadow&&(this.shadow=null);var C=t.util.createCanvasElement(),w=this.getBoundingRect(!0,!0),F=this.shadow,B,U={x:0,y:0},R,W,X;F&&(R=F.blur,F.nonScaling?B={scaleX:1,scaleY:1}:B=this.getObjectScaling(),U.x=2*Math.round(m(F.offsetX)+R)*m(B.scaleX),U.y=2*Math.round(m(F.offsetY)+R)*m(B.scaleY)),W=w.width+U.x,X=w.height+U.y,C.width=Math.ceil(W),C.height=Math.ceil(X);var $=new t.StaticCanvas(C,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});u.format==="jpeg"&&($.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point($.width/2,$.height/2),"center","center");var st=this.canvas;$.add(this);var pt=$.toCanvasElement(y||1,u);return this.shadow=g,this.set("canvas",st),d&&(this.group=d),this.set(h).setCoords(),$._objects=[],$.dispose(),$=null,pt},toDataURL:function(u){return u||(u={}),t.util.toDataURL(this.toCanvasElement(u),u.format||"png",u.quality||1)},isType:function(u){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===u},complexity:function(){return 1},toJSON:function(u){return this.toObject(u)},rotate:function(u){var c=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return c&&this._setOriginToCenter(),this.set("angle",u),c&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(u,c){c=c||this.canvas.getPointer(u);var h=new t.Point(c.x,c.y),d=this._getLeftTopCoords();return this.angle&&(h=t.util.rotatePoint(h,d,r(-this.angle))),{x:h.x-d.x,y:h.y-d.y}},_setupCompositeOperation:function(u){this.globalCompositeOperation&&(u.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){t.runningAnimations&&t.runningAnimations.cancelByTarget(this)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),i(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.ENLIVEN_PROPS=["clipPath"],t.Object._fromObject=function(u,c,h,d){var g=t[u];c=o(c,!0),t.util.enlivenPatterns([c.fill,c.stroke],function(m){typeof m[0]<"u"&&(c.fill=m[0]),typeof m[1]<"u"&&(c.stroke=m[1]),t.util.enlivenObjectEnlivables(c,c,function(){var y=d?new g(c[d],c):new g(c);h&&h(y)})})},t.Object.__uid=0)})(Ct);(function(){var e=D.util.degreesToRadians,t={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};D.util.object.extend(D.Object.prototype,{translateToGivenOrigin:function(o,n,s,r,a){var l=o.x,u=o.y,c,h,d;return typeof n=="string"?n=t[n]:n-=.5,typeof r=="string"?r=t[r]:r-=.5,c=r-n,typeof s=="string"?s=i[s]:s-=.5,typeof a=="string"?a=i[a]:a-=.5,h=a-s,(c||h)&&(d=this._getTransformedDimensions(),l=o.x+c*d.x,u=o.y+h*d.y),new D.Point(l,u)},translateToCenterPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,n,s,"center","center");return this.angle?D.util.rotatePoint(r,o,e(this.angle)):r},translateToOriginPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,"center","center",n,s);return this.angle?D.util.rotatePoint(r,o,e(this.angle)):r},getCenterPoint:function(){var o=new D.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,n){var s=this.getCenterPoint();return this.translateToOriginPoint(s,o,n)},toLocalPoint:function(o,n,s){var r=this.getCenterPoint(),a,l;return typeof n<"u"&&typeof s<"u"?a=this.translateToGivenOrigin(r,"center","center",n,s):a=new D.Point(this.left,this.top),l=new D.Point(o.x,o.y),this.angle&&(l=D.util.rotatePoint(l,r,-e(this.angle))),l.subtractEquals(a)},setPositionByOrigin:function(o,n,s){var r=this.translateToCenterPoint(o,n,s),a=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(o){var n=e(this.angle),s=this.getScaledWidth(),r=D.util.cos(n)*s,a=D.util.sin(n)*s,l,u;typeof this.originX=="string"?l=t[this.originX]:l=this.originX-.5,typeof o=="string"?u=t[o]:u=o-.5,this.left+=r*(u-l),this.top+=a*(u-l),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function e(s){return[new D.Point(s.tl.x,s.tl.y),new D.Point(s.tr.x,s.tr.y),new D.Point(s.br.x,s.br.y),new D.Point(s.bl.x,s.bl.y)]}var t=D.util,i=t.degreesToRadians,o=t.multiplyTransformMatrices,n=t.transformPoint;t.object.extend(D.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(s,r){return r?s?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),s?this.aCoords:this.lineCoords)},getCoords:function(s,r){return e(this._getCoords(s,r))},intersectsWithRect:function(s,r,a,l){var u=this.getCoords(a,l),c=D.Intersection.intersectPolygonRectangle(u,s,r);return c.status==="Intersection"},intersectsWithObject:function(s,r,a){var l=D.Intersection.intersectPolygonPolygon(this.getCoords(r,a),s.getCoords(r,a));return l.status==="Intersection"||s.isContainedWithinObject(this,r,a)||this.isContainedWithinObject(s,r,a)},isContainedWithinObject:function(s,r,a){for(var l=this.getCoords(r,a),u=r?s.aCoords:s.lineCoords,c=0,h=s._getImageLines(u);c<4;c++)if(!s.containsPoint(l[c],h))return!1;return!0},isContainedWithinRect:function(s,r,a,l){var u=this.getBoundingRect(a,l);return u.left>=s.x&&u.left+u.width<=r.x&&u.top>=s.y&&u.top+u.height<=r.y},containsPoint:function(s,c,a,l){var u=this._getCoords(a,l),c=c||this._getImageLines(u),h=this._findCrossPoints(s,c);return h!==0&&h%2===1},isOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br,l=this.getCoords(!0,s);return l.some(function(u){return u.x<=a.x&&u.x>=r.x&&u.y<=a.y&&u.y>=r.y})||this.intersectsWithRect(r,a,!0,s)?!0:this._containsCenterOfCanvas(r,a,s)},_containsCenterOfCanvas:function(s,r,a){var l={x:(s.x+r.x)/2,y:(s.y+r.y)/2};return!!this.containsPoint(l,null,!0,a)},isPartiallyOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;if(this.intersectsWithRect(r,a,!0,s))return!0;var l=this.getCoords(!0,s).every(function(u){return(u.x>=a.x||u.x<=r.x)&&(u.y>=a.y||u.y<=r.y)});return l&&this._containsCenterOfCanvas(r,a,s)},_getImageLines:function(s){var r={topline:{o:s.tl,d:s.tr},rightline:{o:s.tr,d:s.br},bottomline:{o:s.br,d:s.bl},leftline:{o:s.bl,d:s.tl}};return r},_findCrossPoints:function(s,r){var a,l,u,c,h,d=0,g;for(var m in r)if(g=r[m],!(g.o.y<s.y&&g.d.y<s.y)&&!(g.o.y>=s.y&&g.d.y>=s.y)&&(g.o.x===g.d.x&&g.o.x>=s.x?h=g.o.x:(a=0,l=(g.d.y-g.o.y)/(g.d.x-g.o.x),u=s.y-a*s.x,c=g.o.y-l*g.o.x,h=-(u-c)/(a-l)),h>=s.x&&(d+=1),d===2))break;return d},getBoundingRect:function(s,r){var a=this.getCoords(s,r);return t.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(s){return Math.abs(s)<this.minScaleLimit?s<0?-this.minScaleLimit:this.minScaleLimit:s===0?1e-4:s},scale:function(s){return this._set("scaleX",s),this._set("scaleY",s),this.setCoords()},scaleToWidth:function(s,r){var a=this.getBoundingRect(r).width/this.getScaledWidth();return this.scale(s/this.width/a)},scaleToHeight:function(s,r){var a=this.getBoundingRect(r).height/this.getScaledHeight();return this.scale(s/this.height/a)},calcLineCoords:function(){var s=this.getViewportTransform(),r=this.padding,a=i(this.angle),l=t.cos(a),u=t.sin(a),c=l*r,h=u*r,d=c+h,g=c-h,m=this.calcACoords(),y={tl:n(m.tl,s),tr:n(m.tr,s),bl:n(m.bl,s),br:n(m.br,s)};return r&&(y.tl.x-=g,y.tl.y-=d,y.tr.x+=d,y.tr.y-=g,y.bl.x-=d,y.bl.y+=g,y.br.x+=g,y.br.y+=d),y},calcOCoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=this.getViewportTransform(),l=o(a,r),u=o(l,s),u=o(u,[1/a[0],0,0,1/a[3],0,0]),c=this._calculateCurrentDimensions(),h={};return this.forEachControl(function(d,g,m){h[g]=d.positionHandler(c,u,m)}),h},calcACoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=o(r,s),l=this._getTransformedDimensions(),u=l.x/2,c=l.y/2;return{tl:n({x:-u,y:-c},a),tr:n({x:u,y:-c},a),bl:n({x:-u,y:c},a),br:n({x:u,y:c},a)}},setCoords:function(s){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),s?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var s=this.getCenterPoint();return[1,0,0,1,s.x,s.y]},transformMatrixKey:function(s){var r="_",a="";return!s&&this.group&&(a=this.group.transformMatrixKey(s)+r),a+this.top+r+this.left+r+this.scaleX+r+this.scaleY+r+this.skewX+r+this.skewY+r+this.angle+r+this.originX+r+this.originY+r+this.width+r+this.height+r+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(s){var r=this.calcOwnMatrix();if(s||!this.group)return r;var a=this.transformMatrixKey(s),l=this.matrixCache||(this.matrixCache={});return l.key===a?l.value:(this.group&&(r=o(this.group.calcTransformMatrix(!1),r)),l.key=a,l.value=r,r)},calcOwnMatrix:function(){var s=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===s)return r.value;var a=this._calcTranslateMatrix(),l={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=s,r.value=t.composeMatrix(l),r.value},_getNonTransformedDimensions:function(){var s=this.strokeWidth,r=this.width+s,a=this.height+s;return{x:r,y:a}},_getTransformedDimensions:function(s,r){typeof s>"u"&&(s=this.skewX),typeof r>"u"&&(r=this.skewY);var a,l,u,c=s===0&&r===0;if(this.strokeUniform?(l=this.width,u=this.height):(a=this._getNonTransformedDimensions(),l=a.x,u=a.y),c)return this._finalizeDimensions(l*this.scaleX,u*this.scaleY);var h=t.sizeAfterTransform(l,u,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:s,skewY:r});return this._finalizeDimensions(h.x,h.y)},_finalizeDimensions:function(s,r){return this.strokeUniform?{x:s+this.strokeWidth,y:r+this.strokeWidth}:{x:s,y:r}},_calculateCurrentDimensions:function(){var s=this.getViewportTransform(),r=this._getTransformedDimensions(),a=n(r,s,!0);return a.scalarAdd(2*this.padding)}})})();D.util.object.extend(D.Object.prototype,{sendToBack:function(){return this.group?D.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?D.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?D.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas&&this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?D.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas&&this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group&&this.group.type!=="activeSelection"?D.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas&&this.canvas.moveTo(this,e),this}});(function(){function e(i,o){if(o){if(o.toLive)return i+": url(#SVGID_"+o.id+"); ";var n=new D.Color(o),s=i+": "+n.toRgb()+"; ",r=n.getAlpha();return r!==1&&(s+=i+"-opacity: "+r.toString()+"; "),s}else return i+": none; "}var t=D.util.toFixed;D.util.object.extend(D.Object.prototype,{getSvgStyles:function(i){var o=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",r=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=typeof this.opacity<"u"?this.opacity:"1",h=this.visible?"":" visibility: hidden;",d=i?"":this.getSvgFilter(),g=e("fill",this.fill),m=e("stroke",this.stroke);return[m,"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",o,"; ","opacity: ",c,";",d,h].join("")},getSvgSpanStyles:function(i,o){var n="; ",r=i.fontFamily?"font-family: "+(i.fontFamily.indexOf("'")===-1&&i.fontFamily.indexOf('"')===-1?"'"+i.fontFamily+"'":i.fontFamily)+n:"",s=i.strokeWidth?"stroke-width: "+i.strokeWidth+n:"",r=r,a=i.fontSize?"font-size: "+i.fontSize+"px"+n:"",l=i.fontStyle?"font-style: "+i.fontStyle+n:"",u=i.fontWeight?"font-weight: "+i.fontWeight+n:"",c=i.fill?e("fill",i.fill):"",h=i.stroke?e("stroke",i.stroke):"",d=this.getSvgTextDecoration(i),g=i.deltaY?"baseline-shift: "+-i.deltaY+"; ":"";return d&&(d="text-decoration: "+d+n),[h,s,r,a,l,u,d,c,g,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(i){return["overline","underline","line-through"].filter(function(o){return i[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(i,o){var n=i?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'+D.util.matrixToSVG(n);return s+(o||"")+'" '},_setSVGBg:function(i){if(this.backgroundColor){var o=D.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,o),'" y="',t(-this.height/2,o),'" width="',t(this.width,o),'" height="',t(this.height,o),`"></rect>
`)}},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(i),{reviver:i})},toClipPathSVG:function(i){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(i),{reviver:i})},_createBaseClipPathSVGMarkup:function(i,o){o=o||{};var n=o.reviver,s=o.additionalTransform||"",r=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),a=i.indexOf("COMMON_PARTS");return i[a]=r,n?n(i.join("")):i.join("")},_createBaseSVGMarkup:function(i,o){o=o||{};var n=o.noStyle,s=o.reviver,r=n?"":'style="'+this.getSvgStyles()+'" ',a=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=l&&l.absolutePositioned,h=this.stroke,d=this.fill,g=this.shadow,m,y=[],C,w=i.indexOf("COMMON_PARTS"),F=o.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+D.Object.__uid++,C='<clipPath id="'+l.clipPathId+`" >
`+l.toClipPathSVG(s)+`</clipPath>
`),c&&y.push("<g ",a,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),c?"":a+this.getSvgCommons(),` >
`),m=[r,u,n?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),i[w]=m,d&&d.toLive&&y.push(d.toSVG(this)),h&&h.toLive&&y.push(h.toSVG(this)),g&&y.push(g.toSVG(this)),l&&y.push(C),y.push(i.join("")),y.push(`</g>
`),c&&y.push(`</g>
`),s?s(y.join("")):y.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var e=D.util.object.extend,t="stateProperties";function i(n,s,r){var a={},l=!0;r.forEach(function(u){a[u]=n[u]}),e(n[s],a,l)}function o(n,s,r){if(n===s)return!0;if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var a=0,l=n.length;a<l;a++)if(!o(n[a],s[a]))return!1;return!0}else if(n&&typeof n=="object"){var u=Object.keys(n),c;if(!s||typeof s!="object"||!r&&u.length!==Object.keys(s).length)return!1;for(var a=0,l=u.length;a<l;a++)if(c=u[a],!(c==="canvas"||c==="group")&&!o(n[c],s[c]))return!1;return!0}}D.util.object.extend(D.Object.prototype,{hasStateChanged:function(n){n=n||t;var s="_"+n;return Object.keys(this[s]).length<this[n].length?!0:!o(this[s],this,!0)},saveState:function(n){var s=n&&n.propertySet||t,r="_"+s;return this[r]?(i(this,r,this[s]),n&&n.stateProperties&&i(this,r,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var s=n.propertySet||t;return n.propertySet=s,this["_"+s]={},this.saveState(n),this}})})();(function(){var e=D.util.degreesToRadians;D.util.object.extend(D.Object.prototype,{_findTargetCorner:function(t,i){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=t.x,n=t.y,s,r,a=Object.keys(this.oCoords),l=a.length-1,u;for(this.__corner=0;l>=0;l--)if(u=a[l],!!this.isControlVisible(u)&&(r=this._getImageLines(i?this.oCoords[u].touchCorner:this.oCoords[u].corner),s=this._findCrossPoints({x:o,y:n},r),s!==0&&s%2===1))return this.__corner=u,u;return!1},forEachControl:function(t){for(var i in this.controls)t(this.controls[i],i,this)},_setCornerCoords:function(){var t=this.oCoords;for(var i in t){var o=this.controls[i];t[i].corner=o.calcCornerCoords(this.angle,this.cornerSize,t[i].x,t[i].y,!1),t[i].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,t[i].x,t[i].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var i=this.getCenterPoint(),o=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return t.translate(i.x,i.y),t.scale(1/n[0],1/n[3]),t.rotate(e(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-o.x/2,-o.y/2,o.x,o.y),t.restore(),this},drawBorders:function(t,i){i=i||{};var o=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=o.x+n,r=o.y+n,a=typeof i.hasControls<"u"?i.hasControls:this.hasControls,l=!1;return t.save(),t.strokeStyle=i.borderColor||this.borderColor,this._setLineDash(t,i.borderDashArray||this.borderDashArray),t.strokeRect(-s/2,-r/2,s,r),a&&(t.beginPath(),this.forEachControl(function(u,c,h){u.withConnection&&u.getVisibility(h,c)&&(l=!0,t.moveTo(u.x*s,u.y*r),t.lineTo(u.x*s+u.offsetX,u.y*r+u.offsetY))}),l&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,i,o){o=o||{};var n=D.util.sizeAfterTransform(this.width,this.height,i),s=this.strokeWidth,r=this.strokeUniform,a=this.borderScaleFactor,l=n.x+s*(r?this.canvas.getZoom():i.scaleX)+a,u=n.y+s*(r?this.canvas.getZoom():i.scaleY)+a;return t.save(),this._setLineDash(t,o.borderDashArray||this.borderDashArray),t.strokeStyle=o.borderColor||this.borderColor,t.strokeRect(-l/2,-u/2,l,u),t.restore(),this},drawControls:function(t,i){i=i||{},t.save();var o=this.canvas.getRetinaScaling(),n,s;return t.setTransform(o,0,0,o,0,0),t.strokeStyle=t.fillStyle=i.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=i.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,i.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(r,a,l){s=l.oCoords[a],r.getVisibility(l,a)&&(n&&(s=D.util.transformPoint(s,n)),r.render(t,s.x,s.y,i,l))}),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,i){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=i,this},setControlsVisibility:function(t){t||(t={});for(var i in t)this.setControlVisible(i,t[i]);return this},onDeselect:function(){},onSelect:function(){}})})();D.util.object.extend(D.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return D.util.animate({target:this,startValue:e.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(r){e.set("left",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxCenterObjectV:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return D.util.animate({target:this,startValue:e.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(r){e.set("top",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxRemove:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return D.util.animate({target:this,startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(r){e.set("opacity",r),s.requestRenderAll(),n()},onComplete:function(){s.remove(e),o()}})}});D.util.object.extend(D.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var e=[],t,i,o=[];for(t in arguments[0])e.push(t);for(var n=0,s=e.length;n<s;n++)t=e[n],i=n!==s-1,o.push(this._animate(t,arguments[0][t],arguments[1],i));return o}else return this._animate.apply(this,arguments)},_animate:function(e,t,i,o){var n=this,s;t=t.toString(),i?i=D.util.object.clone(i):i={},~e.indexOf(".")&&(s=e.split("."));var r=n.colorProperties.indexOf(e)>-1||s&&n.colorProperties.indexOf(s[1])>-1,a=s?this.get(s[0])[s[1]]:this.get(e);"from"in i||(i.from=a),r||(~t.indexOf("=")?t=a+parseFloat(t.replace("=","")):t=parseFloat(t));var l={target:this,startValue:i.from,endValue:t,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(u,c,h){return i.abort.call(n,u,c,h)},onChange:function(u,c,h){s?n[s[0]][s[1]]=u:n.set(e,u),!o&&i.onChange&&i.onChange(u,c,h)},onComplete:function(u,c,h){o||(n.setCoords(),i.onComplete&&i.onComplete(u,c,h))}};return r?D.util.animateColor(l.startValue,l.endValue,l.duration,l):D.util.animate(l)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(t.Line){t.warn("fabric.Line is already defined");return}t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(r,a){r||(r=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",r[0]),this.set("y1",r[1]),this.set("x2",r[2]),this.set("y2",r[3]),this._setWidthHeight(a)},_setWidthHeight:function(r){r||(r={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in r?r.left:this._getLeftToOriginX(),this.top="top"in r?r.top:this._getTopToOriginY()},_set:function(r,a){return this.callSuper("_set",r,a),typeof n[r]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(r){r.beginPath();var a=this.calcLinePoints();r.moveTo(a.x1,a.y1),r.lineTo(a.x2,a.y2),r.lineWidth=this.strokeWidth;var l=r.strokeStyle;r.strokeStyle=this.stroke||r.fillStyle,this.stroke&&this._renderStroke(r),r.strokeStyle=l},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(r){return i(this.callSuper("toObject",r),this.calcLinePoints())},_getNonTransformedDimensions:function(){var r=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(r.y-=this.strokeWidth),this.height===0&&(r.x-=this.strokeWidth)),r},calcLinePoints:function(){var r=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1,l=r*this.width*.5,u=a*this.height*.5,c=r*this.width*-.5,h=a*this.height*-.5;return{x1:l,x2:c,y1:u,y2:h}},_toSVG:function(){var r=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,`" />
`]}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(r,a,l){l=l||{};var u=t.parseAttributes(r,t.Line.ATTRIBUTE_NAMES),c=[u.x1||0,u.y1||0,u.x2||0,u.y2||0];a(new t.Line(c,i(u,l)))},t.Line.fromObject=function(r,a){function l(c){delete c.points,a&&a(c)}var u=o(r,!0);u.points=[r.x1,r.y1,r.x2,r.y2],t.Object._fromObject("Line",u,l,"points")};function s(r,a){var l=r.origin,u=r.axis1,c=r.axis2,h=r.dimension,d=a.nearest,g=a.center,m=a.farthest;return function(){switch(this.get(l)){case d:return Math.min(this.get(u),this.get(c));case g:return Math.min(this.get(u),this.get(c))+.5*this.get(h);case m:return Math.max(this.get(u),this.get(c))}}}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians;if(t.Circle){t.warn("fabric.Circle is already defined.");return}t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,s){return this.callSuper("_set",n,s),n==="radius"&&this.setRadius(s),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,s=0,r=0,a=(this.endAngle-this.startAngle)%360;if(a===0)n=["<circle ","COMMON_PARTS",'cx="'+s+'" cy="'+r+'" ','r="',this.radius,`" />
`];else{var l=i(this.startAngle),u=i(this.endAngle),c=this.radius,h=t.util.cos(l)*c,d=t.util.sin(l)*c,g=t.util.cos(u)*c,m=t.util.sin(u)*c,y=a>180?"1":"0";n=['<path d="M '+h+" "+d," A "+c+" "+c," 0 ",+y+" 1"," "+g+" "+m,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,i(this.startAngle),i(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(n,s){var r=t.parseAttributes(n,t.Circle.ATTRIBUTE_NAMES);if(!o(r))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,s(new t.Circle(r))};function o(n){return"radius"in n&&n.radius>=0}t.Circle.fromObject=function(n,s){t.Object._fromObject("Circle",n,s)}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Triangle){t.warn("fabric.Triangle is already defined");return}t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(i){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,n),i.lineTo(0,-n),i.lineTo(o,n),i.closePath(),this._renderPaintInOrder(i)},_toSVG:function(){var i=this.width/2,o=this.height/2,n=[-i+" "+o,"0 "+-o,i+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),t.Triangle.fromObject=function(i,o){return t.Object._fromObject("Triangle",i,o)}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.PI*2;if(t.Ellipse){t.warn("fabric.Ellipse is already defined.");return}t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,n){switch(this.callSuper("_set",o,n),o){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,i,!1),o.restore(),this._renderPaintInOrder(o)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(o,n){var s=t.parseAttributes(o,t.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,n(new t.Ellipse(s))},t.Ellipse.fromObject=function(o,n){t.Object._fromObject("Ellipse",o,n)}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend;if(t.Rect){t.warn("fabric.Rect is already defined");return}t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var n=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,a=this.height,l=-this.width/2,u=-this.height/2,c=n!==0||s!==0,h=1-.5522847498;o.beginPath(),o.moveTo(l+n,u),o.lineTo(l+r-n,u),c&&o.bezierCurveTo(l+r-h*n,u,l+r,u+h*s,l+r,u+s),o.lineTo(l+r,u+a-s),c&&o.bezierCurveTo(l+r,u+a-h*s,l+r-h*n,u+a,l+r-n,u+a),o.lineTo(l+n,u+a),c&&o.bezierCurveTo(l+h*n,u+a,l,u+a-h*s,l,u+a-s),o.lineTo(l,u+s),c&&o.bezierCurveTo(l,u+h*s,l+h*n,u,l+n,u),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(o,n,s){if(!o)return n(null);s=s||{};var r=t.parseAttributes(o,t.Rect.ATTRIBUTE_NAMES);r.left=r.left||0,r.top=r.top||0,r.height=r.height||0,r.width=r.width||0;var a=new t.Rect(i(s?t.util.object.clone(s):{},r));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},t.Rect.fromObject=function(o,n){return t.Object._fromObject("Rect",o,n)}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.array.min,n=t.util.array.max,s=t.util.toFixed,r=t.util.projectStrokeOnPoints;if(t.Polyline){t.warn("fabric.Polyline is already defined");return}t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(a,l){l=l||{},this.points=a||[],this.callSuper("initialize",l),this._setPositionDimensions(l)},_projectStrokeOnPoints:function(){return r(this.points,this,!0)},_setPositionDimensions:function(a){var l=this._calcDimensions(a),u,c=this.exactBoundingBox?this.strokeWidth:0;this.width=l.width-c,this.height=l.height-c,a.fromSVG||(u=this.translateToGivenOrigin({x:l.left-this.strokeWidth/2+c/2,y:l.top-this.strokeWidth/2+c/2},"left","top",this.originX,this.originY)),typeof a.left>"u"&&(this.left=a.fromSVG?l.left:u.x),typeof a.top>"u"&&(this.top=a.fromSVG?l.top:u.y),this.pathOffset={x:l.left+this.width/2+c/2,y:l.top+this.height/2+c/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,l=o(a,"x")||0,u=o(a,"y")||0,c=n(a,"x")||0,h=n(a,"y")||0,d=c-l,g=h-u;return{left:l,top:u,width:d,height:g}},toObject:function(a){return i(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],l=this.pathOffset.x,u=this.pathOffset.y,c=t.Object.NUM_FRACTION_DIGITS,h=0,d=this.points.length;h<d;h++)a.push(s(this.points[h].x-l,c),",",s(this.points[h].y-u,c)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),`" />
`]},commonRender:function(a){var l,u=this.points.length,c=this.pathOffset.x,h=this.pathOffset.y;if(!u||isNaN(this.points[u-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-c,this.points[0].y-h);for(var d=0;d<u;d++)l=this.points[d],a.lineTo(l.x-c,l.y-h);return!0},_render:function(a){this.commonRender(a)&&this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(a){return function(l,u,c){if(!l)return u(null);c||(c={});var h=t.parsePointsAttribute(l.getAttribute("points")),d=t.parseAttributes(l,t[a].ATTRIBUTE_NAMES);d.fromSVG=!0,u(new t[a](h,i(d,c)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(a,l){return t.Object._fromObject("Polyline",a,l,"points")}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.projectStrokeOnPoints;if(t.Polygon){t.warn("fabric.Polygon is already defined");return}t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return i(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(o,n){t.Object._fromObject("Polygon",o,n,"points")}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max,n=t.util.object.extend,s=t.util.object.clone,r=t.util.toFixed;if(t.Path){t.warn("fabric.Path is already defined");return}t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(a,l){l=s(l||{}),delete l.path,this.callSuper("initialize",l),this._setPath(a||[],l)},_setPath:function(a,l){this.path=t.util.makePathSimpler(Array.isArray(a)?a:t.util.parsePath(a)),t.Polyline.prototype._setPositionDimensions.call(this,l||{})},_renderPathCommands:function(a){var l,u=0,c=0,h=0,d=0,g=0,m=0,y=-this.pathOffset.x,C=-this.pathOffset.y;a.beginPath();for(var w=0,F=this.path.length;w<F;++w)switch(l=this.path[w],l[0]){case"L":h=l[1],d=l[2],a.lineTo(h+y,d+C);break;case"M":h=l[1],d=l[2],u=h,c=d,a.moveTo(h+y,d+C);break;case"C":h=l[5],d=l[6],g=l[3],m=l[4],a.bezierCurveTo(l[1]+y,l[2]+C,g+y,m+C,h+y,d+C);break;case"Q":a.quadraticCurveTo(l[1]+y,l[2]+C,l[3]+y,l[4]+C),h=l[3],d=l[4],g=l[1],m=l[2];break;case"z":case"Z":h=u,d=c,a.closePath();break}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return n(this.callSuper("toObject",a),{path:this.path.map(function(l){return l.slice()})})},toDatalessObject:function(a){var l=this.toObject(["sourcePath"].concat(a));return l.sourcePath&&delete l.path,l},_toSVG:function(){var a=t.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',a,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var a=t.Object.NUM_FRACTION_DIGITS;return" translate("+r(-this.pathOffset.x,a)+", "+r(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var l=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},toSVG:function(a){var l=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var a=[],l=[],u,c=0,h=0,d=0,g=0,m,y=0,C=this.path.length;y<C;++y){switch(u=this.path[y],u[0]){case"L":d=u[1],g=u[2],m=[];break;case"M":d=u[1],g=u[2],c=d,h=g,m=[];break;case"C":m=t.util.getBoundsOfCurve(d,g,u[1],u[2],u[3],u[4],u[5],u[6]),d=u[5],g=u[6];break;case"Q":m=t.util.getBoundsOfCurve(d,g,u[1],u[2],u[1],u[2],u[3],u[4]),d=u[3],g=u[4];break;case"z":case"Z":d=c,g=h;break}m.forEach(function(X){a.push(X.x),l.push(X.y)}),a.push(d),l.push(g)}var w=i(a)||0,F=i(l)||0,B=o(a)||0,U=o(l)||0,R=B-w,W=U-F;return{left:w,top:F,width:R,height:W}}}),t.Path.fromObject=function(a,l){if(typeof a.sourcePath=="string"){var u=a.sourcePath;t.loadSVGFromURL(u,function(c){var h=c[0];h.setOptions(a),a.clipPath?t.util.enlivenObjects([a.clipPath],function(d){h.clipPath=d[0],l&&l(h)}):l&&l(h)})}else t.Object._fromObject("Path",a,l,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(a,l,u){var c=t.parseAttributes(a,t.Path.ATTRIBUTE_NAMES);c.fromSVG=!0,l(new t.Path(c.d,n(c,u)))}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,s,r){s=s||{},this._objects=[],r&&this.callSuper("initialize",s),this._objects=n||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(r)this._updateObjectsACoords();else{var l=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),l||this._calcBounds(),this._updateObjectsCoords(l),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,s=this._objects.length;s--;)this._objects[s].setCoords(n)},_updateObjectsCoords:function(s){for(var s=s||this.getCenterPoint(),r=this._objects.length;r--;)this._updateObjectCoords(this._objects[r],s)},_updateObjectCoords:function(n,s){var r=n.left,a=n.top,l=!0;n.set({left:r-s.x,top:a-s.y}),n.group=this,n.setCoords(l)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var s=!!this.group;return this._restoreObjectsState(),t.util.resetObjectTransform(this),n&&(s&&t.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,s){var r=this._objects.length;if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(n,s);if(n==="canvas")for(;r--;)this._objects[r]._set(n,s);t.Object.prototype._set.call(this,n,s)},toObject:function(n){var s=this.includeDefaultValues,r=this._objects.filter(function(l){return!l.excludeFromExport}).map(function(l){var u=l.includeDefaultValues;l.includeDefaultValues=s;var c=l.toObject(n);return l.includeDefaultValues=u,c}),a=t.Object.prototype.toObject.call(this,n);return a.objects=r,a},toDatalessObject:function(n){var s,r=this.sourcePath;if(r)s=r;else{var a=this.includeDefaultValues;s=this._objects.map(function(u){var c=u.includeDefaultValues;u.includeDefaultValues=a;var h=u.toDatalessObject(n);return u.includeDefaultValues=c,h})}var l=t.Object.prototype.toDatalessObject.call(this,n);return l.objects=s,l},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=t.Object.prototype.shouldCache.call(this);if(n){for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(t.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,s=this._objects.length;n<s;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var s=0,r=this._objects.length;s<r;s++)this._objects[s].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,l=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-l/2,a,l)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(s){t.util.addTransformToObject(s,n),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,s=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var a=new t.ActiveSelection([]);return a.set(r),a.type="activeSelection",s.remove(this),n.forEach(function(l){l.group=a,l.dirty=!0,s.add(l)}),a.canvas=s,a._objects=n,s._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(s){s.setCoords(n)}),this},_calcBounds:function(n){for(var s=[],r=[],a,l,u,c=["tr","br","bl","tl"],h=0,d=this._objects.length,g,m=c.length;h<d;++h){for(a=this._objects[h],u=a.calcACoords(),g=0;g<m;g++)l=c[g],s.push(u[l].x),r.push(u[l].y);a.aCoords=u}this._getBounds(s,r,n)},_getBounds:function(n,s,r){var a=new t.Point(i(n),i(s)),l=new t.Point(o(n),o(s)),u=a.y||0,c=a.x||0,h=l.x-a.x||0,d=l.y-a.y||0;this.width=h,this.height=d,r||this.setPositionByOrigin({x:c,y:u},"left","top")},_toSVG:function(n){for(var s=["<g ","COMMON_PARTS",` >
`],r=0,a=this._objects.length;r<a;r++)s.push("		",this._objects[r].toSVG(n));return s.push(`</g>
`),s},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),s].join("")},toClipPathSVG:function(n){for(var s=[],r=0,a=this._objects.length;r<a;r++)s.push("	",this._objects[r].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(s,{reviver:n})}}),t.Group.fromObject=function(n,s){var r=n.objects,a=t.util.object.clone(n,!0);if(delete a.objects,typeof r=="string"){t.loadSVGFromURL(r,function(l){var u=t.util.groupSVGElements(l,n,r),c=a.clipPath;delete a.clipPath,u.set(a),c?t.util.enlivenObjects([c],function(h){u.clipPath=h[0],s&&s(u)}):s&&s(u)});return}t.util.enlivenObjects(r,function(l){t.util.enlivenObjectEnlivables(n,a,function(){s&&s(new t.Group(l,a,!0))})})})})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(i,o){o=o||{},this._objects=i||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var i=this._objects.concat();this._objects=[];var o=t.Object.prototype.toObject.call(this),n=new t.Group([]);if(delete o.type,n.set(o),i.forEach(function(r){r.canvas.remove(r),r.group=n}),n._objects=i,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(i,o,n){i.save(),i.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",i,o),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var s=0,r=this._objects.length;s<r;s++)this._objects[s]._renderControls(i,n);i.restore()}}),t.ActiveSelection.fromObject=function(i,o){t.util.enlivenObjects(i.objects,function(n){delete i.objects,o&&o(new t.ActiveSelection(n,i,!0))})})})(Ct);(function(e){"use strict";var t=D.util.object.extend;if(e.fabric||(e.fabric={}),e.fabric.Image){D.warn("fabric.Image is already defined.");return}D.Image=D.util.createClass(D.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:D.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:D.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(i,o){o||(o={}),this.filters=[],this.cacheKey="texture"+D.Object.__uid++,this.callSuper("initialize",o),this._initElement(i,o)},getElement:function(){return this._element||{}},setElement:function(i,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=i,this._originalElement=i,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(i){var o=D.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(i)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(i){D.util.cleanUpJsdomNode(this[i]),this[i]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var i=this.getElement();return{width:i.naturalWidth||i.width,height:i.naturalHeight||i.height}},_stroke:function(i){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,-n),i.lineTo(o,-n),i.lineTo(o,n),i.lineTo(-o,n),i.lineTo(-o,-n),i.closePath()}},toObject:function(i){var o=[];this.filters.forEach(function(s){s&&o.push(s.toObject())});var n=t(this.callSuper("toObject",["cropX","cropY"].concat(i)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var i=[],o=[],n,s=this._element,r=-this.width/2,a=-this.height/2,l="",u="";if(!s)return[];if(this.hasCrop()){var c=D.Object.__uid++;i.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+r+'" y="'+a+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(u='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',r-this.cropX,'" y="',a-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,u,'"',l,`></image>
`),this.stroke||this.strokeDashArray){var h=this.fill;this.fill=null,n=["	<rect ",'x="',r,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=h}return this.paintFirst!=="fill"?i=i.concat(n,o):i=i.concat(o,n),i},getSrc:function(i){var o=i?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(i,o,n){return D.util.loadImage(i,function(s,r){this.setElement(s,n),this._setWidthHeight(),o&&o(this,r)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var i=this.resizeFilter,o=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.scaleX,r=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!i||s>o&&r>o){this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,this._lastScaleY=r;return}D.filterBackend||(D.filterBackend=D.initFilterBackend());var l=D.util.createCanvasElement(),u=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,c=a.width,h=a.height;l.width=c,l.height=h,this._element=l,this._lastScaleX=i.scaleX=s,this._lastScaleY=i.scaleY=r,D.filterBackend.applyFilters([i],a,c,h,this._element,u),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height},applyFilters:function(i){if(i=i||this.filters||[],i=i.filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),i.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,n=o.naturalWidth||o.width,s=o.naturalHeight||o.height;if(this._element===this._originalElement){var r=D.util.createCanvasElement();r.width=n,r.height=s,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1;return D.filterBackend||(D.filterBackend=D.initFilterBackend()),D.filterBackend.applyFilters(i,this._originalElement,n,s,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(i){D.util.setImageSmoothing(i,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(i),this._renderPaintInOrder(i)},drawCacheOnCanvas:function(i){D.util.setImageSmoothing(i,this.imageSmoothing),D.Object.prototype.drawCacheOnCanvas.call(this,i)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(i){var o=this._element;if(o){var n=this._filterScalingX,s=this._filterScalingY,r=this.width,a=this.height,l=Math.min,u=Math.max,c=u(this.cropX,0),h=u(this.cropY,0),d=o.naturalWidth||o.width,g=o.naturalHeight||o.height,m=c*n,y=h*s,C=l(r*n,d-m),w=l(a*s,g-y),F=-r/2,B=-a/2,U=l(r,d/n-c),R=l(a,g/s-h);o&&i.drawImage(o,m,y,C,w,F,B,U,R)}},_needsResize:function(){var i=this.getTotalObjectScaling();return i.scaleX!==this._lastScaleX||i.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(i,o){this.setElement(D.util.getById(i),o),D.util.addClass(this.getElement(),D.Image.CSS_CANVAS)},_initConfig:function(i){i||(i={}),this.setOptions(i),this._setWidthHeight(i)},_initFilters:function(i,o){i&&i.length?D.util.enlivenObjects(i,function(n){o&&o(n)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(i){i||(i={});var o=this.getElement();this.width=i.width||o.naturalWidth||o.width||0,this.height=i.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var i=D.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,n=this._element.height,s=1,r=1,a=0,l=0,u=0,c=0,h,d=this.width,g=this.height,m={width:d,height:g};return i&&(i.alignX!=="none"||i.alignY!=="none")?(i.meetOrSlice==="meet"&&(s=r=D.util.findScaleToFit(this._element,m),h=(d-o*s)/2,i.alignX==="Min"&&(a=-h),i.alignX==="Max"&&(a=h),h=(g-n*r)/2,i.alignY==="Min"&&(l=-h),i.alignY==="Max"&&(l=h)),i.meetOrSlice==="slice"&&(s=r=D.util.findScaleToCover(this._element,m),h=o-d/s,i.alignX==="Mid"&&(u=h/2),i.alignX==="Max"&&(u=h),h=n-g/r,i.alignY==="Mid"&&(c=h/2),i.alignY==="Max"&&(c=h),o=d/s,n=g/r)):(s=d/o,r=g/n),{width:o,height:n,scaleX:s,scaleY:r,offsetLeft:a,offsetTop:l,cropX:u,cropY:c}}}),D.Image.CSS_CANVAS="canvas-img",D.Image.prototype.getSvgSrc=D.Image.prototype.getSrc,D.Image.fromObject=function(i,o){var n=D.util.object.clone(i);D.util.loadImage(n.src,function(s,r){if(r){o&&o(null,!0);return}D.Image.prototype._initFilters.call(n,n.filters,function(a){n.filters=a||[],D.Image.prototype._initFilters.call(n,[n.resizeFilter],function(l){n.resizeFilter=l[0],D.util.enlivenObjectEnlivables(n,n,function(){var u=new D.Image(s,n);o(u,!1)})})})},null,n.crossOrigin)},D.Image.fromURL=function(i,o,n){D.util.loadImage(i,function(s,r){o&&o(new D.Image(s,n),r)},null,n&&n.crossOrigin)},D.Image.ATTRIBUTE_NAMES=D.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),D.Image.fromElement=function(i,o,n){var s=D.parseAttributes(i,D.Image.ATTRIBUTE_NAMES);D.Image.fromURL(s["xlink:href"],o,t(n?D.util.object.clone(n):{},s))}})(Ct);D.util.object.extend(D.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.angle%360;return e>0?Math.round((e-1)/90)*90:Math.round(e/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(e){e=e||{};var t=function(){},i=e.onComplete||t,o=e.onChange||t,n=this;return D.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){n.rotate(s),o()},onComplete:function(){n.setCoords(),i()}})}});D.util.object.extend(D.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function e(i,o){var n="precision "+o+` float;
void main(){}`,s=i.createShader(i.FRAGMENT_SHADER);return i.shaderSource(s,n),i.compileShader(s),!!i.getShaderParameter(s,i.COMPILE_STATUS)}D.isWebglSupported=function(i){if(D.isLikelyNode)return!1;i=i||D.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl"),s=!1;if(n){D.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=D.maxTextureSize>=i;for(var r=["highp","mediump","lowp"],a=0;a<3;a++)if(e(n,r[a])){D.webGlPrecision=r[a];break}}return this.isSupported=s,s},D.WebglFilterBackend=t;function t(i){i&&i.tileSize&&(this.tileSize=i.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}t.prototype={tileSize:2048,resources:{},setupGLContext:function(i,o){this.dispose(),this.createWebGLCanvas(i,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(i,o)},chooseFastestCopyGLTo2DMethod:function(i,o){var n=typeof window.performance<"u",s;try{new ImageData(1,1),s=!0}catch{s=!1}var r=typeof ArrayBuffer<"u",a=typeof Uint8ClampedArray<"u";if(n&&s&&r&&a){var l=D.util.createCanvasElement(),u=new ArrayBuffer(i*o*4);if(D.forceGLPutImageData){this.imageBuffer=u,this.copyGLTo2D=Ld;return}var c={imageBuffer:u,destinationWidth:i,destinationHeight:o,targetCanvas:l},h,d,g;l.width=i,l.height=o,h=window.performance.now(),Bd.call(c,this.gl,c),d=window.performance.now()-h,h=window.performance.now(),Ld.call(c,this.gl,c),g=window.performance.now()-h,d>g?(this.imageBuffer=u,this.copyGLTo2D=Ld):this.copyGLTo2D=Bd}},createWebGLCanvas:function(i,o){var n=D.util.createCanvasElement();n.width=i,n.height=o;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=n.getContext("webgl",s);r||(r=n.getContext("experimental-webgl",s)),r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)},applyFilters:function(i,o,n,s,r,a){var l=this.gl,u;a&&(u=this.getCachedTexture(a,o));var c={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:l,sourceTexture:this.createTexture(l,n,s,!u&&o),targetTexture:this.createTexture(l,n,s),originalTexture:u||this.createTexture(l,n,s,!u&&o),passes:i.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},h=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,h),i.forEach(function(d){d&&d.applyTo(c)}),uE(c),this.copyGLTo2D(l,c),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(c.sourceTexture),l.deleteTexture(c.targetTexture),l.deleteFramebuffer(h),r.getContext("2d").setTransform(1,0,0,1,0,0),c},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(i,o,n,s){var r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),s?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,o,n,0,i.RGBA,i.UNSIGNED_BYTE,null),r},getCachedTexture:function(i,o){if(this.textureCache[i])return this.textureCache[i];var n=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[i]=n,n},evictCachesForKey:function(i){this.textureCache[i]&&(this.gl.deleteTexture(this.textureCache[i]),delete this.textureCache[i])},copyGLTo2D:Bd,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var i=this.gl,o={renderer:"",vendor:""};if(!i)return o;var n=i.getExtension("WEBGL_debug_renderer_info");if(n){var s=i.getParameter(n.UNMASKED_RENDERER_WEBGL),r=i.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(o.renderer=s.toLowerCase()),r&&(o.vendor=r.toLowerCase())}return this.gpuInfo=o,o}}})();function uE(e){var t=e.targetCanvas,i=t.width,o=t.height,n=e.destinationWidth,s=e.destinationHeight;(i!==n||o!==s)&&(t.width=n,t.height=s)}function Bd(e,t){var i=e.canvas,o=t.targetCanvas,n=o.getContext("2d");n.translate(0,o.height),n.scale(1,-1);var s=i.height-o.height;n.drawImage(i,0,s,o.width,o.height,0,0,o.width,o.height)}function Ld(e,t){var i=t.targetCanvas,o=i.getContext("2d"),n=t.destinationWidth,s=t.destinationHeight,r=n*s*4,a=new Uint8Array(this.imageBuffer,0,r),l=new Uint8ClampedArray(this.imageBuffer,0,r);e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,a);var u=new ImageData(l,n,s);o.putImageData(u,0,0)}(function(){"use strict";var e=function(){};D.Canvas2dFilterBackend=t;function t(){}t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(i,o,n,s,r){var a=r.getContext("2d");a.drawImage(o,0,0,n,s);var l=a.getImageData(0,0,n,s),u=a.getImageData(0,0,n,s),c={sourceWidth:n,sourceHeight:s,imageData:l,originalEl:o,originalImageData:u,canvasEl:r,ctx:a,filterBackend:this};return i.forEach(function(h){h.applyTo(c)}),(c.imageData.width!==n||c.imageData.height!==s)&&(r.width=c.imageData.width,r.height=c.imageData.height),a.putImageData(c.imageData,0,0),c}}})();D.Image=D.Image||{};D.Image.filters=D.Image.filters||{};D.Image.filters.BaseFilter=D.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},createProgram:function(e,t,i){t=t||this.fragmentSource,i=i||this.vertexSource,D.webGlPrecision!=="highp"&&(t=t.replace(/precision highp float/g,"precision "+D.webGlPrecision+" float"));var o=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(o,i),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+e.getShaderInfoLog(o));var n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+e.getShaderInfoLog(n));var s=e.createProgram();if(e.attachShader(s,o),e.attachShader(s,n),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+e.getProgramInfoLog(s));var r=this.getAttributeLocations(e,s),a=this.getUniformLocations(e,s)||{};return a.uStepW=e.getUniformLocation(s,"uStepW"),a.uStepH=e.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:r,uniformLocations:a}},getAttributeLocations:function(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(e,t,i){var o=t.aPosition,n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW)},_setupFrameBuffer:function(e){var t=e.context,i,o;e.passes>1?(i=e.destinationWidth,o=e.destinationHeight,(e.sourceWidth!==i||e.sourceHeight!==o)&&(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,i,o)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish())},_swapTextures:function(e){e.passes--,e.pass++;var t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t},isNeutralState:function(){var e=this.mainParameter,t=D.Image.filters[this.type].prototype;if(e)if(Array.isArray(t[e])){for(var i=t[e].length;i--;)if(this[e][i]!==t[e][i])return!1;return!0}else return t[e]===this[e];else return!1},applyTo:function(e){e.webgl?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},retrieveShader:function(e){return e.programCache.hasOwnProperty(this.type)||(e.programCache[this.type]=this.createProgram(e.context)),e.programCache[this.type]},applyToWebGL:function(e){var t=e.context,i=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(i.program),this.sendAttributeData(t,i.attributeLocations,e.aPosition),t.uniform1f(i.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(i.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,i.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(e,t,i){e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)},unbindAdditionalTexture:function(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(e){this[this.mainParameter]=e},sendUniformData:function(){},createHelpLayer:function(e){if(!e.helpLayer){var t=document.createElement("canvas");t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}},toObject:function(){var e={type:this.type},t=this.mainParameter;return t&&(e[t]=this[t]),e},toJSON:function(){return this.toObject()}});D.Image.filters.BaseFilter.fromObject=function(e,t){var i=new D.Image.filters[e.type](e);return t&&t(i),i};(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.ColorMatrix=o(i.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,l=this.matrix,u,c,h,d,g,m=this.colorsOnly;for(g=0;g<a;g+=4)u=r[g],c=r[g+1],h=r[g+2],m?(r[g]=u*l[0]+c*l[1]+h*l[2]+l[4]*255,r[g+1]=u*l[5]+c*l[6]+h*l[7]+l[9]*255,r[g+2]=u*l[10]+c*l[11]+h*l[12]+l[14]*255):(d=r[g+3],r[g]=u*l[0]+c*l[1]+h*l[2]+d*l[3]+l[4]*255,r[g+1]=u*l[5]+c*l[6]+h*l[7]+d*l[8]+l[9]*255,r[g+2]=u*l[10]+c*l[11]+h*l[12]+d*l[13]+l[14]*255,r[g+3]=u*l[15]+c*l[16]+h*l[17]+d*l[18]+l[19]*255)},getUniformLocations:function(n,s){return{uColorMatrix:n.getUniformLocation(s,"uColorMatrix"),uConstants:n.getUniformLocation(s,"uConstants")}},sendUniformData:function(n,s){var r=this.matrix,a=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],l=[r[4],r[9],r[14],r[19]];n.uniformMatrix4fv(s.uColorMatrix,!1,a),n.uniform4fv(s.uConstants,l)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Brightness=o(i.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var s=n.imageData,r=s.data,a,l=r.length,u=Math.round(this.brightness*255);for(a=0;a<l;a+=4)r[a]=r[a]+u,r[a+1]=r[a+1]+u,r[a+2]=r[a+2]+u}},getUniformLocations:function(n,s){return{uBrightness:n.getUniformLocation(s,"uBrightness")}},sendUniformData:function(n,s){n.uniform1f(s.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Convolute=n(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var r=Math.sqrt(this.matrix.length),a=this.type+"_"+r+"_"+(this.opaque?1:0),l=this.fragmentSource[a];return s.programCache.hasOwnProperty(a)||(s.programCache[a]=this.createProgram(s.context,l)),s.programCache[a]},applyTo2d:function(s){var r=s.imageData,a=r.data,l=this.matrix,u=Math.round(Math.sqrt(l.length)),c=Math.floor(u/2),h=r.width,d=r.height,g=s.ctx.createImageData(h,d),m=g.data,y=this.opaque?1:0,C,w,F,B,U,R,W,X,$,st,pt,dt,x;for(pt=0;pt<d;pt++)for(st=0;st<h;st++){for(U=(pt*h+st)*4,C=0,w=0,F=0,B=0,x=0;x<u;x++)for(dt=0;dt<u;dt++)W=pt+x-c,R=st+dt-c,!(W<0||W>=d||R<0||R>=h)&&(X=(W*h+R)*4,$=l[x*u+dt],C+=a[X]*$,w+=a[X+1]*$,F+=a[X+2]*$,y||(B+=a[X+3]*$));m[U]=C,m[U+1]=w,m[U+2]=F,y?m[U+3]=a[U+3]:m[U+3]=B}s.imageData=g},getUniformLocations:function(s,r){return{uMatrix:s.getUniformLocation(r,"uMatrix"),uOpaque:s.getUniformLocation(r,"uOpaque"),uHalfSize:s.getUniformLocation(r,"uHalfSize"),uSize:s.getUniformLocation(r,"uSize")}},sendUniformData:function(s,r){s.uniform1fv(r.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Grayscale=o(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var s=n.imageData,r=s.data,a,l=r.length,u,c=this.mode;for(a=0;a<l;a+=4)c==="average"?u=(r[a]+r[a+1]+r[a+2])/3:c==="lightness"?u=(Math.min(r[a],r[a+1],r[a+2])+Math.max(r[a],r[a+1],r[a+2]))/2:c==="luminosity"&&(u=.21*r[a]+.72*r[a+1]+.07*r[a+2]),r[a]=u,r[a+1]=u,r[a+2]=u},retrieveShader:function(n){var s=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(s)){var r=this.fragmentSource[this.mode];n.programCache[s]=this.createProgram(n.context,r)}return n.programCache[s]},getUniformLocations:function(n,s){return{uMode:n.getUniformLocation(s,"uMode")}},sendUniformData:function(n,s){var r=1;n.uniform1i(s.uMode,r)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Invert=o(i.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var s=n.imageData,r=s.data,a,l=r.length;for(a=0;a<l;a+=4)r[a]=255-r[a],r[a+1]=255-r[a+1],r[a+2]=255-r[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,s){return{uInvert:n.getUniformLocation(s,"uInvert")}},sendUniformData:function(n,s){n.uniform1i(s.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Noise=n(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var r=s.imageData,a=r.data,l,u=a.length,c=this.noise,h;for(l=0,u=a.length;l<u;l+=4)h=(.5-Math.random())*c,a[l]+=h,a[l+1]+=h,a[l+2]+=h}},getUniformLocations:function(s,r){return{uNoise:s.getUniformLocation(r,"uNoise"),uSeed:s.getUniformLocation(r,"uSeed")}},sendUniformData:function(s,r){s.uniform1f(r.uNoise,this.noise/255),s.uniform1f(r.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Pixelate=o(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var s=n.imageData,r=s.data,a=s.height,l=s.width,u,c,h,d,g,m,y,C,w,F,B;for(c=0;c<a;c+=this.blocksize)for(h=0;h<l;h+=this.blocksize)for(u=c*4*l+h*4,d=r[u],g=r[u+1],m=r[u+2],y=r[u+3],F=Math.min(c+this.blocksize,a),B=Math.min(h+this.blocksize,l),C=c;C<F;C++)for(w=h;w<B;w++)u=C*4*l+w*4,r[u]=d,r[u+1]=g,r[u+2]=m,r[u+3]=y},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,s){return{uBlocksize:n.getUniformLocation(s,"uBlocksize"),uStepW:n.getUniformLocation(s,"uStepW"),uStepH:n.getUniformLocation(s,"uStepH")}},sendUniformData:function(n,s){n.uniform1f(s.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.RemoveColor=n(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var r=s.imageData,a=r.data,l,u=this.distance*255,c,h,d,g=new t.Color(this.color).getSource(),m=[g[0]-u,g[1]-u,g[2]-u],y=[g[0]+u,g[1]+u,g[2]+u];for(l=0;l<a.length;l+=4)c=a[l],h=a[l+1],d=a[l+2],c>m[0]&&h>m[1]&&d>m[2]&&c<y[0]&&h<y[1]&&d<y[2]&&(a[l+3]=0)},getUniformLocations:function(s,r){return{uLow:s.getUniformLocation(r,"uLow"),uHigh:s.getUniformLocation(r,"uHigh")}},sendUniformData:function(s,r){var a=new t.Color(this.color).getSource(),l=parseFloat(this.distance),u=[0+a[0]/255-l,0+a[1]/255-l,0+a[2]/255-l,1],c=[a[0]/255+l,a[1]/255+l,a[2]/255+l,1];s.uniform4fv(r.uLow,u),s.uniform4fv(r.uHigh,c)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)i[s]=o(i.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),t.Image.filters[s].fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendColor=o(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r;return n.programCache.hasOwnProperty(s)||(r=this.buildSource(this.mode),n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,l,u,c,h,d,g,m,y=1-this.alpha;m=new t.Color(this.color).getSource(),l=m[0]*this.alpha,u=m[1]*this.alpha,c=m[2]*this.alpha;for(var C=0;C<a;C+=4)switch(h=r[C],d=r[C+1],g=r[C+2],this.mode){case"multiply":r[C]=h*l/255,r[C+1]=d*u/255,r[C+2]=g*c/255;break;case"screen":r[C]=255-(255-h)*(255-l)/255,r[C+1]=255-(255-d)*(255-u)/255,r[C+2]=255-(255-g)*(255-c)/255;break;case"add":r[C]=h+l,r[C+1]=d+u,r[C+2]=g+c;break;case"diff":case"difference":r[C]=Math.abs(h-l),r[C+1]=Math.abs(d-u),r[C+2]=Math.abs(g-c);break;case"subtract":r[C]=h-l,r[C+1]=d-u,r[C+2]=g-c;break;case"darken":r[C]=Math.min(h,l),r[C+1]=Math.min(d,u),r[C+2]=Math.min(g,c);break;case"lighten":r[C]=Math.max(h,l),r[C+1]=Math.max(d,u),r[C+2]=Math.max(g,c);break;case"overlay":r[C]=l<128?2*h*l/255:255-2*(255-h)*(255-l)/255,r[C+1]=u<128?2*d*u/255:255-2*(255-d)*(255-u)/255,r[C+2]=c<128?2*g*c/255:255-2*(255-g)*(255-c)/255;break;case"exclusion":r[C]=l+h-2*l*h/255,r[C+1]=u+d-2*u*d/255,r[C+2]=c+g-2*c*g/255;break;case"tint":r[C]=l+h*y,r[C+1]=u+d*y,r[C+2]=c+g*y}},getUniformLocations:function(n,s){return{uColor:n.getUniformLocation(s,"uColor")}},sendUniformData:function(n,s){var r=new t.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,n.uniform4fv(s.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendImage=o(i.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyToWebGL:function(n){var s=n.context,r=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(s,r,s.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(n,s){return n.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var n=this.image,s=n._element.width,r=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/s,-n.top/r,1]},applyTo2d:function(n){var s=n.imageData,r=n.filterBackend.resources,a=s.data,l=a.length,u=s.width,c=s.height,h,d,g,m,y,C,w,F,B,U,R=this.image,W;r.blendImage||(r.blendImage=t.util.createCanvasElement()),B=r.blendImage,U=B.getContext("2d"),B.width!==u||B.height!==c?(B.width=u,B.height=c):U.clearRect(0,0,u,c),U.setTransform(R.scaleX,0,0,R.scaleY,R.left,R.top),U.drawImage(R._element,0,0,u,c),W=U.getImageData(0,0,u,c).data;for(var X=0;X<l;X+=4)switch(y=a[X],C=a[X+1],w=a[X+2],F=a[X+3],h=W[X],d=W[X+1],g=W[X+2],m=W[X+3],this.mode){case"multiply":a[X]=y*h/255,a[X+1]=C*d/255,a[X+2]=w*g/255,a[X+3]=F*m/255;break;case"mask":a[X+3]=m;break}},getUniformLocations:function(n,s){return{uTransformMatrix:n.getUniformLocation(s,"uTransformMatrix"),uImage:n.getUniformLocation(s,"uImage")}},sendUniformData:function(n,s){var r=this.calculateMatrix();n.uniform1i(s.uImage,1),n.uniformMatrix3fv(s.uTransformMatrix,!1,r)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(n,s){t.Image.fromObject(n.image,function(r){var a=t.util.object.clone(n);a.image=r,s(new t.Image.filters.BlendImage(a))})}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.pow,o=Math.floor,n=Math.sqrt,s=Math.abs,r=Math.round,a=Math.sin,l=Math.ceil,u=t.Image.filters,c=t.util.createClass;u.Resize=c(u.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(h,d){return{uDelta:h.getUniformLocation(d,"uDelta"),uTaps:h.getUniformLocation(d,"uTaps")}},sendUniformData:function(h,d){h.uniform2fv(d.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),h.uniform1fv(d.uTaps,this.taps)},retrieveShader:function(h){var d=this.getFilterWindow(),g=this.type+"_"+d;if(!h.programCache.hasOwnProperty(g)){var m=this.generateShader(d);h.programCache[g]=this.createProgram(h.context,m)}return h.programCache[g]},getFilterWindow:function(){var h=this.tempScale;return Math.ceil(this.lanczosLobes/h)},getTaps:function(){for(var h=this.lanczosCreate(this.lanczosLobes),d=this.tempScale,g=this.getFilterWindow(),m=new Array(g),y=1;y<=g;y++)m[y-1]=h(y*d);return m},generateShader:function(m){for(var d=new Array(m),g=this.fragmentSourceTOP,m,y=1;y<=m;y++)d[y-1]=y+".0 * uDelta";return g+="uniform float uTaps["+m+`];
`,g+=`void main() {
`,g+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,g+=`  float sum = 1.0;
`,d.forEach(function(C,w){g+="  color += texture2D(uTexture, vTexCoord + "+C+") * uTaps["+w+`];
`,g+="  color += texture2D(uTexture, vTexCoord - "+C+") * uTaps["+w+`];
`,g+="  sum += 2.0 * uTaps["+w+`];
`}),g+=`  gl_FragColor = color / sum;
`,g+="}",g},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(h){h.webgl?(h.passes++,this.width=h.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=h.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),h.destinationWidth=this.dW,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceWidth=h.destinationWidth,this.height=h.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),h.destinationHeight=this.dH,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceHeight=h.destinationHeight):this.applyTo2d(h)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(h){return function(d){if(d>=h||d<=-h)return 0;if(d<11920929e-14&&d>-11920929e-14)return 1;d*=Math.PI;var g=d/h;return a(d)/d*a(g)/g}},applyTo2d:function(h){var d=h.imageData,g=this.scaleX,m=this.scaleY;this.rcpScaleX=1/g,this.rcpScaleY=1/m;var y=d.width,C=d.height,w=r(y*g),F=r(C*m),B;this.resizeType==="sliceHack"?B=this.sliceByTwo(h,y,C,w,F):this.resizeType==="hermite"?B=this.hermiteFastResize(h,y,C,w,F):this.resizeType==="bilinear"?B=this.bilinearFiltering(h,y,C,w,F):this.resizeType==="lanczos"&&(B=this.lanczosResize(h,y,C,w,F)),h.imageData=B},sliceByTwo:function(h,d,g,m,y){var C=h.imageData,w=.5,F=!1,B=!1,U=d*w,R=g*w,W=t.filterBackend.resources,X,$,st=0,pt=0,dt=d,x=0;for(W.sliceByTwo||(W.sliceByTwo=document.createElement("canvas")),X=W.sliceByTwo,(X.width<d*1.5||X.height<g)&&(X.width=d*1.5,X.height=g),$=X.getContext("2d"),$.clearRect(0,0,d*1.5,g),$.putImageData(C,0,0),m=o(m),y=o(y);!F||!B;)d=U,g=R,m<o(U*w)?U=o(U*w):(U=m,F=!0),y<o(R*w)?R=o(R*w):(R=y,B=!0),$.drawImage(X,st,pt,d,g,dt,x,U,R),st=dt,pt=x,x+=R;return $.getImageData(st,pt,m,y)},lanczosResize:function(h,d,g,m,y){function C(I){var k,K,S,_,O,j,q,N,H,Q,ot;for(x.x=(I+.5)*R,P.x=o(x.x),k=0;k<y;k++){for(x.y=(k+.5)*W,P.y=o(x.y),O=0,j=0,q=0,N=0,H=0,K=P.x-st;K<=P.x+st;K++)if(!(K<0||K>=d)){Q=o(1e3*s(K-x.x)),dt[Q]||(dt[Q]={});for(var Y=P.y-pt;Y<=P.y+pt;Y++)Y<0||Y>=g||(ot=o(1e3*s(Y-x.y)),dt[Q][ot]||(dt[Q][ot]=U(n(i(Q*X,2)+i(ot*$,2))/1e3)),S=dt[Q][ot],S>0&&(_=(Y*d+K)*4,O+=S,j+=S*w[_],q+=S*w[_+1],N+=S*w[_+2],H+=S*w[_+3]))}_=(k*m+I)*4,B[_]=j/O,B[_+1]=q/O,B[_+2]=N/O,B[_+3]=H/O}return++I<m?C(I):F}var w=h.imageData.data,F=h.ctx.createImageData(m,y),B=F.data,U=this.lanczosCreate(this.lanczosLobes),R=this.rcpScaleX,W=this.rcpScaleY,X=2/this.rcpScaleX,$=2/this.rcpScaleY,st=l(R*this.lanczosLobes/2),pt=l(W*this.lanczosLobes/2),dt={},x={},P={};return C(0)},bilinearFiltering:function(h,d,g,m,y){var C,w,F,B,U,R,W,X,$,st,pt,dt,x=0,P,I=this.rcpScaleX,k=this.rcpScaleY,K=4*(d-1),S=h.imageData,_=S.data,O=h.ctx.createImageData(m,y),j=O.data;for(W=0;W<y;W++)for(X=0;X<m;X++)for(U=o(I*X),R=o(k*W),$=I*X-U,st=k*W-R,P=4*(R*d+U),pt=0;pt<4;pt++)C=_[P+pt],w=_[P+4+pt],F=_[P+K+pt],B=_[P+K+4+pt],dt=C*(1-$)*(1-st)+w*$*(1-st)+F*st*(1-$)+B*$*st,j[x++]=dt;return O},hermiteFastResize:function(h,d,g,m,y){for(var C=this.rcpScaleX,w=this.rcpScaleY,F=l(C/2),B=l(w/2),U=h.imageData,R=U.data,W=h.ctx.createImageData(m,y),X=W.data,$=0;$<y;$++)for(var st=0;st<m;st++){for(var pt=(st+$*m)*4,dt=0,x=0,P=0,I=0,k=0,K=0,S=0,_=($+.5)*w,O=o($*w);O<($+1)*w;O++)for(var j=s(_-(O+.5))/B,q=(st+.5)*C,N=j*j,H=o(st*C);H<(st+1)*C;H++){var Q=s(q-(H+.5))/F,ot=n(N+Q*Q);ot>1&&ot<-1||(dt=2*ot*ot*ot-3*ot*ot+1,dt>0&&(Q=4*(H+O*d),S+=dt*R[Q+3],P+=dt,R[Q+3]<255&&(dt=dt*R[Q+3]/250),I+=dt*R[Q],k+=dt*R[Q+1],K+=dt*R[Q+2],x+=dt))}X[pt]=I/x,X[pt+1]=k/x,X[pt+2]=K/x,X[pt+3]=S/P}return W},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Contrast=o(i.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var s=n.imageData,r,l,a=s.data,l=a.length,u=Math.floor(this.contrast*255),c=259*(u+255)/(255*(259-u));for(r=0;r<l;r+=4)a[r]=c*(a[r]-128)+128,a[r+1]=c*(a[r+1]-128)+128,a[r+2]=c*(a[r+2]-128)+128}},getUniformLocations:function(n,s){return{uContrast:n.getUniformLocation(s,"uContrast")}},sendUniformData:function(n,s){n.uniform1f(s.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Saturation=o(i.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var s=n.imageData,r=s.data,a=r.length,l=-this.saturation,u,c;for(u=0;u<a;u+=4)c=Math.max(r[u],r[u+1],r[u+2]),r[u]+=c!==r[u]?(c-r[u])*l:0,r[u+1]+=c!==r[u+1]?(c-r[u+1])*l:0,r[u+2]+=c!==r[u+2]?(c-r[u+2])*l:0}},getUniformLocations:function(n,s){return{uSaturation:n.getUniformLocation(s,"uSaturation")}},sendUniformData:function(n,s){n.uniform1f(s.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Vibrance=o(i.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var s=n.imageData,r=s.data,a=r.length,l=-this.vibrance,u,c,h,d;for(u=0;u<a;u+=4)c=Math.max(r[u],r[u+1],r[u+2]),h=(r[u]+r[u+1]+r[u+2])/3,d=Math.abs(c-h)*2/255*l,r[u]+=c!==r[u]?(c-r[u])*d:0,r[u+1]+=c!==r[u+1]?(c-r[u+1])*d:0,r[u+2]+=c!==r[u+2]?(c-r[u+2])*d:0}},getUniformLocations:function(n,s){return{uVibrance:n.getUniformLocation(s,"uVibrance")}},sendUniformData:function(n,s){n.uniform1f(s.uVibrance,-this.vibrance)}}),t.Image.filters.Vibrance.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Blur=o(i.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var s=n.filterBackend.resources,r,a,l=n.imageData.width,u=n.imageData.height;s.blurLayer1||(s.blurLayer1=t.util.createCanvasElement(),s.blurLayer2=t.util.createCanvasElement()),r=s.blurLayer1,a=s.blurLayer2,(r.width!==l||r.height!==u)&&(a.width=r.width=l,a.height=r.height=u);var c=r.getContext("2d"),h=a.getContext("2d"),d=15,g,m,y,C,w=this.blur*.06*.5;for(c.putImageData(n.imageData,0,0),h.clearRect(0,0,l,u),C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=w*m*l+g,h.globalAlpha=1-Math.abs(m),h.drawImage(r,y,g),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);for(C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=w*m*u+g,h.globalAlpha=1-Math.abs(m),h.drawImage(r,g,y),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);n.ctx.drawImage(r,0,0);var F=n.ctx.getImageData(0,0,r.width,r.height);return c.globalAlpha=1,c.clearRect(0,0,r.width,r.height),F},getUniformLocations:function(n,s){return{delta:n.getUniformLocation(s,"uDelta")}},sendUniformData:function(n,s){var r=this.chooseRightDelta();n.uniform2fv(s.delta,r)},chooseRightDelta:function(){var n=1,s=[0,0],r;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),r=n*this.blur*.12,this.horizontal?s[0]=r:s[1]=r,s}}),i.Blur.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Gamma=o(i.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=this.gamma,l=r.length,u=1/a[0],c=1/a[1],h=1/a[2],d;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),d=0,l=256;d<l;d++)this.rVals[d]=Math.pow(d/255,u)*255,this.gVals[d]=Math.pow(d/255,c)*255,this.bVals[d]=Math.pow(d/255,h)*255;for(d=0,l=r.length;d<l;d+=4)r[d]=this.rVals[r[d]],r[d+1]=this.gVals[r[d+1]],r[d+2]=this.bVals[r[d+2]]},getUniformLocations:function(n,s){return{uGamma:n.getUniformLocation(s,"uGamma")}},sendUniformData:function(n,s){n.uniform3fv(s.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Composed=o(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(n)})},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),t.Image.filters.Composed.fromObject=function(n,s){var r=n.subFilters||[],a=r.map(function(u){return new t.Image.filters[u.type](u)}),l=new t.Image.filters.Composed({subFilters:a});return s&&s(l),l}})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.HueRotation=o(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,s=t.util.cos(n),r=t.util.sin(n),a=1/3,l=Math.sqrt(a)*r,u=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+u/3,this.matrix[1]=a*u-l,this.matrix[2]=a*u+l,this.matrix[5]=a*u+l,this.matrix[6]=s+a*u,this.matrix[7]=a*u-l,this.matrix[10]=a*u-l,this.matrix[11]=a*u+l,this.matrix[12]=s+a*u},isNeutralState:function(n){return this.calculateMatrix(),i.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),i.BaseFilter.prototype.applyTo.call(this,n)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject})(Ct);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.clone;if(t.Text){t.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat(o),cacheProperties:t.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,s){this.styles=s?s.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=t.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,s,r,a,l,u,c,h=0,d=this._textLines.length;h<d;h++)if(!(this.textAlign!=="justify"&&(h===d-1||this.isEndOfWrapping(h)))&&(a=0,l=this._textLines[h],s=this.getLineWidth(h),s<this.width&&(c=this.textLines[h].match(this._reSpacesAndTabs)))){r=c.length,n=(this.width-s)/r;for(var g=0,m=l.length;g<=m;g++)u=this.__charBounds[h][g],this._reSpaceAndTab.test(l[g])?(u.width+=n,u.kernedWidth+=n,u.left+=a,a+=n):u.left+=a}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return n.width+=s*n.zoomX,n.height+=s*n.zoomY,n},_render:function(n){var s=this.path;s&&!s.isNotVisible()&&s._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,s,r){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(s,r)},calcTextWidth:function(){for(var n=this.getLineWidth(0),s=1,r=this._textLines.length;s<r;s++){var a=this.getLineWidth(s);a>n&&(n=a)}return n},_renderTextLine:function(n,s,r,a,l,u){this._renderChars(n,s,r,a,l,u)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var s,r,a=n.fillStyle,l,u,c=this._getLeftOffset(),h=this._getTopOffset(),d=0,g=0,m,y,C=this.path,w,F=0,B=this._textLines.length;F<B;F++){if(s=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){h+=s;continue}l=this._textLines[F],r=this._getLineLeftOffset(F),g=0,d=0,u=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var U=0,R=l.length;U<R;U++)m=this.__charBounds[F][U],y=this.getValueOfPropertyAt(F,U,"textBackgroundColor"),C?(n.save(),n.translate(m.renderLeft,m.renderTop),n.rotate(m.angle),n.fillStyle=y,y&&n.fillRect(-m.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),m.width,s/this.lineHeight),n.restore()):y!==u?(w=c+r+d,this.direction==="rtl"&&(w=this.width-w-g),n.fillStyle=u,u&&n.fillRect(w,h,g,s/this.lineHeight),d=m.left,g=m.width,u=y):g+=m.kernedWidth;y&&!C&&(w=c+r+d,this.direction==="rtl"&&(w=this.width-w-g),n.fillStyle=y,n.fillRect(w,h,g,s/this.lineHeight)),h+=s}n.fillStyle=a,this._removeShadow(n)}},getFontCache:function(n){var s=n.fontFamily.toLowerCase();t.charWidthsCache[s]||(t.charWidthsCache[s]={});var r=t.charWidthsCache[s],a=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return r[a]||(r[a]={}),r[a]},_measureChar:function(n,s,r,a){var l=this.getFontCache(s),u=this._getFontDeclaration(s),c=this._getFontDeclaration(a),h=r+n,d=u===c,g,m,y,C=s.fontSize/this.CACHE_FONT_SIZE,w;if(r&&l[r]!==void 0&&(y=l[r]),l[n]!==void 0&&(w=g=l[n]),d&&l[h]!==void 0&&(m=l[h],w=m-y),g===void 0||y===void 0||m===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,s,!0)}return g===void 0&&(w=g=F.measureText(n).width,l[n]=g),y===void 0&&d&&r&&(y=F.measureText(r).width,l[r]=y),d&&m===void 0&&(m=F.measureText(h).width,l[h]=m,w=m-y),{width:g*C,kernedWidth:w*C}},getHeightOfChar:function(n,s){return this.getValueOfPropertyAt(n,s,"fontSize")},measureLine:function(n){var s=this._measureLine(n);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(n){var s=0,r,a,l=this._textLines[n],u,c,h=0,d=new Array(l.length),g=0,m,y,C=this.path,w=this.pathSide==="right";for(this.__charBounds[n]=d,r=0;r<l.length;r++)a=l[r],c=this._getGraphemeBox(a,n,r,u),d[r]=c,s+=c.kernedWidth,u=a;if(d[r]={left:c?c.left+c.width:0,width:0,kernedWidth:0,height:this.fontSize},C){switch(y=C.segmentsInfo[C.segmentsInfo.length-1].length,m=t.util.getPointOnPath(C.path,0,C.segmentsInfo),m.x+=C.pathOffset.x,m.y+=C.pathOffset.y,this.textAlign){case"left":g=w?y-s:0;break;case"center":g=(y-s)/2;break;case"right":g=w?0:y-s;break}for(g+=this.pathStartOffset*(w?-1:1),r=w?l.length-1:0;w?r>=0:r<l.length;w?r--:r++)c=d[r],g>y?g%=y:g<0&&(g+=y),this._setGraphemeOnPath(g,c,m),g+=c.kernedWidth}return{width:s,numOfSpaces:h}},_setGraphemeOnPath:function(n,s,r){var a=n+s.kernedWidth/2,l=this.path,u=t.util.getPointOnPath(l.path,a,l.segmentsInfo);s.renderLeft=u.x-r.x,s.renderTop=u.y-r.y,s.angle=u.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,s,r,a,l){var u=this.getCompleteStyleDeclaration(s,r),c=a?this.getCompleteStyleDeclaration(s,r-1):{},h=this._measureChar(n,u,a,c),d=h.kernedWidth,g=h.width,m;this.charSpacing!==0&&(m=this._getWidthOfCharSpacing(),g+=m,d+=m);var y={width:g,left:0,height:u.fontSize,kernedWidth:d,deltaY:u.deltaY};if(r>0&&!l){var C=this.__charBounds[s][r-1];y.left=C.left+C.width+h.kernedWidth-h.width}return y},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var s=this._textLines[n],r=this.getHeightOfChar(n,0),a=1,l=s.length;a<l;a++)r=Math.max(this.getHeightOfChar(n,a),r);return this.__lineHeights[n]=r*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,s=0,r=0,a=this._textLines.length;r<a;r++)n=this.getHeightOfLine(r),s+=r===a-1?n/this.lineHeight:n;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,s){n.save();for(var r=0,a=this._getLeftOffset(),l=this._getTopOffset(),u=0,c=this._textLines.length;u<c;u++){var h=this.getHeightOfLine(u),d=h/this.lineHeight,g=this._getLineLeftOffset(u);this._renderTextLine(s,n,this._textLines[u],a+g,l+r+d,u),r+=h}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,s,r,a,l,u){var c=this.getHeightOfLine(u),h=this.textAlign.indexOf("justify")!==-1,d,g,m="",y,C=0,w,F=this.path,B=!h&&this.charSpacing===0&&this.isEmptyStyles(u)&&!F,U=this.direction==="ltr",R=this.direction==="ltr"?1:-1,W,X=s.canvas.getAttribute("dir");if(s.save(),X!==this.direction&&(s.canvas.setAttribute("dir",U?"ltr":"rtl"),s.direction=U?"ltr":"rtl",s.textAlign=U?"left":"right"),l-=c*this._fontSizeFraction/this.lineHeight,B){this._renderChar(n,s,u,0,r.join(""),a,l,c),s.restore();return}for(var $=0,st=r.length-1;$<=st;$++)w=$===st||this.charSpacing||F,m+=r[$],y=this.__charBounds[u][$],C===0?(a+=R*(y.kernedWidth-y.width),C+=y.width):C+=y.kernedWidth,h&&!w&&this._reSpaceAndTab.test(r[$])&&(w=!0),w||(d=d||this.getCompleteStyleDeclaration(u,$),g=this.getCompleteStyleDeclaration(u,$+1),w=t.util.hasStyleChanged(d,g,!1)),w&&(F?(s.save(),s.translate(y.renderLeft,y.renderTop),s.rotate(y.angle),this._renderChar(n,s,u,$,m,-C/2,0,c),s.restore()):(W=a,this._renderChar(n,s,u,$,m,W,l,c)),m="",d=g,a+=R*C,C=0);s.restore()},_applyPatternGradientTransformText:function(n){var s=t.util.createCanvasElement(),r,a=this.width+this.strokeWidth,l=this.height+this.strokeWidth;return s.width=a,s.height=l,r=s.getContext("2d"),r.beginPath(),r.moveTo(0,0),r.lineTo(a,0),r.lineTo(a,l),r.lineTo(0,l),r.closePath(),r.translate(a/2,l/2),r.fillStyle=n.toLive(r),this._applyPatternGradientTransform(r,n),r.fill(),r.createPattern(s,"no-repeat")},handleFiller:function(n,s,r){var a,l;return r.toLive?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(a=-this.width/2,l=-this.height/2,n.translate(a,l),n[s]=this._applyPatternGradientTransformText(r),{offsetX:a,offsetY:l}):(n[s]=r.toLive(n,this),this._applyPatternGradientTransform(n,r)):(n[s]=r,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,s){return n.lineWidth=s.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",s.stroke)},_setFillStyles:function(n,s){return this.handleFiller(n,"fillStyle",s.fill)},_renderChar:function(n,s,r,a,l,u,c){var h=this._getStyleDeclaration(r,a),d=this.getCompleteStyleDeclaration(r,a),g=n==="fillText"&&d.fill,m=n==="strokeText"&&d.stroke&&d.strokeWidth,y,C;!m&&!g||(s.save(),g&&(y=this._setFillStyles(s,d)),m&&(C=this._setStrokeStyles(s,d)),s.font=this._getFontDeclaration(d),h&&h.textBackgroundColor&&this._removeShadow(s),h&&h.deltaY&&(c+=h.deltaY),g&&s.fillText(l,u-y.offsetX,c-y.offsetY),m&&s.strokeText(l,u-C.offsetX,c-C.offsetY),s.restore())},setSuperscript:function(n,s){return this._setScript(n,s,this.superscript)},setSubscript:function(n,s){return this._setScript(n,s,this.subscript)},_setScript:function(n,s,r){var a=this.get2DCursorLocation(n,!0),l=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY"),c={fontSize:l*r.size,deltaY:u+l*r.baseline};return this.setSelectionStyles(c,n,s),this},_getLineLeftOffset:function(n){var s=this.getLineWidth(n),r=this.width-s,a=this.textAlign,l=this.direction,c,u=0,c=this.isEndOfWrapping(n);return a==="justify"||a==="justify-center"&&!c||a==="justify-right"&&!c||a==="justify-left"&&!c?0:(a==="center"&&(u=r/2),a==="right"&&(u=r),a==="justify-center"&&(u=r/2),a==="justify-right"&&(u=r),l==="rtl"&&(u-=r),u)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var s=this.measureLine(n),r=s.width;return this.__lineWidths[n]=r,r},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,s,r){var a=this._getStyleDeclaration(n,s);return a&&typeof a[r]<"u"?a[r]:this[r]},_renderTextDecoration:function(n,s){if(!(!this[s]&&!this.styleHas(s))){for(var r,a,l,u,c,h,d,g,m=this._getLeftOffset(),y=this._getTopOffset(),C,w,F,B,U,R,W,X,$=this.path,st=this._getWidthOfCharSpacing(),pt=this.offsets[s],dt=0,x=this._textLines.length;dt<x;dt++){if(r=this.getHeightOfLine(dt),!this[s]&&!this.styleHas(s,dt)){y+=r;continue}d=this._textLines[dt],R=r/this.lineHeight,u=this._getLineLeftOffset(dt),w=0,F=0,g=this.getValueOfPropertyAt(dt,0,s),X=this.getValueOfPropertyAt(dt,0,"fill"),C=y+R*(1-this._fontSizeFraction),a=this.getHeightOfChar(dt,0),c=this.getValueOfPropertyAt(dt,0,"deltaY");for(var P=0,I=d.length;P<I;P++)if(B=this.__charBounds[dt][P],U=this.getValueOfPropertyAt(dt,P,s),W=this.getValueOfPropertyAt(dt,P,"fill"),l=this.getHeightOfChar(dt,P),h=this.getValueOfPropertyAt(dt,P,"deltaY"),$&&U&&W)n.save(),n.fillStyle=X,n.translate(B.renderLeft,B.renderTop),n.rotate(B.angle),n.fillRect(-B.kernedWidth/2,pt*l+h,B.kernedWidth,this.fontSize/15),n.restore();else if((U!==g||W!==X||l!==a||h!==c)&&F>0){var k=m+u+w;this.direction==="rtl"&&(k=this.width-k-F),g&&X&&(n.fillStyle=X,n.fillRect(k,C+pt*a+c,F,this.fontSize/15)),w=B.left,F=B.width,g=U,X=W,a=l,c=h}else F+=B.kernedWidth;var k=m+u+w;this.direction==="rtl"&&(k=this.width-k-F),n.fillStyle=W,U&&W&&n.fillRect(k,C+pt*a+c,F-st,this.fontSize/15),y+=r}this._removeShadow(n)}},_getFontDeclaration:function(n,s){var r=n||this,a=this.fontFamily,l=t.Text.genericFonts.indexOf(a.toLowerCase())>-1,u=a===void 0||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||l?r.fontFamily:'"'+r.fontFamily+'"';return[t.isLikelyNode?r.fontWeight:r.fontStyle,t.isLikelyNode?r.fontStyle:r.fontWeight,s?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",u].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var s=n.split(this._reNewline),r=new Array(s.length),a=[`
`],l=[],u=0;u<s.length;u++)r[u]=t.util.string.graphemeSplit(s[u]),l=l.concat(r[u],a);return l.pop(),{_unwrappedLines:r,lines:s,graphemeText:l,graphemeLines:r}},toObject:function(n){var s=o.concat(n),r=this.callSuper("toObject",s);return r.styles=t.util.stylesToArray(this.styles,this.text),r.path&&(r.path=this.path.toObject()),r},set:function(n,s){this.callSuper("set",n,s);var r=!1,a=!1;if(typeof n=="object")for(var l in n)l==="path"&&this.setPathInfo(),r=r||this._dimensionAffectingProps.indexOf(l)!==-1,a=a||l==="path";else r=this._dimensionAffectingProps.indexOf(n)!==-1,a=n==="path";return a&&this.setPathInfo(),r&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(n,s,r){if(!n)return s(null);var a=t.parseAttributes(n,t.Text.ATTRIBUTE_NAMES),l=a.textAnchor||"left";if(r=t.util.object.extend(r?i(r):{},a),r.top=r.top||0,r.left=r.left||0,a.textDecoration){var u=a.textDecoration;u.indexOf("underline")!==-1&&(r.underline=!0),u.indexOf("overline")!==-1&&(r.overline=!0),u.indexOf("line-through")!==-1&&(r.linethrough=!0),delete r.textDecoration}"dx"in a&&(r.left+=a.dx),"dy"in a&&(r.top+=a.dy),"fontSize"in r||(r.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in n?c=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(c=n.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var h=r.strokeWidth;r.strokeWidth=0;var d=new t.Text(c,r),g=d.getScaledHeight()/d.height,m=(d.height+d.strokeWidth)*d.lineHeight-d.height,y=m*g,C=d.getScaledHeight()+y,w=0;l==="center"&&(w=d.getScaledWidth()/2),l==="right"&&(w=d.getScaledWidth()),d.set({left:d.left-w,top:d.top-(C-d.fontSize*(.07+d._fontSizeFraction))/d.lineHeight,strokeWidth:typeof h<"u"?h:1}),s(d)},t.Text.fromObject=function(n,s){var r=i(n),a=n.path;return delete r.path,t.Object._fromObject("Text",r,function(l){l.styles=t.util.stylesFromArray(n.styles,n.text),a?t.Object._fromObject("Path",a,function(u){l.set("path",u),s(l)},"path"):s(l)},"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text)})(Ct);(function(){D.util.object.extend(D.Text.prototype,{isEmptyStyles:function(e){if(!this.styles||typeof e<"u"&&!this.styles[e])return!0;var t=typeof e>"u"?this.styles:{line:this.styles[e]};for(var i in t)for(var o in t[i])for(var n in t[i][o])return!1;return!0},styleHas:function(e,t){if(!this.styles||!e||e===""||typeof t<"u"&&!this.styles[t])return!1;var i=typeof t>"u"?this.styles:{0:this.styles[t]};for(var o in i)for(var n in i[o])if(typeof i[o][n][e]<"u")return!0;return!1},cleanStyle:function(e){if(!this.styles||!e||e==="")return!1;var t=this.styles,i=0,o,n,s=!0,r=0,a;for(var l in t){o=0;for(var u in t[l]){var a=t[l][u],c=a.hasOwnProperty(e);i++,c?(n?a[e]!==n&&(s=!1):n=a[e],a[e]===this[e]&&delete a[e]):s=!1,Object.keys(a).length!==0?o++:delete t[l][u]}o===0&&delete t[l]}for(var h=0;h<this._textLines.length;h++)r+=this._textLines[h].length;s&&i===r&&(this[e]=n,this.removeStyle(e))},removeStyle:function(e){if(!(!this.styles||!e||e==="")){var t=this.styles,i,o,n;for(o in t){i=t[o];for(n in i)delete i[n][e],Object.keys(i[n]).length===0&&delete i[n];Object.keys(i).length===0&&delete t[o]}}},_extendStyles:function(e,t){var i=this.get2DCursorLocation(e);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),D.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),t)},get2DCursorLocation:function(e,t){typeof e>"u"&&(e=this.selectionStart);for(var i=t?this._unwrappedTextLines:this._textLines,o=i.length,n=0;n<o;n++){if(e<=i[n].length)return{lineIndex:n,charIndex:e};e-=i[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:i[n-1].length<e?i[n-1].length:e}},getSelectionStyles:function(e,t,i){typeof e>"u"&&(e=this.selectionStart||0),typeof t>"u"&&(t=this.selectionEnd||e);for(var o=[],n=e;n<t;n++)o.push(this.getStyleAtPosition(n,i));return o},getStyleAtPosition:function(e,t){var i=this.get2DCursorLocation(e),o=t?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex);return o||{}},setSelectionStyles:function(e,t,i){typeof t>"u"&&(t=this.selectionStart||0),typeof i>"u"&&(i=this.selectionEnd||t);for(var o=t;o<i;o++)this._extendStyles(o,e);return this._forceClearCache=!0,this},_getStyleDeclaration:function(e,t){var i=this.styles&&this.styles[e];return i?i[t]:null},getCompleteStyleDeclaration:function(e,t){for(var i=this._getStyleDeclaration(e,t)||{},o={},n,s=0;s<this._styleProperties.length;s++)n=this._styleProperties[s],o[n]=typeof i[n]>"u"?this[n]:i[n];return o},_setStyleDeclaration:function(e,t,i){this.styles[e][t]=i},_deleteStyleDeclaration:function(e,t){delete this.styles[e][t]},_getLineStyle:function(e){return!!this.styles[e]},_setLineStyle:function(e){this.styles[e]={}},_deleteLineStyle:function(e){delete this.styles[e]}})})();(function(){function e(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}D.IText=D.util.createClass(D.Text,D.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,i){this.callSuper("initialize",t,i),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,i){this[t]!==i&&(this._fireSelectionChanged(),this[t]=i),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var i=this.canvas.contextTop,o=this.canvas.viewportTransform;i.save(),i.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(i),this._clearTextArea(i),t||i.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var t=this._getCursorBoundaries(),i=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,i):this.renderSelection(t,i),i.restore()}},_clearTextArea:function(t){var i=this.width+4,o=this.height+4;t.clearRect(-i/2,-o/2,i,o)},_getCursorBoundaries:function(t){typeof t>"u"&&(t=this.selectionStart);var i=this._getLeftOffset(),o=this._getTopOffset(),n=this._getCursorBoundariesOffsets(t);return{left:i,top:o,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var i,o,n,s=0,r=0,a,l=this.get2DCursorLocation(t);n=l.charIndex,o=l.lineIndex;for(var u=0;u<o;u++)s+=this.getHeightOfLine(u);i=this._getLineLeftOffset(o);var c=this.__charBounds[o][n];return c&&(r=c.left),this.charSpacing!==0&&n===this._textLines[o].length&&(r-=this._getWidthOfCharSpacing()),a={top:s,left:i+(r>0?r:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(t,i){var o=this.get2DCursorLocation(),n=o.lineIndex,s=o.charIndex>0?o.charIndex-1:0,r=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.scaleX*this.canvas.getZoom(),l=this.cursorWidth/a,u=t.topOffset,c=this.getValueOfPropertyAt(n,s,"deltaY");u+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-r*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,i),i.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),i.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,i.fillRect(t.left+t.leftOffset-l/2,u+t.top+c,l,r)},renderSelection:function(t,i){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,r=this.get2DCursorLocation(o),a=this.get2DCursorLocation(n),l=r.lineIndex,u=a.lineIndex,c=r.charIndex<0?0:r.charIndex,h=a.charIndex<0?0:a.charIndex,d=l;d<=u;d++){var g=this._getLineLeftOffset(d)||0,m=this.getHeightOfLine(d),y=0,C=0,w=0;if(d===l&&(C=this.__charBounds[l][c].left),d>=l&&d<u)w=s&&!this.isEndOfWrapping(d)?this.width:this.getLineWidth(d)||5;else if(d===u)if(h===0)w=this.__charBounds[u][h].left;else{var F=this._getWidthOfCharSpacing();w=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-F}y=m,(this.lineHeight<1||d===u&&this.lineHeight>1)&&(m/=this.lineHeight);var B=t.left+g+C,U=w-C,R=m,W=0;this.inCompositionMode?(i.fillStyle=this.compositionColor||"black",R=1,W=m):i.fillStyle=this.selectionColor,this.direction==="rtl"&&(B=this.width-B-U),i.fillRect(B,t.top+t.topOffset+W,U,R),t.topOffset+=y}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),i=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:i}}}),D.IText.fromObject=function(t,i){var o=D.util.stylesFromArray(t.styles,t.text),n=Object.assign({},t,{styles:o});if(e(n),n.styles)for(var s in n.styles)for(var r in n.styles[s])e(n.styles[s][r]);D.Object._fromObject("IText",n,i,"text")}})();(function(){var e=D.util.object.clone;D.util.object.extend(D.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",function(){var i=t.canvas;i&&(i._hasITextHandlers||(i._hasITextHandlers=!0,t._initCanvasHandlers(i)),i._iTextInstances=i._iTextInstances||[],i._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var i=t.canvas;i&&(i._iTextInstances=i._iTextInstances||[],D.util.removeFromArray(i._iTextInstances,t),i._iTextInstances.length===0&&(i._hasITextHandlers=!1,t._removeCanvasHandlers(i)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.__isMousedown=!1})},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,i,o,n){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",i,{duration:o,onComplete:function(){s.isAborted||t[n]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var i=this,o=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){i._tick()},o)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,i=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&i&&i.clearContext(i.contextTop||i.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var i=0,o=t-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o--;for(;/\S/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findWordBoundaryRight:function(t){var i=0,o=t;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},findLineBoundaryLeft:function(t){for(var i=0,o=t-1;!/\n/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findLineBoundaryRight:function(t){for(var i=0,o=t;!/\n/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},searchWordBoundary:function(t,i){for(var o=this._text,n=this._reSpace.test(o[t])?t-1:t,s=o[n],r=D.reNonWord;!r.test(s)&&n>0&&n<o.length;)n+=i,s=o[n];return r.test(s)&&(n+=i===1?0:1),n},selectWord:function(t){t=t||this.selectionStart;var i=this.searchWordBoundary(t,-1),o=this.searchWordBoundary(t,1);this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var i=this.findLineBoundaryLeft(t),o=this.findLineBoundaryRight(t);return this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.selected=!1,i.isEditing&&i.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var i=this.getSelectionStartFromPointer(t.e),o=this.selectionStart,n=this.selectionEnd;(i!==this.__selectionStartOnMouseDown||o===n)&&(o===i||n===i)||(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,i,o){var n=o.slice(0,t),s=D.util.string.graphemeSplit(n).length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=D.util.string.graphemeSplit(r).length;return{selectionStart:s,selectionEnd:s+a}},fromGraphemeToStringSelection:function(t,i,o){var n=o.slice(0,t),s=n.join("").length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=r.join("").length;return{selectionStart:s,selectionEnd:s+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,i=this._getCursorBoundaries(t),o=this.get2DCursorLocation(t),n=o.lineIndex,s=o.charIndex,r=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=i.leftOffset,l=this.calcTransformMatrix(),u={x:i.left+a,y:i.top+i.topOffset+r},c=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/c,g=h.height/c,m=d-r,y=g-r,C=h.clientWidth/d,w=h.clientHeight/g;return u=D.util.transformPoint(u,l),u=D.util.transformPoint(u,this.canvas.viewportTransform),u.x*=C,u.y*=w,u.x<0&&(u.x=0),u.x>m&&(u.x=m),u.y<0&&(u.y=0),u.y>y&&(u.y=y),u.x+=this.canvas._offset.left,u.y+=this.canvas._offset.top,{left:u.x+"px",top:u.y+"px",fontSize:r+"px",charHeight:r}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,i=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,i&&(i.blur&&i.blur(),i.parentNode&&i.parentNode.removeChild(i)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,i){var o=this.get2DCursorLocation(t,!0),n=this.get2DCursorLocation(i,!0),s=o.lineIndex,r=o.charIndex,a=n.lineIndex,l=n.charIndex,u,c;if(s!==a){if(this.styles[s])for(u=r;u<this._unwrappedTextLines[s].length;u++)delete this.styles[s][u];if(this.styles[a])for(u=l;u<this._unwrappedTextLines[a].length;u++)c=this.styles[a][u],c&&(this.styles[s]||(this.styles[s]={}),this.styles[s][r+u-l]=c);for(u=s+1;u<=a;u++)delete this.styles[u];this.shiftLineStyles(a,s-a)}else if(this.styles[s]){c=this.styles[s];var h=l-r,d,g;for(u=r;u<l;u++)delete c[u];for(g in this.styles[s])d=parseInt(g,10),d>=l&&(c[d-h]=c[g],delete c[g])}},shiftLineStyles:function(t,i){var o=e(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>t&&(this.styles[s+i]=o[s],o[s-i]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(t,i,o,n){var s,r={},a=!1,l=this._unwrappedTextLines[t].length===i;o||(o=1),this.shiftLineStyles(t,o),this.styles[t]&&(s=this.styles[t][i===0?i:i-1]);for(var u in this.styles[t]){var c=parseInt(u,10);c>=i&&(a=!0,r[c-i]=this.styles[t][u],l&&i===0||delete this.styles[t][u])}var h=!1;for(a&&!l&&(this.styles[t+o]=r,h=!0),h&&o--;o>0;)n&&n[o-1]?this.styles[t+o]={0:e(n[o-1])}:s?this.styles[t+o]={0:e(s)}:delete this.styles[t+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(t,i,o,n){this.styles||(this.styles={});var s=this.styles[t],r=s?e(s):{};o||(o=1);for(var a in r){var l=parseInt(a,10);l>=i&&(s[l+o]=r[l],r[l-o]||delete s[l])}if(this._forceClearCache=!0,n){for(;o--;)Object.keys(n[o]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][i+o]=e(n[o]));return}if(s)for(var u=s[i?i-1:1];u&&o--;)this.styles[t][i+o]=e(u)},insertNewStyleBlock:function(t,i,o){for(var n=this.get2DCursorLocation(i,!0),s=[0],r=0,a=0;a<t.length;a++)t[a]===`
`?(r++,s[r]=0):s[r]++;s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],o),o=o&&o.slice(s[0]+1)),r&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],r);for(var a=1;a<r;a++)s[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,s[a],o):o&&this.styles[n.lineIndex+a]&&o[0]&&(this.styles[n.lineIndex+a][0]=o[0]),o=o&&o.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,s[a],o)},setSelectionStartEndWithShift:function(t,i,o){o<=t?(i===t?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=o):o>t&&o<i?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(i===t?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=i),this.selectionEnd=o)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})})();D.util.object.extend(D.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(e){if(this.canvas){this.__newClickTime=+new Date;var t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))},tripleClickHandler:function(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(e.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(e){if(this.__isMousedown=!1,!(!this.editable||this.group||e.transform&&e.transform.actionPerformed||e.e.button&&e.e.button!==1)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e),i=this.selectionStart,o=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(i,o,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(e){for(var t=this.getLocalPointer(e),i=0,o=0,n=0,s=0,r=0,a,l,u=0,c=this._textLines.length;u<c&&n<=t.y;u++)n+=this.getHeightOfLine(u)*this.scaleY,r=u,u>0&&(s+=this._textLines[u-1].length+this.missingNewlineOffset(u-1));a=this._getLineLeftOffset(r),o=a*this.scaleX,l=this._textLines[r],this.direction==="rtl"&&(t.x=this.width*this.scaleX-t.x+o);for(var h=0,d=l.length;h<d&&(i=o,o+=this.__charBounds[r][h].kernedWidth*this.scaleX,o<=t.x);h++)s++;return this._getNewSelectionStartFromOffset(t,i,o,s,d)},_getNewSelectionStartFromOffset:function(e,t,i,o,n){var s=e.x-t,r=i-e.x,a=r>s||r<0?0:1,l=o+a;return this.flipX&&(l=n-l),l>this._text.length&&(l=this._text.length),l}});D.util.object.extend(D.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=D.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+e.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):D.document.body.appendChild(this.hiddenTextarea),D.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),D.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),D.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),D.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),D.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),D.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),D.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),D.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),D.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(D.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){var t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else if(e.keyCode in this.ctrlKeysMapDown&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapDown[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(e){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapUp[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(e){var t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!!this.isEditing){var i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,n=i.length,s,r,a=n-o,l=this.selectionStart,u=this.selectionEnd,c=l!==u,h,d,g;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var m=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=l>m.selectionStart;c?(s=this._text.slice(l,u),a+=u-l):n<o&&(y?s=this._text.slice(u+a,u):s=this._text.slice(l,l-a)),r=i.slice(m.selectionEnd-a,m.selectionEnd),s&&s.length&&(r.length&&(h=this.getSelectionStyles(l,l+1,!1),h=r.map(function(){return h[0]})),c?(d=l,g=u):y?(d=u-s.length,g=u):(d=u,g=u+s.length),this.removeStyleFromTo(d,g)),r.length&&(t&&r.join("")===D.copiedText&&!D.disableStyleCopyPaste&&(h=D.copiedTextStyle),this.insertNewStyleBlock(r,l,h)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(e){this.compositionStart=e.target.selectionStart,this.compositionEnd=e.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(D.copiedText=this.getSelectedText(),D.disableStyleCopyPaste?D.copiedTextStyle=null:D.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(e){return e&&e.clipboardData||D.window.clipboardData},_getWidthBeforeCursor:function(e,t){var i=this._getLineLeftOffset(e),o;return t>0&&(o=this.__charBounds[e][t-1],i+=o.left+o.width),i},getDownCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,r),l=this._textLines[n].slice(s);return l.length+a+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===0||e.metaKey||e.keyCode===33)return-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,r),l=this._textLines[n].slice(0,s),u=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-l.length+(1-u)},_getIndexOnLine:function(e,t){for(var i=this._textLines[e],o=this._getLineLeftOffset(e),n=o,s=0,r,a,l=0,u=i.length;l<u;l++)if(r=this.__charBounds[e][l].width,n+=r,n>t){a=!0;var c=n-r,h=n,d=Math.abs(c-t),g=Math.abs(h-t);s=g<d?l:l-1;break}return a||(s=i.length-1),s},moveCursorDown:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)},moveCursorUp:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)},_moveCursorUpOrDown:function(e,t){var i="get"+e+"CursorOffset",o=this[i](t,this._selectionDirection==="right");t.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(e){var t=this._selectionDirection==="left"?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0},moveCursorWithoutShift:function(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0},moveCursorLeft:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)},_move:function(e,t,i){var o;if(e.altKey)o=this["findWordBoundary"+i](this[t]);else if(e.metaKey||e.keyCode===35||e.keyCode===36)o=this["findLineBoundary"+i](this[t]);else return this[t]+=i==="Left"?-1:1,!0;if(typeof o<"u"&&this[t]!==o)return this[t]=o,!0},_moveLeft:function(e,t){return this._move(e,t,"Left")},_moveRight:function(e,t){return this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(e){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(e,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(e,"selectionStart")},moveCursorRight:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)},_moveCursorLeftOrRight:function(e,t){var i="moveCursor"+e+"With";this._currentCursorOpacity=1,t.shiftKey?i+="Shift":i+="outShift",this[i](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(e){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(e,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(e,"selectionEnd")},moveCursorRightWithoutShift:function(e){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(e,t){typeof t>"u"&&(t=e+1),this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(e,t,i,o){typeof o>"u"&&(o=i),o>i&&this.removeStyleFromTo(i,o);var n=D.util.string.graphemeSplit(e);this.insertNewStyleBlock(n,i,t),this._text=[].concat(this._text.slice(0,i),n,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var e=D.util.toFixed,t=/  +/g;D.util.object.extend(D.Text.prototype,{_toSVG:function(){var i=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(i){var o=!0,n=this.getSvgTextDecoration(this);return[i.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",i.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(i,o){var n=[],s=[],r=i,a;this._setSVGBg(s);for(var l=0,u=this._textLines.length;l<u;l++)a=this._getLineLeftOffset(l),(this.textBackgroundColor||this.styleHas("textBackgroundColor",l))&&this._setSVGTextLineBg(s,l,o+a,r),this._setSVGTextLineText(n,l,o+a,r),r+=this.getHeightOfLine(l);return{textSpans:n,textBgRects:s}},_createTextCharSpan:function(i,o,n,s){var r=i!==i.trim()||i.match(t),a=this.getSvgSpanStyles(o,r),l=a?'style="'+a+'"':"",u=o.deltaY,c="",h=D.Object.NUM_FRACTION_DIGITS;return u&&(c=' dy="'+e(u,h)+'" '),['<tspan x="',e(n,h),'" y="',e(s,h),'" ',c,l,">",D.util.string.escapeXml(i),"</tspan>"].join("")},_setSVGTextLineText:function(i,o,n,s){var r=this.getHeightOfLine(o),a=this.textAlign.indexOf("justify")!==-1,l,u,c="",h,d,g=0,m=this._textLines[o],y;s+=r*(1-this._fontSizeFraction)/this.lineHeight;for(var C=0,w=m.length-1;C<=w;C++)y=C===w||this.charSpacing,c+=m[C],h=this.__charBounds[o][C],g===0?(n+=h.kernedWidth-h.width,g+=h.width):g+=h.kernedWidth,a&&!y&&this._reSpaceAndTab.test(m[C])&&(y=!0),y||(l=l||this.getCompleteStyleDeclaration(o,C),u=this.getCompleteStyleDeclaration(o,C+1),y=D.util.hasStyleChanged(l,u,!0)),y&&(d=this._getStyleDeclaration(o,C)||{},i.push(this._createTextCharSpan(c,d,n,s)),c="",l=u,n+=g,g=0)},_pushTextBgRect:function(i,o,n,s,r,a){var l=D.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(o),' x="',e(n,l),'" y="',e(s,l),'" width="',e(r,l),'" height="',e(a,l),`"></rect>
`)},_setSVGTextLineBg:function(i,o,n,s){for(var r=this._textLines[o],a=this.getHeightOfLine(o)/this.lineHeight,l=0,u=0,c,h,d=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),g=0,m=r.length;g<m;g++)c=this.__charBounds[o][g],h=this.getValueOfPropertyAt(o,g,"textBackgroundColor"),h!==d?(d&&this._pushTextBgRect(i,d,n+u,s,l,a),u=c.left,l=c.width,d=h):l+=c.kernedWidth;h&&this._pushTextBgRect(i,h,n+u,s,l,a)},_getFillAttributes:function(i){var o=i&&typeof i=="string"?new D.Color(i):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+i+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(i){for(var o=0,n=0,s=0;s<i;s++)o+=this.getHeightOfLine(s);return n=this.getHeightOfLine(s),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(i){var o=D.Object.prototype.getSvgStyles.call(this,i);return o+" white-space: pre;"}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(i){for(var o=0,n=0,s=0,r={},a=0;a<i.graphemeLines.length;a++)i.graphemeText[s]===`
`&&a>0?(n=0,s++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(i.graphemeText[s])&&a>0&&(n++,s++),r[a]={line:o,offset:n},s+=i.graphemeLines[a].length,n+=i.graphemeLines[a].length;return r},styleHas:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[o];n&&(o=n.line)}return t.Text.prototype.styleHas.call(this,i,o)},isEmptyStyles:function(i){if(!this.styles)return!0;var o=0,n=i+1,s,r,a=!1,l=this._styleMap[i],u=this._styleMap[i+1];l&&(i=l.line,o=l.offset),u&&(n=u.line,a=n===i,s=u.offset),r=typeof i>"u"?this.styles:{line:this.styles[i]};for(var c in r)for(var h in r[c])if(h>=o&&(!a||h<s))for(var d in r[c][h])return!1;return!0},_getStyleDeclaration:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[i];if(!n)return null;i=n.line,o=n.offset+o}return this.callSuper("_getStyleDeclaration",i,o)},_setStyleDeclaration:function(i,o,n){var s=this._styleMap[i];i=s.line,o=s.offset+o,this.styles[i][o]=n},_deleteStyleDeclaration:function(i,o){var n=this._styleMap[i];i=n.line,o=n.offset+o,delete this.styles[i][o]},_getLineStyle:function(i){var o=this._styleMap[i];return!!this.styles[o.line]},_setLineStyle:function(i){var o=this._styleMap[i];this.styles[o.line]={}},_wrapText:function(i,o){var n=[],s;for(this.isWrapping=!0,s=0;s<i.length;s++)n=n.concat(this._wrapLine(i[s],s,o));return this.isWrapping=!1,n},_measureWord:function(i,o,n){var s=0,r,a=!0;n=n||0;for(var l=0,u=i.length;l<u;l++){var c=this._getGraphemeBox(i[l],o,l+n,r,a);s+=c.kernedWidth,r=i[l]}return s},_wrapLine:function(i,o,n,B){var r=0,a=this.splitByGrapheme,l=[],u=[],c=a?t.util.string.graphemeSplit(i):i.split(this._wordJoiners),h="",d=0,g=a?"":" ",m=0,y=0,C=0,w=!0,F=this._getWidthOfCharSpacing(),B=B||0;c.length===0&&c.push([]),n-=B;for(var U=0;U<c.length;U++)h=a?c[U]:t.util.string.graphemeSplit(c[U]),m=this._measureWord(h,o,d),d+=h.length,r+=y+m-F,r>n&&!w?(l.push(u),u=[],r=m,w=!0):r+=F,!w&&!a&&u.push(g),u=u.concat(h),y=a?0:this._measureWord([g],o,d),d++,w=!1,m>C&&(C=m);return U&&l.push(u),C+B>this.dynamicMinWidth&&(this.dynamicMinWidth=C-F+B),l},isEndOfWrapping:function(i){return!this._styleMap[i+1]||this._styleMap[i+1].line!==this._styleMap[i].line},missingNewlineOffset:function(i){return this.splitByGrapheme?this.isEndOfWrapping(i)?1:0:1},_splitTextIntoLines:function(i){for(var o=t.Text.prototype._splitTextIntoLines.call(this,i),n=this._wrapText(o.lines,this.width),s=new Array(n.length),r=0;r<n.length;r++)s[r]=n[r].join("");return o.lines=s,o.graphemeLines=n,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var i={};for(var o in this._styleMap)this._textLines[o]&&(i[this._styleMap[o].line]=1);for(var o in this.styles)i[o]||delete this.styles[o]},toObject:function(i){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(i))}}),t.Textbox.fromObject=function(i,o){var n=t.util.stylesFromArray(i.styles,i.text),s=Object.assign({},i,{styles:n});return t.Object._fromObject("Textbox",s,o,"text")}})(Ct);(function(){var e=D.controlsUtils,t=e.scaleSkewCursorStyleHandler,i=e.scaleCursorStyleHandler,o=e.scalingEqually,n=e.scalingYOrSkewingX,s=e.scalingXOrSkewingY,r=e.scaleOrSkewActionName,a=D.Object.prototype.controls;if(a.ml=new D.Control({x:-.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mr=new D.Control({x:.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mb=new D.Control({x:0,y:.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.mt=new D.Control({x:0,y:-.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.tl=new D.Control({x:-.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.tr=new D.Control({x:.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.bl=new D.Control({x:-.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.br=new D.Control({x:.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.mtr=new D.Control({x:0,y:-.5,actionHandler:e.rotationWithSnapping,cursorStyleHandler:e.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),D.Textbox){var l=D.Textbox.prototype.controls={};l.mtr=a.mtr,l.tr=a.tr,l.br=a.br,l.tl=a.tl,l.bl=a.bl,l.mt=a.mt,l.mb=a.mb,l.mr=new D.Control({x:.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"}),l.ml=new D.Control({x:-.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"})}})()});var Md=ue((o3,Hv)=>{"use strict";var Gv=Object.getOwnPropertySymbols,lE=Object.prototype.hasOwnProperty,cE=Object.prototype.propertyIsEnumerable;function hE(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function fE(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var o=Object.getOwnPropertyNames(t).map(function(s){return t[s]});if(o.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(s){n[s]=s}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Hv.exports=fE()?Object.assign:function(e,t){for(var i,o=hE(e),n,s=1;s<arguments.length;s++){i=Object(arguments[s]);for(var r in i)lE.call(i,r)&&(o[r]=i[r]);if(Gv){n=Gv(i);for(var a=0;a<n.length;a++)cE.call(i,n[a])&&(o[n[a]]=i[n[a]])}}return o}});var oy=ue(ye=>{"use strict";var jd=Md(),ba=60103,Vv=60106;ye.Fragment=60107;ye.StrictMode=60108;ye.Profiler=60114;var qv=60109,$v=60110,Kv=60112;ye.Suspense=60113;var Jv=60115,Qv=60116;typeof Symbol=="function"&&Symbol.for&&(Rn=Symbol.for,ba=Rn("react.element"),Vv=Rn("react.portal"),ye.Fragment=Rn("react.fragment"),ye.StrictMode=Rn("react.strict_mode"),ye.Profiler=Rn("react.profiler"),qv=Rn("react.provider"),$v=Rn("react.context"),Kv=Rn("react.forward_ref"),ye.Suspense=Rn("react.suspense"),Jv=Rn("react.memo"),Qv=Rn("react.lazy"));var Rn,Xv=typeof Symbol=="function"&&Symbol.iterator;function dE(e){return e===null||typeof e!="object"?null:(e=Xv&&e[Xv]||e["@@iterator"],typeof e=="function"?e:null)}function Yu(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ty={};function Aa(e,t,i){this.props=e,this.context=t,this.refs=ty,this.updater=i||Zv}Aa.prototype.isReactComponent={};Aa.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error(Yu(85));this.updater.enqueueSetState(this,e,t,"setState")};Aa.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ey(){}ey.prototype=Aa.prototype;function Nd(e,t,i){this.props=e,this.context=t,this.refs=ty,this.updater=i||Zv}var Ud=Nd.prototype=new ey;Ud.constructor=Nd;jd(Ud,Aa.prototype);Ud.isPureReactComponent=!0;var zd={current:null},iy=Object.prototype.hasOwnProperty,ny={key:!0,ref:!0,__self:!0,__source:!0};function ry(e,t,i){var o,n={},s=null,r=null;if(t!=null)for(o in t.ref!==void 0&&(r=t.ref),t.key!==void 0&&(s=""+t.key),t)iy.call(t,o)&&!ny.hasOwnProperty(o)&&(n[o]=t[o]);var a=arguments.length-2;if(a===1)n.children=i;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];n.children=l}if(e&&e.defaultProps)for(o in a=e.defaultProps,a)n[o]===void 0&&(n[o]=a[o]);return{$$typeof:ba,type:e,key:s,ref:r,props:n,_owner:zd.current}}function pE(e,t){return{$$typeof:ba,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wd(e){return typeof e=="object"&&e!==null&&e.$$typeof===ba}function gE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var Yv=/\/+/g;function Rd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?gE(""+e.key):t.toString(36)}function qc(e,t,i,o,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var r=!1;if(e===null)r=!0;else switch(s){case"string":case"number":r=!0;break;case"object":switch(e.$$typeof){case ba:case Vv:r=!0}}if(r)return r=e,n=n(r),e=o===""?"."+Rd(r,0):o,Array.isArray(n)?(i="",e!=null&&(i=e.replace(Yv,"$&/")+"/"),qc(n,t,i,"",function(u){return u})):n!=null&&(Wd(n)&&(n=pE(n,i+(!n.key||r&&r.key===n.key?"":(""+n.key).replace(Yv,"$&/")+"/")+e)),t.push(n)),1;if(r=0,o=o===""?".":o+":",Array.isArray(e))for(var a=0;a<e.length;a++){s=e[a];var l=o+Rd(s,a);r+=qc(s,t,i,l,n)}else if(l=dE(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=o+Rd(s,a++),r+=qc(s,t,i,l,n);else if(s==="object")throw t=""+e,Error(Yu(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t));return r}function Vc(e,t,i){if(e==null)return e;var o=[],n=0;return qc(e,o,"","",function(s){return t.call(i,s,n++)}),o}function mE(e){if(e._status===-1){var t=e._result;t=t(),e._status=0,e._result=t,t.then(function(i){e._status===0&&(i=i.default,e._status=1,e._result=i)},function(i){e._status===0&&(e._status=2,e._result=i)})}if(e._status===1)return e._result;throw e._result}var sy={current:null};function is(){var e=sy.current;if(e===null)throw Error(Yu(321));return e}var vE={ReactCurrentDispatcher:sy,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:zd,IsSomeRendererActing:{current:!1},assign:jd};ye.Children={map:Vc,forEach:function(e,t,i){Vc(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return Vc(e,function(){t++}),t},toArray:function(e){return Vc(e,function(t){return t})||[]},only:function(e){if(!Wd(e))throw Error(Yu(143));return e}};ye.Component=Aa;ye.PureComponent=Nd;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vE;ye.cloneElement=function(e,t,i){if(e==null)throw Error(Yu(267,e));var o=jd({},e.props),n=e.key,s=e.ref,r=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,r=zd.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)iy.call(t,l)&&!ny.hasOwnProperty(l)&&(o[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)o.children=i;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];o.children=a}return{$$typeof:ba,type:e.type,key:n,ref:s,props:o,_owner:r}};ye.createContext=function(e,t){return t===void 0&&(t=null),e={$$typeof:$v,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider={$$typeof:qv,_context:e},e.Consumer=e};ye.createElement=ry;ye.createFactory=function(e){var t=ry.bind(null,e);return t.type=e,t};ye.createRef=function(){return{current:null}};ye.forwardRef=function(e){return{$$typeof:Kv,render:e}};ye.isValidElement=Wd;ye.lazy=function(e){return{$$typeof:Qv,_payload:{_status:-1,_result:e},_init:mE}};ye.memo=function(e,t){return{$$typeof:Jv,type:e,compare:t===void 0?null:t}};ye.useCallback=function(e,t){return is().useCallback(e,t)};ye.useContext=function(e,t){return is().useContext(e,t)};ye.useDebugValue=function(){};ye.useEffect=function(e,t){return is().useEffect(e,t)};ye.useImperativeHandle=function(e,t,i){return is().useImperativeHandle(e,t,i)};ye.useLayoutEffect=function(e,t){return is().useLayoutEffect(e,t)};ye.useMemo=function(e,t){return is().useMemo(e,t)};ye.useReducer=function(e,t,i){return is().useReducer(e,t,i)};ye.useRef=function(e){return is().useRef(e)};ye.useState=function(e){return is().useState(e)};ye.version="17.0.2"});var Ea=ue((u3,ay)=>{"use strict";ay.exports=oy()});var dy=ue(Ae=>{"use strict";var Fa,$u,Qc,$d;typeof performance=="object"&&typeof performance.now=="function"?(uy=performance,Ae.unstable_now=function(){return uy.now()}):(Gd=Date,ly=Gd.now(),Ae.unstable_now=function(){return Gd.now()-ly});var uy,Gd,ly;typeof window>"u"||typeof MessageChannel!="function"?(Ta=null,Hd=null,Xd=function(){if(Ta!==null)try{var e=Ae.unstable_now();Ta(!0,e),Ta=null}catch(t){throw setTimeout(Xd,0),t}},Fa=function(e){Ta!==null?setTimeout(Fa,0,e):(Ta=e,setTimeout(Xd,0))},$u=function(e,t){Hd=setTimeout(e,t)},Qc=function(){clearTimeout(Hd)},Ae.unstable_shouldYield=function(){return!1},$d=Ae.unstable_forceFrameRate=function(){}):(cy=window.setTimeout,hy=window.clearTimeout,typeof console<"u"&&(fy=window.cancelAnimationFrame,typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),typeof fy!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")),Vu=!1,qu=null,$c=-1,Yd=5,Vd=0,Ae.unstable_shouldYield=function(){return Ae.unstable_now()>=Vd},$d=function(){},Ae.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Yd=0<e?Math.floor(1e3/e):5},qd=new MessageChannel,Kc=qd.port2,qd.port1.onmessage=function(){if(qu!==null){var e=Ae.unstable_now();Vd=e+Yd;try{qu(!0,e)?Kc.postMessage(null):(Vu=!1,qu=null)}catch(t){throw Kc.postMessage(null),t}}else Vu=!1},Fa=function(e){qu=e,Vu||(Vu=!0,Kc.postMessage(null))},$u=function(e,t){$c=cy(function(){e(Ae.unstable_now())},t)},Qc=function(){hy($c),$c=-1});var Ta,Hd,Xd,cy,hy,fy,Vu,qu,$c,Yd,Vd,qd,Kc;function Kd(e,t){var i=e.length;e.push(t);t:for(;;){var o=i-1>>>1,n=e[o];if(n!==void 0&&0<Jc(n,t))e[o]=t,e[i]=n,i=o;else break t}}function ur(e){return e=e[0],e===void 0?null:e}function Zc(e){var t=e[0];if(t!==void 0){var i=e.pop();if(i!==t){e[0]=i;t:for(var o=0,n=e.length;o<n;){var s=2*(o+1)-1,r=e[s],a=s+1,l=e[a];if(r!==void 0&&0>Jc(r,i))l!==void 0&&0>Jc(l,r)?(e[o]=l,e[a]=i,o=a):(e[o]=r,e[s]=i,o=s);else if(l!==void 0&&0>Jc(l,i))e[o]=l,e[a]=i,o=a;else break t}}return t}return null}function Jc(e,t){var i=e.sortIndex-t.sortIndex;return i!==0?i:e.id-t.id}var xr=[],Is=[],yE=1,jn=null,_i=3,th=!1,To=!1,Ku=!1;function Jd(e){for(var t=ur(Is);t!==null;){if(t.callback===null)Zc(Is);else if(t.startTime<=e)Zc(Is),t.sortIndex=t.expirationTime,Kd(xr,t);else break;t=ur(Is)}}function Qd(e){if(Ku=!1,Jd(e),!To)if(ur(xr)!==null)To=!0,Fa(Zd);else{var t=ur(Is);t!==null&&$u(Qd,t.startTime-e)}}function Zd(e,t){To=!1,Ku&&(Ku=!1,Qc()),th=!0;var i=_i;try{for(Jd(t),jn=ur(xr);jn!==null&&(!(jn.expirationTime>t)||e&&!Ae.unstable_shouldYield());){var o=jn.callback;if(typeof o=="function"){jn.callback=null,_i=jn.priorityLevel;var n=o(jn.expirationTime<=t);t=Ae.unstable_now(),typeof n=="function"?jn.callback=n:jn===ur(xr)&&Zc(xr),Jd(t)}else Zc(xr);jn=ur(xr)}if(jn!==null)var s=!0;else{var r=ur(Is);r!==null&&$u(Qd,r.startTime-t),s=!1}return s}finally{jn=null,_i=i,th=!1}}var CE=$d;Ae.unstable_IdlePriority=5;Ae.unstable_ImmediatePriority=1;Ae.unstable_LowPriority=4;Ae.unstable_NormalPriority=3;Ae.unstable_Profiling=null;Ae.unstable_UserBlockingPriority=2;Ae.unstable_cancelCallback=function(e){e.callback=null};Ae.unstable_continueExecution=function(){To||th||(To=!0,Fa(Zd))};Ae.unstable_getCurrentPriorityLevel=function(){return _i};Ae.unstable_getFirstCallbackNode=function(){return ur(xr)};Ae.unstable_next=function(e){switch(_i){case 1:case 2:case 3:var t=3;break;default:t=_i}var i=_i;_i=t;try{return e()}finally{_i=i}};Ae.unstable_pauseExecution=function(){};Ae.unstable_requestPaint=CE;Ae.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=_i;_i=e;try{return t()}finally{_i=i}};Ae.unstable_scheduleCallback=function(e,t,i){var o=Ae.unstable_now();switch(typeof i=="object"&&i!==null?(i=i.delay,i=typeof i=="number"&&0<i?o+i:o):i=o,e){case 1:var n=-1;break;case 2:n=250;break;case 5:n=1073741823;break;case 4:n=1e4;break;default:n=5e3}return n=i+n,e={id:yE++,callback:t,priorityLevel:e,startTime:i,expirationTime:n,sortIndex:-1},i>o?(e.sortIndex=i,Kd(Is,e),ur(xr)===null&&e===ur(Is)&&(Ku?Qc():Ku=!0,$u(Qd,i-o))):(e.sortIndex=n,Kd(xr,e),To||th||(To=!0,Fa(Zd))),e};Ae.unstable_wrapCallback=function(e){var t=_i;return function(){var i=_i;_i=t;try{return e.apply(this,arguments)}finally{_i=i}}}});var gy=ue((c3,py)=>{"use strict";py.exports=dy()});var e_=ue(Hn=>{"use strict";var Vh=Ea(),je=Md(),oi=gy();function Ot(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!Vh)throw Error(Ot(227));var T1=new Set,Al={};function No(e,t){Ka(e,t),Ka(e+"Capture",t)}function Ka(e,t){for(Al[e]=t,e=0;e<t.length;e++)T1.add(t[e])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_E=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,my=Object.prototype.hasOwnProperty,vy={},yy={};function wE(e){return my.call(yy,e)?!0:my.call(vy,e)?!1:_E.test(e)?yy[e]=!0:(vy[e]=!0,!1)}function SE(e,t,i,o){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function xE(e,t,i,o){if(t===null||typeof t>"u"||SE(e,t,i,o))return!0;if(o)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ji(e,t,i,o,n,s,r){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=r}var fi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){fi[e]=new ji(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];fi[t]=new ji(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){fi[e]=new ji(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){fi[e]=new ji(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){fi[e]=new ji(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){fi[e]=new ji(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){fi[e]=new ji(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){fi[e]=new ji(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){fi[e]=new ji(e,5,!1,e.toLowerCase(),null,!1,!1)});var ug=/[\-:]([a-z])/g;function lg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ug,lg);fi[t]=new ji(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ug,lg);fi[t]=new ji(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ug,lg);fi[t]=new ji(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){fi[e]=new ji(e,1,!1,e.toLowerCase(),null,!1,!1)});fi.xlinkHref=new ji("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){fi[e]=new ji(e,1,!1,e.toLowerCase(),null,!0,!0)});function cg(e,t,i,o){var n=fi.hasOwnProperty(t)?fi[t]:null,s=n!==null?n.type===0:o?!1:!(!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N");s||(xE(t,i,n,o)&&(i=null),o||n===null?wE(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):n.mustUseProperty?e[n.propertyName]=i===null?n.type===3?!1:"":i:(t=n.attributeName,o=n.attributeNamespace,i===null?e.removeAttribute(t):(n=n.type,i=n===3||n===4&&i===!0?"":""+i,o?e.setAttributeNS(o,t,i):e.setAttribute(t,i))))}var Uo=Vh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ll=60103,Oo=60106,Ls=60107,hg=60108,pl=60114,fg=60109,dg=60110,qh=60112,gl=60113,Dh=60120,$h=60115,pg=60116,gg=60121,mg=60128,F1=60129,vg=60130,Sp=60131;typeof Symbol=="function"&&Symbol.for&&(ti=Symbol.for,ll=ti("react.element"),Oo=ti("react.portal"),Ls=ti("react.fragment"),hg=ti("react.strict_mode"),pl=ti("react.profiler"),fg=ti("react.provider"),dg=ti("react.context"),qh=ti("react.forward_ref"),gl=ti("react.suspense"),Dh=ti("react.suspense_list"),$h=ti("react.memo"),pg=ti("react.lazy"),gg=ti("react.block"),ti("react.scope"),mg=ti("react.opaque.id"),F1=ti("react.debug_trace_mode"),vg=ti("react.offscreen"),Sp=ti("react.legacy_hidden"));var ti,Cy=typeof Symbol=="function"&&Symbol.iterator;function Ju(e){return e===null||typeof e!="object"?null:(e=Cy&&e[Cy]||e["@@iterator"],typeof e=="function"?e:null)}var tp;function cl(e){if(tp===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);tp=t&&t[1]||""}return`
`+tp+e}var ep=!1;function eh(e,t){if(!e||ep)return"";ep=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var o=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){o=l}e.call(t.prototype)}else{try{throw Error()}catch(l){o=l}e()}}catch(l){if(l&&o&&typeof l.stack=="string"){for(var n=l.stack.split(`
`),s=o.stack.split(`
`),r=n.length-1,a=s.length-1;1<=r&&0<=a&&n[r]!==s[a];)a--;for(;1<=r&&0<=a;r--,a--)if(n[r]!==s[a]){if(r!==1||a!==1)do if(r--,a--,0>a||n[r]!==s[a])return`
`+n[r].replace(" at new "," at ");while(1<=r&&0<=a);break}}}finally{ep=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?cl(e):""}function DE(e){switch(e.tag){case 5:return cl(e.type);case 16:return cl("Lazy");case 13:return cl("Suspense");case 19:return cl("SuspenseList");case 0:case 2:case 15:return e=eh(e.type,!1),e;case 11:return e=eh(e.type.render,!1),e;case 22:return e=eh(e.type._render,!1),e;case 1:return e=eh(e.type,!0),e;default:return""}}function Ua(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ls:return"Fragment";case Oo:return"Portal";case pl:return"Profiler";case hg:return"StrictMode";case gl:return"Suspense";case Dh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dg:return(e.displayName||"Context")+".Consumer";case fg:return(e._context.displayName||"Context")+".Provider";case qh:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case $h:return Ua(e.type);case gg:return Ua(e._render);case pg:t=e._payload,e=e._init;try{return Ua(e(t))}catch{}}return null}function Vs(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function O1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function bE(e){var t=O1(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var n=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(r){o=""+r,s.call(this,r)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return o},setValue:function(r){o=""+r},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ih(e){e._valueTracker||(e._valueTracker=bE(e))}function k1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),o="";return e&&(o=O1(e)?e.checked?"true":"false":e.value),e=o,e!==i?(t.setValue(e),!0):!1}function bh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function xp(e,t){var i=t.checked;return je({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function _y(e,t){var i=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;i=Vs(t.value!=null?t.value:i),e._wrapperState={initialChecked:o,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function P1(e,t){t=t.checked,t!=null&&cg(e,"checked",t,!1)}function Dp(e,t){P1(e,t);var i=Vs(t.value),o=t.type;if(i!=null)o==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bp(e,t.type,i):t.hasOwnProperty("defaultValue")&&bp(e,t.type,Vs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function wy(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function bp(e,t,i){(t!=="number"||bh(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}function AE(e){var t="";return Vh.Children.forEach(e,function(i){i!=null&&(t+=i)}),t}function Ap(e,t){return e=je({children:void 0},t),(t=AE(t.children))&&(e.children=t),e}function za(e,t,i,o){if(e=e.options,t){t={};for(var n=0;n<i.length;n++)t["$"+i[n]]=!0;for(i=0;i<e.length;i++)n=t.hasOwnProperty("$"+e[i].value),e[i].selected!==n&&(e[i].selected=n),n&&o&&(e[i].defaultSelected=!0)}else{for(i=""+Vs(i),t=null,n=0;n<e.length;n++){if(e[n].value===i){e[n].selected=!0,o&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function Ep(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ot(91));return je({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Sy(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(Ot(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(Ot(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:Vs(i)}}function I1(e,t){var i=Vs(t.value),o=Vs(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),o!=null&&(e.defaultValue=""+o)}function xy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}var Tp={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function B1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?B1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var nh,L1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,o,n){MSApp.execUnsafeLocalFunction(function(){return e(t,i,o,n)})}:e}(function(e,t){if(e.namespaceURI!==Tp.svg||"innerHTML"in e)e.innerHTML=t;else{for(nh=nh||document.createElement("div"),nh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=nh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function El(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var ml={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EE=["Webkit","ms","Moz","O"];Object.keys(ml).forEach(function(e){EE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ml[t]=ml[e]})});function M1(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||ml.hasOwnProperty(e)&&ml[e]?(""+t).trim():t+"px"}function R1(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var o=i.indexOf("--")===0,n=M1(i,t[i],o);i==="float"&&(i="cssFloat"),o?e.setProperty(i,n):e[i]=n}}var TE=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Op(e,t){if(t){if(TE[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ot(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ot(60));if(!(typeof t.dangerouslySetInnerHTML=="object"&&"__html"in t.dangerouslySetInnerHTML))throw Error(Ot(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ot(62))}}function kp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function yg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pp=null,Wa=null,Ga=null;function Dy(e){if(e=zl(e)){if(typeof Pp!="function")throw Error(Ot(280));var t=e.stateNode;t&&(t=ef(t),Pp(e.stateNode,e.type,t))}}function j1(e){Wa?Ga?Ga.push(e):Ga=[e]:Wa=e}function N1(){if(Wa){var e=Wa,t=Ga;if(Ga=Wa=null,Dy(e),t)for(e=0;e<t.length;e++)Dy(t[e])}}function Cg(e,t){return e(t)}function U1(e,t,i,o,n){return e(t,i,o,n)}function _g(){}var z1=Cg,ko=!1,ip=!1;function wg(){(Wa!==null||Ga!==null)&&(_g(),N1())}function FE(e,t,i){if(ip)return e(t,i);ip=!0;try{return z1(e,t,i)}finally{ip=!1,wg()}}function Tl(e,t){var i=e.stateNode;if(i===null)return null;var o=ef(i);if(o===null)return null;i=o[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(Ot(231,t,typeof i));return i}var Ip=!1;if(us)try{Oa={},Object.defineProperty(Oa,"passive",{get:function(){Ip=!0}}),window.addEventListener("test",Oa,Oa),window.removeEventListener("test",Oa,Oa)}catch{Ip=!1}var Oa;function OE(e,t,i,o,n,s,r,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(i,u)}catch(c){this.onError(c)}}var vl=!1,Ah=null,Eh=!1,Bp=null,kE={onError:function(e){vl=!0,Ah=e}};function PE(e,t,i,o,n,s,r,a,l){vl=!1,Ah=null,OE.apply(kE,arguments)}function IE(e,t,i,o,n,s,r,a,l){if(PE.apply(this,arguments),vl){if(vl){var u=Ah;vl=!1,Ah=null}else throw Error(Ot(198));Eh||(Eh=!0,Bp=u)}}function zo(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&1026&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function W1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function by(e){if(zo(e)!==e)throw Error(Ot(188))}function BE(e){var t=e.alternate;if(!t){if(t=zo(e),t===null)throw Error(Ot(188));return t!==e?null:e}for(var i=e,o=t;;){var n=i.return;if(n===null)break;var s=n.alternate;if(s===null){if(o=n.return,o!==null){i=o;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===i)return by(n),e;if(s===o)return by(n),t;s=s.sibling}throw Error(Ot(188))}if(i.return!==o.return)i=n,o=s;else{for(var r=!1,a=n.child;a;){if(a===i){r=!0,i=n,o=s;break}if(a===o){r=!0,o=n,i=s;break}a=a.sibling}if(!r){for(a=s.child;a;){if(a===i){r=!0,i=s,o=n;break}if(a===o){r=!0,o=s,i=n;break}a=a.sibling}if(!r)throw Error(Ot(189))}}if(i.alternate!==o)throw Error(Ot(190))}if(i.tag!==3)throw Error(Ot(188));return i.stateNode.current===i?e:t}function G1(e){if(e=BE(e),!e)return null;for(var t=e;;){if(t.tag===5||t.tag===6)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Ay(e,t){for(var i=e.alternate;t!==null;){if(t===e||t===i)return!0;t=t.return}return!1}var H1,Sg,X1,Y1,Lp=!1,Dr=[],Ns=null,Us=null,zs=null,Fl=new Map,Ol=new Map,Qu=[],Ey="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mp(e,t,i,o,n){return{blockedOn:e,domEventName:t,eventSystemFlags:i|16,nativeEvent:n,targetContainers:[o]}}function Ty(e,t){switch(e){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":Us=null;break;case"mouseover":case"mouseout":zs=null;break;case"pointerover":case"pointerout":Fl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ol.delete(t.pointerId)}}function Zu(e,t,i,o,n,s){return e===null||e.nativeEvent!==s?(e=Mp(t,i,o,n,s),t!==null&&(t=zl(t),t!==null&&Sg(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function LE(e,t,i,o,n){switch(t){case"focusin":return Ns=Zu(Ns,e,t,i,o,n),!0;case"dragenter":return Us=Zu(Us,e,t,i,o,n),!0;case"mouseover":return zs=Zu(zs,e,t,i,o,n),!0;case"pointerover":var s=n.pointerId;return Fl.set(s,Zu(Fl.get(s)||null,e,t,i,o,n)),!0;case"gotpointercapture":return s=n.pointerId,Ol.set(s,Zu(Ol.get(s)||null,e,t,i,o,n)),!0}return!1}function ME(e){var t=Po(e.target);if(t!==null){var i=zo(t);if(i!==null){if(t=i.tag,t===13){if(t=W1(i),t!==null){e.blockedOn=t,Y1(e.lanePriority,function(){oi.unstable_runWithPriority(e.priority,function(){X1(i)})});return}}else if(t===3&&i.stateNode.hydrate){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ph(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=Ag(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i!==null)return t=zl(i),t!==null&&Sg(t),e.blockedOn=i,!1;t.shift()}return!0}function Fy(e,t,i){ph(e)&&i.delete(t)}function RE(){for(Lp=!1;0<Dr.length;){var e=Dr[0];if(e.blockedOn!==null){e=zl(e.blockedOn),e!==null&&H1(e);break}for(var t=e.targetContainers;0<t.length;){var i=Ag(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i!==null){e.blockedOn=i;break}t.shift()}e.blockedOn===null&&Dr.shift()}Ns!==null&&ph(Ns)&&(Ns=null),Us!==null&&ph(Us)&&(Us=null),zs!==null&&ph(zs)&&(zs=null),Fl.forEach(Fy),Ol.forEach(Fy)}function tl(e,t){e.blockedOn===t&&(e.blockedOn=null,Lp||(Lp=!0,oi.unstable_scheduleCallback(oi.unstable_NormalPriority,RE)))}function V1(e){function t(n){return tl(n,e)}if(0<Dr.length){tl(Dr[0],e);for(var i=1;i<Dr.length;i++){var o=Dr[i];o.blockedOn===e&&(o.blockedOn=null)}}for(Ns!==null&&tl(Ns,e),Us!==null&&tl(Us,e),zs!==null&&tl(zs,e),Fl.forEach(t),Ol.forEach(t),i=0;i<Qu.length;i++)o=Qu[i],o.blockedOn===e&&(o.blockedOn=null);for(;0<Qu.length&&(i=Qu[0],i.blockedOn===null);)ME(i),i.blockedOn===null&&Qu.shift()}function rh(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Ba={animationend:rh("Animation","AnimationEnd"),animationiteration:rh("Animation","AnimationIteration"),animationstart:rh("Animation","AnimationStart"),transitionend:rh("Transition","TransitionEnd")},np={},q1={};us&&(q1=document.createElement("div").style,"AnimationEvent"in window||(delete Ba.animationend.animation,delete Ba.animationiteration.animation,delete Ba.animationstart.animation),"TransitionEvent"in window||delete Ba.transitionend.transition);function Kh(e){if(np[e])return np[e];if(!Ba[e])return e;var t=Ba[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in q1)return np[e]=t[i];return e}var $1=Kh("animationend"),K1=Kh("animationiteration"),J1=Kh("animationstart"),Q1=Kh("transitionend"),Z1=new Map,xg=new Map,jE=["abort","abort",$1,"animationEnd",K1,"animationIteration",J1,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Q1,"transitionEnd","waiting","waiting"];function Dg(e,t){for(var i=0;i<e.length;i+=2){var o=e[i],n=e[i+1];n="on"+(n[0].toUpperCase()+n.slice(1)),xg.set(o,t),Z1.set(o,n),No(n,[o])}}var NE=oi.unstable_now;NE();var Be=8;function Pa(e){if(1&e)return Be=15,1;if(2&e)return Be=14,2;if(4&e)return Be=13,4;var t=24&e;return t!==0?(Be=12,t):e&32?(Be=11,32):(t=192&e,t!==0?(Be=10,t):e&256?(Be=9,256):(t=3584&e,t!==0?(Be=8,t):e&4096?(Be=7,4096):(t=4186112&e,t!==0?(Be=6,t):(t=62914560&e,t!==0?(Be=5,t):e&67108864?(Be=4,67108864):e&134217728?(Be=3,134217728):(t=805306368&e,t!==0?(Be=2,t):1073741824&e?(Be=1,1073741824):(Be=8,e))))))}function UE(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function zE(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(Ot(358,e))}}function kl(e,t){var i=e.pendingLanes;if(i===0)return Be=0;var o=0,n=0,s=e.expiredLanes,r=e.suspendedLanes,a=e.pingedLanes;if(s!==0)o=s,n=Be=15;else if(s=i&134217727,s!==0){var l=s&~r;l!==0?(o=Pa(l),n=Be):(a&=s,a!==0&&(o=Pa(a),n=Be))}else s=i&~r,s!==0?(o=Pa(s),n=Be):a!==0&&(o=Pa(a),n=Be);if(o===0)return 0;if(o=31-qs(o),o=i&((0>o?0:1<<o)<<1)-1,t!==0&&t!==o&&!(t&r)){if(Pa(t),n<=Be)return t;Be=n}if(t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)i=31-qs(t),n=1<<i,o|=e[i],t&=~n;return o}function tC(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Th(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return e=Ia(24&~t),e===0?Th(10,t):e;case 10:return e=Ia(192&~t),e===0?Th(8,t):e;case 8:return e=Ia(3584&~t),e===0&&(e=Ia(4186112&~t),e===0&&(e=512)),e;case 2:return t=Ia(805306368&~t),t===0&&(t=268435456),t}throw Error(Ot(358,e))}function Ia(e){return e&-e}function rp(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Jh(e,t,i){e.pendingLanes|=t;var o=t-1;e.suspendedLanes&=o,e.pingedLanes&=o,e=e.eventTimes,t=31-qs(t),e[t]=i}var qs=Math.clz32?Math.clz32:HE,WE=Math.log,GE=Math.LN2;function HE(e){return e===0?32:31-(WE(e)/GE|0)|0}var XE=oi.unstable_UserBlockingPriority,YE=oi.unstable_runWithPriority,gh=!0;function VE(e,t,i,o){ko||_g();var n=bg,s=ko;ko=!0;try{U1(n,e,t,i,o)}finally{(ko=s)||wg()}}function qE(e,t,i,o){YE(XE,bg.bind(null,e,t,i,o))}function bg(e,t,i,o){if(gh){var n;if((n=(t&4)===0)&&0<Dr.length&&-1<Ey.indexOf(e))e=Mp(null,e,t,i,o),Dr.push(e);else{var s=Ag(e,t,i,o);if(s===null)n&&Ty(e,o);else{if(n){if(-1<Ey.indexOf(e)){e=Mp(s,e,t,i,o),Dr.push(e);return}if(LE(s,e,t,i,o))return;Ty(e,o)}dC(e,t,o,null,i)}}}}function Ag(e,t,i,o){var n=yg(o);if(n=Po(n),n!==null){var s=zo(n);if(s===null)n=null;else{var r=s.tag;if(r===13){if(n=W1(s),n!==null)return n;n=null}else if(r===3){if(s.stateNode.hydrate)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return dC(e,t,o,n,i),null}var Ms=null,Eg=null,mh=null;function eC(){if(mh)return mh;var e,t=Eg,i=t.length,o,n="value"in Ms?Ms.value:Ms.textContent,s=n.length;for(e=0;e<i&&t[e]===n[e];e++);var r=i-e;for(o=1;o<=r&&t[i-o]===n[s-o];o++);return mh=n.slice(e,1<o?1-o:void 0)}function vh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sh(){return!0}function Oy(){return!1}function xn(e){function t(i,o,n,s,r){this._reactName=i,this._targetInst=n,this.type=o,this.nativeEvent=s,this.target=r,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(i=e[a],this[a]=i?i(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?sh:Oy,this.isPropagationStopped=Oy,this}return je(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=sh)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=sh)},persist:function(){},isPersistent:sh}),t}var tu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tg=xn(tu),Ul=je({},tu,{view:0,detail:0}),$E=xn(Ul),sp,op,el,Qh=je({},Ul,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==el&&(el&&e.type==="mousemove"?(sp=e.screenX-el.screenX,op=e.screenY-el.screenY):op=sp=0,el=e),sp)},movementY:function(e){return"movementY"in e?e.movementY:op}}),ky=xn(Qh),KE=je({},Qh,{dataTransfer:0}),JE=xn(KE),QE=je({},Ul,{relatedTarget:0}),ap=xn(QE),ZE=je({},tu,{animationName:0,elapsedTime:0,pseudoElement:0}),tT=xn(ZE),eT=je({},tu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),iT=xn(eT),nT=je({},tu,{data:0}),Py=xn(nT),rT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oT[e])?!!t[e]:!1}function Fg(){return aT}var uT=je({},Ul,{key:function(e){if(e.key){var t=rT[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?sT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fg,charCode:function(e){return e.type==="keypress"?vh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),lT=xn(uT),cT=je({},Qh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Iy=xn(cT),hT=je({},Ul,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fg}),fT=xn(hT),dT=je({},tu,{propertyName:0,elapsedTime:0,pseudoElement:0}),pT=xn(dT),gT=je({},Qh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),mT=xn(gT),vT=[9,13,27,32],Og=us&&"CompositionEvent"in window,yl=null;us&&"documentMode"in document&&(yl=document.documentMode);var yT=us&&"TextEvent"in window&&!yl,iC=us&&(!Og||yl&&8<yl&&11>=yl),By=String.fromCharCode(32),Ly=!1;function nC(e,t){switch(e){case"keyup":return vT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rC(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var La=!1;function CT(e,t){switch(e){case"compositionend":return rC(t);case"keypress":return t.which!==32?null:(Ly=!0,By);case"textInput":return e=t.data,e===By&&Ly?null:e;default:return null}}function _T(e,t){if(La)return e==="compositionend"||!Og&&nC(e,t)?(e=eC(),mh=Eg=Ms=null,La=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return iC&&t.locale!=="ko"?null:t.data;default:return null}}var wT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function My(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!wT[e.type]:t==="textarea"}function sC(e,t,i,o){j1(o),t=Fh(t,"onChange"),0<t.length&&(i=new Tg("onChange","change",null,i,o),e.push({event:i,listeners:t}))}var Cl=null,Pl=null;function ST(e){cC(e,0)}function Zh(e){var t=Ra(e);if(k1(t))return e}function xT(e,t){if(e==="change")return t}var oC=!1;us&&(us?(ah="oninput"in document,ah||(up=document.createElement("div"),up.setAttribute("oninput","return;"),ah=typeof up.oninput=="function"),oh=ah):oh=!1,oC=oh&&(!document.documentMode||9<document.documentMode));var oh,ah,up;function Ry(){Cl&&(Cl.detachEvent("onpropertychange",aC),Pl=Cl=null)}function aC(e){if(e.propertyName==="value"&&Zh(Pl)){var t=[];if(sC(t,Pl,e,yg(e)),e=ST,ko)e(t);else{ko=!0;try{Cg(e,t)}finally{ko=!1,wg()}}}}function DT(e,t,i){e==="focusin"?(Ry(),Cl=t,Pl=i,Cl.attachEvent("onpropertychange",aC)):e==="focusout"&&Ry()}function bT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Zh(Pl)}function AT(e,t){if(e==="click")return Zh(t)}function ET(e,t){if(e==="input"||e==="change")return Zh(t)}function TT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nn=typeof Object.is=="function"?Object.is:TT,FT=Object.prototype.hasOwnProperty;function Il(e,t){if(Nn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(o=0;o<i.length;o++)if(!FT.call(t,i[o])||!Nn(e[i[o]],t[i[o]]))return!1;return!0}function jy(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ny(e,t){var i=jy(e);e=0;for(var o;i;){if(i.nodeType===3){if(o=e+i.textContent.length,e<=t&&o>=t)return{node:i,offset:t-e};e=o}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=jy(i)}}function uC(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?uC(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Uy(){for(var e=window,t=bh();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=bh(e.document)}return t}function Rp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var OT=us&&"documentMode"in document&&11>=document.documentMode,Ma=null,jp=null,_l=null,Np=!1;function zy(e,t,i){var o=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Np||Ma==null||Ma!==bh(o)||(o=Ma,"selectionStart"in o&&Rp(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),_l&&Il(_l,o)||(_l=o,o=Fh(jp,"onSelect"),0<o.length&&(t=new Tg("onSelect","select",null,t,i),e.push({event:t,listeners:o}),t.target=Ma)))}Dg("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);Dg("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Dg(jE,2);for(lp="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),uh=0;uh<lp.length;uh++)xg.set(lp[uh],0);var lp,uh;Ka("onMouseEnter",["mouseout","mouseover"]);Ka("onMouseLeave",["mouseout","mouseover"]);Ka("onPointerEnter",["pointerout","pointerover"]);Ka("onPointerLeave",["pointerout","pointerover"]);No("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));No("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));No("onBeforeInput",["compositionend","keypress","textInput","paste"]);No("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));No("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));No("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lC=new Set("cancel close invalid load scroll toggle".split(" ").concat(hl));function Wy(e,t,i){var o=e.type||"unknown-event";e.currentTarget=i,IE(o,t,void 0,e),e.currentTarget=null}function cC(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var o=e[i],n=o.event;o=o.listeners;t:{var s=void 0;if(t)for(var r=o.length-1;0<=r;r--){var a=o[r],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&n.isPropagationStopped())break t;Wy(n,a,u),s=l}else for(r=0;r<o.length;r++){if(a=o[r],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&n.isPropagationStopped())break t;Wy(n,a,u),s=l}}}if(Eh)throw e=Bp,Eh=!1,Bp=null,e}function Me(e,t){var i=gC(t),o=e+"__bubble";i.has(o)||(fC(t,e,2,!1),i.add(o))}var Gy="_reactListening"+Math.random().toString(36).slice(2);function hC(e){e[Gy]||(e[Gy]=!0,T1.forEach(function(t){lC.has(t)||Hy(t,!1,e,null),Hy(t,!0,e,null)}))}function Hy(e,t,i,o){var n=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,s=i;if(e==="selectionchange"&&i.nodeType!==9&&(s=i.ownerDocument),o!==null&&!t&&lC.has(e)){if(e!=="scroll")return;n|=2,s=o}var r=gC(s),a=e+"__"+(t?"capture":"bubble");r.has(a)||(t&&(n|=4),fC(s,e,n,t),r.add(a))}function fC(e,t,i,o){var n=xg.get(t);switch(n===void 0?2:n){case 0:n=VE;break;case 1:n=qE;break;default:n=bg}i=n.bind(null,t,i,e),n=void 0,!Ip||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),o?n!==void 0?e.addEventListener(t,i,{capture:!0,passive:n}):e.addEventListener(t,i,!0):n!==void 0?e.addEventListener(t,i,{passive:n}):e.addEventListener(t,i,!1)}function dC(e,t,i,o,n){var s=o;if(!(t&1)&&!(t&2)&&o!==null)t:for(;;){if(o===null)return;var r=o.tag;if(r===3||r===4){var a=o.stateNode.containerInfo;if(a===n||a.nodeType===8&&a.parentNode===n)break;if(r===4)for(r=o.return;r!==null;){var l=r.tag;if((l===3||l===4)&&(l=r.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;r=r.return}for(;a!==null;){if(r=Po(a),r===null)return;if(l=r.tag,l===5||l===6){o=s=r;continue t}a=a.parentNode}}o=o.return}FE(function(){var u=s,c=yg(i),h=[];t:{var d=Z1.get(e);if(d!==void 0){var g=Tg,m=e;switch(e){case"keypress":if(vh(i)===0)break t;case"keydown":case"keyup":g=lT;break;case"focusin":m="focus",g=ap;break;case"focusout":m="blur",g=ap;break;case"beforeblur":case"afterblur":g=ap;break;case"click":if(i.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=ky;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=JE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=fT;break;case $1:case K1:case J1:g=tT;break;case Q1:g=pT;break;case"scroll":g=$E;break;case"wheel":g=mT;break;case"copy":case"cut":case"paste":g=iT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Iy}var y=(t&4)!==0,C=!y&&e==="scroll",w=y?d!==null?d+"Capture":null:d;y=[];for(var F=u,B;F!==null;){B=F;var U=B.stateNode;if(B.tag===5&&U!==null&&(B=U,w!==null&&(U=Tl(F,w),U!=null&&y.push(Bl(F,U,B)))),C)break;F=F.return}0<y.length&&(d=new g(d,m,null,i,c),h.push({event:d,listeners:y}))}}if(!(t&7)){t:{if(d=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",d&&!(t&16)&&(m=i.relatedTarget||i.fromElement)&&(Po(m)||m[eu]))break t;if((g||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,g?(m=i.relatedTarget||i.toElement,g=u,m=m?Po(m):null,m!==null&&(C=zo(m),m!==C||m.tag!==5&&m.tag!==6)&&(m=null)):(g=null,m=u),g!==m)){if(y=ky,U="onMouseLeave",w="onMouseEnter",F="mouse",(e==="pointerout"||e==="pointerover")&&(y=Iy,U="onPointerLeave",w="onPointerEnter",F="pointer"),C=g==null?d:Ra(g),B=m==null?d:Ra(m),d=new y(U,F+"leave",g,i,c),d.target=C,d.relatedTarget=B,U=null,Po(c)===u&&(y=new y(w,F+"enter",m,i,c),y.target=B,y.relatedTarget=C,U=y),C=U,g&&m)e:{for(y=g,w=m,F=0,B=y;B;B=ka(B))F++;for(B=0,U=w;U;U=ka(U))B++;for(;0<F-B;)y=ka(y),F--;for(;0<B-F;)w=ka(w),B--;for(;F--;){if(y===w||w!==null&&y===w.alternate)break e;y=ka(y),w=ka(w)}y=null}else y=null;g!==null&&Xy(h,d,g,y,!1),m!==null&&C!==null&&Xy(h,C,m,y,!0)}}t:{if(d=u?Ra(u):window,g=d.nodeName&&d.nodeName.toLowerCase(),g==="select"||g==="input"&&d.type==="file")var R=xT;else if(My(d))if(oC)R=ET;else{R=bT;var W=DT}else(g=d.nodeName)&&g.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(R=AT);if(R&&(R=R(e,u))){sC(h,R,i,c);break t}W&&W(e,d,u),e==="focusout"&&(W=d._wrapperState)&&W.controlled&&d.type==="number"&&bp(d,"number",d.value)}switch(W=u?Ra(u):window,e){case"focusin":(My(W)||W.contentEditable==="true")&&(Ma=W,jp=u,_l=null);break;case"focusout":_l=jp=Ma=null;break;case"mousedown":Np=!0;break;case"contextmenu":case"mouseup":case"dragend":Np=!1,zy(h,i,c);break;case"selectionchange":if(OT)break;case"keydown":case"keyup":zy(h,i,c)}var X;if(Og)t:{switch(e){case"compositionstart":var $="onCompositionStart";break t;case"compositionend":$="onCompositionEnd";break t;case"compositionupdate":$="onCompositionUpdate";break t}$=void 0}else La?nC(e,i)&&($="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&($="onCompositionStart");$&&(iC&&i.locale!=="ko"&&(La||$!=="onCompositionStart"?$==="onCompositionEnd"&&La&&(X=eC()):(Ms=c,Eg="value"in Ms?Ms.value:Ms.textContent,La=!0)),W=Fh(u,$),0<W.length&&($=new Py($,e,null,i,c),h.push({event:$,listeners:W}),X?$.data=X:(X=rC(i),X!==null&&($.data=X)))),(X=yT?CT(e,i):_T(e,i))&&(u=Fh(u,"onBeforeInput"),0<u.length&&(c=new Py("onBeforeInput","beforeinput",null,i,c),h.push({event:c,listeners:u}),c.data=X))}cC(h,t)})}function Bl(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Fh(e,t){for(var i=t+"Capture",o=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=Tl(e,i),s!=null&&o.unshift(Bl(e,s,n)),s=Tl(e,t),s!=null&&o.push(Bl(e,s,n))),e=e.return}return o}function ka(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xy(e,t,i,o,n){for(var s=t._reactName,r=[];i!==null&&i!==o;){var a=i,l=a.alternate,u=a.stateNode;if(l!==null&&l===o)break;a.tag===5&&u!==null&&(a=u,n?(l=Tl(i,s),l!=null&&r.unshift(Bl(i,l,a))):n||(l=Tl(i,s),l!=null&&r.push(Bl(i,l,a)))),i=i.return}r.length!==0&&e.push({event:t,listeners:r})}function Oh(){}var cp=null,hp=null;function pC(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Up(e,t){return e==="textarea"||e==="option"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yy=typeof setTimeout=="function"?setTimeout:void 0,kT=typeof clearTimeout=="function"?clearTimeout:void 0;function kg(e){e.nodeType===1?e.textContent="":e.nodeType===9&&(e=e.body,e!=null&&(e.textContent=""))}function Ha(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break}return e}function Vy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var fp=0;function PT(e){return{$$typeof:mg,toString:e,valueOf:e}}var tf=Math.random().toString(36).slice(2),Rs="__reactFiber$"+tf,kh="__reactProps$"+tf,eu="__reactContainer$"+tf,qy="__reactEvents$"+tf;function Po(e){var t=e[Rs];if(t)return t;for(var i=e.parentNode;i;){if(t=i[eu]||i[Rs]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=Vy(e);e!==null;){if(i=e[Rs])return i;e=Vy(e)}return t}e=i,i=e.parentNode}return null}function zl(e){return e=e[Rs]||e[eu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ra(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ot(33))}function ef(e){return e[kh]||null}function gC(e){var t=e[qy];return t===void 0&&(t=e[qy]=new Set),t}var zp=[],ja=-1;function Qs(e){return{current:e}}function Re(e){0>ja||(e.current=zp[ja],zp[ja]=null,ja--)}function Ve(e,t){ja++,zp[ja]=e.current,e.current=t}var $s={},Di=Qs($s),sn=Qs(!1),Mo=$s;function Ja(e,t){var i=e.type.contextTypes;if(!i)return $s;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in i)n[s]=t[s];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function on(e){return e=e.childContextTypes,e!=null}function Ph(){Re(sn),Re(Di)}function $y(e,t,i){if(Di.current!==$s)throw Error(Ot(168));Ve(Di,t),Ve(sn,i)}function mC(e,t,i){var o=e.stateNode;if(e=t.childContextTypes,typeof o.getChildContext!="function")return i;o=o.getChildContext();for(var n in o)if(!(n in e))throw Error(Ot(108,Ua(t)||"Unknown",n));return je({},i,o)}function yh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$s,Mo=Di.current,Ve(Di,e),Ve(sn,sn.current),!0}function Ky(e,t,i){var o=e.stateNode;if(!o)throw Error(Ot(169));i?(e=mC(e,t,Mo),o.__reactInternalMemoizedMergedChildContext=e,Re(sn),Re(Di),Ve(Di,e)):Re(sn),Ve(sn,i)}var Pg=null,Lo=null,IT=oi.unstable_runWithPriority,Ig=oi.unstable_scheduleCallback,Wp=oi.unstable_cancelCallback,BT=oi.unstable_shouldYield,Jy=oi.unstable_requestPaint,Gp=oi.unstable_now,LT=oi.unstable_getCurrentPriorityLevel,nf=oi.unstable_ImmediatePriority,vC=oi.unstable_UserBlockingPriority,yC=oi.unstable_NormalPriority,CC=oi.unstable_LowPriority,_C=oi.unstable_IdlePriority,dp={},MT=Jy!==void 0?Jy:function(){},ns=null,Ch=null,pp=!1,Qy=Gp(),Si=1e4>Qy?Gp:function(){return Gp()-Qy};function Qa(){switch(LT()){case nf:return 99;case vC:return 98;case yC:return 97;case CC:return 96;case _C:return 95;default:throw Error(Ot(332))}}function wC(e){switch(e){case 99:return nf;case 98:return vC;case 97:return yC;case 96:return CC;case 95:return _C;default:throw Error(Ot(332))}}function Ro(e,t){return e=wC(e),IT(e,t)}function Ll(e,t,i){return e=wC(e),Ig(e,t,i)}function Fr(){if(Ch!==null){var e=Ch;Ch=null,Wp(e)}SC()}function SC(){if(!pp&&ns!==null){pp=!0;var e=0;try{var t=ns;Ro(99,function(){for(;e<t.length;e++){var i=t[e];do i=i(!0);while(i!==null)}}),ns=null}catch(i){throw ns!==null&&(ns=ns.slice(e+1)),Ig(nf,Fr),i}finally{pp=!1}}}var RT=Uo.ReactCurrentBatchConfig;function lr(e,t){if(e&&e.defaultProps){t=je({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}var Ih=Qs(null),Bh=null,Na=null,Lh=null;function Bg(){Lh=Na=Bh=null}function Lg(e){var t=Ih.current;Re(Ih),e.type._context._currentValue=t}function xC(e,t){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)===t){if(i===null||(i.childLanes&t)===t)break;i.childLanes|=t}else e.childLanes|=t,i!==null&&(i.childLanes|=t);e=e.return}}function Xa(e,t){Bh=e,Lh=Na=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(cr=!0),e.firstContext=null)}function Wn(e,t){if(Lh!==e&&t!==!1&&t!==0)if((typeof t!="number"||t===1073741823)&&(Lh=e,t=1073741823),t={context:e,observedBits:t,next:null},Na===null){if(Bh===null)throw Error(Ot(308));Na=t,Bh.dependencies={lanes:0,firstContext:t,responders:null}}else Na=Na.next=t;return e._currentValue}var Bs=!1;function Mg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function DC(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ws(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Gs(e,t){if(e=e.updateQueue,e!==null){e=e.shared;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}}function Zy(e,t){var i=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,i===o)){var n=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var r={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?n=s=r:s=s.next=r,i=i.next}while(i!==null);s===null?n=s=t:s=s.next=t}else n=s=t;i={baseState:o.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:o.shared,effects:o.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Ml(e,t,i,o){var n=e.updateQueue;Bs=!1;var s=n.firstBaseUpdate,r=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var l=a,u=l.next;l.next=null,r===null?s=u:r.next=u,r=l;var c=e.alternate;if(c!==null){c=c.updateQueue;var h=c.lastBaseUpdate;h!==r&&(h===null?c.firstBaseUpdate=u:h.next=u,c.lastBaseUpdate=l)}}if(s!==null){h=n.baseState,r=0,c=u=l=null;do{a=s.lane;var d=s.eventTime;if((o&a)===a){c!==null&&(c=c.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var g=e,m=s;switch(a=t,d=i,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(d,h,a);break t}h=g;break t;case 3:g.flags=g.flags&-4097|64;case 0:if(g=m.payload,a=typeof g=="function"?g.call(d,h,a):g,a==null)break t;h=je({},h,a);break t;case 2:Bs=!0}}s.callback!==null&&(e.flags|=32,a=n.effects,a===null?n.effects=[s]:a.push(s))}else d={eventTime:d,lane:a,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=d,l=h):c=c.next=d,r|=a;if(s=s.next,s===null){if(a=n.shared.pending,a===null)break;s=a.next,a.next=null,n.lastBaseUpdate=a,n.shared.pending=null}}while(1);c===null&&(l=h),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=c,Gl|=r,e.lanes=r,e.memoizedState=h}}function t1(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],n=o.callback;if(n!==null){if(o.callback=null,o=i,typeof n!="function")throw Error(Ot(191,n));n.call(o)}}}var bC=new Vh.Component().refs;function Mh(e,t,i,o){t=e.memoizedState,i=i(o,t),i=i==null?t:je({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var rf={isMounted:function(e){return(e=e._reactInternals)?zo(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var o=Sn(),n=Hs(e),s=Ws(o,n);s.payload=t,i!=null&&(s.callback=i),Gs(e,s),Xs(e,n,o)},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var o=Sn(),n=Hs(e),s=Ws(o,n);s.tag=1,s.payload=t,i!=null&&(s.callback=i),Gs(e,s),Xs(e,n,o)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Sn(),o=Hs(e),n=Ws(i,o);n.tag=2,t!=null&&(n.callback=t),Gs(e,n),Xs(e,o,i)}};function e1(e,t,i,o,n,s,r){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,s,r):t.prototype&&t.prototype.isPureReactComponent?!Il(i,o)||!Il(n,s):!0}function AC(e,t,i){var o=!1,n=$s,s=t.contextType;return typeof s=="object"&&s!==null?s=Wn(s):(n=on(t)?Mo:Di.current,o=t.contextTypes,s=(o=o!=null)?Ja(e,n):$s),t=new t(i,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=rf,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function i1(e,t,i,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,o),t.state!==e&&rf.enqueueReplaceState(t,t.state,null)}function Hp(e,t,i,o){var n=e.stateNode;n.props=i,n.state=e.memoizedState,n.refs=bC,Mg(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=Wn(s):(s=on(t)?Mo:Di.current,n.context=Ja(e,s)),Ml(e,i,n,o),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Mh(e,t,s,i),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&rf.enqueueReplaceState(n,n.state,null),Ml(e,i,n,o),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4)}var lh=Array.isArray;function il(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(Ot(309));var o=i.stateNode}if(!o)throw Error(Ot(147,e));var n=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===n?t.ref:(t=function(s){var r=o.refs;r===bC&&(r=o.refs={}),s===null?delete r[n]:r[n]=s},t._stringRef=n,t)}if(typeof e!="string")throw Error(Ot(284));if(!i._owner)throw Error(Ot(290,e))}return e}function ch(e,t){if(e.type!=="textarea")throw Error(Ot(31,Object.prototype.toString.call(t)==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function EC(e){function t(C,w){if(e){var F=C.lastEffect;F!==null?(F.nextEffect=w,C.lastEffect=w):C.firstEffect=C.lastEffect=w,w.nextEffect=null,w.flags=8}}function i(C,w){if(!e)return null;for(;w!==null;)t(C,w),w=w.sibling;return null}function o(C,w){for(C=new Map;w!==null;)w.key!==null?C.set(w.key,w):C.set(w.index,w),w=w.sibling;return C}function n(C,w){return C=Js(C,w),C.index=0,C.sibling=null,C}function s(C,w,F){return C.index=F,e?(F=C.alternate,F!==null?(F=F.index,F<w?(C.flags=2,w):F):(C.flags=2,w)):w}function r(C){return e&&C.alternate===null&&(C.flags=2),C}function a(C,w,F,B){return w===null||w.tag!==6?(w=Cp(F,C.mode,B),w.return=C,w):(w=n(w,F),w.return=C,w)}function l(C,w,F,B){return w!==null&&w.elementType===F.type?(B=n(w,F.props),B.ref=il(C,w,F),B.return=C,B):(B=xh(F.type,F.key,F.props,null,C.mode,B),B.ref=il(C,w,F),B.return=C,B)}function u(C,w,F,B){return w===null||w.tag!==4||w.stateNode.containerInfo!==F.containerInfo||w.stateNode.implementation!==F.implementation?(w=_p(F,C.mode,B),w.return=C,w):(w=n(w,F.children||[]),w.return=C,w)}function c(C,w,F,B,U){return w===null||w.tag!==7?(w=$a(F,C.mode,B,U),w.return=C,w):(w=n(w,F),w.return=C,w)}function h(C,w,F){if(typeof w=="string"||typeof w=="number")return w=Cp(""+w,C.mode,F),w.return=C,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ll:return F=xh(w.type,w.key,w.props,null,C.mode,F),F.ref=il(C,null,w),F.return=C,F;case Oo:return w=_p(w,C.mode,F),w.return=C,w}if(lh(w)||Ju(w))return w=$a(w,C.mode,F,null),w.return=C,w;ch(C,w)}return null}function d(C,w,F,B){var U=w!==null?w.key:null;if(typeof F=="string"||typeof F=="number")return U!==null?null:a(C,w,""+F,B);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case ll:return F.key===U?F.type===Ls?c(C,w,F.props.children,B,U):l(C,w,F,B):null;case Oo:return F.key===U?u(C,w,F,B):null}if(lh(F)||Ju(F))return U!==null?null:c(C,w,F,B,null);ch(C,F)}return null}function g(C,w,F,B,U){if(typeof B=="string"||typeof B=="number")return C=C.get(F)||null,a(w,C,""+B,U);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case ll:return C=C.get(B.key===null?F:B.key)||null,B.type===Ls?c(w,C,B.props.children,U,B.key):l(w,C,B,U);case Oo:return C=C.get(B.key===null?F:B.key)||null,u(w,C,B,U)}if(lh(B)||Ju(B))return C=C.get(F)||null,c(w,C,B,U,null);ch(w,B)}return null}function m(C,w,F,B){for(var U=null,R=null,W=w,X=w=0,$=null;W!==null&&X<F.length;X++){W.index>X?($=W,W=null):$=W.sibling;var st=d(C,W,F[X],B);if(st===null){W===null&&(W=$);break}e&&W&&st.alternate===null&&t(C,W),w=s(st,w,X),R===null?U=st:R.sibling=st,R=st,W=$}if(X===F.length)return i(C,W),U;if(W===null){for(;X<F.length;X++)W=h(C,F[X],B),W!==null&&(w=s(W,w,X),R===null?U=W:R.sibling=W,R=W);return U}for(W=o(C,W);X<F.length;X++)$=g(W,C,X,F[X],B),$!==null&&(e&&$.alternate!==null&&W.delete($.key===null?X:$.key),w=s($,w,X),R===null?U=$:R.sibling=$,R=$);return e&&W.forEach(function(pt){return t(C,pt)}),U}function y(C,w,F,B){var U=Ju(F);if(typeof U!="function")throw Error(Ot(150));if(F=U.call(F),F==null)throw Error(Ot(151));for(var R=U=null,W=w,X=w=0,$=null,st=F.next();W!==null&&!st.done;X++,st=F.next()){W.index>X?($=W,W=null):$=W.sibling;var pt=d(C,W,st.value,B);if(pt===null){W===null&&(W=$);break}e&&W&&pt.alternate===null&&t(C,W),w=s(pt,w,X),R===null?U=pt:R.sibling=pt,R=pt,W=$}if(st.done)return i(C,W),U;if(W===null){for(;!st.done;X++,st=F.next())st=h(C,st.value,B),st!==null&&(w=s(st,w,X),R===null?U=st:R.sibling=st,R=st);return U}for(W=o(C,W);!st.done;X++,st=F.next())st=g(W,C,X,st.value,B),st!==null&&(e&&st.alternate!==null&&W.delete(st.key===null?X:st.key),w=s(st,w,X),R===null?U=st:R.sibling=st,R=st);return e&&W.forEach(function(dt){return t(C,dt)}),U}return function(C,w,F,B){var U=typeof F=="object"&&F!==null&&F.type===Ls&&F.key===null;U&&(F=F.props.children);var R=typeof F=="object"&&F!==null;if(R)switch(F.$$typeof){case ll:t:{for(R=F.key,U=w;U!==null;){if(U.key===R){switch(U.tag){case 7:if(F.type===Ls){i(C,U.sibling),w=n(U,F.props.children),w.return=C,C=w;break t}break;default:if(U.elementType===F.type){i(C,U.sibling),w=n(U,F.props),w.ref=il(C,U,F),w.return=C,C=w;break t}}i(C,U);break}else t(C,U);U=U.sibling}F.type===Ls?(w=$a(F.props.children,C.mode,B,F.key),w.return=C,C=w):(B=xh(F.type,F.key,F.props,null,C.mode,B),B.ref=il(C,w,F),B.return=C,C=B)}return r(C);case Oo:t:{for(U=F.key;w!==null;){if(w.key===U)if(w.tag===4&&w.stateNode.containerInfo===F.containerInfo&&w.stateNode.implementation===F.implementation){i(C,w.sibling),w=n(w,F.children||[]),w.return=C,C=w;break t}else{i(C,w);break}else t(C,w);w=w.sibling}w=_p(F,C.mode,B),w.return=C,C=w}return r(C)}if(typeof F=="string"||typeof F=="number")return F=""+F,w!==null&&w.tag===6?(i(C,w.sibling),w=n(w,F),w.return=C,C=w):(i(C,w),w=Cp(F,C.mode,B),w.return=C,C=w),r(C);if(lh(F))return m(C,w,F,B);if(Ju(F))return y(C,w,F,B);if(R&&ch(C,F),typeof F>"u"&&!U)switch(C.tag){case 1:case 22:case 0:case 11:case 15:throw Error(Ot(152,Ua(C.type)||"Component"))}return i(C,w)}}var Rh=EC(!0),TC=EC(!1),Wl={},Er=Qs(Wl),Rl=Qs(Wl),jl=Qs(Wl);function Io(e){if(e===Wl)throw Error(Ot(174));return e}function Xp(e,t){switch(Ve(jl,t),Ve(Rl,e),Ve(Er,Wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Fp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Fp(t,e)}Re(Er),Ve(Er,t)}function Za(){Re(Er),Re(Rl),Re(jl)}function n1(e){Io(jl.current);var t=Io(Er.current),i=Fp(t,e.type);t!==i&&(Ve(Rl,e),Ve(Er,i))}function Rg(e){Rl.current===e&&(Re(Er),Re(Rl))}var Ye=Qs(0);function jh(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&64)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ss=null,js=null,Tr=!1;function FC(e,t){var i=Un(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=t,i.return=e,i.flags=8,e.lastEffect!==null?(e.lastEffect.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i}function r1(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,!0):!1;case 13:return!1;default:return!1}}function Yp(e){if(Tr){var t=js;if(t){var i=t;if(!r1(e,t)){if(t=Ha(i.nextSibling),!t||!r1(e,t)){e.flags=e.flags&-1025|2,Tr=!1,ss=e;return}FC(ss,i)}ss=e,js=Ha(t.firstChild)}else e.flags=e.flags&-1025|2,Tr=!1,ss=e}}function s1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ss=e}function hh(e){if(e!==ss)return!1;if(!Tr)return s1(e),Tr=!0,!1;var t=e.type;if(e.tag!==5||t!=="head"&&t!=="body"&&!Up(t,e.memoizedProps))for(t=js;t;)FC(e,t),t=Ha(t.nextSibling);if(s1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ot(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){js=Ha(e.nextSibling);break t}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}js=null}}else js=ss?Ha(e.stateNode.nextSibling):null;return!0}function gp(){js=ss=null,Tr=!1}var Ya=[];function jg(){for(var e=0;e<Ya.length;e++)Ya[e]._workInProgressVersionPrimary=null;Ya.length=0}var wl=Uo.ReactCurrentDispatcher,zn=Uo.ReactCurrentBatchConfig,Nl=0,Je=null,wi=null,ci=null,Nh=!1,Sl=!1;function nn(){throw Error(Ot(321))}function Ng(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Nn(e[i],t[i]))return!1;return!0}function Ug(e,t,i,o,n,s){if(Nl=s,Je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wl.current=e===null||e.memoizedState===null?NT:UT,e=i(o,n),Sl){s=0;do{if(Sl=!1,!(25>s))throw Error(Ot(301));s+=1,ci=wi=null,t.updateQueue=null,wl.current=zT,e=i(o,n)}while(Sl)}if(wl.current=Gh,t=wi!==null&&wi.next!==null,Nl=0,ci=wi=Je=null,Nh=!1,t)throw Error(Ot(300));return e}function Bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ci===null?Je.memoizedState=ci=e:ci=ci.next=e,ci}function Wo(){if(wi===null){var e=Je.alternate;e=e!==null?e.memoizedState:null}else e=wi.next;var t=ci===null?Je.memoizedState:ci.next;if(t!==null)ci=t,wi=e;else{if(e===null)throw Error(Ot(310));wi=e,e={memoizedState:wi.memoizedState,baseState:wi.baseState,baseQueue:wi.baseQueue,queue:wi.queue,next:null},ci===null?Je.memoizedState=ci=e:ci=ci.next=e}return ci}function br(e,t){return typeof t=="function"?t(e):t}function nl(e){var t=Wo(),i=t.queue;if(i===null)throw Error(Ot(311));i.lastRenderedReducer=e;var o=wi,n=o.baseQueue,s=i.pending;if(s!==null){if(n!==null){var r=n.next;n.next=s.next,s.next=r}o.baseQueue=n=s,i.pending=null}if(n!==null){n=n.next,o=o.baseState;var a=r=s=null,l=n;do{var u=l.lane;if((Nl&u)===u)a!==null&&(a=a.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),o=l.eagerReducer===e?l.eagerState:e(o,l.action);else{var c={lane:u,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};a===null?(r=a=c,s=o):a=a.next=c,Je.lanes|=u,Gl|=u}l=l.next}while(l!==null&&l!==n);a===null?s=o:a.next=r,Nn(o,t.memoizedState)||(cr=!0),t.memoizedState=o,t.baseState=s,t.baseQueue=a,i.lastRenderedState=o}return[t.memoizedState,i.dispatch]}function rl(e){var t=Wo(),i=t.queue;if(i===null)throw Error(Ot(311));i.lastRenderedReducer=e;var o=i.dispatch,n=i.pending,s=t.memoizedState;if(n!==null){i.pending=null;var r=n=n.next;do s=e(s,r.action),r=r.next;while(r!==n);Nn(s,t.memoizedState)||(cr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),i.lastRenderedState=s}return[s,o]}function o1(e,t,i){var o=t._getVersion;o=o(t._source);var n=t._workInProgressVersionPrimary;if(n!==null?e=n===o:(e=e.mutableReadLanes,(e=(Nl&e)===e)&&(t._workInProgressVersionPrimary=o,Ya.push(t))),e)return i(t._source);throw Ya.push(t),Error(Ot(350))}function OC(e,t,i,o){var n=Ri;if(n===null)throw Error(Ot(349));var s=t._getVersion,r=s(t._source),a=wl.current,l=a.useState(function(){return o1(n,t,i)}),u=l[1],c=l[0];l=ci;var h=e.memoizedState,d=h.refs,g=d.getSnapshot,m=h.source;h=h.subscribe;var y=Je;return e.memoizedState={refs:d,source:t,subscribe:o},a.useEffect(function(){d.getSnapshot=i,d.setSnapshot=u;var C=s(t._source);if(!Nn(r,C)){C=i(t._source),Nn(c,C)||(u(C),C=Hs(y),n.mutableReadLanes|=C&n.pendingLanes),C=n.mutableReadLanes,n.entangledLanes|=C;for(var w=n.entanglements,F=C;0<F;){var B=31-qs(F),U=1<<B;w[B]|=C,F&=~U}}},[i,t,o]),a.useEffect(function(){return o(t._source,function(){var C=d.getSnapshot,w=d.setSnapshot;try{w(C(t._source));var F=Hs(y);n.mutableReadLanes|=F&n.pendingLanes}catch(B){w(function(){throw B})}})},[t,o]),Nn(g,i)&&Nn(m,t)&&Nn(h,o)||(e={pending:null,dispatch:null,lastRenderedReducer:br,lastRenderedState:c},e.dispatch=u=Gg.bind(null,Je,e),l.queue=e,l.baseQueue=null,c=o1(n,t,i),l.memoizedState=l.baseState=c),c}function kC(e,t,i){var o=Wo();return OC(o,e,t,i)}function sl(e){var t=Bo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e=t.queue={pending:null,dispatch:null,lastRenderedReducer:br,lastRenderedState:e},e=e.dispatch=Gg.bind(null,Je,e),[t.memoizedState,e]}function Uh(e,t,i,o){return e={tag:e,create:t,destroy:i,deps:o,next:null},t=Je.updateQueue,t===null?(t={lastEffect:null},Je.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(o=i.next,i.next=e,e.next=o,t.lastEffect=e)),e}function a1(e){var t=Bo();return e={current:e},t.memoizedState=e}function zh(){return Wo().memoizedState}function Vp(e,t,i,o){var n=Bo();Je.flags|=e,n.memoizedState=Uh(1|t,i,void 0,o===void 0?null:o)}function zg(e,t,i,o){var n=Wo();o=o===void 0?null:o;var s=void 0;if(wi!==null){var r=wi.memoizedState;if(s=r.destroy,o!==null&&Ng(o,r.deps)){Uh(t,i,s,o);return}}Je.flags|=e,n.memoizedState=Uh(1|t,i,s,o)}function u1(e,t){return Vp(516,4,e,t)}function Wh(e,t){return zg(516,4,e,t)}function PC(e,t){return zg(4,2,e,t)}function IC(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function BC(e,t,i){return i=i!=null?i.concat([e]):null,zg(4,2,IC.bind(null,t,e),i)}function Wg(){}function LC(e,t){var i=Wo();t=t===void 0?null:t;var o=i.memoizedState;return o!==null&&t!==null&&Ng(t,o[1])?o[0]:(i.memoizedState=[e,t],e)}function MC(e,t){var i=Wo();t=t===void 0?null:t;var o=i.memoizedState;return o!==null&&t!==null&&Ng(t,o[1])?o[0]:(e=e(),i.memoizedState=[e,t],e)}function jT(e,t){var i=Qa();Ro(98>i?98:i,function(){e(!0)}),Ro(97<i?97:i,function(){var o=zn.transition;zn.transition=1;try{e(!1),t()}finally{zn.transition=o}})}function Gg(e,t,i){var o=Sn(),n=Hs(e),s={lane:n,action:i,eagerReducer:null,eagerState:null,next:null},r=t.pending;if(r===null?s.next=s:(s.next=r.next,r.next=s),t.pending=s,r=e.alternate,e===Je||r!==null&&r===Je)Sl=Nh=!0;else{if(e.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var a=t.lastRenderedState,l=r(a,i);if(s.eagerReducer=r,s.eagerState=l,Nn(l,a))return}catch{}finally{}Xs(e,n,o)}}var Gh={readContext:Wn,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useOpaqueIdentifier:nn,unstable_isNewReconciler:!1},NT={readContext:Wn,useCallback:function(e,t){return Bo().memoizedState=[e,t===void 0?null:t],e},useContext:Wn,useEffect:u1,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,Vp(4,2,IC.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Vp(4,2,e,t)},useMemo:function(e,t){var i=Bo();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var o=Bo();return t=i!==void 0?i(t):t,o.memoizedState=o.baseState=t,e=o.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},e=e.dispatch=Gg.bind(null,Je,e),[o.memoizedState,e]},useRef:a1,useState:sl,useDebugValue:Wg,useDeferredValue:function(e){var t=sl(e),i=t[0],o=t[1];return u1(function(){var n=zn.transition;zn.transition=1;try{o(e)}finally{zn.transition=n}},[e]),i},useTransition:function(){var e=sl(!1),t=e[0];return e=jT.bind(null,e[1]),a1(e),[e,t]},useMutableSource:function(e,t,i){var o=Bo();return o.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:i},OC(o,e,t,i)},useOpaqueIdentifier:function(){if(Tr){var e=!1,t=PT(function(){throw e||(e=!0,i("r:"+(fp++).toString(36))),Error(Ot(355))}),i=sl(t)[1];return!(Je.mode&2)&&(Je.flags|=516,Uh(5,function(){i("r:"+(fp++).toString(36))},void 0,null)),t}return t="r:"+(fp++).toString(36),sl(t),t},unstable_isNewReconciler:!1},UT={readContext:Wn,useCallback:LC,useContext:Wn,useEffect:Wh,useImperativeHandle:BC,useLayoutEffect:PC,useMemo:MC,useReducer:nl,useRef:zh,useState:function(){return nl(br)},useDebugValue:Wg,useDeferredValue:function(e){var t=nl(br),i=t[0],o=t[1];return Wh(function(){var n=zn.transition;zn.transition=1;try{o(e)}finally{zn.transition=n}},[e]),i},useTransition:function(){var e=nl(br)[0];return[zh().current,e]},useMutableSource:kC,useOpaqueIdentifier:function(){return nl(br)[0]},unstable_isNewReconciler:!1},zT={readContext:Wn,useCallback:LC,useContext:Wn,useEffect:Wh,useImperativeHandle:BC,useLayoutEffect:PC,useMemo:MC,useReducer:rl,useRef:zh,useState:function(){return rl(br)},useDebugValue:Wg,useDeferredValue:function(e){var t=rl(br),i=t[0],o=t[1];return Wh(function(){var n=zn.transition;zn.transition=1;try{o(e)}finally{zn.transition=n}},[e]),i},useTransition:function(){var e=rl(br)[0];return[zh().current,e]},useMutableSource:kC,useOpaqueIdentifier:function(){return rl(br)[0]},unstable_isNewReconciler:!1},WT=Uo.ReactCurrentOwner,cr=!1;function rn(e,t,i,o){t.child=e===null?TC(t,null,i,o):Rh(t,e.child,i,o)}function l1(e,t,i,o,n){i=i.render;var s=t.ref;return Xa(t,n),o=Ug(e,t,i,o,s,n),e!==null&&!cr?(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~n,os(e,t,n)):(t.flags|=1,rn(e,t,o,n),t.child)}function c1(e,t,i,o,n,s){if(e===null){var r=i.type;return typeof r=="function"&&!$g(r)&&r.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=r,RC(e,t,r,o,n,s)):(e=xh(i.type,null,o,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}return r=e.child,!(n&s)&&(n=r.memoizedProps,i=i.compare,i=i!==null?i:Il,i(n,o)&&e.ref===t.ref)?os(e,t,s):(t.flags|=1,e=Js(r,o),e.ref=t.ref,e.return=t,t.child=e)}function RC(e,t,i,o,n,s){if(e!==null&&Il(e.memoizedProps,o)&&e.ref===t.ref)if(cr=!1,(s&n)!==0)e.flags&16384&&(cr=!0);else return t.lanes=e.lanes,os(e,t,s);return qp(e,t,i,o,s)}function mp(e,t,i){var o=t.pendingProps,n=o.children,s=e!==null?e.memoizedState:null;if(o.mode==="hidden"||o.mode==="unstable-defer-without-hiding")if(!(t.mode&4))t.memoizedState={baseLanes:0},dh(t,i);else if(i&1073741824)t.memoizedState={baseLanes:0},dh(t,s!==null?s.baseLanes:i);else return e=s!==null?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},dh(t,e),null;else s!==null?(o=s.baseLanes|i,t.memoizedState=null):o=i,dh(t,o);return rn(e,t,n,i),t.child}function jC(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=128)}function qp(e,t,i,o,n){var s=on(i)?Mo:Di.current;return s=Ja(t,s),Xa(t,n),i=Ug(e,t,i,o,s,n),e!==null&&!cr?(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~n,os(e,t,n)):(t.flags|=1,rn(e,t,i,n),t.child)}function h1(e,t,i,o,n){if(on(i)){var s=!0;yh(t)}else s=!1;if(Xa(t,n),t.stateNode===null)e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),AC(t,i,o),Hp(t,i,o,n),o=!0;else if(e===null){var r=t.stateNode,a=t.memoizedProps;r.props=a;var l=r.context,u=i.contextType;typeof u=="object"&&u!==null?u=Wn(u):(u=on(i)?Mo:Di.current,u=Ja(t,u));var c=i.getDerivedStateFromProps,h=typeof c=="function"||typeof r.getSnapshotBeforeUpdate=="function";h||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==o||l!==u)&&i1(t,r,o,u),Bs=!1;var d=t.memoizedState;r.state=d,Ml(t,o,r,n),l=t.memoizedState,a!==o||d!==l||sn.current||Bs?(typeof c=="function"&&(Mh(t,i,c,o),l=t.memoizedState),(a=Bs||e1(t,i,a,o,d,l,u))?(h||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4)):(typeof r.componentDidMount=="function"&&(t.flags|=4),t.memoizedProps=o,t.memoizedState=l),r.props=o,r.state=l,r.context=u,o=a):(typeof r.componentDidMount=="function"&&(t.flags|=4),o=!1)}else{r=t.stateNode,DC(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:lr(t.type,a),r.props=u,h=t.pendingProps,d=r.context,l=i.contextType,typeof l=="object"&&l!==null?l=Wn(l):(l=on(i)?Mo:Di.current,l=Ja(t,l));var g=i.getDerivedStateFromProps;(c=typeof g=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==h||d!==l)&&i1(t,r,o,l),Bs=!1,d=t.memoizedState,r.state=d,Ml(t,o,r,n);var m=t.memoizedState;a!==h||d!==m||sn.current||Bs?(typeof g=="function"&&(Mh(t,i,g,o),m=t.memoizedState),(u=Bs||e1(t,i,u,o,d,m,l))?(c||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(o,m,l),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(o,m,l)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=256)):(typeof r.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=o,t.memoizedState=m),r.props=o,r.state=m,r.context=l,o=u):(typeof r.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),o=!1)}return $p(e,t,i,o,s,n)}function $p(e,t,i,o,n,s){jC(e,t);var r=(t.flags&64)!==0;if(!o&&!r)return n&&Ky(t,i,!1),os(e,t,s);o=t.stateNode,WT.current=t;var a=r&&typeof i.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&r?(t.child=Rh(t,e.child,null,s),t.child=Rh(t,null,a,s)):rn(e,t,a,s),t.memoizedState=o.state,n&&Ky(t,i,!0),t.child}function f1(e){var t=e.stateNode;t.pendingContext?$y(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$y(e,t.context,!1),Xp(e,t.containerInfo)}var fh={dehydrated:null,retryLane:0};function d1(e,t,i){var o=t.pendingProps,n=Ye.current,s=!1,r;return(r=(t.flags&64)!==0)||(r=e!==null&&e.memoizedState===null?!1:(n&2)!==0),r?(s=!0,t.flags&=-65):e!==null&&e.memoizedState===null||o.fallback===void 0||o.unstable_avoidThisFallback===!0||(n|=1),Ve(Ye,n&1),e===null?(o.fallback!==void 0&&Yp(t),e=o.children,n=o.fallback,s?(e=p1(t,e,n,i),t.child.memoizedState={baseLanes:i},t.memoizedState=fh,e):typeof o.unstable_expectedLoadTime=="number"?(e=p1(t,e,n,i),t.child.memoizedState={baseLanes:i},t.memoizedState=fh,t.lanes=33554432,e):(i=Kg({mode:"visible",children:e},t.mode,i,null),i.return=t,t.child=i)):e.memoizedState!==null?s?(o=m1(e,t,o.children,o.fallback,i),s=t.child,n=e.child.memoizedState,s.memoizedState=n===null?{baseLanes:i}:{baseLanes:n.baseLanes|i},s.childLanes=e.childLanes&~i,t.memoizedState=fh,o):(i=g1(e,t,o.children,i),t.memoizedState=null,i):s?(o=m1(e,t,o.children,o.fallback,i),s=t.child,n=e.child.memoizedState,s.memoizedState=n===null?{baseLanes:i}:{baseLanes:n.baseLanes|i},s.childLanes=e.childLanes&~i,t.memoizedState=fh,o):(i=g1(e,t,o.children,i),t.memoizedState=null,i)}function p1(e,t,i,o){var n=e.mode,s=e.child;return t={mode:"hidden",children:t},!(n&2)&&s!==null?(s.childLanes=0,s.pendingProps=t):s=Kg(t,n,0,null),i=$a(i,n,o,null),s.return=e,i.return=e,s.sibling=i,e.child=s,i}function g1(e,t,i,o){var n=e.child;return e=n.sibling,i=Js(n,{mode:"visible",children:i}),!(t.mode&2)&&(i.lanes=o),i.return=t,i.sibling=null,e!==null&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=i}function m1(e,t,i,o,n){var s=t.mode,r=e.child;e=r.sibling;var a={mode:"hidden",children:i};return!(s&2)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=a,r=i.lastEffect,r!==null?(t.firstEffect=i.firstEffect,t.lastEffect=r,r.nextEffect=null):t.firstEffect=t.lastEffect=null):i=Js(r,a),e!==null?o=Js(e,o):(o=$a(o,s,n,null),o.flags|=2),o.return=t,i.return=t,i.sibling=o,t.child=i,o}function v1(e,t){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),xC(e.return,t)}function vp(e,t,i,o,n,s){var r=e.memoizedState;r===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:i,tailMode:n,lastEffect:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=o,r.tail=i,r.tailMode=n,r.lastEffect=s)}function y1(e,t,i){var o=t.pendingProps,n=o.revealOrder,s=o.tail;if(rn(e,t,o.children,i),o=Ye.current,o&2)o=o&1|2,t.flags|=64;else{if(e!==null&&e.flags&64)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&v1(e,i);else if(e.tag===19)v1(e,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Ve(Ye,o),!(t.mode&2))t.memoizedState=null;else switch(n){case"forwards":for(i=t.child,n=null;i!==null;)e=i.alternate,e!==null&&jh(e)===null&&(n=i),i=i.sibling;i=n,i===null?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),vp(t,!1,n,i,s,t.lastEffect);break;case"backwards":for(i=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&jh(e)===null){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}vp(t,!0,i,null,s,t.lastEffect);break;case"together":vp(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function os(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Gl|=t.lanes,i&t.childLanes){if(e!==null&&t.child!==e.child)throw Error(Ot(153));if(t.child!==null){for(e=t.child,i=Js(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Js(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}return null}var NC,Kp,UC,zC;NC=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Kp=function(){};UC=function(e,t,i,o){var n=e.memoizedProps;if(n!==o){e=t.stateNode,Io(Er.current);var s=null;switch(i){case"input":n=xp(e,n),o=xp(e,o),s=[];break;case"option":n=Ap(e,n),o=Ap(e,o),s=[];break;case"select":n=je({},n,{value:void 0}),o=je({},o,{value:void 0}),s=[];break;case"textarea":n=Ep(e,n),o=Ep(e,o),s=[];break;default:typeof n.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Oh)}Op(i,o);var r;i=null;for(u in n)if(!o.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var a=n[u];for(r in a)a.hasOwnProperty(r)&&(i||(i={}),i[r]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Al.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in o){var l=o[u];if(a=n?.[u],o.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(r in a)!a.hasOwnProperty(r)||l&&l.hasOwnProperty(r)||(i||(i={}),i[r]="");for(r in l)l.hasOwnProperty(r)&&a[r]!==l[r]&&(i||(i={}),i[r]=l[r])}else i||(s||(s=[]),s.push(u,i)),i=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Al.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Me("scroll",e),s||a===l||(s=[])):typeof l=="object"&&l!==null&&l.$$typeof===mg?l.toString():(s=s||[]).push(u,l))}i&&(s=s||[]).push("style",i);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};zC=function(e,t,i,o){i!==o&&(t.flags|=4)};function ol(e,t){if(!Tr)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function GT(e,t,i){var o=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return on(t.type)&&Ph(),null;case 3:return Za(),Re(sn),Re(Di),jg(),o=t.stateNode,o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(hh(t)?t.flags|=4:o.hydrate||(t.flags|=256)),Kp(t),null;case 5:Rg(t);var n=Io(jl.current);if(i=t.type,e!==null&&t.stateNode!=null)UC(e,t,i,o,n),e.ref!==t.ref&&(t.flags|=128);else{if(!o){if(t.stateNode===null)throw Error(Ot(166));return null}if(e=Io(Er.current),hh(t)){o=t.stateNode,i=t.type;var s=t.memoizedProps;switch(o[Rs]=t,o[kh]=s,i){case"dialog":Me("cancel",o),Me("close",o);break;case"iframe":case"object":case"embed":Me("load",o);break;case"video":case"audio":for(e=0;e<hl.length;e++)Me(hl[e],o);break;case"source":Me("error",o);break;case"img":case"image":case"link":Me("error",o),Me("load",o);break;case"details":Me("toggle",o);break;case"input":_y(o,s),Me("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!s.multiple},Me("invalid",o);break;case"textarea":Sy(o,s),Me("invalid",o)}Op(i,s),e=null;for(var r in s)s.hasOwnProperty(r)&&(n=s[r],r==="children"?typeof n=="string"?o.textContent!==n&&(e=["children",n]):typeof n=="number"&&o.textContent!==""+n&&(e=["children",""+n]):Al.hasOwnProperty(r)&&n!=null&&r==="onScroll"&&Me("scroll",o));switch(i){case"input":ih(o),wy(o,s,!0);break;case"textarea":ih(o),xy(o);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(o.onclick=Oh)}o=e,t.updateQueue=o,o!==null&&(t.flags|=4)}else{switch(r=n.nodeType===9?n:n.ownerDocument,e===Tp.html&&(e=B1(i)),e===Tp.html?i==="script"?(e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=r.createElement(i,{is:o.is}):(e=r.createElement(i),i==="select"&&(r=e,o.multiple?r.multiple=!0:o.size&&(r.size=o.size))):e=r.createElementNS(e,i),e[Rs]=t,e[kh]=o,NC(e,t,!1,!1),t.stateNode=e,r=kp(i,o),i){case"dialog":Me("cancel",e),Me("close",e),n=o;break;case"iframe":case"object":case"embed":Me("load",e),n=o;break;case"video":case"audio":for(n=0;n<hl.length;n++)Me(hl[n],e);n=o;break;case"source":Me("error",e),n=o;break;case"img":case"image":case"link":Me("error",e),Me("load",e),n=o;break;case"details":Me("toggle",e),n=o;break;case"input":_y(e,o),n=xp(e,o),Me("invalid",e);break;case"option":n=Ap(e,o);break;case"select":e._wrapperState={wasMultiple:!!o.multiple},n=je({},o,{value:void 0}),Me("invalid",e);break;case"textarea":Sy(e,o),n=Ep(e,o),Me("invalid",e);break;default:n=o}Op(i,n);var a=n;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?R1(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&L1(e,l)):s==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&El(e,l):typeof l=="number"&&El(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Al.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Me("scroll",e):l!=null&&cg(e,s,l,r))}switch(i){case"input":ih(e),wy(e,o,!1);break;case"textarea":ih(e),xy(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Vs(o.value));break;case"select":e.multiple=!!o.multiple,s=o.value,s!=null?za(e,!!o.multiple,s,!1):o.defaultValue!=null&&za(e,!!o.multiple,o.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=Oh)}pC(i,o)&&(t.flags|=4)}t.ref!==null&&(t.flags|=128)}return null;case 6:if(e&&t.stateNode!=null)zC(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(Ot(166));i=Io(jl.current),Io(Er.current),hh(t)?(o=t.stateNode,i=t.memoizedProps,o[Rs]=t,o.nodeValue!==i&&(t.flags|=4)):(o=(i.nodeType===9?i:i.ownerDocument).createTextNode(o),o[Rs]=t,t.stateNode=o)}return null;case 13:return Re(Ye),o=t.memoizedState,t.flags&64?(t.lanes=i,t):(o=o!==null,i=!1,e===null?t.memoizedProps.fallback!==void 0&&hh(t):i=e.memoizedState!==null,o&&!i&&t.mode&2&&(e===null&&t.memoizedProps.unstable_avoidThisFallback!==!0||Ye.current&1?hi===0&&(hi=3):((hi===0||hi===3)&&(hi=4),Ri===null||!(Gl&134217727)&&!(nu&134217727)||Va(Ri,xi))),(o||i)&&(t.flags|=4),null);case 4:return Za(),Kp(t),e===null&&hC(t.stateNode.containerInfo),null;case 10:return Lg(t),null;case 17:return on(t.type)&&Ph(),null;case 19:if(Re(Ye),o=t.memoizedState,o===null)return null;if(s=(t.flags&64)!==0,r=o.rendering,r===null)if(s)ol(o,!1);else{if(hi!==0||e!==null&&e.flags&64)for(e=t.child;e!==null;){if(r=jh(e),r!==null){for(t.flags|=64,ol(o,!1),s=r.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),o.lastEffect===null&&(t.firstEffect=null),t.lastEffect=o.lastEffect,o=i,i=t.child;i!==null;)s=i,e=o,s.flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,r=s.alternate,r===null?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=r.childLanes,s.lanes=r.lanes,s.child=r.child,s.memoizedProps=r.memoizedProps,s.memoizedState=r.memoizedState,s.updateQueue=r.updateQueue,s.type=r.type,e=r.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Ve(Ye,Ye.current&1|2),t.child}e=e.sibling}o.tail!==null&&Si()>ig&&(t.flags|=64,s=!0,ol(o,!1),t.lanes=33554432)}else{if(!s)if(e=jh(r),e!==null){if(t.flags|=64,s=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),ol(o,!0),o.tail===null&&o.tailMode==="hidden"&&!r.alternate&&!Tr)return t=t.lastEffect=o.lastEffect,t!==null&&(t.nextEffect=null),null}else 2*Si()-o.renderingStartTime>ig&&i!==1073741824&&(t.flags|=64,s=!0,ol(o,!1),t.lanes=33554432);o.isBackwards?(r.sibling=t.child,t.child=r):(i=o.last,i!==null?i.sibling=r:t.child=r,o.last=r)}return o.tail!==null?(i=o.tail,o.rendering=i,o.tail=i.sibling,o.lastEffect=t.lastEffect,o.renderingStartTime=Si(),i.sibling=null,t=Ye.current,Ve(Ye,s?t&1|2:t&1),i):null;case 23:case 24:return qg(),e!==null&&e.memoizedState!==null!=(t.memoizedState!==null)&&o.mode!=="unstable-defer-without-hiding"&&(t.flags|=4),null}throw Error(Ot(156,t.tag))}function HT(e){switch(e.tag){case 1:on(e.type)&&Ph();var t=e.flags;return t&4096?(e.flags=t&-4097|64,e):null;case 3:if(Za(),Re(sn),Re(Di),jg(),t=e.flags,t&64)throw Error(Ot(285));return e.flags=t&-4097|64,e;case 5:return Rg(e),null;case 13:return Re(Ye),t=e.flags,t&4096?(e.flags=t&-4097|64,e):null;case 19:return Re(Ye),null;case 4:return Za(),null;case 10:return Lg(e),null;case 23:case 24:return qg(),null;default:return null}}function Hg(e,t){try{var i="",o=t;do i+=DE(o),o=o.return;while(o);var n=i}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n}}function Jp(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var XT=typeof WeakMap=="function"?WeakMap:Map;function WC(e,t,i){i=Ws(-1,i),i.tag=3,i.payload={element:null};var o=t.value;return i.callback=function(){Xh||(Xh=!0,ng=o),Jp(e,t)},i}function GC(e,t,i){i=Ws(-1,i),i.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var n=t.value;i.payload=function(){return Jp(e,t),o(n)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){typeof o!="function"&&(Ar===null?Ar=new Set([this]):Ar.add(this),Jp(e,t));var r=t.stack;this.componentDidCatch(t.value,{componentStack:r!==null?r:""})}),i}var YT=typeof WeakSet=="function"?WeakSet:Set;function C1(e){var t=e.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Ys(e,i)}else t.current=null}function VT(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(t.flags&256&&e!==null){var i=e.memoizedProps,o=e.memoizedState;e=t.stateNode,t=e.getSnapshotBeforeUpdate(t.elementType===t.type?i:lr(t.type,i),o),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:t.flags&256&&kg(t.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(Ot(163))}function qT(e,t,i){switch(i.tag){case 0:case 11:case 15:case 22:if(t=i.updateQueue,t=t!==null?t.lastEffect:null,t!==null){e=t=t.next;do{if((e.tag&3)===3){var o=e.create;e.destroy=o()}e=e.next}while(e!==t)}if(t=i.updateQueue,t=t!==null?t.lastEffect:null,t!==null){e=t=t.next;do{var n=e;o=n.next,n=n.tag,n&4&&n&1&&(QC(i,e),iF(i,e)),e=o}while(e!==t)}return;case 1:e=i.stateNode,i.flags&4&&(t===null?e.componentDidMount():(o=i.elementType===i.type?t.memoizedProps:lr(i.type,t.memoizedProps),e.componentDidUpdate(o,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),t=i.updateQueue,t!==null&&t1(i,t,e);return;case 3:if(t=i.updateQueue,t!==null){if(e=null,i.child!==null)switch(i.child.tag){case 5:e=i.child.stateNode;break;case 1:e=i.child.stateNode}t1(i,t,e)}return;case 5:e=i.stateNode,t===null&&i.flags&4&&pC(i.type,i.memoizedProps)&&e.focus();return;case 6:return;case 4:return;case 12:return;case 13:i.memoizedState===null&&(i=i.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&V1(i))));return;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(Ot(163))}function _1(e,t){for(var i=e;;){if(i.tag===5){var o=i.stateNode;if(t)o=o.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none";else{o=i.stateNode;var n=i.memoizedProps.style;n=n!=null&&n.hasOwnProperty("display")?n.display:null,o.style.display=M1("display",n)}}else if(i.tag===6)i.stateNode.nodeValue=t?"":i.memoizedProps;else if((i.tag!==23&&i.tag!==24||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function w1(e,t){if(Lo&&typeof Lo.onCommitFiberUnmount=="function")try{Lo.onCommitFiberUnmount(Pg,t)}catch{}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(e=t.updateQueue,e!==null&&(e=e.lastEffect,e!==null)){var i=e=e.next;do{var o=i,n=o.destroy;if(o=o.tag,n!==void 0)if(o&4)QC(t,i);else{o=t;try{n()}catch(s){Ys(o,s)}}i=i.next}while(i!==e)}break;case 1:if(C1(t),e=t.stateNode,typeof e.componentWillUnmount=="function")try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(s){Ys(t,s)}break;case 5:C1(t);break;case 4:HC(e,t)}}function S1(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function x1(e){return e.tag===5||e.tag===3||e.tag===4}function D1(e){t:{for(var t=e.return;t!==null;){if(x1(t))break t;t=t.return}throw Error(Ot(160))}var i=t;switch(t=i.stateNode,i.tag){case 5:var o=!1;break;case 3:t=t.containerInfo,o=!0;break;case 4:t=t.containerInfo,o=!0;break;default:throw Error(Ot(161))}i.flags&16&&(El(t,""),i.flags&=-17);t:e:for(i=e;;){for(;i.sibling===null;){if(i.return===null||x1(i.return)){i=null;break t}i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2)){i=i.stateNode;break t}}o?Qp(e,i,t):Zp(e,i,t)}function Qp(e,t,i){var o=e.tag,n=o===5||o===6;if(n)e=n?e.stateNode:e.stateNode.instance,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Oh));else if(o!==4&&(e=e.child,e!==null))for(Qp(e,t,i),e=e.sibling;e!==null;)Qp(e,t,i),e=e.sibling}function Zp(e,t,i){var o=e.tag,n=o===5||o===6;if(n)e=n?e.stateNode:e.stateNode.instance,t?i.insertBefore(e,t):i.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(Zp(e,t,i),e=e.sibling;e!==null;)Zp(e,t,i),e=e.sibling}function HC(e,t){for(var i=t,o=!1,n,s;;){if(!o){o=i.return;t:for(;;){if(o===null)throw Error(Ot(160));switch(n=o.stateNode,o.tag){case 5:s=!1;break t;case 3:n=n.containerInfo,s=!0;break t;case 4:n=n.containerInfo,s=!0;break t}o=o.return}o=!0}if(i.tag===5||i.tag===6){t:for(var r=e,a=i,l=a;;)if(w1(r,l),l.child!==null&&l.tag!==4)l.child.return=l,l=l.child;else{if(l===a)break t;for(;l.sibling===null;){if(l.return===null||l.return===a)break t;l=l.return}l.sibling.return=l.return,l=l.sibling}s?(r=n,a=i.stateNode,r.nodeType===8?r.parentNode.removeChild(a):r.removeChild(a)):n.removeChild(i.stateNode)}else if(i.tag===4){if(i.child!==null){n=i.stateNode.containerInfo,s=!0,i.child.return=i,i=i.child;continue}}else if(w1(e,i),i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return,i.tag===4&&(o=!1)}i.sibling.return=i.return,i=i.sibling}}function yp(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do(o.tag&3)===3&&(e=o.destroy,o.destroy=void 0,e!==void 0&&e()),o=o.next;while(o!==i)}return;case 1:return;case 5:if(i=t.stateNode,i!=null){o=t.memoizedProps;var n=e!==null?e.memoizedProps:o;e=t.type;var s=t.updateQueue;if(t.updateQueue=null,s!==null){for(i[kh]=o,e==="input"&&o.type==="radio"&&o.name!=null&&P1(i,o),kp(e,n),t=kp(e,o),n=0;n<s.length;n+=2){var r=s[n],a=s[n+1];r==="style"?R1(i,a):r==="dangerouslySetInnerHTML"?L1(i,a):r==="children"?El(i,a):cg(i,r,a,t)}switch(e){case"input":Dp(i,o);break;case"textarea":I1(i,o);break;case"select":e=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!o.multiple,s=o.value,s!=null?za(i,!!o.multiple,s,!1):e!==!!o.multiple&&(o.defaultValue!=null?za(i,!!o.multiple,o.defaultValue,!0):za(i,!!o.multiple,o.multiple?[]:"",!1))}}}return;case 6:if(t.stateNode===null)throw Error(Ot(162));t.stateNode.nodeValue=t.memoizedProps;return;case 3:i=t.stateNode,i.hydrate&&(i.hydrate=!1,V1(i.containerInfo));return;case 12:return;case 13:t.memoizedState!==null&&(Vg=Si(),_1(t.child,!0)),b1(t);return;case 19:b1(t);return;case 17:return;case 23:case 24:_1(t,t.memoizedState!==null);return}throw Error(Ot(163))}function b1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new YT),t.forEach(function(o){var n=sF.bind(null,e,o);i.has(o)||(i.add(o),o.then(n,n))})}}function $T(e,t){return e!==null&&(e=e.memoizedState,e===null||e.dehydrated!==null)?(t=t.memoizedState,t!==null&&t.dehydrated===null):!1}var KT=Math.ceil,Hh=Uo.ReactCurrentDispatcher,Xg=Uo.ReactCurrentOwner,Zt=0,Ri=null,ei=null,xi=0,jo=0,tg=Qs(0),hi=0,sf=null,iu=0,Gl=0,nu=0,Yg=0,eg=null,Vg=0,ig=1/0;function ru(){ig=Si()+500}var zt=null,Xh=!1,ng=null,Ar=null,Ks=!1,xl=null,fl=90,rg=[],sg=[],as=null,Dl=0,og=null,_h=-1,rs=0,wh=0,bl=null,Sh=!1;function Sn(){return Zt&48?Si():_h!==-1?_h:_h=Si()}function Hs(e){if(e=e.mode,!(e&2))return 1;if(!(e&4))return Qa()===99?1:2;if(rs===0&&(rs=iu),RT.transition!==0){wh!==0&&(wh=eg!==null?eg.pendingLanes:0),e=rs;var t=4186112&~wh;return t&=-t,t===0&&(e=4186112&~e,t=e&-e,t===0&&(t=8192)),t}return e=Qa(),Zt&4&&e===98?e=Th(12,rs):(e=UE(e),e=Th(e,rs)),e}function Xs(e,t,i){if(50<Dl)throw Dl=0,og=null,Error(Ot(185));if(e=of(e,t),e===null)return null;Jh(e,t,i),e===Ri&&(nu|=t,hi===4&&Va(e,xi));var o=Qa();t===1?Zt&8&&!(Zt&48)?ag(e):(Gn(e,i),Zt===0&&(ru(),Fr())):(!(Zt&4)||o!==98&&o!==99||(as===null?as=new Set([e]):as.add(e)),Gn(e,i)),eg=e}function of(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}function Gn(e,t){for(var i=e.callbackNode,o=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes;0<r;){var a=31-qs(r),l=1<<a,u=s[a];if(u===-1){if(!(l&o)||l&n){u=t,Pa(l);var c=Be;s[a]=10<=c?u+250:6<=c?u+5e3:-1}}else u<=t&&(e.expiredLanes|=l);r&=~l}if(o=kl(e,e===Ri?xi:0),t=Be,o===0)i!==null&&(i!==dp&&Wp(i),e.callbackNode=null,e.callbackPriority=0);else{if(i!==null){if(e.callbackPriority===t)return;i!==dp&&Wp(i)}t===15?(i=ag.bind(null,e),ns===null?(ns=[i],Ch=Ig(nf,SC)):ns.push(i),i=dp):t===14?i=Ll(99,ag.bind(null,e)):(i=zE(t),i=Ll(i,XC.bind(null,e))),e.callbackPriority=t,e.callbackNode=i}}function XC(e){if(_h=-1,wh=rs=0,Zt&48)throw Error(Ot(327));var t=e.callbackNode;if(Zs()&&e.callbackNode!==t)return null;var i=kl(e,e===Ri?xi:0);if(i===0)return null;var o=i,n=Zt;Zt|=16;var s=$C();(Ri!==e||xi!==o)&&(ru(),qa(e,o));do try{ZT();break}catch(a){qC(e,a)}while(1);if(Bg(),Hh.current=s,Zt=n,ei!==null?o=0:(Ri=null,xi=0,o=hi),iu&nu)qa(e,0);else if(o!==0){if(o===2&&(Zt|=64,e.hydrate&&(e.hydrate=!1,kg(e.containerInfo)),i=tC(e),i!==0&&(o=dl(e,i))),o===1)throw t=sf,qa(e,0),Va(e,i),Gn(e,Si()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=i,o){case 0:case 1:throw Error(Ot(345));case 2:Fo(e);break;case 3:if(Va(e,i),(i&62914560)===i&&(o=Vg+500-Si(),10<o)){if(kl(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){Sn(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=Yy(Fo.bind(null,e),o);break}Fo(e);break;case 4:if(Va(e,i),(i&4186112)===i)break;for(o=e.eventTimes,n=-1;0<i;){var r=31-qs(i);s=1<<r,r=o[r],r>n&&(n=r),i&=~s}if(i=n,i=Si()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*KT(i/1960))-i,10<i){e.timeoutHandle=Yy(Fo.bind(null,e),i);break}Fo(e);break;case 5:Fo(e);break;default:throw Error(Ot(329))}}return Gn(e,Si()),e.callbackNode===t?XC.bind(null,e):null}function Va(e,t){for(t&=~Yg,t&=~nu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-qs(t),o=1<<i;e[i]=-1,t&=~o}}function ag(e){if(Zt&48)throw Error(Ot(327));if(Zs(),e===Ri&&e.expiredLanes&xi){var t=xi,i=dl(e,t);iu&nu&&(t=kl(e,t),i=dl(e,t))}else t=kl(e,0),i=dl(e,t);if(e.tag!==0&&i===2&&(Zt|=64,e.hydrate&&(e.hydrate=!1,kg(e.containerInfo)),t=tC(e),t!==0&&(i=dl(e,t))),i===1)throw i=sf,qa(e,0),Va(e,t),Gn(e,Si()),i;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Fo(e),Gn(e,Si()),null}function JT(){if(as!==null){var e=as;as=null,e.forEach(function(t){t.expiredLanes|=24&t.pendingLanes,Gn(t,Si())})}Fr()}function YC(e,t){var i=Zt;Zt|=1;try{return e(t)}finally{Zt=i,Zt===0&&(ru(),Fr())}}function VC(e,t){var i=Zt;Zt&=-2,Zt|=8;try{return e(t)}finally{Zt=i,Zt===0&&(ru(),Fr())}}function dh(e,t){Ve(tg,jo),jo|=t,iu|=t}function qg(){jo=tg.current,Re(tg)}function qa(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,kT(i)),ei!==null)for(i=ei.return;i!==null;){var o=i;switch(o.tag){case 1:o=o.type.childContextTypes,o!=null&&Ph();break;case 3:Za(),Re(sn),Re(Di),jg();break;case 5:Rg(o);break;case 4:Za();break;case 13:Re(Ye);break;case 19:Re(Ye);break;case 10:Lg(o);break;case 23:case 24:qg()}i=i.return}Ri=e,ei=Js(e.current,null),xi=jo=iu=t,hi=0,sf=null,Yg=nu=Gl=0}function qC(e,t){do{var i=ei;try{if(Bg(),wl.current=Gh,Nh){for(var o=Je.memoizedState;o!==null;){var n=o.queue;n!==null&&(n.pending=null),o=o.next}Nh=!1}if(Nl=0,ci=wi=Je=null,Sl=!1,Xg.current=null,i===null||i.return===null){hi=1,sf=t,ei=null;break}t:{var s=e,r=i.return,a=i,l=t;if(t=xi,a.flags|=2048,a.firstEffect=a.lastEffect=null,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l;if(!(a.mode&2)){var c=a.alternate;c?(a.updateQueue=c.updateQueue,a.memoizedState=c.memoizedState,a.lanes=c.lanes):(a.updateQueue=null,a.memoizedState=null)}var h=(Ye.current&1)!==0,d=r;do{var g;if(g=d.tag===13){var m=d.memoizedState;if(m!==null)g=m.dehydrated!==null;else{var y=d.memoizedProps;g=y.fallback===void 0?!1:y.unstable_avoidThisFallback!==!0?!0:!h}}if(g){var C=d.updateQueue;if(C===null){var w=new Set;w.add(u),d.updateQueue=w}else C.add(u);if(!(d.mode&2)){if(d.flags|=64,a.flags|=16384,a.flags&=-2981,a.tag===1)if(a.alternate===null)a.tag=17;else{var F=Ws(-1,1);F.tag=2,Gs(a,F)}a.lanes|=1;break t}l=void 0,a=t;var B=s.pingCache;if(B===null?(B=s.pingCache=new XT,l=new Set,B.set(u,l)):(l=B.get(u),l===void 0&&(l=new Set,B.set(u,l))),!l.has(a)){l.add(a);var U=rF.bind(null,s,u,a);u.then(U,U)}d.flags|=4096,d.lanes=t;break t}d=d.return}while(d!==null);l=Error((Ua(a.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`)}hi!==5&&(hi=2),l=Hg(l,a),d=r;do{switch(d.tag){case 3:s=l,d.flags|=4096,t&=-t,d.lanes|=t;var R=WC(d,s,t);Zy(d,R);break t;case 1:s=l;var W=d.type,X=d.stateNode;if(!(d.flags&64)&&(typeof W.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(Ar===null||!Ar.has(X)))){d.flags|=4096,t&=-t,d.lanes|=t;var $=GC(d,s,t);Zy(d,$);break t}}d=d.return}while(d!==null)}JC(i)}catch(st){t=st,ei===i&&i!==null&&(ei=i=i.return);continue}break}while(1)}function $C(){var e=Hh.current;return Hh.current=Gh,e===null?Gh:e}function dl(e,t){var i=Zt;Zt|=16;var o=$C();Ri===e&&xi===t||qa(e,t);do try{QT();break}catch(n){qC(e,n)}while(1);if(Bg(),Zt=i,Hh.current=o,ei!==null)throw Error(Ot(261));return Ri=null,xi=0,hi}function QT(){for(;ei!==null;)KC(ei)}function ZT(){for(;ei!==null&&!BT();)KC(ei)}function KC(e){var t=ZC(e.alternate,e,jo);e.memoizedProps=e.pendingProps,t===null?JC(e):ei=t,Xg.current=null}function JC(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&2048){if(i=HT(t),i!==null){i.flags&=2047,ei=i;return}e!==null&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(i=GT(i,t,jo),i!==null){ei=i;return}if(i=t,i.tag!==24&&i.tag!==23||i.memoizedState===null||jo&1073741824||!(i.mode&4)){for(var o=0,n=i.child;n!==null;)o|=n.lanes|n.childLanes,n=n.sibling;i.childLanes=o}e!==null&&!(e.flags&2048)&&(e.firstEffect===null&&(e.firstEffect=t.firstEffect),t.lastEffect!==null&&(e.lastEffect!==null&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(e.lastEffect!==null?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(t=t.sibling,t!==null){ei=t;return}ei=t=e}while(t!==null);hi===0&&(hi=5)}function Fo(e){var t=Qa();return Ro(99,tF.bind(null,e,t)),null}function tF(e,t){do Zs();while(xl!==null);if(Zt&48)throw Error(Ot(327));var i=e.finishedWork;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(Ot(177));e.callbackNode=null;var o=i.lanes|i.childLanes,n=o,s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;for(var r=e.eventTimes,a=e.expirationTimes;0<s;){var l=31-qs(s),u=1<<l;n[l]=0,r[l]=-1,a[l]=-1,s&=~u}if(as!==null&&!(o&24)&&as.has(e)&&as.delete(e),e===Ri&&(ei=Ri=null,xi=0),1<i.flags?i.lastEffect!==null?(i.lastEffect.nextEffect=i,o=i.firstEffect):o=i:o=i.firstEffect,o!==null){if(n=Zt,Zt|=32,Xg.current=null,cp=gh,r=Uy(),Rp(r)){if("selectionStart"in r)a={start:r.selectionStart,end:r.selectionEnd};else t:if(a=(a=r.ownerDocument)&&a.defaultView||window,(u=a.getSelection&&a.getSelection())&&u.rangeCount!==0){a=u.anchorNode,s=u.anchorOffset,l=u.focusNode,u=u.focusOffset;try{a.nodeType,l.nodeType}catch{a=null;break t}var c=0,h=-1,d=-1,g=0,m=0,y=r,C=null;e:for(;;){for(var w;y!==a||s!==0&&y.nodeType!==3||(h=c+s),y!==l||u!==0&&y.nodeType!==3||(d=c+u),y.nodeType===3&&(c+=y.nodeValue.length),(w=y.firstChild)!==null;)C=y,y=w;for(;;){if(y===r)break e;if(C===a&&++g===s&&(h=c),C===l&&++m===u&&(d=c),(w=y.nextSibling)!==null)break;y=C,C=y.parentNode}y=w}a=h===-1||d===-1?null:{start:h,end:d}}else a=null;a=a||{start:0,end:0}}else a=null;hp={focusedElem:r,selectionRange:a},gh=!1,bl=null,Sh=!1,zt=o;do try{eF()}catch(st){if(zt===null)throw Error(Ot(330));Ys(zt,st),zt=zt.nextEffect}while(zt!==null);bl=null,zt=o;do try{for(r=e;zt!==null;){var F=zt.flags;if(F&16&&El(zt.stateNode,""),F&128){var B=zt.alternate;if(B!==null){var U=B.ref;U!==null&&(typeof U=="function"?U(null):U.current=null)}}switch(F&1038){case 2:D1(zt),zt.flags&=-3;break;case 6:D1(zt),zt.flags&=-3,yp(zt.alternate,zt);break;case 1024:zt.flags&=-1025;break;case 1028:zt.flags&=-1025,yp(zt.alternate,zt);break;case 4:yp(zt.alternate,zt);break;case 8:a=zt,HC(r,a);var R=a.alternate;S1(a),R!==null&&S1(R)}zt=zt.nextEffect}}catch(st){if(zt===null)throw Error(Ot(330));Ys(zt,st),zt=zt.nextEffect}while(zt!==null);if(U=hp,B=Uy(),F=U.focusedElem,r=U.selectionRange,B!==F&&F&&F.ownerDocument&&uC(F.ownerDocument.documentElement,F)){for(r!==null&&Rp(F)&&(B=r.start,U=r.end,U===void 0&&(U=B),"selectionStart"in F?(F.selectionStart=B,F.selectionEnd=Math.min(U,F.value.length)):(U=(B=F.ownerDocument||document)&&B.defaultView||window,U.getSelection&&(U=U.getSelection(),a=F.textContent.length,R=Math.min(r.start,a),r=r.end===void 0?R:Math.min(r.end,a),!U.extend&&R>r&&(a=r,r=R,R=a),a=Ny(F,R),s=Ny(F,r),a&&s&&(U.rangeCount!==1||U.anchorNode!==a.node||U.anchorOffset!==a.offset||U.focusNode!==s.node||U.focusOffset!==s.offset)&&(B=B.createRange(),B.setStart(a.node,a.offset),U.removeAllRanges(),R>r?(U.addRange(B),U.extend(s.node,s.offset)):(B.setEnd(s.node,s.offset),U.addRange(B)))))),B=[],U=F;U=U.parentNode;)U.nodeType===1&&B.push({element:U,left:U.scrollLeft,top:U.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<B.length;F++)U=B[F],U.element.scrollLeft=U.left,U.element.scrollTop=U.top}gh=!!cp,hp=cp=null,e.current=i,zt=o;do try{for(F=e;zt!==null;){var W=zt.flags;if(W&36&&qT(F,zt.alternate,zt),W&128){B=void 0;var X=zt.ref;if(X!==null){var $=zt.stateNode;switch(zt.tag){case 5:B=$;break;default:B=$}typeof X=="function"?X(B):X.current=B}}zt=zt.nextEffect}}catch(st){if(zt===null)throw Error(Ot(330));Ys(zt,st),zt=zt.nextEffect}while(zt!==null);zt=null,MT(),Zt=n}else e.current=i;if(Ks)Ks=!1,xl=e,fl=t;else for(zt=o;zt!==null;)t=zt.nextEffect,zt.nextEffect=null,zt.flags&8&&(W=zt,W.sibling=null,W.stateNode=null),zt=t;if(o=e.pendingLanes,o===0&&(Ar=null),o===1?e===og?Dl++:(Dl=0,og=e):Dl=0,i=i.stateNode,Lo&&typeof Lo.onCommitFiberRoot=="function")try{Lo.onCommitFiberRoot(Pg,i,void 0,(i.current.flags&64)===64)}catch{}if(Gn(e,Si()),Xh)throw Xh=!1,e=ng,ng=null,e;return Zt&8||Fr(),null}function eF(){for(;zt!==null;){var e=zt.alternate;Sh||bl===null||(zt.flags&8?Ay(zt,bl)&&(Sh=!0):zt.tag===13&&$T(e,zt)&&Ay(zt,bl)&&(Sh=!0));var t=zt.flags;t&256&&VT(e,zt),!(t&512)||Ks||(Ks=!0,Ll(97,function(){return Zs(),null})),zt=zt.nextEffect}}function Zs(){if(fl!==90){var e=97<fl?97:fl;return fl=90,Ro(e,nF)}return!1}function iF(e,t){rg.push(t,e),Ks||(Ks=!0,Ll(97,function(){return Zs(),null}))}function QC(e,t){sg.push(t,e),Ks||(Ks=!0,Ll(97,function(){return Zs(),null}))}function nF(){if(xl===null)return!1;var e=xl;if(xl=null,Zt&48)throw Error(Ot(331));var t=Zt;Zt|=32;var i=sg;sg=[];for(var o=0;o<i.length;o+=2){var n=i[o],s=i[o+1],r=n.destroy;if(n.destroy=void 0,typeof r=="function")try{r()}catch(l){if(s===null)throw Error(Ot(330));Ys(s,l)}}for(i=rg,rg=[],o=0;o<i.length;o+=2){n=i[o],s=i[o+1];try{var a=n.create;n.destroy=a()}catch(l){if(s===null)throw Error(Ot(330));Ys(s,l)}}for(a=e.current.firstEffect;a!==null;)e=a.nextEffect,a.nextEffect=null,a.flags&8&&(a.sibling=null,a.stateNode=null),a=e;return Zt=t,Fr(),!0}function A1(e,t,i){t=Hg(i,t),t=WC(e,t,1),Gs(e,t),t=Sn(),e=of(e,1),e!==null&&(Jh(e,1,t),Gn(e,t))}function Ys(e,t){if(e.tag===3)A1(e,e,t);else for(var i=e.return;i!==null;){if(i.tag===3){A1(i,e,t);break}else if(i.tag===1){var o=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ar===null||!Ar.has(o))){e=Hg(t,e);var n=GC(i,e,1);if(Gs(i,n),n=Sn(),i=of(i,1),i!==null)Jh(i,1,n),Gn(i,n);else if(typeof o.componentDidCatch=="function"&&(Ar===null||!Ar.has(o)))try{o.componentDidCatch(t,e)}catch{}break}}i=i.return}}function rF(e,t,i){var o=e.pingCache;o!==null&&o.delete(t),t=Sn(),e.pingedLanes|=e.suspendedLanes&i,Ri===e&&(xi&i)===i&&(hi===4||hi===3&&(xi&62914560)===xi&&500>Si()-Vg?qa(e,0):Yg|=i),Gn(e,t)}function sF(e,t){var i=e.stateNode;i!==null&&i.delete(t),t=0,t===0&&(t=e.mode,t&2?t&4?(rs===0&&(rs=iu),t=Ia(62914560&~rs),t===0&&(t=4194304)):t=Qa()===99?1:2:t=1),i=Sn(),e=of(e,t),e!==null&&(Jh(e,t,i),Gn(e,i))}var ZC;ZC=function(e,t,i){var o=t.lanes;if(e!==null)if(e.memoizedProps!==t.pendingProps||sn.current)cr=!0;else if(i&o)cr=!!(e.flags&16384);else{switch(cr=!1,t.tag){case 3:f1(t),gp();break;case 5:n1(t);break;case 1:on(t.type)&&yh(t);break;case 4:Xp(t,t.stateNode.containerInfo);break;case 10:o=t.memoizedProps.value;var n=t.type._context;Ve(Ih,n._currentValue),n._currentValue=o;break;case 13:if(t.memoizedState!==null)return i&t.child.childLanes?d1(e,t,i):(Ve(Ye,Ye.current&1),t=os(e,t,i),t!==null?t.sibling:null);Ve(Ye,Ye.current&1);break;case 19:if(o=(i&t.childLanes)!==0,e.flags&64){if(o)return y1(e,t,i);t.flags|=64}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Ve(Ye,Ye.current),o)break;return null;case 23:case 24:return t.lanes=0,mp(e,t,i)}return os(e,t,i)}else cr=!1;switch(t.lanes=0,t.tag){case 2:if(o=t.type,e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,n=Ja(t,Di.current),Xa(t,i),n=Ug(null,t,o,e,n,i),t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,on(o)){var s=!0;yh(t)}else s=!1;t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Mg(t);var r=o.getDerivedStateFromProps;typeof r=="function"&&Mh(t,o,r,e),n.updater=rf,t.stateNode=n,n._reactInternals=t,Hp(t,o,e,i),t=$p(null,t,o,!0,s,i)}else t.tag=0,rn(null,t,n,i),t=t.child;return t;case 16:n=t.elementType;t:{switch(e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=aF(n),e=lr(n,e),s){case 0:t=qp(null,t,n,e,i);break t;case 1:t=h1(null,t,n,e,i);break t;case 11:t=l1(null,t,n,e,i);break t;case 14:t=c1(null,t,n,lr(n.type,e),o,i);break t}throw Error(Ot(306,n,""))}return t;case 0:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:lr(o,n),qp(e,t,o,n,i);case 1:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:lr(o,n),h1(e,t,o,n,i);case 3:if(f1(t),o=t.updateQueue,e===null||o===null)throw Error(Ot(282));if(o=t.pendingProps,n=t.memoizedState,n=n!==null?n.element:null,DC(e,t),Ml(t,o,null,i),o=t.memoizedState.element,o===n)gp(),t=os(e,t,i);else{if(n=t.stateNode,(s=n.hydrate)&&(js=Ha(t.stateNode.containerInfo.firstChild),ss=t,s=Tr=!0),s){if(e=n.mutableSourceEagerHydrationData,e!=null)for(n=0;n<e.length;n+=2)s=e[n],s._workInProgressVersionPrimary=e[n+1],Ya.push(s);for(i=TC(t,null,o,i),t.child=i;i;)i.flags=i.flags&-3|1024,i=i.sibling}else rn(e,t,o,i),gp();t=t.child}return t;case 5:return n1(t),e===null&&Yp(t),o=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,r=n.children,Up(o,n)?r=null:s!==null&&Up(o,s)&&(t.flags|=16),jC(e,t),rn(e,t,r,i),t.child;case 6:return e===null&&Yp(t),null;case 13:return d1(e,t,i);case 4:return Xp(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Rh(t,null,o,i):rn(e,t,o,i),t.child;case 11:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:lr(o,n),l1(e,t,o,n,i);case 7:return rn(e,t,t.pendingProps,i),t.child;case 8:return rn(e,t,t.pendingProps.children,i),t.child;case 12:return rn(e,t,t.pendingProps.children,i),t.child;case 10:t:{o=t.type._context,n=t.pendingProps,r=t.memoizedProps,s=n.value;var a=t.type._context;if(Ve(Ih,a._currentValue),a._currentValue=s,r!==null)if(a=r.value,s=Nn(a,s)?0:(typeof o._calculateChangedBits=="function"?o._calculateChangedBits(a,s):1073741823)|0,s===0){if(r.children===n.children&&!sn.current){t=os(e,t,i);break t}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){r=a.child;for(var u=l.firstContext;u!==null;){if(u.context===o&&u.observedBits&s){a.tag===1&&(u=Ws(-1,i&-i),u.tag=2,Gs(a,u)),a.lanes|=i,u=a.alternate,u!==null&&(u.lanes|=i),xC(a.return,i),l.lanes|=i;break}u=u.next}}else r=a.tag===10&&a.type===t.type?null:a.child;if(r!==null)r.return=a;else for(r=a;r!==null;){if(r===t){r=null;break}if(a=r.sibling,a!==null){a.return=r.return,r=a;break}r=r.return}a=r}rn(e,t,n.children,i),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps,o=s.children,Xa(t,i),n=Wn(n,s.unstable_observedBits),o=o(n),t.flags|=1,rn(e,t,o,i),t.child;case 14:return n=t.type,s=lr(n,t.pendingProps),s=lr(n.type,s),c1(e,t,n,s,o,i);case 15:return RC(e,t,t.type,t.pendingProps,o,i);case 17:return o=t.type,n=t.pendingProps,n=t.elementType===o?n:lr(o,n),e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,on(o)?(e=!0,yh(t)):e=!1,Xa(t,i),AC(t,o,n),Hp(t,o,n,i),$p(null,t,o,!0,e,i);case 19:return y1(e,t,i);case 23:return mp(e,t,i);case 24:return mp(e,t,i)}throw Error(Ot(156,t.tag))};function oF(e,t,i,o){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(e,t,i,o){return new oF(e,t,i,o)}function $g(e){return e=e.prototype,!(!e||!e.isReactComponent)}function aF(e){if(typeof e=="function")return $g(e)?1:0;if(e!=null){if(e=e.$$typeof,e===qh)return 11;if(e===$h)return 14}return 2}function Js(e,t){var i=e.alternate;return i===null?(i=Un(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function xh(e,t,i,o,n,s){var r=2;if(o=e,typeof e=="function")$g(e)&&(r=1);else if(typeof e=="string")r=5;else t:switch(e){case Ls:return $a(i.children,n,s,t);case F1:r=8,n|=16;break;case hg:r=8,n|=1;break;case pl:return e=Un(12,i,t,n|8),e.elementType=pl,e.type=pl,e.lanes=s,e;case gl:return e=Un(13,i,t,n),e.type=gl,e.elementType=gl,e.lanes=s,e;case Dh:return e=Un(19,i,t,n),e.elementType=Dh,e.lanes=s,e;case vg:return Kg(i,n,s,t);case Sp:return e=Un(24,i,t,n),e.elementType=Sp,e.lanes=s,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case fg:r=10;break t;case dg:r=9;break t;case qh:r=11;break t;case $h:r=14;break t;case pg:r=16,o=null;break t;case gg:r=22;break t}throw Error(Ot(130,e==null?e:typeof e,""))}return t=Un(r,i,t,n),t.elementType=e,t.type=o,t.lanes=s,t}function $a(e,t,i,o){return e=Un(7,e,o,t),e.lanes=i,e}function Kg(e,t,i,o){return e=Un(23,e,o,t),e.elementType=vg,e.lanes=i,e}function Cp(e,t,i){return e=Un(6,e,null,t),e.lanes=i,e}function _p(e,t,i){return t=Un(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uF(e,t,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=rp(0),this.expirationTimes=rp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rp(0),this.mutableSourceEagerHydrationData=null}function lF(e,t,i){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oo,key:o==null?null:""+o,children:e,containerInfo:t,implementation:i}}function Yh(e,t,i,o){var n=t.current,s=Sn(),r=Hs(n);t:if(i){i=i._reactInternals;e:{if(zo(i)!==i||i.tag!==1)throw Error(Ot(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(on(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(Ot(171))}if(i.tag===1){var l=i.type;if(on(l)){i=mC(i,l,a);break t}}i=a}else i=$s;return t.context===null?t.context=i:t.pendingContext=i,t=Ws(s,r),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),Gs(n,t),Xs(n,r,s),r}function wp(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function E1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Jg(e,t){E1(e,t),(e=e.alternate)&&E1(e,t)}function cF(){return null}function Qg(e,t,i){var o=i!=null&&i.hydrationOptions!=null&&i.hydrationOptions.mutableSources||null;if(i=new uF(e,t,i!=null&&i.hydrate===!0),t=Un(3,null,null,t===2?7:t===1?3:0),i.current=t,t.stateNode=i,Mg(t),e[eu]=i.current,hC(e.nodeType===8?e.parentNode:e),o)for(e=0;e<o.length;e++){t=o[e];var n=t._getVersion;n=n(t._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[t,n]:i.mutableSourceEagerHydrationData.push(t,n)}this._internalRoot=i}Qg.prototype.render=function(e){Yh(e,this._internalRoot,null,null)};Qg.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Yh(null,e,null,function(){t[eu]=null})};function Hl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hF(e,t){if(t||(t=e?e.nodeType===9?e.documentElement:e.firstChild:null,t=!(!t||t.nodeType!==1||!t.hasAttribute("data-reactroot"))),!t)for(var i;i=e.lastChild;)e.removeChild(i);return new Qg(e,0,t?{hydrate:!0}:void 0)}function af(e,t,i,o,n){var s=i._reactRootContainer;if(s){var r=s._internalRoot;if(typeof n=="function"){var a=n;n=function(){var u=wp(r);a.call(u)}}Yh(t,r,e,n)}else{if(s=i._reactRootContainer=hF(i,o),r=s._internalRoot,typeof n=="function"){var l=n;n=function(){var u=wp(r);l.call(u)}}VC(function(){Yh(t,r,e,n)})}return wp(r)}H1=function(e){if(e.tag===13){var t=Sn();Xs(e,4,t),Jg(e,4)}};Sg=function(e){if(e.tag===13){var t=Sn();Xs(e,67108864,t),Jg(e,67108864)}};X1=function(e){if(e.tag===13){var t=Sn(),i=Hs(e);Xs(e,i,t),Jg(e,i)}};Y1=function(e,t){return t()};Pp=function(e,t,i){switch(t){case"input":if(Dp(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var o=i[t];if(o!==e&&o.form===e.form){var n=ef(o);if(!n)throw Error(Ot(90));k1(o),Dp(o,n)}}}break;case"textarea":I1(e,i);break;case"select":t=i.value,t!=null&&za(e,!!i.multiple,t,!1)}};Cg=YC;U1=function(e,t,i,o,n){var s=Zt;Zt|=4;try{return Ro(98,e.bind(null,t,i,o,n))}finally{Zt=s,Zt===0&&(ru(),Fr())}};_g=function(){!(Zt&49)&&(JT(),Zs())};z1=function(e,t){var i=Zt;Zt|=2;try{return e(t)}finally{Zt=i,Zt===0&&(ru(),Fr())}};function t_(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hl(t))throw Error(Ot(200));return lF(e,t,null,i)}var fF={Events:[zl,Ra,ef,j1,N1,Zs,{current:!1}]},al={findFiberByHostInstance:Po,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},dF={bundleType:al.bundleType,version:al.version,rendererPackageName:al.rendererPackageName,rendererConfig:al.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Uo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=G1(e),e===null?null:e.stateNode},findFiberByHostInstance:al.findFiberByHostInstance||cF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(ul=__REACT_DEVTOOLS_GLOBAL_HOOK__,!ul.isDisabled&&ul.supportsFiber))try{Pg=ul.inject(dF),Lo=ul}catch{}var ul;Hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fF;Hn.createPortal=t_;Hn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ot(188)):Error(Ot(268,Object.keys(e)));return e=G1(t),e=e===null?null:e.stateNode,e};Hn.flushSync=function(e,t){var i=Zt;if(i&48)return e(t);Zt|=1;try{if(e)return Ro(99,e.bind(null,t))}finally{Zt=i,Fr()}};Hn.hydrate=function(e,t,i){if(!Hl(t))throw Error(Ot(200));return af(null,e,t,!0,i)};Hn.render=function(e,t,i){if(!Hl(t))throw Error(Ot(200));return af(null,e,t,!1,i)};Hn.unmountComponentAtNode=function(e){if(!Hl(e))throw Error(Ot(40));return e._reactRootContainer?(VC(function(){af(null,null,e,!1,function(){e._reactRootContainer=null,e[eu]=null})}),!0):!1};Hn.unstable_batchedUpdates=YC;Hn.unstable_createPortal=function(e,t){return t_(e,t,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};Hn.unstable_renderSubtreeIntoContainer=function(e,t,i,o){if(!Hl(i))throw Error(Ot(200));if(e==null||e._reactInternals===void 0)throw Error(Ot(38));return af(e,t,i,!1,o)};Hn.version="17.0.2"});var r_=ue((f3,n_)=>{"use strict";function i_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i_)}catch(e){console.error(e)}}i_(),n_.exports=e_()});var uf=ue((su,Xl)=>{(function(){var e,t="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",s="Invalid `variable` option passed into `_.template`",r="__lodash_hash_undefined__",a=500,l="__lodash_placeholder__",u=1,c=2,h=4,d=1,g=2,m=1,y=2,C=4,w=8,F=16,B=32,U=64,R=128,W=256,X=512,$=30,st="...",pt=800,dt=16,x=1,P=2,I=3,k=1/0,K=9007199254740991,S=17976931348623157e292,_=0/0,O=4294967295,j=O-1,q=O>>>1,N=[["ary",R],["bind",m],["bindKey",y],["curry",w],["curryRight",F],["flip",X],["partial",B],["partialRight",U],["rearg",W]],H="[object Arguments]",Q="[object Array]",ot="[object AsyncFunction]",Y="[object Boolean]",z="[object Date]",it="[object DOMException]",Z="[object Error]",J="[object Function]",nt="[object GeneratorFunction]",lt="[object Map]",At="[object Number]",wt="[object Null]",et="[object Object]",yt="[object Promise]",Tt="[object Proxy]",It="[object RegExp]",jt="[object Set]",Mt="[object String]",se="[object Symbol]",Jt="[object Undefined]",Le="[object WeakMap]",qe="[object WeakSet]",Ce="[object ArrayBuffer]",Ei="[object DataView]",Ft="[object Float32Array]",Bt="[object Float64Array]",Gt="[object Int8Array]",ne="[object Int16Array]",Oe="[object Int32Array]",Ti="[object Uint8Array]",Xi="[object Uint8ClampedArray]",En="[object Uint16Array]",Ir="[object Uint32Array]",$o=/\b__p \+= '';/g,Vn=/\b(__p \+=) '' \+/g,pu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ko=/&(?:amp|lt|gt|quot|#39);/g,Jo=/[&<>"']/g,hs=RegExp(Ko.source),gu=RegExp(Jo.source),mu=/<%-([\s\S]+?)%>/g,vu=/<%([\s\S]+?)%>/g,fs=/<%=([\s\S]+?)%>/g,fn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dn=/^\w*$/,Qo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gr=/[\\^$.*+?()[\]{}|]/g,oo=RegExp(gr.source),Tn=/^\s+/,Zo=/\s/,ta=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,yu=/\{\n\/\* \[wrapped with (.+)\] \*/,ea=/,? & /,Fi=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Br=/[()=,{}\[\]\/\s]/,Fn=/\\(\\)?/g,ds=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Lr=/\w*$/,ao=/^[-+]0x[0-9a-f]+$/i,Cu=/^0b[01]+$/i,ia=/^\[object .+?Constructor\]$/,ps=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,We=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mr=/($^)/,Ge=/['\n\r\u2028\u2029\\]/g,pn="\\ud800-\\udfff",ke="\\u0300-\\u036f",mr="\\ufe20-\\ufe2f",gs="\\u20d0-\\u20ff",ms=ke+mr+gs,vs="\\u2700-\\u27bf",uo="a-z\\xdf-\\xf6\\xf8-\\xff",vr="\\xac\\xb1\\xd7\\xf7",qn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",lo="\\u2000-\\u206f",co=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",$n="A-Z\\xc0-\\xd6\\xd8-\\xde",Rr="\\ufe0e\\ufe0f",Kn=vr+qn+lo+co,ys="['\u2019]",ho="["+pn+"]",Jn="["+Kn+"]",vi="["+ms+"]",Qn="\\d+",na="["+vs+"]",fo="["+uo+"]",po="[^"+pn+Kn+Qn+vs+uo+$n+"]",jr="\\ud83c[\\udffb-\\udfff]",Zn="(?:"+vi+"|"+jr+")",tr="[^"+pn+"]",Nr="(?:\\ud83c[\\udde6-\\uddff]){2}",Yi="[\\ud800-\\udbff][\\udc00-\\udfff]",gn="["+$n+"]",go="\\u200d",yr="(?:"+fo+"|"+po+")",Ur="(?:"+gn+"|"+po+")",er="(?:"+ys+"(?:d|ll|m|re|s|t|ve))?",ra="(?:"+ys+"(?:D|LL|M|RE|S|T|VE))?",mo=Zn+"?",Cs="["+Rr+"]?",sa="(?:"+go+"(?:"+[tr,Nr,Yi].join("|")+")"+Cs+mo+")*",oa="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_u="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Vi=Cs+mo+sa,_s="(?:"+[na,Nr,Yi].join("|")+")"+Vi,wu="(?:"+[tr+vi+"?",vi,Nr,Yi,ho].join("|")+")",mn=RegExp(ys,"g"),zr=RegExp(vi,"g"),ws=RegExp(jr+"(?="+jr+")|"+wu+Vi,"g"),aa=RegExp([gn+"?"+fo+"+"+er+"(?="+[Jn,gn,"$"].join("|")+")",Ur+"+"+ra+"(?="+[Jn,gn+yr,"$"].join("|")+")",gn+"?"+yr+"+"+er,gn+"+"+ra,_u,oa,Qn,_s].join("|"),"g"),Su=RegExp("["+go+pn+ms+Rr+"]"),Wr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ni=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Gr=-1,xe={};xe[Ft]=xe[Bt]=xe[Gt]=xe[ne]=xe[Oe]=xe[Ti]=xe[Xi]=xe[En]=xe[Ir]=!0,xe[H]=xe[Q]=xe[Ce]=xe[Y]=xe[Ei]=xe[z]=xe[Z]=xe[J]=xe[lt]=xe[At]=xe[et]=xe[It]=xe[jt]=xe[Mt]=xe[Le]=!1;var de={};de[H]=de[Q]=de[Ce]=de[Ei]=de[Y]=de[z]=de[Ft]=de[Bt]=de[Gt]=de[ne]=de[Oe]=de[lt]=de[At]=de[et]=de[It]=de[jt]=de[Mt]=de[se]=de[Ti]=de[Xi]=de[En]=de[Ir]=!0,de[Z]=de[J]=de[Le]=!1;var Hr={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},xu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},at={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Pt=parseFloat,we=parseInt,Pe=typeof global=="object"&&global&&global.Object===Object&&global,Qe=typeof self=="object"&&self&&self.Object===Object&&self,le=Pe||Qe||Function("return this")(),ir=typeof su=="object"&&su&&!su.nodeType&&su,ri=ir&&typeof Xl=="object"&&Xl&&!Xl.nodeType&&Xl,ui=ri&&ri.exports===ir,Xr=ui&&Pe.process,Oi=function(){try{var ct=ri&&ri.require&&ri.require("util").types;return ct||Xr&&Xr.binding&&Xr.binding("util")}catch{}}(),nc=Oi&&Oi.isArrayBuffer,rc=Oi&&Oi.isDate,sc=Oi&&Oi.isMap,oc=Oi&&Oi.isRegExp,ac=Oi&&Oi.isSet,Du=Oi&&Oi.isTypedArray;function ki(ct,St,gt){switch(gt.length){case 0:return ct.call(St);case 1:return ct.call(St,gt[0]);case 2:return ct.call(St,gt[0],gt[1]);case 3:return ct.call(St,gt[0],gt[1],gt[2])}return ct.apply(St,gt)}function uc(ct,St,gt,Nt){for(var Qt=-1,ve=ct==null?0:ct.length;++Qt<ve;){var Ie=ct[Qt];St(Nt,Ie,gt(Ie),ct)}return Nt}function qi(ct,St){for(var gt=-1,Nt=ct==null?0:ct.length;++gt<Nt&&St(ct[gt],gt,ct)!==!1;);return ct}function _f(ct,St){for(var gt=ct==null?0:ct.length;gt--&&St(ct[gt],gt,ct)!==!1;);return ct}function ua(ct,St){for(var gt=-1,Nt=ct==null?0:ct.length;++gt<Nt;)if(!St(ct[gt],gt,ct))return!1;return!0}function On(ct,St){for(var gt=-1,Nt=ct==null?0:ct.length,Qt=0,ve=[];++gt<Nt;){var Ie=ct[gt];St(Ie,gt,ct)&&(ve[Qt++]=Ie)}return ve}function Ss(ct,St){var gt=ct==null?0:ct.length;return!!gt&&$i(ct,St,0)>-1}function vo(ct,St,gt){for(var Nt=-1,Qt=ct==null?0:ct.length;++Nt<Qt;)if(gt(St,ct[Nt]))return!0;return!1}function Fe(ct,St){for(var gt=-1,Nt=ct==null?0:ct.length,Qt=Array(Nt);++gt<Nt;)Qt[gt]=St(ct[gt],gt,ct);return Qt}function nr(ct,St){for(var gt=-1,Nt=St.length,Qt=ct.length;++gt<Nt;)ct[Qt+gt]=St[gt];return ct}function la(ct,St,gt,Nt){var Qt=-1,ve=ct==null?0:ct.length;for(Nt&&ve&&(gt=ct[++Qt]);++Qt<ve;)gt=St(gt,ct[Qt],Qt,ct);return gt}function lc(ct,St,gt,Nt){var Qt=ct==null?0:ct.length;for(Nt&&Qt&&(gt=ct[--Qt]);Qt--;)gt=St(gt,ct[Qt],Qt,ct);return gt}function ca(ct,St){for(var gt=-1,Nt=ct==null?0:ct.length;++gt<Nt;)if(St(ct[gt],gt,ct))return!0;return!1}var wf=xs("length");function Sf(ct){return ct.split("")}function xf(ct){return ct.match(Fi)||[]}function cc(ct,St,gt){var Nt;return gt(ct,function(Qt,ve,Ie){if(St(Qt,ve,Ie))return Nt=ve,!1}),Nt}function ha(ct,St,gt,Nt){for(var Qt=ct.length,ve=gt+(Nt?1:-1);Nt?ve--:++ve<Qt;)if(St(ct[ve],ve,ct))return ve;return-1}function $i(ct,St,gt){return St===St?Ff(ct,St,gt):ha(ct,bu,gt)}function hc(ct,St,gt,Nt){for(var Qt=gt-1,ve=ct.length;++Qt<ve;)if(Nt(ct[Qt],St))return Qt;return-1}function bu(ct){return ct!==ct}function Au(ct,St){var gt=ct==null?0:ct.length;return gt?Eu(ct,St)/gt:_}function xs(ct){return function(St){return St==null?e:St[ct]}}function fa(ct){return function(St){return ct==null?e:ct[St]}}function fc(ct,St,gt,Nt,Qt){return Qt(ct,function(ve,Ie,De){gt=Nt?(Nt=!1,ve):St(gt,ve,Ie,De)}),gt}function dc(ct,St){var gt=ct.length;for(ct.sort(St);gt--;)ct[gt]=ct[gt].value;return ct}function Eu(ct,St){for(var gt,Nt=-1,Qt=ct.length;++Nt<Qt;){var ve=St(ct[Nt]);ve!==e&&(gt=gt===e?ve:gt+ve)}return gt}function da(ct,St){for(var gt=-1,Nt=Array(ct);++gt<ct;)Nt[gt]=St(gt);return Nt}function Df(ct,St){return Fe(St,function(gt){return[gt,ct[gt]]})}function Tu(ct){return ct&&ct.slice(0,Cc(ct)+1).replace(Tn,"")}function Pi(ct){return function(St){return ct(St)}}function yo(ct,St){return Fe(St,function(gt){return ct[gt]})}function Co(ct,St){return ct.has(St)}function pc(ct,St){for(var gt=-1,Nt=ct.length;++gt<Nt&&$i(St,ct[gt],0)>-1;);return gt}function pa(ct,St){for(var gt=ct.length;gt--&&$i(St,ct[gt],0)>-1;);return gt}function Fu(ct,St){for(var gt=ct.length,Nt=0;gt--;)ct[gt]===St&&++Nt;return Nt}var bf=fa(Hr),Af=fa(xu);function Ef(ct){return"\\"+Lt[ct]}function Tf(ct,St){return ct==null?e:ct[St]}function Ds(ct){return Su.test(ct)}function gc(ct){return Wr.test(ct)}function mc(ct){for(var St,gt=[];!(St=ct.next()).done;)gt.push(St.value);return gt}function Ou(ct){var St=-1,gt=Array(ct.size);return ct.forEach(function(Nt,Qt){gt[++St]=[Qt,Nt]}),gt}function vc(ct,St){return function(gt){return ct(St(gt))}}function rr(ct,St){for(var gt=-1,Nt=ct.length,Qt=0,ve=[];++gt<Nt;){var Ie=ct[gt];(Ie===St||Ie===l)&&(ct[gt]=l,ve[Qt++]=gt)}return ve}function Yr(ct){var St=-1,gt=Array(ct.size);return ct.forEach(function(Nt){gt[++St]=Nt}),gt}function yc(ct){var St=-1,gt=Array(ct.size);return ct.forEach(function(Nt){gt[++St]=[Nt,Nt]}),gt}function Ff(ct,St,gt){for(var Nt=gt-1,Qt=ct.length;++Nt<Qt;)if(ct[Nt]===St)return Nt;return-1}function Of(ct,St,gt){for(var Nt=gt+1;Nt--;)if(ct[Nt]===St)return Nt;return Nt}function bs(ct){return Ds(ct)?Pf(ct):wf(ct)}function vn(ct){return Ds(ct)?If(ct):Sf(ct)}function Cc(ct){for(var St=ct.length;St--&&Zo.test(ct.charAt(St)););return St}var kf=fa(at);function Pf(ct){for(var St=ws.lastIndex=0;ws.test(ct);)++St;return St}function If(ct){return ct.match(ws)||[]}function Bf(ct){return ct.match(aa)||[]}var Lf=function ct(St){St=St==null?le:Cr.defaults(le.Object(),St,Cr.pick(le,ni));var gt=St.Array,Nt=St.Date,Qt=St.Error,ve=St.Function,Ie=St.Math,De=St.Object,As=St.RegExp,_c=St.String,Ki=St.TypeError,_o=gt.prototype,Mf=ve.prototype,Es=De.prototype,ga=St["__core-js_shared__"],ma=Mf.toString,Se=Es.hasOwnProperty,ku=0,Pu=function(){var f=/[^.]+$/.exec(ga&&ga.keys&&ga.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""}(),T=Es.toString,A=ma.call(De),L=le._,tt=As("^"+ma.call(Se).replace(gr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ft=ui?St.Buffer:e,mt=St.Symbol,vt=St.Uint8Array,bt=ft?ft.allocUnsafe:e,kt=vc(De.getPrototypeOf,De),Ut=De.create,re=Es.propertyIsEnumerable,Wt=_o.splice,Xt=mt?mt.isConcatSpreadable:e,Vt=mt?mt.iterator:e,Yt=mt?mt.toStringTag:e,ce=function(){try{var f=bo(De,"defineProperty");return f({},"",{}),f}catch{}}(),Ee=St.clearTimeout!==le.clearTimeout&&St.clearTimeout,He=Nt&&Nt.now!==le.Date.now&&Nt.now,Ji=St.setTimeout!==le.setTimeout&&St.setTimeout,kn=Ie.ceil,wc=Ie.floor,Rf=De.getOwnPropertySymbols,rS=ft?ft.isBuffer:e,e0=St.isFinite,sS=_o.join,oS=vc(De.keys,De),Ze=Ie.max,yi=Ie.min,aS=Nt.now,uS=St.parseInt,i0=Ie.random,lS=_o.reverse,jf=bo(St,"DataView"),Iu=bo(St,"Map"),Nf=bo(St,"Promise"),va=bo(St,"Set"),Bu=bo(St,"WeakMap"),Lu=bo(De,"create"),Sc=Bu&&new Bu,ya={},cS=Ao(jf),hS=Ao(Iu),fS=Ao(Nf),dS=Ao(va),pS=Ao(Bu),xc=mt?mt.prototype:e,Mu=xc?xc.valueOf:e,n0=xc?xc.toString:e;function G(f){if(Xe(f)&&!te(f)&&!(f instanceof pe)){if(f instanceof Pn)return f;if(Se.call(f,"__wrapped__"))return rv(f)}return new Pn(f)}var Ca=function(){function f(){}return function(p){if(!Ue(p))return{};if(Ut)return Ut(p);f.prototype=p;var v=new f;return f.prototype=e,v}}();function Dc(){}function Pn(f,p){this.__wrapped__=f,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=e}G.templateSettings={escape:mu,evaluate:vu,interpolate:fs,variable:"",imports:{_:G}},G.prototype=Dc.prototype,G.prototype.constructor=G,Pn.prototype=Ca(Dc.prototype),Pn.prototype.constructor=Pn;function pe(f){this.__wrapped__=f,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function gS(){var f=new pe(this.__wrapped__);return f.__actions__=Qi(this.__actions__),f.__dir__=this.__dir__,f.__filtered__=this.__filtered__,f.__iteratees__=Qi(this.__iteratees__),f.__takeCount__=this.__takeCount__,f.__views__=Qi(this.__views__),f}function mS(){if(this.__filtered__){var f=new pe(this);f.__dir__=-1,f.__filtered__=!0}else f=this.clone(),f.__dir__*=-1;return f}function vS(){var f=this.__wrapped__.value(),p=this.__dir__,v=te(f),E=p<0,M=v?f.length:0,V=F2(0,M,this.__views__),rt=V.start,ut=V.end,ht=ut-rt,xt=E?ut:rt-1,Dt=this.__iteratees__,Et=Dt.length,Rt=0,Ht=yi(ht,this.__takeCount__);if(!v||!E&&M==ht&&Ht==ht)return E0(f,this.__actions__);var $t=[];t:for(;ht--&&Rt<Ht;){xt+=p;for(var ae=-1,Kt=f[xt];++ae<Et;){var fe=Dt[ae],ge=fe.iteratee,_n=fe.type,Li=ge(Kt);if(_n==P)Kt=Li;else if(!Li){if(_n==x)continue t;break t}}$t[Rt++]=Kt}return $t}pe.prototype=Ca(Dc.prototype),pe.prototype.constructor=pe;function wo(f){var p=-1,v=f==null?0:f.length;for(this.clear();++p<v;){var E=f[p];this.set(E[0],E[1])}}function yS(){this.__data__=Lu?Lu(null):{},this.size=0}function CS(f){var p=this.has(f)&&delete this.__data__[f];return this.size-=p?1:0,p}function _S(f){var p=this.__data__;if(Lu){var v=p[f];return v===r?e:v}return Se.call(p,f)?p[f]:e}function wS(f){var p=this.__data__;return Lu?p[f]!==e:Se.call(p,f)}function SS(f,p){var v=this.__data__;return this.size+=this.has(f)?0:1,v[f]=Lu&&p===e?r:p,this}wo.prototype.clear=yS,wo.prototype.delete=CS,wo.prototype.get=_S,wo.prototype.has=wS,wo.prototype.set=SS;function Vr(f){var p=-1,v=f==null?0:f.length;for(this.clear();++p<v;){var E=f[p];this.set(E[0],E[1])}}function xS(){this.__data__=[],this.size=0}function DS(f){var p=this.__data__,v=bc(p,f);if(v<0)return!1;var E=p.length-1;return v==E?p.pop():Wt.call(p,v,1),--this.size,!0}function bS(f){var p=this.__data__,v=bc(p,f);return v<0?e:p[v][1]}function AS(f){return bc(this.__data__,f)>-1}function ES(f,p){var v=this.__data__,E=bc(v,f);return E<0?(++this.size,v.push([f,p])):v[E][1]=p,this}Vr.prototype.clear=xS,Vr.prototype.delete=DS,Vr.prototype.get=bS,Vr.prototype.has=AS,Vr.prototype.set=ES;function qr(f){var p=-1,v=f==null?0:f.length;for(this.clear();++p<v;){var E=f[p];this.set(E[0],E[1])}}function TS(){this.size=0,this.__data__={hash:new wo,map:new(Iu||Vr),string:new wo}}function FS(f){var p=Rc(this,f).delete(f);return this.size-=p?1:0,p}function OS(f){return Rc(this,f).get(f)}function kS(f){return Rc(this,f).has(f)}function PS(f,p){var v=Rc(this,f),E=v.size;return v.set(f,p),this.size+=v.size==E?0:1,this}qr.prototype.clear=TS,qr.prototype.delete=FS,qr.prototype.get=OS,qr.prototype.has=kS,qr.prototype.set=PS;function So(f){var p=-1,v=f==null?0:f.length;for(this.__data__=new qr;++p<v;)this.add(f[p])}function IS(f){return this.__data__.set(f,r),this}function BS(f){return this.__data__.has(f)}So.prototype.add=So.prototype.push=IS,So.prototype.has=BS;function sr(f){var p=this.__data__=new Vr(f);this.size=p.size}function LS(){this.__data__=new Vr,this.size=0}function MS(f){var p=this.__data__,v=p.delete(f);return this.size=p.size,v}function RS(f){return this.__data__.get(f)}function jS(f){return this.__data__.has(f)}function NS(f,p){var v=this.__data__;if(v instanceof Vr){var E=v.__data__;if(!Iu||E.length<i-1)return E.push([f,p]),this.size=++v.size,this;v=this.__data__=new qr(E)}return v.set(f,p),this.size=v.size,this}sr.prototype.clear=LS,sr.prototype.delete=MS,sr.prototype.get=RS,sr.prototype.has=jS,sr.prototype.set=NS;function r0(f,p){var v=te(f),E=!v&&Eo(f),M=!v&&!E&&Ps(f),V=!v&&!E&&!M&&xa(f),rt=v||E||M||V,ut=rt?da(f.length,_c):[],ht=ut.length;for(var xt in f)(p||Se.call(f,xt))&&!(rt&&(xt=="length"||M&&(xt=="offset"||xt=="parent")||V&&(xt=="buffer"||xt=="byteLength"||xt=="byteOffset")||Qr(xt,ht)))&&ut.push(xt);return ut}function s0(f){var p=f.length;return p?f[Kf(0,p-1)]:e}function US(f,p){return jc(Qi(f),xo(p,0,f.length))}function zS(f){return jc(Qi(f))}function Uf(f,p,v){(v!==e&&!or(f[p],v)||v===e&&!(p in f))&&$r(f,p,v)}function Ru(f,p,v){var E=f[p];(!(Se.call(f,p)&&or(E,v))||v===e&&!(p in f))&&$r(f,p,v)}function bc(f,p){for(var v=f.length;v--;)if(or(f[v][0],p))return v;return-1}function WS(f,p,v,E){return Ts(f,function(M,V,rt){p(E,M,v(M),rt)}),E}function o0(f,p){return f&&wr(p,si(p),f)}function GS(f,p){return f&&wr(p,tn(p),f)}function $r(f,p,v){p=="__proto__"&&ce?ce(f,p,{configurable:!0,enumerable:!0,value:v,writable:!0}):f[p]=v}function zf(f,p){for(var v=-1,E=p.length,M=gt(E),V=f==null;++v<E;)M[v]=V?e:wd(f,p[v]);return M}function xo(f,p,v){return f===f&&(v!==e&&(f=f<=v?f:v),p!==e&&(f=f>=p?f:p)),f}function In(f,p,v,E,M,V){var rt,ut=p&u,ht=p&c,xt=p&h;if(v&&(rt=M?v(f,E,M,V):v(f)),rt!==e)return rt;if(!Ue(f))return f;var Dt=te(f);if(Dt){if(rt=k2(f),!ut)return Qi(f,rt)}else{var Et=Ci(f),Rt=Et==J||Et==nt;if(Ps(f))return O0(f,ut);if(Et==et||Et==H||Rt&&!M){if(rt=ht||Rt?{}:$0(f),!ut)return ht?_2(f,GS(rt,f)):C2(f,o0(rt,f))}else{if(!de[Et])return M?f:{};rt=P2(f,Et,ut)}}V||(V=new sr);var Ht=V.get(f);if(Ht)return Ht;V.set(f,rt),Dv(f)?f.forEach(function(Kt){rt.add(In(Kt,p,v,Kt,f,V))}):Sv(f)&&f.forEach(function(Kt,fe){rt.set(fe,In(Kt,p,v,fe,f,V))});var $t=xt?ht?ad:od:ht?tn:si,ae=Dt?e:$t(f);return qi(ae||f,function(Kt,fe){ae&&(fe=Kt,Kt=f[fe]),Ru(rt,fe,In(Kt,p,v,fe,f,V))}),rt}function HS(f){var p=si(f);return function(v){return a0(v,f,p)}}function a0(f,p,v){var E=v.length;if(f==null)return!E;for(f=De(f);E--;){var M=v[E],V=p[M],rt=f[M];if(rt===e&&!(M in f)||!V(rt))return!1}return!0}function u0(f,p,v){if(typeof f!="function")throw new Ki(n);return Hu(function(){f.apply(e,v)},p)}function ju(f,p,v,E){var M=-1,V=Ss,rt=!0,ut=f.length,ht=[],xt=p.length;if(!ut)return ht;v&&(p=Fe(p,Pi(v))),E?(V=vo,rt=!1):p.length>=i&&(V=Co,rt=!1,p=new So(p));t:for(;++M<ut;){var Dt=f[M],Et=v==null?Dt:v(Dt);if(Dt=E||Dt!==0?Dt:0,rt&&Et===Et){for(var Rt=xt;Rt--;)if(p[Rt]===Et)continue t;ht.push(Dt)}else V(p,Et,E)||ht.push(Dt)}return ht}var Ts=L0(_r),l0=L0(Gf,!0);function XS(f,p){var v=!0;return Ts(f,function(E,M,V){return v=!!p(E,M,V),v}),v}function Ac(f,p,v){for(var E=-1,M=f.length;++E<M;){var V=f[E],rt=p(V);if(rt!=null&&(ut===e?rt===rt&&!Cn(rt):v(rt,ut)))var ut=rt,ht=V}return ht}function YS(f,p,v,E){var M=f.length;for(v=oe(v),v<0&&(v=-v>M?0:M+v),E=E===e||E>M?M:oe(E),E<0&&(E+=M),E=v>E?0:Av(E);v<E;)f[v++]=p;return f}function c0(f,p){var v=[];return Ts(f,function(E,M,V){p(E,M,V)&&v.push(E)}),v}function li(f,p,v,E,M){var V=-1,rt=f.length;for(v||(v=B2),M||(M=[]);++V<rt;){var ut=f[V];p>0&&v(ut)?p>1?li(ut,p-1,v,E,M):nr(M,ut):E||(M[M.length]=ut)}return M}var Wf=M0(),h0=M0(!0);function _r(f,p){return f&&Wf(f,p,si)}function Gf(f,p){return f&&h0(f,p,si)}function Ec(f,p){return On(p,function(v){return Zr(f[v])})}function Do(f,p){p=Os(p,f);for(var v=0,E=p.length;f!=null&&v<E;)f=f[Sr(p[v++])];return v&&v==E?f:e}function f0(f,p,v){var E=p(f);return te(f)?E:nr(E,v(f))}function Ii(f){return f==null?f===e?Jt:wt:Yt&&Yt in De(f)?T2(f):z2(f)}function Hf(f,p){return f>p}function VS(f,p){return f!=null&&Se.call(f,p)}function qS(f,p){return f!=null&&p in De(f)}function $S(f,p,v){return f>=yi(p,v)&&f<Ze(p,v)}function Xf(f,p,v){for(var E=v?vo:Ss,M=f[0].length,V=f.length,rt=V,ut=gt(V),ht=1/0,xt=[];rt--;){var Dt=f[rt];rt&&p&&(Dt=Fe(Dt,Pi(p))),ht=yi(Dt.length,ht),ut[rt]=!v&&(p||M>=120&&Dt.length>=120)?new So(rt&&Dt):e}Dt=f[0];var Et=-1,Rt=ut[0];t:for(;++Et<M&&xt.length<ht;){var Ht=Dt[Et],$t=p?p(Ht):Ht;if(Ht=v||Ht!==0?Ht:0,!(Rt?Co(Rt,$t):E(xt,$t,v))){for(rt=V;--rt;){var ae=ut[rt];if(!(ae?Co(ae,$t):E(f[rt],$t,v)))continue t}Rt&&Rt.push($t),xt.push(Ht)}}return xt}function KS(f,p,v,E){return _r(f,function(M,V,rt){p(E,v(M),V,rt)}),E}function Nu(f,p,v){p=Os(p,f),f=Z0(f,p);var E=f==null?f:f[Sr(Ln(p))];return E==null?e:ki(E,f,v)}function d0(f){return Xe(f)&&Ii(f)==H}function JS(f){return Xe(f)&&Ii(f)==Ce}function QS(f){return Xe(f)&&Ii(f)==z}function Uu(f,p,v,E,M){return f===p?!0:f==null||p==null||!Xe(f)&&!Xe(p)?f!==f&&p!==p:ZS(f,p,v,E,Uu,M)}function ZS(f,p,v,E,M,V){var rt=te(f),ut=te(p),ht=rt?Q:Ci(f),xt=ut?Q:Ci(p);ht=ht==H?et:ht,xt=xt==H?et:xt;var Dt=ht==et,Et=xt==et,Rt=ht==xt;if(Rt&&Ps(f)){if(!Ps(p))return!1;rt=!0,Dt=!1}if(Rt&&!Dt)return V||(V=new sr),rt||xa(f)?Y0(f,p,v,E,M,V):A2(f,p,ht,v,E,M,V);if(!(v&d)){var Ht=Dt&&Se.call(f,"__wrapped__"),$t=Et&&Se.call(p,"__wrapped__");if(Ht||$t){var ae=Ht?f.value():f,Kt=$t?p.value():p;return V||(V=new sr),M(ae,Kt,v,E,V)}}return Rt?(V||(V=new sr),E2(f,p,v,E,M,V)):!1}function t2(f){return Xe(f)&&Ci(f)==lt}function Yf(f,p,v,E){var M=v.length,V=M,rt=!E;if(f==null)return!V;for(f=De(f);M--;){var ut=v[M];if(rt&&ut[2]?ut[1]!==f[ut[0]]:!(ut[0]in f))return!1}for(;++M<V;){ut=v[M];var ht=ut[0],xt=f[ht],Dt=ut[1];if(rt&&ut[2]){if(xt===e&&!(ht in f))return!1}else{var Et=new sr;if(E)var Rt=E(xt,Dt,ht,f,p,Et);if(!(Rt===e?Uu(Dt,xt,d|g,E,Et):Rt))return!1}}return!0}function p0(f){if(!Ue(f)||M2(f))return!1;var p=Zr(f)?tt:ia;return p.test(Ao(f))}function e2(f){return Xe(f)&&Ii(f)==It}function i2(f){return Xe(f)&&Ci(f)==jt}function n2(f){return Xe(f)&&Hc(f.length)&&!!xe[Ii(f)]}function g0(f){return typeof f=="function"?f:f==null?en:typeof f=="object"?te(f)?y0(f[0],f[1]):v0(f):Rv(f)}function Vf(f){if(!Gu(f))return oS(f);var p=[];for(var v in De(f))Se.call(f,v)&&v!="constructor"&&p.push(v);return p}function r2(f){if(!Ue(f))return U2(f);var p=Gu(f),v=[];for(var E in f)E=="constructor"&&(p||!Se.call(f,E))||v.push(E);return v}function qf(f,p){return f<p}function m0(f,p){var v=-1,E=Zi(f)?gt(f.length):[];return Ts(f,function(M,V,rt){E[++v]=p(M,V,rt)}),E}function v0(f){var p=ld(f);return p.length==1&&p[0][2]?J0(p[0][0],p[0][1]):function(v){return v===f||Yf(v,f,p)}}function y0(f,p){return hd(f)&&K0(p)?J0(Sr(f),p):function(v){var E=wd(v,f);return E===e&&E===p?Sd(v,f):Uu(p,E,d|g)}}function Tc(f,p,v,E,M){f!==p&&Wf(p,function(V,rt){if(M||(M=new sr),Ue(V))s2(f,p,rt,v,Tc,E,M);else{var ut=E?E(dd(f,rt),V,rt+"",f,p,M):e;ut===e&&(ut=V),Uf(f,rt,ut)}},tn)}function s2(f,p,v,E,M,V,rt){var ut=dd(f,v),ht=dd(p,v),xt=rt.get(ht);if(xt){Uf(f,v,xt);return}var Dt=V?V(ut,ht,v+"",f,p,rt):e,Et=Dt===e;if(Et){var Rt=te(ht),Ht=!Rt&&Ps(ht),$t=!Rt&&!Ht&&xa(ht);Dt=ht,Rt||Ht||$t?te(ut)?Dt=ut:$e(ut)?Dt=Qi(ut):Ht?(Et=!1,Dt=O0(ht,!0)):$t?(Et=!1,Dt=k0(ht,!0)):Dt=[]:Xu(ht)||Eo(ht)?(Dt=ut,Eo(ut)?Dt=Ev(ut):(!Ue(ut)||Zr(ut))&&(Dt=$0(ht))):Et=!1}Et&&(rt.set(ht,Dt),M(Dt,ht,E,V,rt),rt.delete(ht)),Uf(f,v,Dt)}function C0(f,p){var v=f.length;if(v)return p+=p<0?v:0,Qr(p,v)?f[p]:e}function _0(f,p,v){p.length?p=Fe(p,function(V){return te(V)?function(rt){return Do(rt,V.length===1?V[0]:V)}:V}):p=[en];var E=-1;p=Fe(p,Pi(qt()));var M=m0(f,function(V,rt,ut){var ht=Fe(p,function(xt){return xt(V)});return{criteria:ht,index:++E,value:V}});return dc(M,function(V,rt){return y2(V,rt,v)})}function o2(f,p){return w0(f,p,function(v,E){return Sd(f,E)})}function w0(f,p,v){for(var E=-1,M=p.length,V={};++E<M;){var rt=p[E],ut=Do(f,rt);v(ut,rt)&&zu(V,Os(rt,f),ut)}return V}function a2(f){return function(p){return Do(p,f)}}function $f(f,p,v,E){var M=E?hc:$i,V=-1,rt=p.length,ut=f;for(f===p&&(p=Qi(p)),v&&(ut=Fe(f,Pi(v)));++V<rt;)for(var ht=0,xt=p[V],Dt=v?v(xt):xt;(ht=M(ut,Dt,ht,E))>-1;)ut!==f&&Wt.call(ut,ht,1),Wt.call(f,ht,1);return f}function S0(f,p){for(var v=f?p.length:0,E=v-1;v--;){var M=p[v];if(v==E||M!==V){var V=M;Qr(M)?Wt.call(f,M,1):Zf(f,M)}}return f}function Kf(f,p){return f+wc(i0()*(p-f+1))}function u2(f,p,v,E){for(var M=-1,V=Ze(kn((p-f)/(v||1)),0),rt=gt(V);V--;)rt[E?V:++M]=f,f+=v;return rt}function Jf(f,p){var v="";if(!f||p<1||p>K)return v;do p%2&&(v+=f),p=wc(p/2),p&&(f+=f);while(p);return v}function he(f,p){return pd(Q0(f,p,en),f+"")}function l2(f){return s0(Da(f))}function c2(f,p){var v=Da(f);return jc(v,xo(p,0,v.length))}function zu(f,p,v,E){if(!Ue(f))return f;p=Os(p,f);for(var M=-1,V=p.length,rt=V-1,ut=f;ut!=null&&++M<V;){var ht=Sr(p[M]),xt=v;if(ht==="__proto__"||ht==="constructor"||ht==="prototype")return f;if(M!=rt){var Dt=ut[ht];xt=E?E(Dt,ht,ut):e,xt===e&&(xt=Ue(Dt)?Dt:Qr(p[M+1])?[]:{})}Ru(ut,ht,xt),ut=ut[ht]}return f}var x0=Sc?function(f,p){return Sc.set(f,p),f}:en,h2=ce?function(f,p){return ce(f,"toString",{configurable:!0,enumerable:!1,value:Dd(p),writable:!0})}:en;function f2(f){return jc(Da(f))}function Bn(f,p,v){var E=-1,M=f.length;p<0&&(p=-p>M?0:M+p),v=v>M?M:v,v<0&&(v+=M),M=p>v?0:v-p>>>0,p>>>=0;for(var V=gt(M);++E<M;)V[E]=f[E+p];return V}function d2(f,p){var v;return Ts(f,function(E,M,V){return v=p(E,M,V),!v}),!!v}function Fc(f,p,v){var E=0,M=f==null?E:f.length;if(typeof p=="number"&&p===p&&M<=q){for(;E<M;){var V=E+M>>>1,rt=f[V];rt!==null&&!Cn(rt)&&(v?rt<=p:rt<p)?E=V+1:M=V}return M}return Qf(f,p,en,v)}function Qf(f,p,v,E){var M=0,V=f==null?0:f.length;if(V===0)return 0;p=v(p);for(var rt=p!==p,ut=p===null,ht=Cn(p),xt=p===e;M<V;){var Dt=wc((M+V)/2),Et=v(f[Dt]),Rt=Et!==e,Ht=Et===null,$t=Et===Et,ae=Cn(Et);if(rt)var Kt=E||$t;else xt?Kt=$t&&(E||Rt):ut?Kt=$t&&Rt&&(E||!Ht):ht?Kt=$t&&Rt&&!Ht&&(E||!ae):Ht||ae?Kt=!1:Kt=E?Et<=p:Et<p;Kt?M=Dt+1:V=Dt}return yi(V,j)}function D0(f,p){for(var v=-1,E=f.length,M=0,V=[];++v<E;){var rt=f[v],ut=p?p(rt):rt;if(!v||!or(ut,ht)){var ht=ut;V[M++]=rt===0?0:rt}}return V}function b0(f){return typeof f=="number"?f:Cn(f)?_:+f}function yn(f){if(typeof f=="string")return f;if(te(f))return Fe(f,yn)+"";if(Cn(f))return n0?n0.call(f):"";var p=f+"";return p=="0"&&1/f==-k?"-0":p}function Fs(f,p,v){var E=-1,M=Ss,V=f.length,rt=!0,ut=[],ht=ut;if(v)rt=!1,M=vo;else if(V>=i){var xt=p?null:D2(f);if(xt)return Yr(xt);rt=!1,M=Co,ht=new So}else ht=p?[]:ut;t:for(;++E<V;){var Dt=f[E],Et=p?p(Dt):Dt;if(Dt=v||Dt!==0?Dt:0,rt&&Et===Et){for(var Rt=ht.length;Rt--;)if(ht[Rt]===Et)continue t;p&&ht.push(Et),ut.push(Dt)}else M(ht,Et,v)||(ht!==ut&&ht.push(Et),ut.push(Dt))}return ut}function Zf(f,p){return p=Os(p,f),f=Z0(f,p),f==null||delete f[Sr(Ln(p))]}function A0(f,p,v,E){return zu(f,p,v(Do(f,p)),E)}function Oc(f,p,v,E){for(var M=f.length,V=E?M:-1;(E?V--:++V<M)&&p(f[V],V,f););return v?Bn(f,E?0:V,E?V+1:M):Bn(f,E?V+1:0,E?M:V)}function E0(f,p){var v=f;return v instanceof pe&&(v=v.value()),la(p,function(E,M){return M.func.apply(M.thisArg,nr([E],M.args))},v)}function td(f,p,v){var E=f.length;if(E<2)return E?Fs(f[0]):[];for(var M=-1,V=gt(E);++M<E;)for(var rt=f[M],ut=-1;++ut<E;)ut!=M&&(V[M]=ju(V[M]||rt,f[ut],p,v));return Fs(li(V,1),p,v)}function T0(f,p,v){for(var E=-1,M=f.length,V=p.length,rt={};++E<M;){var ut=E<V?p[E]:e;v(rt,f[E],ut)}return rt}function ed(f){return $e(f)?f:[]}function id(f){return typeof f=="function"?f:en}function Os(f,p){return te(f)?f:hd(f,p)?[f]:nv(be(f))}var p2=he;function ks(f,p,v){var E=f.length;return v=v===e?E:v,!p&&v>=E?f:Bn(f,p,v)}var F0=Ee||function(f){return le.clearTimeout(f)};function O0(f,p){if(p)return f.slice();var v=f.length,E=bt?bt(v):new f.constructor(v);return f.copy(E),E}function nd(f){var p=new f.constructor(f.byteLength);return new vt(p).set(new vt(f)),p}function g2(f,p){var v=p?nd(f.buffer):f.buffer;return new f.constructor(v,f.byteOffset,f.byteLength)}function m2(f){var p=new f.constructor(f.source,Lr.exec(f));return p.lastIndex=f.lastIndex,p}function v2(f){return Mu?De(Mu.call(f)):{}}function k0(f,p){var v=p?nd(f.buffer):f.buffer;return new f.constructor(v,f.byteOffset,f.length)}function P0(f,p){if(f!==p){var v=f!==e,E=f===null,M=f===f,V=Cn(f),rt=p!==e,ut=p===null,ht=p===p,xt=Cn(p);if(!ut&&!xt&&!V&&f>p||V&&rt&&ht&&!ut&&!xt||E&&rt&&ht||!v&&ht||!M)return 1;if(!E&&!V&&!xt&&f<p||xt&&v&&M&&!E&&!V||ut&&v&&M||!rt&&M||!ht)return-1}return 0}function y2(f,p,v){for(var E=-1,M=f.criteria,V=p.criteria,rt=M.length,ut=v.length;++E<rt;){var ht=P0(M[E],V[E]);if(ht){if(E>=ut)return ht;var xt=v[E];return ht*(xt=="desc"?-1:1)}}return f.index-p.index}function I0(f,p,v,E){for(var M=-1,V=f.length,rt=v.length,ut=-1,ht=p.length,xt=Ze(V-rt,0),Dt=gt(ht+xt),Et=!E;++ut<ht;)Dt[ut]=p[ut];for(;++M<rt;)(Et||M<V)&&(Dt[v[M]]=f[M]);for(;xt--;)Dt[ut++]=f[M++];return Dt}function B0(f,p,v,E){for(var M=-1,V=f.length,rt=-1,ut=v.length,ht=-1,xt=p.length,Dt=Ze(V-ut,0),Et=gt(Dt+xt),Rt=!E;++M<Dt;)Et[M]=f[M];for(var Ht=M;++ht<xt;)Et[Ht+ht]=p[ht];for(;++rt<ut;)(Rt||M<V)&&(Et[Ht+v[rt]]=f[M++]);return Et}function Qi(f,p){var v=-1,E=f.length;for(p||(p=gt(E));++v<E;)p[v]=f[v];return p}function wr(f,p,v,E){var M=!v;v||(v={});for(var V=-1,rt=p.length;++V<rt;){var ut=p[V],ht=E?E(v[ut],f[ut],ut,v,f):e;ht===e&&(ht=f[ut]),M?$r(v,ut,ht):Ru(v,ut,ht)}return v}function C2(f,p){return wr(f,cd(f),p)}function _2(f,p){return wr(f,V0(f),p)}function kc(f,p){return function(v,E){var M=te(v)?uc:WS,V=p?p():{};return M(v,f,qt(E,2),V)}}function _a(f){return he(function(p,v){var E=-1,M=v.length,V=M>1?v[M-1]:e,rt=M>2?v[2]:e;for(V=f.length>3&&typeof V=="function"?(M--,V):e,rt&&Bi(v[0],v[1],rt)&&(V=M<3?e:V,M=1),p=De(p);++E<M;){var ut=v[E];ut&&f(p,ut,E,V)}return p})}function L0(f,p){return function(v,E){if(v==null)return v;if(!Zi(v))return f(v,E);for(var M=v.length,V=p?M:-1,rt=De(v);(p?V--:++V<M)&&E(rt[V],V,rt)!==!1;);return v}}function M0(f){return function(p,v,E){for(var M=-1,V=De(p),rt=E(p),ut=rt.length;ut--;){var ht=rt[f?ut:++M];if(v(V[ht],ht,V)===!1)break}return p}}function w2(f,p,v){var E=p&m,M=Wu(f);function V(){var rt=this&&this!==le&&this instanceof V?M:f;return rt.apply(E?v:this,arguments)}return V}function R0(f){return function(p){p=be(p);var v=Ds(p)?vn(p):e,E=v?v[0]:p.charAt(0),M=v?ks(v,1).join(""):p.slice(1);return E[f]()+M}}function wa(f){return function(p){return la(Lv(Bv(p).replace(mn,"")),f,"")}}function Wu(f){return function(){var p=arguments;switch(p.length){case 0:return new f;case 1:return new f(p[0]);case 2:return new f(p[0],p[1]);case 3:return new f(p[0],p[1],p[2]);case 4:return new f(p[0],p[1],p[2],p[3]);case 5:return new f(p[0],p[1],p[2],p[3],p[4]);case 6:return new f(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new f(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var v=Ca(f.prototype),E=f.apply(v,p);return Ue(E)?E:v}}function S2(f,p,v){var E=Wu(f);function M(){for(var V=arguments.length,rt=gt(V),ut=V,ht=Sa(M);ut--;)rt[ut]=arguments[ut];var xt=V<3&&rt[0]!==ht&&rt[V-1]!==ht?[]:rr(rt,ht);if(V-=xt.length,V<v)return W0(f,p,Pc,M.placeholder,e,rt,xt,e,e,v-V);var Dt=this&&this!==le&&this instanceof M?E:f;return ki(Dt,this,rt)}return M}function j0(f){return function(p,v,E){var M=De(p);if(!Zi(p)){var V=qt(v,3);p=si(p),v=function(ut){return V(M[ut],ut,M)}}var rt=f(p,v,E);return rt>-1?M[V?p[rt]:rt]:e}}function N0(f){return Jr(function(p){var v=p.length,E=v,M=Pn.prototype.thru;for(f&&p.reverse();E--;){var V=p[E];if(typeof V!="function")throw new Ki(n);if(M&&!rt&&Mc(V)=="wrapper")var rt=new Pn([],!0)}for(E=rt?E:v;++E<v;){V=p[E];var ut=Mc(V),ht=ut=="wrapper"?ud(V):e;ht&&fd(ht[0])&&ht[1]==(R|w|B|W)&&!ht[4].length&&ht[9]==1?rt=rt[Mc(ht[0])].apply(rt,ht[3]):rt=V.length==1&&fd(V)?rt[ut]():rt.thru(V)}return function(){var xt=arguments,Dt=xt[0];if(rt&&xt.length==1&&te(Dt))return rt.plant(Dt).value();for(var Et=0,Rt=v?p[Et].apply(this,xt):Dt;++Et<v;)Rt=p[Et].call(this,Rt);return Rt}})}function Pc(f,p,v,E,M,V,rt,ut,ht,xt){var Dt=p&R,Et=p&m,Rt=p&y,Ht=p&(w|F),$t=p&X,ae=Rt?e:Wu(f);function Kt(){for(var fe=arguments.length,ge=gt(fe),_n=fe;_n--;)ge[_n]=arguments[_n];if(Ht)var Li=Sa(Kt),wn=Fu(ge,Li);if(E&&(ge=I0(ge,E,M,Ht)),V&&(ge=B0(ge,V,rt,Ht)),fe-=wn,Ht&&fe<xt){var Ke=rr(ge,Li);return W0(f,p,Pc,Kt.placeholder,v,ge,Ke,ut,ht,xt-fe)}var ar=Et?v:this,es=Rt?ar[f]:f;return fe=ge.length,ut?ge=W2(ge,ut):$t&&fe>1&&ge.reverse(),Dt&&ht<fe&&(ge.length=ht),this&&this!==le&&this instanceof Kt&&(es=ae||Wu(es)),es.apply(ar,ge)}return Kt}function U0(f,p){return function(v,E){return KS(v,f,p(E),{})}}function Ic(f,p){return function(v,E){var M;if(v===e&&E===e)return p;if(v!==e&&(M=v),E!==e){if(M===e)return E;typeof v=="string"||typeof E=="string"?(v=yn(v),E=yn(E)):(v=b0(v),E=b0(E)),M=f(v,E)}return M}}function rd(f){return Jr(function(p){return p=Fe(p,Pi(qt())),he(function(v){var E=this;return f(p,function(M){return ki(M,E,v)})})})}function Bc(f,p){p=p===e?" ":yn(p);var v=p.length;if(v<2)return v?Jf(p,f):p;var E=Jf(p,kn(f/bs(p)));return Ds(p)?ks(vn(E),0,f).join(""):E.slice(0,f)}function x2(f,p,v,E){var M=p&m,V=Wu(f);function rt(){for(var ut=-1,ht=arguments.length,xt=-1,Dt=E.length,Et=gt(Dt+ht),Rt=this&&this!==le&&this instanceof rt?V:f;++xt<Dt;)Et[xt]=E[xt];for(;ht--;)Et[xt++]=arguments[++ut];return ki(Rt,M?v:this,Et)}return rt}function z0(f){return function(p,v,E){return E&&typeof E!="number"&&Bi(p,v,E)&&(v=E=e),p=ts(p),v===e?(v=p,p=0):v=ts(v),E=E===e?p<v?1:-1:ts(E),u2(p,v,E,f)}}function Lc(f){return function(p,v){return typeof p=="string"&&typeof v=="string"||(p=Mn(p),v=Mn(v)),f(p,v)}}function W0(f,p,v,E,M,V,rt,ut,ht,xt){var Dt=p&w,Et=Dt?rt:e,Rt=Dt?e:rt,Ht=Dt?V:e,$t=Dt?e:V;p|=Dt?B:U,p&=~(Dt?U:B),p&C||(p&=~(m|y));var ae=[f,p,M,Ht,Et,$t,Rt,ut,ht,xt],Kt=v.apply(e,ae);return fd(f)&&tv(Kt,ae),Kt.placeholder=E,ev(Kt,f,p)}function sd(f){var p=Ie[f];return function(v,E){if(v=Mn(v),E=E==null?0:yi(oe(E),292),E&&e0(v)){var M=(be(v)+"e").split("e"),V=p(M[0]+"e"+(+M[1]+E));return M=(be(V)+"e").split("e"),+(M[0]+"e"+(+M[1]-E))}return p(v)}}var D2=va&&1/Yr(new va([,-0]))[1]==k?function(f){return new va(f)}:Ed;function G0(f){return function(p){var v=Ci(p);return v==lt?Ou(p):v==jt?yc(p):Df(p,f(p))}}function Kr(f,p,v,E,M,V,rt,ut){var ht=p&y;if(!ht&&typeof f!="function")throw new Ki(n);var xt=E?E.length:0;if(xt||(p&=~(B|U),E=M=e),rt=rt===e?rt:Ze(oe(rt),0),ut=ut===e?ut:oe(ut),xt-=M?M.length:0,p&U){var Dt=E,Et=M;E=M=e}var Rt=ht?e:ud(f),Ht=[f,p,v,E,M,Dt,Et,V,rt,ut];if(Rt&&N2(Ht,Rt),f=Ht[0],p=Ht[1],v=Ht[2],E=Ht[3],M=Ht[4],ut=Ht[9]=Ht[9]===e?ht?0:f.length:Ze(Ht[9]-xt,0),!ut&&p&(w|F)&&(p&=~(w|F)),!p||p==m)var $t=w2(f,p,v);else p==w||p==F?$t=S2(f,p,ut):(p==B||p==(m|B))&&!M.length?$t=x2(f,p,v,E):$t=Pc.apply(e,Ht);var ae=Rt?x0:tv;return ev(ae($t,Ht),f,p)}function H0(f,p,v,E){return f===e||or(f,Es[v])&&!Se.call(E,v)?p:f}function X0(f,p,v,E,M,V){return Ue(f)&&Ue(p)&&(V.set(p,f),Tc(f,p,e,X0,V),V.delete(p)),f}function b2(f){return Xu(f)?e:f}function Y0(f,p,v,E,M,V){var rt=v&d,ut=f.length,ht=p.length;if(ut!=ht&&!(rt&&ht>ut))return!1;var xt=V.get(f),Dt=V.get(p);if(xt&&Dt)return xt==p&&Dt==f;var Et=-1,Rt=!0,Ht=v&g?new So:e;for(V.set(f,p),V.set(p,f);++Et<ut;){var $t=f[Et],ae=p[Et];if(E)var Kt=rt?E(ae,$t,Et,p,f,V):E($t,ae,Et,f,p,V);if(Kt!==e){if(Kt)continue;Rt=!1;break}if(Ht){if(!ca(p,function(fe,ge){if(!Co(Ht,ge)&&($t===fe||M($t,fe,v,E,V)))return Ht.push(ge)})){Rt=!1;break}}else if(!($t===ae||M($t,ae,v,E,V))){Rt=!1;break}}return V.delete(f),V.delete(p),Rt}function A2(f,p,v,E,M,V,rt){switch(v){case Ei:if(f.byteLength!=p.byteLength||f.byteOffset!=p.byteOffset)return!1;f=f.buffer,p=p.buffer;case Ce:return!(f.byteLength!=p.byteLength||!V(new vt(f),new vt(p)));case Y:case z:case At:return or(+f,+p);case Z:return f.name==p.name&&f.message==p.message;case It:case Mt:return f==p+"";case lt:var ut=Ou;case jt:var ht=E&d;if(ut||(ut=Yr),f.size!=p.size&&!ht)return!1;var xt=rt.get(f);if(xt)return xt==p;E|=g,rt.set(f,p);var Dt=Y0(ut(f),ut(p),E,M,V,rt);return rt.delete(f),Dt;case se:if(Mu)return Mu.call(f)==Mu.call(p)}return!1}function E2(f,p,v,E,M,V){var rt=v&d,ut=od(f),ht=ut.length,xt=od(p),Dt=xt.length;if(ht!=Dt&&!rt)return!1;for(var Et=ht;Et--;){var Rt=ut[Et];if(!(rt?Rt in p:Se.call(p,Rt)))return!1}var Ht=V.get(f),$t=V.get(p);if(Ht&&$t)return Ht==p&&$t==f;var ae=!0;V.set(f,p),V.set(p,f);for(var Kt=rt;++Et<ht;){Rt=ut[Et];var fe=f[Rt],ge=p[Rt];if(E)var _n=rt?E(ge,fe,Rt,p,f,V):E(fe,ge,Rt,f,p,V);if(!(_n===e?fe===ge||M(fe,ge,v,E,V):_n)){ae=!1;break}Kt||(Kt=Rt=="constructor")}if(ae&&!Kt){var Li=f.constructor,wn=p.constructor;Li!=wn&&"constructor"in f&&"constructor"in p&&!(typeof Li=="function"&&Li instanceof Li&&typeof wn=="function"&&wn instanceof wn)&&(ae=!1)}return V.delete(f),V.delete(p),ae}function Jr(f){return pd(Q0(f,e,av),f+"")}function od(f){return f0(f,si,cd)}function ad(f){return f0(f,tn,V0)}var ud=Sc?function(f){return Sc.get(f)}:Ed;function Mc(f){for(var p=f.name+"",v=ya[p],E=Se.call(ya,p)?v.length:0;E--;){var M=v[E],V=M.func;if(V==null||V==f)return M.name}return p}function Sa(f){var p=Se.call(G,"placeholder")?G:f;return p.placeholder}function qt(){var f=G.iteratee||bd;return f=f===bd?g0:f,arguments.length?f(arguments[0],arguments[1]):f}function Rc(f,p){var v=f.__data__;return L2(p)?v[typeof p=="string"?"string":"hash"]:v.map}function ld(f){for(var p=si(f),v=p.length;v--;){var E=p[v],M=f[E];p[v]=[E,M,K0(M)]}return p}function bo(f,p){var v=Tf(f,p);return p0(v)?v:e}function T2(f){var p=Se.call(f,Yt),v=f[Yt];try{f[Yt]=e;var E=!0}catch{}var M=T.call(f);return E&&(p?f[Yt]=v:delete f[Yt]),M}var cd=Rf?function(f){return f==null?[]:(f=De(f),On(Rf(f),function(p){return re.call(f,p)}))}:Td,V0=Rf?function(f){for(var p=[];f;)nr(p,cd(f)),f=kt(f);return p}:Td,Ci=Ii;(jf&&Ci(new jf(new ArrayBuffer(1)))!=Ei||Iu&&Ci(new Iu)!=lt||Nf&&Ci(Nf.resolve())!=yt||va&&Ci(new va)!=jt||Bu&&Ci(new Bu)!=Le)&&(Ci=function(f){var p=Ii(f),v=p==et?f.constructor:e,E=v?Ao(v):"";if(E)switch(E){case cS:return Ei;case hS:return lt;case fS:return yt;case dS:return jt;case pS:return Le}return p});function F2(f,p,v){for(var E=-1,M=v.length;++E<M;){var V=v[E],rt=V.size;switch(V.type){case"drop":f+=rt;break;case"dropRight":p-=rt;break;case"take":p=yi(p,f+rt);break;case"takeRight":f=Ze(f,p-rt);break}}return{start:f,end:p}}function O2(f){var p=f.match(yu);return p?p[1].split(ea):[]}function q0(f,p,v){p=Os(p,f);for(var E=-1,M=p.length,V=!1;++E<M;){var rt=Sr(p[E]);if(!(V=f!=null&&v(f,rt)))break;f=f[rt]}return V||++E!=M?V:(M=f==null?0:f.length,!!M&&Hc(M)&&Qr(rt,M)&&(te(f)||Eo(f)))}function k2(f){var p=f.length,v=new f.constructor(p);return p&&typeof f[0]=="string"&&Se.call(f,"index")&&(v.index=f.index,v.input=f.input),v}function $0(f){return typeof f.constructor=="function"&&!Gu(f)?Ca(kt(f)):{}}function P2(f,p,v){var E=f.constructor;switch(p){case Ce:return nd(f);case Y:case z:return new E(+f);case Ei:return g2(f,v);case Ft:case Bt:case Gt:case ne:case Oe:case Ti:case Xi:case En:case Ir:return k0(f,v);case lt:return new E;case At:case Mt:return new E(f);case It:return m2(f);case jt:return new E;case se:return v2(f)}}function I2(f,p){var v=p.length;if(!v)return f;var E=v-1;return p[E]=(v>1?"& ":"")+p[E],p=p.join(v>2?", ":" "),f.replace(ta,`{
/* [wrapped with `+p+`] */
`)}function B2(f){return te(f)||Eo(f)||!!(Xt&&f&&f[Xt])}function Qr(f,p){var v=typeof f;return p=p??K,!!p&&(v=="number"||v!="symbol"&&_e.test(f))&&f>-1&&f%1==0&&f<p}function Bi(f,p,v){if(!Ue(v))return!1;var E=typeof p;return(E=="number"?Zi(v)&&Qr(p,v.length):E=="string"&&p in v)?or(v[p],f):!1}function hd(f,p){if(te(f))return!1;var v=typeof f;return v=="number"||v=="symbol"||v=="boolean"||f==null||Cn(f)?!0:dn.test(f)||!fn.test(f)||p!=null&&f in De(p)}function L2(f){var p=typeof f;return p=="string"||p=="number"||p=="symbol"||p=="boolean"?f!=="__proto__":f===null}function fd(f){var p=Mc(f),v=G[p];if(typeof v!="function"||!(p in pe.prototype))return!1;if(f===v)return!0;var E=ud(v);return!!E&&f===E[0]}function M2(f){return!!Pu&&Pu in f}var R2=ga?Zr:Fd;function Gu(f){var p=f&&f.constructor,v=typeof p=="function"&&p.prototype||Es;return f===v}function K0(f){return f===f&&!Ue(f)}function J0(f,p){return function(v){return v==null?!1:v[f]===p&&(p!==e||f in De(v))}}function j2(f){var p=Wc(f,function(E){return v.size===a&&v.clear(),E}),v=p.cache;return p}function N2(f,p){var v=f[1],E=p[1],M=v|E,V=M<(m|y|R),rt=E==R&&v==w||E==R&&v==W&&f[7].length<=p[8]||E==(R|W)&&p[7].length<=p[8]&&v==w;if(!(V||rt))return f;E&m&&(f[2]=p[2],M|=v&m?0:C);var ut=p[3];if(ut){var ht=f[3];f[3]=ht?I0(ht,ut,p[4]):ut,f[4]=ht?rr(f[3],l):p[4]}return ut=p[5],ut&&(ht=f[5],f[5]=ht?B0(ht,ut,p[6]):ut,f[6]=ht?rr(f[5],l):p[6]),ut=p[7],ut&&(f[7]=ut),E&R&&(f[8]=f[8]==null?p[8]:yi(f[8],p[8])),f[9]==null&&(f[9]=p[9]),f[0]=p[0],f[1]=M,f}function U2(f){var p=[];if(f!=null)for(var v in De(f))p.push(v);return p}function z2(f){return T.call(f)}function Q0(f,p,v){return p=Ze(p===e?f.length-1:p,0),function(){for(var E=arguments,M=-1,V=Ze(E.length-p,0),rt=gt(V);++M<V;)rt[M]=E[p+M];M=-1;for(var ut=gt(p+1);++M<p;)ut[M]=E[M];return ut[p]=v(rt),ki(f,this,ut)}}function Z0(f,p){return p.length<2?f:Do(f,Bn(p,0,-1))}function W2(f,p){for(var v=f.length,E=yi(p.length,v),M=Qi(f);E--;){var V=p[E];f[E]=Qr(V,v)?M[V]:e}return f}function dd(f,p){if(!(p==="constructor"&&typeof f[p]=="function")&&p!="__proto__")return f[p]}var tv=iv(x0),Hu=Ji||function(f,p){return le.setTimeout(f,p)},pd=iv(h2);function ev(f,p,v){var E=p+"";return pd(f,I2(E,G2(O2(E),v)))}function iv(f){var p=0,v=0;return function(){var E=aS(),M=dt-(E-v);if(v=E,M>0){if(++p>=pt)return arguments[0]}else p=0;return f.apply(e,arguments)}}function jc(f,p){var v=-1,E=f.length,M=E-1;for(p=p===e?E:p;++v<p;){var V=Kf(v,M),rt=f[V];f[V]=f[v],f[v]=rt}return f.length=p,f}var nv=j2(function(f){var p=[];return f.charCodeAt(0)===46&&p.push(""),f.replace(Qo,function(v,E,M,V){p.push(M?V.replace(Fn,"$1"):E||v)}),p});function Sr(f){if(typeof f=="string"||Cn(f))return f;var p=f+"";return p=="0"&&1/f==-k?"-0":p}function Ao(f){if(f!=null){try{return ma.call(f)}catch{}try{return f+""}catch{}}return""}function G2(f,p){return qi(N,function(v){var E="_."+v[0];p&v[1]&&!Ss(f,E)&&f.push(E)}),f.sort()}function rv(f){if(f instanceof pe)return f.clone();var p=new Pn(f.__wrapped__,f.__chain__);return p.__actions__=Qi(f.__actions__),p.__index__=f.__index__,p.__values__=f.__values__,p}function H2(f,p,v){(v?Bi(f,p,v):p===e)?p=1:p=Ze(oe(p),0);var E=f==null?0:f.length;if(!E||p<1)return[];for(var M=0,V=0,rt=gt(kn(E/p));M<E;)rt[V++]=Bn(f,M,M+=p);return rt}function X2(f){for(var p=-1,v=f==null?0:f.length,E=0,M=[];++p<v;){var V=f[p];V&&(M[E++]=V)}return M}function Y2(){var f=arguments.length;if(!f)return[];for(var p=gt(f-1),v=arguments[0],E=f;E--;)p[E-1]=arguments[E];return nr(te(v)?Qi(v):[v],li(p,1))}var V2=he(function(f,p){return $e(f)?ju(f,li(p,1,$e,!0)):[]}),q2=he(function(f,p){var v=Ln(p);return $e(v)&&(v=e),$e(f)?ju(f,li(p,1,$e,!0),qt(v,2)):[]}),$2=he(function(f,p){var v=Ln(p);return $e(v)&&(v=e),$e(f)?ju(f,li(p,1,$e,!0),e,v):[]});function K2(f,p,v){var E=f==null?0:f.length;return E?(p=v||p===e?1:oe(p),Bn(f,p<0?0:p,E)):[]}function J2(f,p,v){var E=f==null?0:f.length;return E?(p=v||p===e?1:oe(p),p=E-p,Bn(f,0,p<0?0:p)):[]}function Q2(f,p){return f&&f.length?Oc(f,qt(p,3),!0,!0):[]}function Z2(f,p){return f&&f.length?Oc(f,qt(p,3),!0):[]}function tx(f,p,v,E){var M=f==null?0:f.length;return M?(v&&typeof v!="number"&&Bi(f,p,v)&&(v=0,E=M),YS(f,p,v,E)):[]}function sv(f,p,v){var E=f==null?0:f.length;if(!E)return-1;var M=v==null?0:oe(v);return M<0&&(M=Ze(E+M,0)),ha(f,qt(p,3),M)}function ov(f,p,v){var E=f==null?0:f.length;if(!E)return-1;var M=E-1;return v!==e&&(M=oe(v),M=v<0?Ze(E+M,0):yi(M,E-1)),ha(f,qt(p,3),M,!0)}function av(f){var p=f==null?0:f.length;return p?li(f,1):[]}function ex(f){var p=f==null?0:f.length;return p?li(f,k):[]}function ix(f,p){var v=f==null?0:f.length;return v?(p=p===e?1:oe(p),li(f,p)):[]}function nx(f){for(var p=-1,v=f==null?0:f.length,E={};++p<v;){var M=f[p];E[M[0]]=M[1]}return E}function uv(f){return f&&f.length?f[0]:e}function rx(f,p,v){var E=f==null?0:f.length;if(!E)return-1;var M=v==null?0:oe(v);return M<0&&(M=Ze(E+M,0)),$i(f,p,M)}function sx(f){var p=f==null?0:f.length;return p?Bn(f,0,-1):[]}var ox=he(function(f){var p=Fe(f,ed);return p.length&&p[0]===f[0]?Xf(p):[]}),ax=he(function(f){var p=Ln(f),v=Fe(f,ed);return p===Ln(v)?p=e:v.pop(),v.length&&v[0]===f[0]?Xf(v,qt(p,2)):[]}),ux=he(function(f){var p=Ln(f),v=Fe(f,ed);return p=typeof p=="function"?p:e,p&&v.pop(),v.length&&v[0]===f[0]?Xf(v,e,p):[]});function lx(f,p){return f==null?"":sS.call(f,p)}function Ln(f){var p=f==null?0:f.length;return p?f[p-1]:e}function cx(f,p,v){var E=f==null?0:f.length;if(!E)return-1;var M=E;return v!==e&&(M=oe(v),M=M<0?Ze(E+M,0):yi(M,E-1)),p===p?Of(f,p,M):ha(f,bu,M,!0)}function hx(f,p){return f&&f.length?C0(f,oe(p)):e}var fx=he(lv);function lv(f,p){return f&&f.length&&p&&p.length?$f(f,p):f}function dx(f,p,v){return f&&f.length&&p&&p.length?$f(f,p,qt(v,2)):f}function px(f,p,v){return f&&f.length&&p&&p.length?$f(f,p,e,v):f}var gx=Jr(function(f,p){var v=f==null?0:f.length,E=zf(f,p);return S0(f,Fe(p,function(M){return Qr(M,v)?+M:M}).sort(P0)),E});function mx(f,p){var v=[];if(!(f&&f.length))return v;var E=-1,M=[],V=f.length;for(p=qt(p,3);++E<V;){var rt=f[E];p(rt,E,f)&&(v.push(rt),M.push(E))}return S0(f,M),v}function gd(f){return f==null?f:lS.call(f)}function vx(f,p,v){var E=f==null?0:f.length;return E?(v&&typeof v!="number"&&Bi(f,p,v)?(p=0,v=E):(p=p==null?0:oe(p),v=v===e?E:oe(v)),Bn(f,p,v)):[]}function yx(f,p){return Fc(f,p)}function Cx(f,p,v){return Qf(f,p,qt(v,2))}function _x(f,p){var v=f==null?0:f.length;if(v){var E=Fc(f,p);if(E<v&&or(f[E],p))return E}return-1}function wx(f,p){return Fc(f,p,!0)}function Sx(f,p,v){return Qf(f,p,qt(v,2),!0)}function xx(f,p){var v=f==null?0:f.length;if(v){var E=Fc(f,p,!0)-1;if(or(f[E],p))return E}return-1}function Dx(f){return f&&f.length?D0(f):[]}function bx(f,p){return f&&f.length?D0(f,qt(p,2)):[]}function Ax(f){var p=f==null?0:f.length;return p?Bn(f,1,p):[]}function Ex(f,p,v){return f&&f.length?(p=v||p===e?1:oe(p),Bn(f,0,p<0?0:p)):[]}function Tx(f,p,v){var E=f==null?0:f.length;return E?(p=v||p===e?1:oe(p),p=E-p,Bn(f,p<0?0:p,E)):[]}function Fx(f,p){return f&&f.length?Oc(f,qt(p,3),!1,!0):[]}function Ox(f,p){return f&&f.length?Oc(f,qt(p,3)):[]}var kx=he(function(f){return Fs(li(f,1,$e,!0))}),Px=he(function(f){var p=Ln(f);return $e(p)&&(p=e),Fs(li(f,1,$e,!0),qt(p,2))}),Ix=he(function(f){var p=Ln(f);return p=typeof p=="function"?p:e,Fs(li(f,1,$e,!0),e,p)});function Bx(f){return f&&f.length?Fs(f):[]}function Lx(f,p){return f&&f.length?Fs(f,qt(p,2)):[]}function Mx(f,p){return p=typeof p=="function"?p:e,f&&f.length?Fs(f,e,p):[]}function md(f){if(!(f&&f.length))return[];var p=0;return f=On(f,function(v){if($e(v))return p=Ze(v.length,p),!0}),da(p,function(v){return Fe(f,xs(v))})}function cv(f,p){if(!(f&&f.length))return[];var v=md(f);return p==null?v:Fe(v,function(E){return ki(p,e,E)})}var Rx=he(function(f,p){return $e(f)?ju(f,p):[]}),jx=he(function(f){return td(On(f,$e))}),Nx=he(function(f){var p=Ln(f);return $e(p)&&(p=e),td(On(f,$e),qt(p,2))}),Ux=he(function(f){var p=Ln(f);return p=typeof p=="function"?p:e,td(On(f,$e),e,p)}),zx=he(md);function Wx(f,p){return T0(f||[],p||[],Ru)}function Gx(f,p){return T0(f||[],p||[],zu)}var Hx=he(function(f){var p=f.length,v=p>1?f[p-1]:e;return v=typeof v=="function"?(f.pop(),v):e,cv(f,v)});function hv(f){var p=G(f);return p.__chain__=!0,p}function Xx(f,p){return p(f),f}function Nc(f,p){return p(f)}var Yx=Jr(function(f){var p=f.length,v=p?f[0]:0,E=this.__wrapped__,M=function(V){return zf(V,f)};return p>1||this.__actions__.length||!(E instanceof pe)||!Qr(v)?this.thru(M):(E=E.slice(v,+v+(p?1:0)),E.__actions__.push({func:Nc,args:[M],thisArg:e}),new Pn(E,this.__chain__).thru(function(V){return p&&!V.length&&V.push(e),V}))});function Vx(){return hv(this)}function qx(){return new Pn(this.value(),this.__chain__)}function $x(){this.__values__===e&&(this.__values__=bv(this.value()));var f=this.__index__>=this.__values__.length,p=f?e:this.__values__[this.__index__++];return{done:f,value:p}}function Kx(){return this}function Jx(f){for(var p,v=this;v instanceof Dc;){var E=rv(v);E.__index__=0,E.__values__=e,p?M.__wrapped__=E:p=E;var M=E;v=v.__wrapped__}return M.__wrapped__=f,p}function Qx(){var f=this.__wrapped__;if(f instanceof pe){var p=f;return this.__actions__.length&&(p=new pe(this)),p=p.reverse(),p.__actions__.push({func:Nc,args:[gd],thisArg:e}),new Pn(p,this.__chain__)}return this.thru(gd)}function Zx(){return E0(this.__wrapped__,this.__actions__)}var tD=kc(function(f,p,v){Se.call(f,v)?++f[v]:$r(f,v,1)});function eD(f,p,v){var E=te(f)?ua:XS;return v&&Bi(f,p,v)&&(p=e),E(f,qt(p,3))}function iD(f,p){var v=te(f)?On:c0;return v(f,qt(p,3))}var nD=j0(sv),rD=j0(ov);function sD(f,p){return li(Uc(f,p),1)}function oD(f,p){return li(Uc(f,p),k)}function aD(f,p,v){return v=v===e?1:oe(v),li(Uc(f,p),v)}function fv(f,p){var v=te(f)?qi:Ts;return v(f,qt(p,3))}function dv(f,p){var v=te(f)?_f:l0;return v(f,qt(p,3))}var uD=kc(function(f,p,v){Se.call(f,v)?f[v].push(p):$r(f,v,[p])});function lD(f,p,v,E){f=Zi(f)?f:Da(f),v=v&&!E?oe(v):0;var M=f.length;return v<0&&(v=Ze(M+v,0)),Xc(f)?v<=M&&f.indexOf(p,v)>-1:!!M&&$i(f,p,v)>-1}var cD=he(function(f,p,v){var E=-1,M=typeof p=="function",V=Zi(f)?gt(f.length):[];return Ts(f,function(rt){V[++E]=M?ki(p,rt,v):Nu(rt,p,v)}),V}),hD=kc(function(f,p,v){$r(f,v,p)});function Uc(f,p){var v=te(f)?Fe:m0;return v(f,qt(p,3))}function fD(f,p,v,E){return f==null?[]:(te(p)||(p=p==null?[]:[p]),v=E?e:v,te(v)||(v=v==null?[]:[v]),_0(f,p,v))}var dD=kc(function(f,p,v){f[v?0:1].push(p)},function(){return[[],[]]});function pD(f,p,v){var E=te(f)?la:fc,M=arguments.length<3;return E(f,qt(p,4),v,M,Ts)}function gD(f,p,v){var E=te(f)?lc:fc,M=arguments.length<3;return E(f,qt(p,4),v,M,l0)}function mD(f,p){var v=te(f)?On:c0;return v(f,Gc(qt(p,3)))}function vD(f){var p=te(f)?s0:l2;return p(f)}function yD(f,p,v){(v?Bi(f,p,v):p===e)?p=1:p=oe(p);var E=te(f)?US:c2;return E(f,p)}function CD(f){var p=te(f)?zS:f2;return p(f)}function _D(f){if(f==null)return 0;if(Zi(f))return Xc(f)?bs(f):f.length;var p=Ci(f);return p==lt||p==jt?f.size:Vf(f).length}function wD(f,p,v){var E=te(f)?ca:d2;return v&&Bi(f,p,v)&&(p=e),E(f,qt(p,3))}var SD=he(function(f,p){if(f==null)return[];var v=p.length;return v>1&&Bi(f,p[0],p[1])?p=[]:v>2&&Bi(p[0],p[1],p[2])&&(p=[p[0]]),_0(f,li(p,1),[])}),zc=He||function(){return le.Date.now()};function xD(f,p){if(typeof p!="function")throw new Ki(n);return f=oe(f),function(){if(--f<1)return p.apply(this,arguments)}}function pv(f,p,v){return p=v?e:p,p=f&&p==null?f.length:p,Kr(f,R,e,e,e,e,p)}function gv(f,p){var v;if(typeof p!="function")throw new Ki(n);return f=oe(f),function(){return--f>0&&(v=p.apply(this,arguments)),f<=1&&(p=e),v}}var vd=he(function(f,p,v){var E=m;if(v.length){var M=rr(v,Sa(vd));E|=B}return Kr(f,E,p,v,M)}),mv=he(function(f,p,v){var E=m|y;if(v.length){var M=rr(v,Sa(mv));E|=B}return Kr(p,E,f,v,M)});function vv(f,p,v){p=v?e:p;var E=Kr(f,w,e,e,e,e,e,p);return E.placeholder=vv.placeholder,E}function yv(f,p,v){p=v?e:p;var E=Kr(f,F,e,e,e,e,e,p);return E.placeholder=yv.placeholder,E}function Cv(f,p,v){var E,M,V,rt,ut,ht,xt=0,Dt=!1,Et=!1,Rt=!0;if(typeof f!="function")throw new Ki(n);p=Mn(p)||0,Ue(v)&&(Dt=!!v.leading,Et="maxWait"in v,V=Et?Ze(Mn(v.maxWait)||0,p):V,Rt="trailing"in v?!!v.trailing:Rt);function Ht(Ke){var ar=E,es=M;return E=M=e,xt=Ke,rt=f.apply(es,ar),rt}function $t(Ke){return xt=Ke,ut=Hu(fe,p),Dt?Ht(Ke):rt}function ae(Ke){var ar=Ke-ht,es=Ke-xt,jv=p-ar;return Et?yi(jv,V-es):jv}function Kt(Ke){var ar=Ke-ht,es=Ke-xt;return ht===e||ar>=p||ar<0||Et&&es>=V}function fe(){var Ke=zc();if(Kt(Ke))return ge(Ke);ut=Hu(fe,ae(Ke))}function ge(Ke){return ut=e,Rt&&E?Ht(Ke):(E=M=e,rt)}function _n(){ut!==e&&F0(ut),xt=0,E=ht=M=ut=e}function Li(){return ut===e?rt:ge(zc())}function wn(){var Ke=zc(),ar=Kt(Ke);if(E=arguments,M=this,ht=Ke,ar){if(ut===e)return $t(ht);if(Et)return F0(ut),ut=Hu(fe,p),Ht(ht)}return ut===e&&(ut=Hu(fe,p)),rt}return wn.cancel=_n,wn.flush=Li,wn}var DD=he(function(f,p){return u0(f,1,p)}),bD=he(function(f,p,v){return u0(f,Mn(p)||0,v)});function AD(f){return Kr(f,X)}function Wc(f,p){if(typeof f!="function"||p!=null&&typeof p!="function")throw new Ki(n);var v=function(){var E=arguments,M=p?p.apply(this,E):E[0],V=v.cache;if(V.has(M))return V.get(M);var rt=f.apply(this,E);return v.cache=V.set(M,rt)||V,rt};return v.cache=new(Wc.Cache||qr),v}Wc.Cache=qr;function Gc(f){if(typeof f!="function")throw new Ki(n);return function(){var p=arguments;switch(p.length){case 0:return!f.call(this);case 1:return!f.call(this,p[0]);case 2:return!f.call(this,p[0],p[1]);case 3:return!f.call(this,p[0],p[1],p[2])}return!f.apply(this,p)}}function ED(f){return gv(2,f)}var TD=p2(function(f,p){p=p.length==1&&te(p[0])?Fe(p[0],Pi(qt())):Fe(li(p,1),Pi(qt()));var v=p.length;return he(function(E){for(var M=-1,V=yi(E.length,v);++M<V;)E[M]=p[M].call(this,E[M]);return ki(f,this,E)})}),yd=he(function(f,p){var v=rr(p,Sa(yd));return Kr(f,B,e,p,v)}),_v=he(function(f,p){var v=rr(p,Sa(_v));return Kr(f,U,e,p,v)}),FD=Jr(function(f,p){return Kr(f,W,e,e,e,p)});function OD(f,p){if(typeof f!="function")throw new Ki(n);return p=p===e?p:oe(p),he(f,p)}function kD(f,p){if(typeof f!="function")throw new Ki(n);return p=p==null?0:Ze(oe(p),0),he(function(v){var E=v[p],M=ks(v,0,p);return E&&nr(M,E),ki(f,this,M)})}function PD(f,p,v){var E=!0,M=!0;if(typeof f!="function")throw new Ki(n);return Ue(v)&&(E="leading"in v?!!v.leading:E,M="trailing"in v?!!v.trailing:M),Cv(f,p,{leading:E,maxWait:p,trailing:M})}function ID(f){return pv(f,1)}function BD(f,p){return yd(id(p),f)}function LD(){if(!arguments.length)return[];var f=arguments[0];return te(f)?f:[f]}function MD(f){return In(f,h)}function RD(f,p){return p=typeof p=="function"?p:e,In(f,h,p)}function jD(f){return In(f,u|h)}function ND(f,p){return p=typeof p=="function"?p:e,In(f,u|h,p)}function UD(f,p){return p==null||a0(f,p,si(p))}function or(f,p){return f===p||f!==f&&p!==p}var zD=Lc(Hf),WD=Lc(function(f,p){return f>=p}),Eo=d0(function(){return arguments}())?d0:function(f){return Xe(f)&&Se.call(f,"callee")&&!re.call(f,"callee")},te=gt.isArray,GD=nc?Pi(nc):JS;function Zi(f){return f!=null&&Hc(f.length)&&!Zr(f)}function $e(f){return Xe(f)&&Zi(f)}function HD(f){return f===!0||f===!1||Xe(f)&&Ii(f)==Y}var Ps=rS||Fd,XD=rc?Pi(rc):QS;function YD(f){return Xe(f)&&f.nodeType===1&&!Xu(f)}function VD(f){if(f==null)return!0;if(Zi(f)&&(te(f)||typeof f=="string"||typeof f.splice=="function"||Ps(f)||xa(f)||Eo(f)))return!f.length;var p=Ci(f);if(p==lt||p==jt)return!f.size;if(Gu(f))return!Vf(f).length;for(var v in f)if(Se.call(f,v))return!1;return!0}function qD(f,p){return Uu(f,p)}function $D(f,p,v){v=typeof v=="function"?v:e;var E=v?v(f,p):e;return E===e?Uu(f,p,e,v):!!E}function Cd(f){if(!Xe(f))return!1;var p=Ii(f);return p==Z||p==it||typeof f.message=="string"&&typeof f.name=="string"&&!Xu(f)}function KD(f){return typeof f=="number"&&e0(f)}function Zr(f){if(!Ue(f))return!1;var p=Ii(f);return p==J||p==nt||p==ot||p==Tt}function wv(f){return typeof f=="number"&&f==oe(f)}function Hc(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=K}function Ue(f){var p=typeof f;return f!=null&&(p=="object"||p=="function")}function Xe(f){return f!=null&&typeof f=="object"}var Sv=sc?Pi(sc):t2;function JD(f,p){return f===p||Yf(f,p,ld(p))}function QD(f,p,v){return v=typeof v=="function"?v:e,Yf(f,p,ld(p),v)}function ZD(f){return xv(f)&&f!=+f}function tb(f){if(R2(f))throw new Qt(o);return p0(f)}function eb(f){return f===null}function ib(f){return f==null}function xv(f){return typeof f=="number"||Xe(f)&&Ii(f)==At}function Xu(f){if(!Xe(f)||Ii(f)!=et)return!1;var p=kt(f);if(p===null)return!0;var v=Se.call(p,"constructor")&&p.constructor;return typeof v=="function"&&v instanceof v&&ma.call(v)==A}var _d=oc?Pi(oc):e2;function nb(f){return wv(f)&&f>=-K&&f<=K}var Dv=ac?Pi(ac):i2;function Xc(f){return typeof f=="string"||!te(f)&&Xe(f)&&Ii(f)==Mt}function Cn(f){return typeof f=="symbol"||Xe(f)&&Ii(f)==se}var xa=Du?Pi(Du):n2;function rb(f){return f===e}function sb(f){return Xe(f)&&Ci(f)==Le}function ob(f){return Xe(f)&&Ii(f)==qe}var ab=Lc(qf),ub=Lc(function(f,p){return f<=p});function bv(f){if(!f)return[];if(Zi(f))return Xc(f)?vn(f):Qi(f);if(Vt&&f[Vt])return mc(f[Vt]());var p=Ci(f),v=p==lt?Ou:p==jt?Yr:Da;return v(f)}function ts(f){if(!f)return f===0?f:0;if(f=Mn(f),f===k||f===-k){var p=f<0?-1:1;return p*S}return f===f?f:0}function oe(f){var p=ts(f),v=p%1;return p===p?v?p-v:p:0}function Av(f){return f?xo(oe(f),0,O):0}function Mn(f){if(typeof f=="number")return f;if(Cn(f))return _;if(Ue(f)){var p=typeof f.valueOf=="function"?f.valueOf():f;f=Ue(p)?p+"":p}if(typeof f!="string")return f===0?f:+f;f=Tu(f);var v=Cu.test(f);return v||ps.test(f)?we(f.slice(2),v?2:8):ao.test(f)?_:+f}function Ev(f){return wr(f,tn(f))}function lb(f){return f?xo(oe(f),-K,K):f===0?f:0}function be(f){return f==null?"":yn(f)}var cb=_a(function(f,p){if(Gu(p)||Zi(p)){wr(p,si(p),f);return}for(var v in p)Se.call(p,v)&&Ru(f,v,p[v])}),Tv=_a(function(f,p){wr(p,tn(p),f)}),Yc=_a(function(f,p,v,E){wr(p,tn(p),f,E)}),hb=_a(function(f,p,v,E){wr(p,si(p),f,E)}),fb=Jr(zf);function db(f,p){var v=Ca(f);return p==null?v:o0(v,p)}var pb=he(function(f,p){f=De(f);var v=-1,E=p.length,M=E>2?p[2]:e;for(M&&Bi(p[0],p[1],M)&&(E=1);++v<E;)for(var V=p[v],rt=tn(V),ut=-1,ht=rt.length;++ut<ht;){var xt=rt[ut],Dt=f[xt];(Dt===e||or(Dt,Es[xt])&&!Se.call(f,xt))&&(f[xt]=V[xt])}return f}),gb=he(function(f){return f.push(e,X0),ki(Fv,e,f)});function mb(f,p){return cc(f,qt(p,3),_r)}function vb(f,p){return cc(f,qt(p,3),Gf)}function yb(f,p){return f==null?f:Wf(f,qt(p,3),tn)}function Cb(f,p){return f==null?f:h0(f,qt(p,3),tn)}function _b(f,p){return f&&_r(f,qt(p,3))}function wb(f,p){return f&&Gf(f,qt(p,3))}function Sb(f){return f==null?[]:Ec(f,si(f))}function xb(f){return f==null?[]:Ec(f,tn(f))}function wd(f,p,v){var E=f==null?e:Do(f,p);return E===e?v:E}function Db(f,p){return f!=null&&q0(f,p,VS)}function Sd(f,p){return f!=null&&q0(f,p,qS)}var bb=U0(function(f,p,v){p!=null&&typeof p.toString!="function"&&(p=T.call(p)),f[p]=v},Dd(en)),Ab=U0(function(f,p,v){p!=null&&typeof p.toString!="function"&&(p=T.call(p)),Se.call(f,p)?f[p].push(v):f[p]=[v]},qt),Eb=he(Nu);function si(f){return Zi(f)?r0(f):Vf(f)}function tn(f){return Zi(f)?r0(f,!0):r2(f)}function Tb(f,p){var v={};return p=qt(p,3),_r(f,function(E,M,V){$r(v,p(E,M,V),E)}),v}function Fb(f,p){var v={};return p=qt(p,3),_r(f,function(E,M,V){$r(v,M,p(E,M,V))}),v}var Ob=_a(function(f,p,v){Tc(f,p,v)}),Fv=_a(function(f,p,v,E){Tc(f,p,v,E)}),kb=Jr(function(f,p){var v={};if(f==null)return v;var E=!1;p=Fe(p,function(V){return V=Os(V,f),E||(E=V.length>1),V}),wr(f,ad(f),v),E&&(v=In(v,u|c|h,b2));for(var M=p.length;M--;)Zf(v,p[M]);return v});function Pb(f,p){return Ov(f,Gc(qt(p)))}var Ib=Jr(function(f,p){return f==null?{}:o2(f,p)});function Ov(f,p){if(f==null)return{};var v=Fe(ad(f),function(E){return[E]});return p=qt(p),w0(f,v,function(E,M){return p(E,M[0])})}function Bb(f,p,v){p=Os(p,f);var E=-1,M=p.length;for(M||(M=1,f=e);++E<M;){var V=f==null?e:f[Sr(p[E])];V===e&&(E=M,V=v),f=Zr(V)?V.call(f):V}return f}function Lb(f,p,v){return f==null?f:zu(f,p,v)}function Mb(f,p,v,E){return E=typeof E=="function"?E:e,f==null?f:zu(f,p,v,E)}var kv=G0(si),Pv=G0(tn);function Rb(f,p,v){var E=te(f),M=E||Ps(f)||xa(f);if(p=qt(p,4),v==null){var V=f&&f.constructor;M?v=E?new V:[]:Ue(f)?v=Zr(V)?Ca(kt(f)):{}:v={}}return(M?qi:_r)(f,function(rt,ut,ht){return p(v,rt,ut,ht)}),v}function jb(f,p){return f==null?!0:Zf(f,p)}function Nb(f,p,v){return f==null?f:A0(f,p,id(v))}function Ub(f,p,v,E){return E=typeof E=="function"?E:e,f==null?f:A0(f,p,id(v),E)}function Da(f){return f==null?[]:yo(f,si(f))}function zb(f){return f==null?[]:yo(f,tn(f))}function Wb(f,p,v){return v===e&&(v=p,p=e),v!==e&&(v=Mn(v),v=v===v?v:0),p!==e&&(p=Mn(p),p=p===p?p:0),xo(Mn(f),p,v)}function Gb(f,p,v){return p=ts(p),v===e?(v=p,p=0):v=ts(v),f=Mn(f),$S(f,p,v)}function Hb(f,p,v){if(v&&typeof v!="boolean"&&Bi(f,p,v)&&(p=v=e),v===e&&(typeof p=="boolean"?(v=p,p=e):typeof f=="boolean"&&(v=f,f=e)),f===e&&p===e?(f=0,p=1):(f=ts(f),p===e?(p=f,f=0):p=ts(p)),f>p){var E=f;f=p,p=E}if(v||f%1||p%1){var M=i0();return yi(f+M*(p-f+Pt("1e-"+((M+"").length-1))),p)}return Kf(f,p)}var Xb=wa(function(f,p,v){return p=p.toLowerCase(),f+(v?Iv(p):p)});function Iv(f){return xd(be(f).toLowerCase())}function Bv(f){return f=be(f),f&&f.replace(We,bf).replace(zr,"")}function Yb(f,p,v){f=be(f),p=yn(p);var E=f.length;v=v===e?E:xo(oe(v),0,E);var M=v;return v-=p.length,v>=0&&f.slice(v,M)==p}function Vb(f){return f=be(f),f&&gu.test(f)?f.replace(Jo,Af):f}function qb(f){return f=be(f),f&&oo.test(f)?f.replace(gr,"\\$&"):f}var $b=wa(function(f,p,v){return f+(v?"-":"")+p.toLowerCase()}),Kb=wa(function(f,p,v){return f+(v?" ":"")+p.toLowerCase()}),Jb=R0("toLowerCase");function Qb(f,p,v){f=be(f),p=oe(p);var E=p?bs(f):0;if(!p||E>=p)return f;var M=(p-E)/2;return Bc(wc(M),v)+f+Bc(kn(M),v)}function Zb(f,p,v){f=be(f),p=oe(p);var E=p?bs(f):0;return p&&E<p?f+Bc(p-E,v):f}function tA(f,p,v){f=be(f),p=oe(p);var E=p?bs(f):0;return p&&E<p?Bc(p-E,v)+f:f}function eA(f,p,v){return v||p==null?p=0:p&&(p=+p),uS(be(f).replace(Tn,""),p||0)}function iA(f,p,v){return(v?Bi(f,p,v):p===e)?p=1:p=oe(p),Jf(be(f),p)}function nA(){var f=arguments,p=be(f[0]);return f.length<3?p:p.replace(f[1],f[2])}var rA=wa(function(f,p,v){return f+(v?"_":"")+p.toLowerCase()});function sA(f,p,v){return v&&typeof v!="number"&&Bi(f,p,v)&&(p=v=e),v=v===e?O:v>>>0,v?(f=be(f),f&&(typeof p=="string"||p!=null&&!_d(p))&&(p=yn(p),!p&&Ds(f))?ks(vn(f),0,v):f.split(p,v)):[]}var oA=wa(function(f,p,v){return f+(v?" ":"")+xd(p)});function aA(f,p,v){return f=be(f),v=v==null?0:xo(oe(v),0,f.length),p=yn(p),f.slice(v,v+p.length)==p}function uA(f,p,v){var E=G.templateSettings;v&&Bi(f,p,v)&&(p=e),f=be(f),p=Yc({},p,E,H0);var M=Yc({},p.imports,E.imports,H0),V=si(M),rt=yo(M,V),ut,ht,xt=0,Dt=p.interpolate||Mr,Et="__p += '",Rt=As((p.escape||Mr).source+"|"+Dt.source+"|"+(Dt===fs?ds:Mr).source+"|"+(p.evaluate||Mr).source+"|$","g"),Ht="//# sourceURL="+(Se.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Gr+"]")+`
`;f.replace(Rt,function(Kt,fe,ge,_n,Li,wn){return ge||(ge=_n),Et+=f.slice(xt,wn).replace(Ge,Ef),fe&&(ut=!0,Et+=`' +
__e(`+fe+`) +
'`),Li&&(ht=!0,Et+=`';
`+Li+`;
__p += '`),ge&&(Et+=`' +
((__t = (`+ge+`)) == null ? '' : __t) +
'`),xt=wn+Kt.length,Kt}),Et+=`';
`;var $t=Se.call(p,"variable")&&p.variable;if(!$t)Et=`with (obj) {
`+Et+`
}
`;else if(Br.test($t))throw new Qt(s);Et=(ht?Et.replace($o,""):Et).replace(Vn,"$1").replace(pu,"$1;"),Et="function("+($t||"obj")+`) {
`+($t?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ut?", __e = _.escape":"")+(ht?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Et+`return __p
}`;var ae=Mv(function(){return ve(V,Ht+"return "+Et).apply(e,rt)});if(ae.source=Et,Cd(ae))throw ae;return ae}function lA(f){return be(f).toLowerCase()}function cA(f){return be(f).toUpperCase()}function hA(f,p,v){if(f=be(f),f&&(v||p===e))return Tu(f);if(!f||!(p=yn(p)))return f;var E=vn(f),M=vn(p),V=pc(E,M),rt=pa(E,M)+1;return ks(E,V,rt).join("")}function fA(f,p,v){if(f=be(f),f&&(v||p===e))return f.slice(0,Cc(f)+1);if(!f||!(p=yn(p)))return f;var E=vn(f),M=pa(E,vn(p))+1;return ks(E,0,M).join("")}function dA(f,p,v){if(f=be(f),f&&(v||p===e))return f.replace(Tn,"");if(!f||!(p=yn(p)))return f;var E=vn(f),M=pc(E,vn(p));return ks(E,M).join("")}function pA(f,p){var v=$,E=st;if(Ue(p)){var M="separator"in p?p.separator:M;v="length"in p?oe(p.length):v,E="omission"in p?yn(p.omission):E}f=be(f);var V=f.length;if(Ds(f)){var rt=vn(f);V=rt.length}if(v>=V)return f;var ut=v-bs(E);if(ut<1)return E;var ht=rt?ks(rt,0,ut).join(""):f.slice(0,ut);if(M===e)return ht+E;if(rt&&(ut+=ht.length-ut),_d(M)){if(f.slice(ut).search(M)){var xt,Dt=ht;for(M.global||(M=As(M.source,be(Lr.exec(M))+"g")),M.lastIndex=0;xt=M.exec(Dt);)var Et=xt.index;ht=ht.slice(0,Et===e?ut:Et)}}else if(f.indexOf(yn(M),ut)!=ut){var Rt=ht.lastIndexOf(M);Rt>-1&&(ht=ht.slice(0,Rt))}return ht+E}function gA(f){return f=be(f),f&&hs.test(f)?f.replace(Ko,kf):f}var mA=wa(function(f,p,v){return f+(v?" ":"")+p.toUpperCase()}),xd=R0("toUpperCase");function Lv(f,p,v){return f=be(f),p=v?e:p,p===e?gc(f)?Bf(f):xf(f):f.match(p)||[]}var Mv=he(function(f,p){try{return ki(f,e,p)}catch(v){return Cd(v)?v:new Qt(v)}}),vA=Jr(function(f,p){return qi(p,function(v){v=Sr(v),$r(f,v,vd(f[v],f))}),f});function yA(f){var p=f==null?0:f.length,v=qt();return f=p?Fe(f,function(E){if(typeof E[1]!="function")throw new Ki(n);return[v(E[0]),E[1]]}):[],he(function(E){for(var M=-1;++M<p;){var V=f[M];if(ki(V[0],this,E))return ki(V[1],this,E)}})}function CA(f){return HS(In(f,u))}function Dd(f){return function(){return f}}function _A(f,p){return f==null||f!==f?p:f}var wA=N0(),SA=N0(!0);function en(f){return f}function bd(f){return g0(typeof f=="function"?f:In(f,u))}function xA(f){return v0(In(f,u))}function DA(f,p){return y0(f,In(p,u))}var bA=he(function(f,p){return function(v){return Nu(v,f,p)}}),AA=he(function(f,p){return function(v){return Nu(f,v,p)}});function Ad(f,p,v){var E=si(p),M=Ec(p,E);v==null&&!(Ue(p)&&(M.length||!E.length))&&(v=p,p=f,f=this,M=Ec(p,si(p)));var V=!(Ue(v)&&"chain"in v)||!!v.chain,rt=Zr(f);return qi(M,function(ut){var ht=p[ut];f[ut]=ht,rt&&(f.prototype[ut]=function(){var xt=this.__chain__;if(V||xt){var Dt=f(this.__wrapped__),Et=Dt.__actions__=Qi(this.__actions__);return Et.push({func:ht,args:arguments,thisArg:f}),Dt.__chain__=xt,Dt}return ht.apply(f,nr([this.value()],arguments))})}),f}function EA(){return le._===this&&(le._=L),this}function Ed(){}function TA(f){return f=oe(f),he(function(p){return C0(p,f)})}var FA=rd(Fe),OA=rd(ua),kA=rd(ca);function Rv(f){return hd(f)?xs(Sr(f)):a2(f)}function PA(f){return function(p){return f==null?e:Do(f,p)}}var IA=z0(),BA=z0(!0);function Td(){return[]}function Fd(){return!1}function LA(){return{}}function MA(){return""}function RA(){return!0}function jA(f,p){if(f=oe(f),f<1||f>K)return[];var v=O,E=yi(f,O);p=qt(p),f-=O;for(var M=da(E,p);++v<f;)p(v);return M}function NA(f){return te(f)?Fe(f,Sr):Cn(f)?[f]:Qi(nv(be(f)))}function UA(f){var p=++ku;return be(f)+p}var zA=Ic(function(f,p){return f+p},0),WA=sd("ceil"),GA=Ic(function(f,p){return f/p},1),HA=sd("floor");function XA(f){return f&&f.length?Ac(f,en,Hf):e}function YA(f,p){return f&&f.length?Ac(f,qt(p,2),Hf):e}function VA(f){return Au(f,en)}function qA(f,p){return Au(f,qt(p,2))}function $A(f){return f&&f.length?Ac(f,en,qf):e}function KA(f,p){return f&&f.length?Ac(f,qt(p,2),qf):e}var JA=Ic(function(f,p){return f*p},1),QA=sd("round"),ZA=Ic(function(f,p){return f-p},0);function tE(f){return f&&f.length?Eu(f,en):0}function eE(f,p){return f&&f.length?Eu(f,qt(p,2)):0}return G.after=xD,G.ary=pv,G.assign=cb,G.assignIn=Tv,G.assignInWith=Yc,G.assignWith=hb,G.at=fb,G.before=gv,G.bind=vd,G.bindAll=vA,G.bindKey=mv,G.castArray=LD,G.chain=hv,G.chunk=H2,G.compact=X2,G.concat=Y2,G.cond=yA,G.conforms=CA,G.constant=Dd,G.countBy=tD,G.create=db,G.curry=vv,G.curryRight=yv,G.debounce=Cv,G.defaults=pb,G.defaultsDeep=gb,G.defer=DD,G.delay=bD,G.difference=V2,G.differenceBy=q2,G.differenceWith=$2,G.drop=K2,G.dropRight=J2,G.dropRightWhile=Q2,G.dropWhile=Z2,G.fill=tx,G.filter=iD,G.flatMap=sD,G.flatMapDeep=oD,G.flatMapDepth=aD,G.flatten=av,G.flattenDeep=ex,G.flattenDepth=ix,G.flip=AD,G.flow=wA,G.flowRight=SA,G.fromPairs=nx,G.functions=Sb,G.functionsIn=xb,G.groupBy=uD,G.initial=sx,G.intersection=ox,G.intersectionBy=ax,G.intersectionWith=ux,G.invert=bb,G.invertBy=Ab,G.invokeMap=cD,G.iteratee=bd,G.keyBy=hD,G.keys=si,G.keysIn=tn,G.map=Uc,G.mapKeys=Tb,G.mapValues=Fb,G.matches=xA,G.matchesProperty=DA,G.memoize=Wc,G.merge=Ob,G.mergeWith=Fv,G.method=bA,G.methodOf=AA,G.mixin=Ad,G.negate=Gc,G.nthArg=TA,G.omit=kb,G.omitBy=Pb,G.once=ED,G.orderBy=fD,G.over=FA,G.overArgs=TD,G.overEvery=OA,G.overSome=kA,G.partial=yd,G.partialRight=_v,G.partition=dD,G.pick=Ib,G.pickBy=Ov,G.property=Rv,G.propertyOf=PA,G.pull=fx,G.pullAll=lv,G.pullAllBy=dx,G.pullAllWith=px,G.pullAt=gx,G.range=IA,G.rangeRight=BA,G.rearg=FD,G.reject=mD,G.remove=mx,G.rest=OD,G.reverse=gd,G.sampleSize=yD,G.set=Lb,G.setWith=Mb,G.shuffle=CD,G.slice=vx,G.sortBy=SD,G.sortedUniq=Dx,G.sortedUniqBy=bx,G.split=sA,G.spread=kD,G.tail=Ax,G.take=Ex,G.takeRight=Tx,G.takeRightWhile=Fx,G.takeWhile=Ox,G.tap=Xx,G.throttle=PD,G.thru=Nc,G.toArray=bv,G.toPairs=kv,G.toPairsIn=Pv,G.toPath=NA,G.toPlainObject=Ev,G.transform=Rb,G.unary=ID,G.union=kx,G.unionBy=Px,G.unionWith=Ix,G.uniq=Bx,G.uniqBy=Lx,G.uniqWith=Mx,G.unset=jb,G.unzip=md,G.unzipWith=cv,G.update=Nb,G.updateWith=Ub,G.values=Da,G.valuesIn=zb,G.without=Rx,G.words=Lv,G.wrap=BD,G.xor=jx,G.xorBy=Nx,G.xorWith=Ux,G.zip=zx,G.zipObject=Wx,G.zipObjectDeep=Gx,G.zipWith=Hx,G.entries=kv,G.entriesIn=Pv,G.extend=Tv,G.extendWith=Yc,Ad(G,G),G.add=zA,G.attempt=Mv,G.camelCase=Xb,G.capitalize=Iv,G.ceil=WA,G.clamp=Wb,G.clone=MD,G.cloneDeep=jD,G.cloneDeepWith=ND,G.cloneWith=RD,G.conformsTo=UD,G.deburr=Bv,G.defaultTo=_A,G.divide=GA,G.endsWith=Yb,G.eq=or,G.escape=Vb,G.escapeRegExp=qb,G.every=eD,G.find=nD,G.findIndex=sv,G.findKey=mb,G.findLast=rD,G.findLastIndex=ov,G.findLastKey=vb,G.floor=HA,G.forEach=fv,G.forEachRight=dv,G.forIn=yb,G.forInRight=Cb,G.forOwn=_b,G.forOwnRight=wb,G.get=wd,G.gt=zD,G.gte=WD,G.has=Db,G.hasIn=Sd,G.head=uv,G.identity=en,G.includes=lD,G.indexOf=rx,G.inRange=Gb,G.invoke=Eb,G.isArguments=Eo,G.isArray=te,G.isArrayBuffer=GD,G.isArrayLike=Zi,G.isArrayLikeObject=$e,G.isBoolean=HD,G.isBuffer=Ps,G.isDate=XD,G.isElement=YD,G.isEmpty=VD,G.isEqual=qD,G.isEqualWith=$D,G.isError=Cd,G.isFinite=KD,G.isFunction=Zr,G.isInteger=wv,G.isLength=Hc,G.isMap=Sv,G.isMatch=JD,G.isMatchWith=QD,G.isNaN=ZD,G.isNative=tb,G.isNil=ib,G.isNull=eb,G.isNumber=xv,G.isObject=Ue,G.isObjectLike=Xe,G.isPlainObject=Xu,G.isRegExp=_d,G.isSafeInteger=nb,G.isSet=Dv,G.isString=Xc,G.isSymbol=Cn,G.isTypedArray=xa,G.isUndefined=rb,G.isWeakMap=sb,G.isWeakSet=ob,G.join=lx,G.kebabCase=$b,G.last=Ln,G.lastIndexOf=cx,G.lowerCase=Kb,G.lowerFirst=Jb,G.lt=ab,G.lte=ub,G.max=XA,G.maxBy=YA,G.mean=VA,G.meanBy=qA,G.min=$A,G.minBy=KA,G.stubArray=Td,G.stubFalse=Fd,G.stubObject=LA,G.stubString=MA,G.stubTrue=RA,G.multiply=JA,G.nth=hx,G.noConflict=EA,G.noop=Ed,G.now=zc,G.pad=Qb,G.padEnd=Zb,G.padStart=tA,G.parseInt=eA,G.random=Hb,G.reduce=pD,G.reduceRight=gD,G.repeat=iA,G.replace=nA,G.result=Bb,G.round=QA,G.runInContext=ct,G.sample=vD,G.size=_D,G.snakeCase=rA,G.some=wD,G.sortedIndex=yx,G.sortedIndexBy=Cx,G.sortedIndexOf=_x,G.sortedLastIndex=wx,G.sortedLastIndexBy=Sx,G.sortedLastIndexOf=xx,G.startCase=oA,G.startsWith=aA,G.subtract=ZA,G.sum=tE,G.sumBy=eE,G.template=uA,G.times=jA,G.toFinite=ts,G.toInteger=oe,G.toLength=Av,G.toLower=lA,G.toNumber=Mn,G.toSafeInteger=lb,G.toString=be,G.toUpper=cA,G.trim=hA,G.trimEnd=fA,G.trimStart=dA,G.truncate=pA,G.unescape=gA,G.uniqueId=UA,G.upperCase=mA,G.upperFirst=xd,G.each=fv,G.eachRight=dv,G.first=uv,Ad(G,function(){var f={};return _r(G,function(p,v){Se.call(G.prototype,v)||(f[v]=p)}),f}(),{chain:!1}),G.VERSION=t,qi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(f){G[f].placeholder=G}),qi(["drop","take"],function(f,p){pe.prototype[f]=function(v){v=v===e?1:Ze(oe(v),0);var E=this.__filtered__&&!p?new pe(this):this.clone();return E.__filtered__?E.__takeCount__=yi(v,E.__takeCount__):E.__views__.push({size:yi(v,O),type:f+(E.__dir__<0?"Right":"")}),E},pe.prototype[f+"Right"]=function(v){return this.reverse()[f](v).reverse()}}),qi(["filter","map","takeWhile"],function(f,p){var v=p+1,E=v==x||v==I;pe.prototype[f]=function(M){var V=this.clone();return V.__iteratees__.push({iteratee:qt(M,3),type:v}),V.__filtered__=V.__filtered__||E,V}}),qi(["head","last"],function(f,p){var v="take"+(p?"Right":"");pe.prototype[f]=function(){return this[v](1).value()[0]}}),qi(["initial","tail"],function(f,p){var v="drop"+(p?"":"Right");pe.prototype[f]=function(){return this.__filtered__?new pe(this):this[v](1)}}),pe.prototype.compact=function(){return this.filter(en)},pe.prototype.find=function(f){return this.filter(f).head()},pe.prototype.findLast=function(f){return this.reverse().find(f)},pe.prototype.invokeMap=he(function(f,p){return typeof f=="function"?new pe(this):this.map(function(v){return Nu(v,f,p)})}),pe.prototype.reject=function(f){return this.filter(Gc(qt(f)))},pe.prototype.slice=function(f,p){f=oe(f);var v=this;return v.__filtered__&&(f>0||p<0)?new pe(v):(f<0?v=v.takeRight(-f):f&&(v=v.drop(f)),p!==e&&(p=oe(p),v=p<0?v.dropRight(-p):v.take(p-f)),v)},pe.prototype.takeRightWhile=function(f){return this.reverse().takeWhile(f).reverse()},pe.prototype.toArray=function(){return this.take(O)},_r(pe.prototype,function(f,p){var v=/^(?:filter|find|map|reject)|While$/.test(p),E=/^(?:head|last)$/.test(p),M=G[E?"take"+(p=="last"?"Right":""):p],V=E||/^find/.test(p);M&&(G.prototype[p]=function(){var rt=this.__wrapped__,ut=E?[1]:arguments,ht=rt instanceof pe,xt=ut[0],Dt=ht||te(rt),Et=function(fe){var ge=M.apply(G,nr([fe],ut));return E&&Rt?ge[0]:ge};Dt&&v&&typeof xt=="function"&&xt.length!=1&&(ht=Dt=!1);var Rt=this.__chain__,Ht=!!this.__actions__.length,$t=V&&!Rt,ae=ht&&!Ht;if(!V&&Dt){rt=ae?rt:new pe(this);var Kt=f.apply(rt,ut);return Kt.__actions__.push({func:Nc,args:[Et],thisArg:e}),new Pn(Kt,Rt)}return $t&&ae?f.apply(this,ut):(Kt=this.thru(Et),$t?E?Kt.value()[0]:Kt.value():Kt)})}),qi(["pop","push","shift","sort","splice","unshift"],function(f){var p=_o[f],v=/^(?:push|sort|unshift)$/.test(f)?"tap":"thru",E=/^(?:pop|shift)$/.test(f);G.prototype[f]=function(){var M=arguments;if(E&&!this.__chain__){var V=this.value();return p.apply(te(V)?V:[],M)}return this[v](function(rt){return p.apply(te(rt)?rt:[],M)})}}),_r(pe.prototype,function(f,p){var v=G[p];if(v){var E=v.name+"";Se.call(ya,E)||(ya[E]=[]),ya[E].push({name:p,func:v})}}),ya[Pc(e,y).name]=[{name:"wrapper",func:e}],pe.prototype.clone=gS,pe.prototype.reverse=mS,pe.prototype.value=vS,G.prototype.at=Yx,G.prototype.chain=Vx,G.prototype.commit=qx,G.prototype.next=$x,G.prototype.plant=Jx,G.prototype.reverse=Qx,G.prototype.toJSON=G.prototype.valueOf=G.prototype.value=Zx,G.prototype.first=G.prototype.head,Vt&&(G.prototype[Vt]=Kx),G},Cr=Lf();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(le._=Cr,define(function(){return Cr})):ri?((ri.exports=Cr)._=Cr,ir._=Cr):le._=Cr}).call(su)});var o_=ue(_t=>{var b=b||{version:"5.2.4"};typeof _t<"u"?_t.fabric=b:typeof define=="function"&&define.amd&&define([],function(){return b});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?b.document=document:b.document=document.implementation.createHTMLDocument(""),b.window=window):(s_=Od(),Zg=new s_.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,b.document=Zg.document,b.jsdomImplForWrapper=kd().implForWrapper,b.nodeCanvas=Pd().Canvas,b.window=Zg,DOMParser=b.window.DOMParser);var s_,Zg;b.isTouchSupported="ontouchstart"in b.window||"ontouchstart"in b.document||b.window&&b.window.navigator&&b.window.navigator.maxTouchPoints>0;b.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";b.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];b.DPI=96;b.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";b.commaWsp="(?:\\s+,?\\s*|,\\s*)";b.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;b.reNonWord=/[ \n\.,;!\?\-]/;b.fontPaths={};b.iMatrix=[1,0,0,1,0,0];b.svgNS="http://www.w3.org/2000/svg";b.perfLimitSizeTotal=2097152;b.maxCacheSideLimit=4096;b.minCacheSideLimit=256;b.charWidthsCache={};b.textureSize=2048;b.disableStyleCopyPaste=!1;b.enableGLFiltering=!0;b.devicePixelRatio=b.window.devicePixelRatio||b.window.webkitDevicePixelRatio||b.window.mozDevicePixelRatio||1;b.browserShadowBlurConstant=1;b.arcToSegmentsCache={};b.boundsOfCurveCache={};b.cachesBoundsOfCurve=!0;b.forceGLPutImageData=!1;b.initFilterBackend=function(){if(b.enableGLFiltering&&b.isWebglSupported&&b.isWebglSupported(b.textureSize))return console.log("max texture size: "+b.maxTextureSize),new b.WebglFilterBackend({tileSize:b.textureSize});if(b.Canvas2dFilterBackend)return new b.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=b);(function(){function e(r,a){if(this.__eventListeners[r]){var l=this.__eventListeners[r];a?l[l.indexOf(a)]=!1:b.util.array.fill(l,!1)}}function t(r,a){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var l in r)this.on(l,r[l]);else this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(a);return this}function i(r,a){var l=function(){a.apply(this,arguments),this.off(r,l)}.bind(this);this.on(r,l)}function o(r,a){if(arguments.length===1)for(var l in r)i.call(this,l,r[l]);else i.call(this,r,a);return this}function n(r,a){if(!this.__eventListeners)return this;if(arguments.length===0)for(r in this.__eventListeners)e.call(this,r);else if(arguments.length===1&&typeof arguments[0]=="object")for(var l in r)e.call(this,l,r[l]);else e.call(this,r,a);return this}function s(r,a){if(!this.__eventListeners)return this;var l=this.__eventListeners[r];if(!l)return this;for(var u=0,c=l.length;u<c;u++)l[u]&&l[u].call(this,a||{});return this.__eventListeners[r]=l.filter(function(h){return h!==!1}),this}b.Observable={fire:s,on:t,once:o,off:n}})();b.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,i){var o=this._objects;return i?o[t]=e:o.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e=this._objects,t,i=!1,o=0,n=arguments.length;o<n;o++)t=e.indexOf(arguments[o]),t!==-1&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var i=this.getObjects(),o=0,n=i.length;o<n;o++)e.call(t,i[o],o,i);return this},getObjects:function(e){return typeof e>"u"?this._objects.concat():this._objects.filter(function(t){return t.type===e})},item:function(e){return this._objects[e]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(e,t){return this._objects.indexOf(e)>-1?!0:t?this._objects.some(function(i){return typeof i.contains=="function"&&i.contains(e,!0)}):!1},complexity:function(){return this._objects.reduce(function(e,t){return e+=t.complexity?t.complexity():0,e},0)}};b.CommonMethods={_setOptions:function(e){for(var t in e)this.set(t,e[t])},_initGradient:function(e,t){e&&e.colorStops&&!(e instanceof b.Gradient)&&this.set(t,new b.Gradient(e))},_initPattern:function(e,t,i){e&&e.source&&!(e instanceof b.Pattern)?this.set(t,new b.Pattern(e,i)):i&&i()},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this},_set:function(e,t){this[e]=t},toggle:function(e){var t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this},get:function(e){return this[e]}};(function(e){var t=Math.sqrt,i=Math.atan2,o=Math.pow,n=Math.PI/180,s=Math.PI/2;b.util={cos:function(r){if(r===0)return 1;r<0&&(r=-r);var a=r/s;switch(a){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},sin:function(r){if(r===0)return 0;var a=r/s,l=1;switch(r<0&&(l=-1),a){case 1:return l;case 2:return 0;case 3:return-l}return Math.sin(r)},removeFromArray:function(r,a){var l=r.indexOf(a);return l!==-1&&r.splice(l,1),r},getRandomInt:function(r,a){return Math.floor(Math.random()*(a-r+1))+r},degreesToRadians:function(r){return r*n},radiansToDegrees:function(r){return r/n},rotatePoint:function(r,a,l){var u=new b.Point(r.x-a.x,r.y-a.y),c=b.util.rotateVector(u,l);return new b.Point(c.x,c.y).addEquals(a)},rotateVector:function(r,a){var l=b.util.sin(a),u=b.util.cos(a),c=r.x*u-r.y*l,h=r.x*l+r.y*u;return{x:c,y:h}},createVector:function(r,a){return new b.Point(a.x-r.x,a.y-r.y)},calcAngleBetweenVectors:function(r,a){return Math.acos((r.x*a.x+r.y*a.y)/(Math.hypot(r.x,r.y)*Math.hypot(a.x,a.y)))},getHatVector:function(r){return new b.Point(r.x,r.y).multiply(1/Math.hypot(r.x,r.y))},getBisector:function(r,a,l){var u=b.util.createVector(r,a),c=b.util.createVector(r,l),h=b.util.calcAngleBetweenVectors(u,c),d=b.util.calcAngleBetweenVectors(b.util.rotateVector(u,h),c),g=h*(d===0?1:-1)/2;return{vector:b.util.getHatVector(b.util.rotateVector(u,g)),angle:h}},projectStrokeOnPoints:function(r,a,l){var u=[],c=a.strokeWidth/2,h=a.strokeUniform?new b.Point(1/a.scaleX,1/a.scaleY):new b.Point(1,1),d=function(g){var m=c/Math.hypot(g.x,g.y);return new b.Point(g.x*m*h.x,g.y*m*h.y)};return r.length<=1||r.forEach(function(g,m){var y=new b.Point(g.x,g.y),C,w;m===0?(w=r[m+1],C=l?d(b.util.createVector(w,y)).addEquals(y):r[r.length-1]):m===r.length-1?(C=r[m-1],w=l?d(b.util.createVector(C,y)).addEquals(y):r[0]):(C=r[m-1],w=r[m+1]);var F=b.util.getBisector(y,C,w),B=F.vector,U=F.angle,R,W;if(a.strokeLineJoin==="miter"&&(R=-c/Math.sin(U/2),W=new b.Point(B.x*R*h.x,B.y*R*h.y),Math.hypot(W.x,W.y)/c<=a.strokeMiterLimit)){u.push(y.add(W)),u.push(y.subtract(W));return}R=-c*Math.SQRT2,W=new b.Point(B.x*R*h.x,B.y*R*h.y),u.push(y.add(W)),u.push(y.subtract(W))}),u},transformPoint:function(r,a,l){return l?new b.Point(a[0]*r.x+a[2]*r.y,a[1]*r.x+a[3]*r.y):new b.Point(a[0]*r.x+a[2]*r.y+a[4],a[1]*r.x+a[3]*r.y+a[5])},makeBoundingBoxFromPoints:function(r,a){if(a)for(var l=0;l<r.length;l++)r[l]=b.util.transformPoint(r[l],a);var u=[r[0].x,r[1].x,r[2].x,r[3].x],c=b.util.array.min(u),h=b.util.array.max(u),d=h-c,g=[r[0].y,r[1].y,r[2].y,r[3].y],m=b.util.array.min(g),y=b.util.array.max(g),C=y-m;return{left:c,top:m,width:d,height:C}},invertTransform:function(r){var a=1/(r[0]*r[3]-r[1]*r[2]),l=[a*r[3],-a*r[1],-a*r[2],a*r[0]],u=b.util.transformPoint({x:r[4],y:r[5]},l,!0);return l[4]=-u.x,l[5]=-u.y,l},toFixed:function(r,a){return parseFloat(Number(r).toFixed(a))},parseUnit:function(r,a){var l=/\D{0,2}$/.exec(r),u=parseFloat(r);switch(a||(a=b.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return u*b.DPI/25.4;case"cm":return u*b.DPI/2.54;case"in":return u*b.DPI;case"pt":return u*b.DPI/72;case"pc":return u*b.DPI/72*12;case"em":return u*a;default:return u}},falseFunction:function(){return!1},getKlass:function(r,a){return r=b.util.string.camelize(r.charAt(0).toUpperCase()+r.slice(1)),b.util.resolveNamespace(a)[r]},getSvgAttributes:function(r){var a=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"]);break}return a},resolveNamespace:function(r){if(!r)return b;var a=r.split("."),l=a.length,u,c=e||b.window;for(u=0;u<l;++u)c=c[a[u]];return c},loadImage:function(r,a,l,u){if(!r){a&&a.call(l,r);return}var c=b.util.createImage(),h=function(){a&&a.call(l,c,!1),c=c.onload=c.onerror=null};c.onload=h,c.onerror=function(){b.log("Error loading "+c.src),a&&a.call(l,null,!0),c=c.onload=c.onerror=null},r.indexOf("data")!==0&&u!==void 0&&u!==null&&(c.crossOrigin=u),r.substring(0,14)==="data:image/svg"&&(c.onload=null,b.util.loadImageInDom(c,h)),c.src=r},loadImageInDom:function(r,a){var l=b.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(r),b.document.querySelector("body").appendChild(l),r.onload=function(){a(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(r,a,l,u){r=r||[];var c=[],h=0,d=r.length;function g(){++h===d&&a&&a(c.filter(function(m){return m}))}if(!d){a&&a(c);return}r.forEach(function(m,y){if(!m||!m.type){g();return}var C=b.util.getKlass(m.type,l);C.fromObject(m,function(w,F){F||(c[y]=w),u&&u(m,w,F),g()})})},enlivenObjectEnlivables:function(r,a,l){var u=b.Object.ENLIVEN_PROPS.filter(function(c){return!!r[c]});b.util.enlivenObjects(u.map(function(c){return r[c]}),function(c){var h={};u.forEach(function(d,g){h[d]=c[g],a&&(a[d]=c[g])}),l&&l(h)})},enlivenPatterns:function(r,a){r=r||[];function l(){++c===h&&a&&a(u)}var u=[],c=0,h=r.length;if(!h){a&&a(u);return}r.forEach(function(d,g){d&&d.source?new b.Pattern(d,function(m){u[g]=m,l()}):(u[g]=d,l())})},groupSVGElements:function(r,a,l){var u;return r&&r.length===1?(typeof l<"u"&&(r[0].sourcePath=l),r[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),u=new b.Group(r,a),typeof l<"u"&&(u.sourcePath=l),u)},populateWithProperties:function(r,a,l){if(l&&Array.isArray(l))for(var u=0,c=l.length;u<c;u++)l[u]in r&&(a[l[u]]=r[l[u]])},createCanvasElement:function(){return b.document.createElement("canvas")},copyCanvasElement:function(r){var a=b.util.createCanvasElement();return a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),a},toDataURL:function(r,a,l){return r.toDataURL("image/"+a,l)},createImage:function(){return b.document.createElement("img")},multiplyTransformMatrices:function(r,a,l){return[r[0]*a[0]+r[2]*a[1],r[1]*a[0]+r[3]*a[1],r[0]*a[2]+r[2]*a[3],r[1]*a[2]+r[3]*a[3],l?0:r[0]*a[4]+r[2]*a[5]+r[4],l?0:r[1]*a[4]+r[3]*a[5]+r[5]]},qrDecompose:function(r){var a=i(r[1],r[0]),l=o(r[0],2)+o(r[1],2),u=t(l),c=(r[0]*r[3]-r[2]*r[1])/u,h=i(r[0]*r[2]+r[1]*r[3],l);return{angle:a/n,scaleX:u,scaleY:c,skewX:h/n,skewY:0,translateX:r[4],translateY:r[5]}},calcRotateMatrix:function(r){if(!r.angle)return b.iMatrix.concat();var a=b.util.degreesToRadians(r.angle),l=b.util.cos(a),u=b.util.sin(a);return[l,u,-u,l,0,0]},calcDimensionsMatrix:function(r){var a=typeof r.scaleX>"u"?1:r.scaleX,l=typeof r.scaleY>"u"?1:r.scaleY,u=[r.flipX?-a:a,0,0,r.flipY?-l:l,0,0],c=b.util.multiplyTransformMatrices,h=b.util.degreesToRadians;return r.skewX&&(u=c(u,[1,0,Math.tan(h(r.skewX)),1],!0)),r.skewY&&(u=c(u,[1,Math.tan(h(r.skewY)),0,1],!0)),u},composeMatrix:function(r){var a=[1,0,0,1,r.translateX||0,r.translateY||0],l=b.util.multiplyTransformMatrices;return r.angle&&(a=l(a,b.util.calcRotateMatrix(r))),(r.scaleX!==1||r.scaleY!==1||r.skewX||r.skewY||r.flipX||r.flipY)&&(a=l(a,b.util.calcDimensionsMatrix(r))),a},resetObjectTransform:function(r){r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},saveObjectTransform:function(r){return{scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}},isTransparent:function(r,a,l,u){u>0&&(a>u?a-=u:a=0,l>u?l-=u:l=0);var c=!0,h,d,g=r.getImageData(a,l,u*2||1,u*2||1),m=g.data.length;for(h=3;h<m&&(d=g.data[h],c=d<=0,c!==!1);h+=4);return g=null,c},parsePreserveAspectRatioAttribute:function(r){var a="meet",l="Mid",u="Mid",c=r.split(" "),h;return c&&c.length&&(a=c.pop(),a!=="meet"&&a!=="slice"?(h=a,a="meet"):c.length&&(h=c.pop())),l=h!=="none"?h.slice(1,4):"none",u=h!=="none"?h.slice(5,8):"none",{meetOrSlice:a,alignX:l,alignY:u}},clearFabricFontCache:function(r){r=(r||"").toLowerCase(),r?b.charWidthsCache[r]&&delete b.charWidthsCache[r]:b.charWidthsCache={}},limitDimsByArea:function(r,a){var l=Math.sqrt(a*r),u=Math.floor(a/l);return{x:Math.floor(l),y:u}},capValue:function(r,a,l){return Math.max(r,Math.min(a,l))},findScaleToFit:function(r,a){return Math.min(a.width/r.width,a.height/r.height)},findScaleToCover:function(r,a){return Math.max(a.width/r.width,a.height/r.height)},matrixToSVG:function(r){return"matrix("+r.map(function(a){return b.util.toFixed(a,b.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(r,a){var l=b.util.invertTransform(a),u=b.util.multiplyTransformMatrices(l,r.calcOwnMatrix());b.util.applyTransformToObject(r,u)},addTransformToObject:function(r,a){b.util.applyTransformToObject(r,b.util.multiplyTransformMatrices(a,r.calcOwnMatrix()))},applyTransformToObject:function(r,a){var l=b.util.qrDecompose(a),u=new b.Point(l.translateX,l.translateY);r.flipX=!1,r.flipY=!1,r.set("scaleX",l.scaleX),r.set("scaleY",l.scaleY),r.skewX=l.skewX,r.skewY=l.skewY,r.angle=l.angle,r.setPositionByOrigin(u,"center","center")},sizeAfterTransform:function(r,a,l){var u=r/2,c=a/2,h=[{x:-u,y:-c},{x:u,y:-c},{x:-u,y:c},{x:u,y:c}],d=b.util.calcDimensionsMatrix(l),g=b.util.makeBoundingBoxFromPoints(h,d);return{x:g.width,y:g.height}},mergeClipPaths:function(r,a){var l=r,u=a;l.inverted&&!u.inverted&&(l=a,u=r),b.util.applyTransformToObject(u,b.util.multiplyTransformMatrices(b.util.invertTransform(l.calcTransformMatrix()),u.calcTransformMatrix()));var c=l.inverted&&u.inverted;return c&&(l.inverted=u.inverted=!1),new b.Group([l],{clipPath:u,inverted:c})},hasStyleChanged:function(r,a,l){return l=l||!1,r.fill!==a.fill||r.stroke!==a.stroke||r.strokeWidth!==a.strokeWidth||r.fontSize!==a.fontSize||r.fontFamily!==a.fontFamily||r.fontWeight!==a.fontWeight||r.fontStyle!==a.fontStyle||r.deltaY!==a.deltaY||l&&(r.overline!==a.overline||r.underline!==a.underline||r.linethrough!==a.linethrough)},stylesToArray:function(l,a){for(var l=b.util.object.clone(l,!0),u=a.split(`
`),c=-1,h={},d=[],g=0;g<u.length;g++){if(!l[g]){c+=u[g].length;continue}for(var m=0;m<u[g].length;m++){c++;var y=l[g][m];if(y){var C=b.util.hasStyleChanged(h,y,!0);C?d.push({start:c,end:c+1,style:y}):d[d.length-1].end++}h=y||{}}}return d},stylesFromArray:function(r,a){if(!Array.isArray(r))return r;for(var l=a.split(`
`),u=-1,c=0,h={},d=0;d<l.length;d++)for(var g=0;g<l[d].length;g++)u++,r[c]&&r[c].start<=u&&u<r[c].end&&(h[d]=h[d]||{},h[d][g]=Object.assign({},r[c].style),u===r[c].end-1&&c++);return h}}})(_t);(function(){var e=Array.prototype.join,t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},i={m:"l",M:"L"};function o(x,P,I,k,K,S,_,O,j,q,N){var H=b.util.cos(x),Q=b.util.sin(x),ot=b.util.cos(P),Y=b.util.sin(P),z=I*K*ot-k*S*Y+_,it=k*K*ot+I*S*Y+O,Z=q+j*(-I*K*Q-k*S*H),J=N+j*(-k*K*Q+I*S*H),nt=z+j*(I*K*Y+k*S*ot),lt=it+j*(k*K*Y-I*S*ot);return["C",Z,J,nt,lt,z,it]}function n(x,P,I,k,K,S,_){var O=Math.PI,j=_*O/180,q=b.util.sin(j),N=b.util.cos(j),H=0,Q=0;I=Math.abs(I),k=Math.abs(k);var ot=-N*x*.5-q*P*.5,Y=-N*P*.5+q*x*.5,z=I*I,it=k*k,Z=Y*Y,J=ot*ot,nt=z*it-z*Z-it*J,lt=0;if(nt<0){var At=Math.sqrt(1-nt/(z*it));I*=At,k*=At}else lt=(K===S?-1:1)*Math.sqrt(nt/(z*Z+it*J));var wt=lt*I*Y/k,et=-lt*k*ot/I,yt=N*wt-q*et+x*.5,Tt=q*wt+N*et+P*.5,It=s(1,0,(ot-wt)/I,(Y-et)/k),jt=s((ot-wt)/I,(Y-et)/k,(-ot-wt)/I,(-Y-et)/k);S===0&&jt>0?jt-=2*O:S===1&&jt<0&&(jt+=2*O);for(var Mt=Math.ceil(Math.abs(jt/O*2)),se=[],Jt=jt/Mt,Le=8/3*Math.sin(Jt/4)*Math.sin(Jt/4)/Math.sin(Jt/2),qe=It+Jt,Ce=0;Ce<Mt;Ce++)se[Ce]=o(It,qe,N,q,I,k,yt,Tt,Le,H,Q),H=se[Ce][5],Q=se[Ce][6],It=qe,qe+=Jt;return se}function s(x,P,I,k){var K=Math.atan2(P,x),S=Math.atan2(k,I);return S>=K?S-K:2*Math.PI-(K-S)}function r(x,P,I,k,K,S,_,O){var j;if(b.cachesBoundsOfCurve&&(j=e.call(arguments),b.boundsOfCurveCache[j]))return b.boundsOfCurveCache[j];var q=Math.sqrt,N=Math.min,H=Math.max,Q=Math.abs,ot=[],Y=[[],[]],z,it,Z,J,nt,lt,At,wt;it=6*x-12*I+6*K,z=-3*x+9*I-9*K+3*_,Z=3*I-3*x;for(var et=0;et<2;++et){if(et>0&&(it=6*P-12*k+6*S,z=-3*P+9*k-9*S+3*O,Z=3*k-3*P),Q(z)<1e-12){if(Q(it)<1e-12)continue;J=-Z/it,0<J&&J<1&&ot.push(J);continue}At=it*it-4*Z*z,!(At<0)&&(wt=q(At),nt=(-it+wt)/(2*z),0<nt&&nt<1&&ot.push(nt),lt=(-it-wt)/(2*z),0<lt&&lt<1&&ot.push(lt))}for(var yt,Tt,It=ot.length,jt=It,Mt;It--;)J=ot[It],Mt=1-J,yt=Mt*Mt*Mt*x+3*Mt*Mt*J*I+3*Mt*J*J*K+J*J*J*_,Y[0][It]=yt,Tt=Mt*Mt*Mt*P+3*Mt*Mt*J*k+3*Mt*J*J*S+J*J*J*O,Y[1][It]=Tt;Y[0][jt]=x,Y[1][jt]=P,Y[0][jt+1]=_,Y[1][jt+1]=O;var se=[{x:N.apply(null,Y[0]),y:N.apply(null,Y[1])},{x:H.apply(null,Y[0]),y:H.apply(null,Y[1])}];return b.cachesBoundsOfCurve&&(b.boundsOfCurveCache[j]=se),se}function a(x,P,I){for(var k=I[1],K=I[2],S=I[3],_=I[4],O=I[5],j=I[6],q=I[7],N=n(j-x,q-P,k,K,_,O,S),H=0,Q=N.length;H<Q;H++)N[H][1]+=x,N[H][2]+=P,N[H][3]+=x,N[H][4]+=P,N[H][5]+=x,N[H][6]+=P;return N}function l(x){var P=0,I=0,k=x.length,K=0,S=0,_,O,j,q=[],N,H,Q;for(O=0;O<k;++O){switch(j=!1,_=x[O].slice(0),_[0]){case"l":_[0]="L",_[1]+=P,_[2]+=I;case"L":P=_[1],I=_[2];break;case"h":_[1]+=P;case"H":_[0]="L",_[2]=I,P=_[1];break;case"v":_[1]+=I;case"V":_[0]="L",I=_[1],_[1]=P,_[2]=I;break;case"m":_[0]="M",_[1]+=P,_[2]+=I;case"M":P=_[1],I=_[2],K=_[1],S=_[2];break;case"c":_[0]="C",_[1]+=P,_[2]+=I,_[3]+=P,_[4]+=I,_[5]+=P,_[6]+=I;case"C":H=_[3],Q=_[4],P=_[5],I=_[6];break;case"s":_[0]="S",_[1]+=P,_[2]+=I,_[3]+=P,_[4]+=I;case"S":N==="C"?(H=2*P-H,Q=2*I-Q):(H=P,Q=I),P=_[3],I=_[4],_[0]="C",_[5]=_[3],_[6]=_[4],_[3]=_[1],_[4]=_[2],_[1]=H,_[2]=Q,H=_[3],Q=_[4];break;case"q":_[0]="Q",_[1]+=P,_[2]+=I,_[3]+=P,_[4]+=I;case"Q":H=_[1],Q=_[2],P=_[3],I=_[4];break;case"t":_[0]="T",_[1]+=P,_[2]+=I;case"T":N==="Q"?(H=2*P-H,Q=2*I-Q):(H=P,Q=I),_[0]="Q",P=_[1],I=_[2],_[1]=H,_[2]=Q,_[3]=P,_[4]=I;break;case"a":_[0]="A",_[6]+=P,_[7]+=I;case"A":j=!0,q=q.concat(a(P,I,_)),P=_[6],I=_[7];break;case"z":case"Z":P=K,I=S;break;default:}j||q.push(_),N=_[0]}return q}function u(x,P,I,k){return Math.sqrt((I-x)*(I-x)+(k-P)*(k-P))}function c(x){return x*x*x}function h(x){return 3*x*x*(1-x)}function d(x){return 3*x*(1-x)*(1-x)}function g(x){return(1-x)*(1-x)*(1-x)}function m(x,P,I,k,K,S,_,O){return function(j){var q=c(j),N=h(j),H=d(j),Q=g(j);return{x:_*q+K*N+I*H+x*Q,y:O*q+S*N+k*H+P*Q}}}function y(x,P,I,k,K,S,_,O){return function(j){var q=1-j,N=3*q*q*(I-x)+6*q*j*(K-I)+3*j*j*(_-K),H=3*q*q*(k-P)+6*q*j*(S-k)+3*j*j*(O-S);return Math.atan2(H,N)}}function C(x){return x*x}function w(x){return 2*x*(1-x)}function F(x){return(1-x)*(1-x)}function B(x,P,I,k,K,S){return function(_){var O=C(_),j=w(_),q=F(_);return{x:K*O+I*j+x*q,y:S*O+k*j+P*q}}}function U(x,P,I,k,K,S){return function(_){var O=1-_,j=2*O*(I-x)+2*_*(K-I),q=2*O*(k-P)+2*_*(S-k);return Math.atan2(q,j)}}function R(x,P,I){var k={x:P,y:I},K,S=0,_;for(_=1;_<=100;_+=1)K=x(_/100),S+=u(k.x,k.y,K.x,K.y),k=K;return S}function W(x,P){for(var I=0,k=0,K=x.iterator,S={x:x.x,y:x.y},_,O,j=.01,q=x.angleFinder,N;k<P&&j>1e-4;)_=K(I),N=I,O=u(S.x,S.y,_.x,_.y),O+k>P?(I-=j,j/=2):(S=_,I+=j,k+=O);return _.angle=q(N),_}function X(x){for(var P=0,I=x.length,k,K=0,S=0,_=0,O=0,j=[],q,N,H,Q=0;Q<I;Q++){switch(k=x[Q],N={x:K,y:S,command:k[0]},k[0]){case"M":N.length=0,_=K=k[1],O=S=k[2];break;case"L":N.length=u(K,S,k[1],k[2]),K=k[1],S=k[2];break;case"C":q=m(K,S,k[1],k[2],k[3],k[4],k[5],k[6]),H=y(K,S,k[1],k[2],k[3],k[4],k[5],k[6]),N.iterator=q,N.angleFinder=H,N.length=R(q,K,S),K=k[5],S=k[6];break;case"Q":q=B(K,S,k[1],k[2],k[3],k[4]),H=U(K,S,k[1],k[2],k[3],k[4]),N.iterator=q,N.angleFinder=H,N.length=R(q,K,S),K=k[3],S=k[4];break;case"Z":case"z":N.destX=_,N.destY=O,N.length=u(K,S,_,O),K=_,S=O;break}P+=N.length,j.push(N)}return j.push({length:P,x:K,y:S}),j}function $(x,P,I){I||(I=X(x));for(var k=0;P-I[k].length>0&&k<I.length-2;)P-=I[k].length,k++;var K=I[k],S=P/K.length,_=K.command,O=x[k],j;switch(_){case"M":return{x:K.x,y:K.y,angle:0};case"Z":case"z":return j=new b.Point(K.x,K.y).lerp(new b.Point(K.destX,K.destY),S),j.angle=Math.atan2(K.destY-K.y,K.destX-K.x),j;case"L":return j=new b.Point(K.x,K.y).lerp(new b.Point(O[1],O[2]),S),j.angle=Math.atan2(O[2]-K.y,O[1]-K.x),j;case"C":return W(K,P);case"Q":return W(K,P)}}function st(x){var P=[],I=[],k,K,S=b.rePathCommand,_="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",O="("+_+")"+b.commaWsp,j="([01])"+b.commaWsp+"?",q=O+"?"+O+"?"+O+j+j+O+"?("+_+")",N=new RegExp(q,"g"),H,Q,ot;if(!x||!x.match)return P;ot=x.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var Y=0,z,it=ot.length;Y<it;Y++){k=ot[Y],Q=k.slice(1).trim(),I.length=0;var Z=k.charAt(0);if(z=[Z],Z.toLowerCase()==="a")for(var J;J=N.exec(Q);)for(var nt=1;nt<J.length;nt++)I.push(J[nt]);else for(;H=S.exec(Q);)I.push(H[0]);for(var nt=0,lt=I.length;nt<lt;nt++)K=parseFloat(I[nt]),isNaN(K)||z.push(K);var At=t[Z.toLowerCase()],wt=i[Z]||Z;if(z.length-1>At)for(var et=1,yt=z.length;et<yt;et+=At)P.push([Z].concat(z.slice(et,et+At))),Z=wt;else P.push(z)}return P}function pt(x,P){var I=[],k,K=new b.Point(x[0].x,x[0].y),S=new b.Point(x[1].x,x[1].y),_=x.length,O=1,j=0,q=_>2;for(P=P||0,q&&(O=x[2].x<S.x?-1:x[2].x===S.x?0:1,j=x[2].y<S.y?-1:x[2].y===S.y?0:1),I.push(["M",K.x-O*P,K.y-j*P]),k=1;k<_;k++){if(!K.eq(S)){var N=K.midPointFrom(S);I.push(["Q",K.x,K.y,N.x,N.y])}K=x[k],k+1<x.length&&(S=x[k+1])}return q&&(O=K.x>x[k-2].x?1:K.x===x[k-2].x?0:-1,j=K.y>x[k-2].y?1:K.y===x[k-2].y?0:-1),I.push(["L",K.x+O*P,K.y+j*P]),I}function dt(x,P,I){return I&&(P=b.util.multiplyTransformMatrices(P,[1,0,0,1,-I.x,-I.y])),x.map(function(k){for(var K=k.slice(0),S={},_=1;_<k.length-1;_+=2)S.x=k[_],S.y=k[_+1],S=b.util.transformPoint(S,P),K[_]=S.x,K[_+1]=S.y;return K})}b.util.joinPath=function(x){return x.map(function(P){return P.join(" ")}).join(" ")},b.util.parsePath=st,b.util.makePathSimpler=l,b.util.getSmoothPathFromPoints=pt,b.util.getPathSegmentsInfo=X,b.util.getBoundsOfCurve=r,b.util.getPointOnPath=$,b.util.transformPath=dt})();(function(){var e=Array.prototype.slice;function t(r,a){for(var l=e.call(arguments,2),u=[],c=0,h=r.length;c<h;c++)u[c]=l.length?r[c][a].apply(r[c],l):r[c][a].call(r[c]);return u}function i(r,a){return s(r,a,function(l,u){return l>=u})}function o(r,a){return s(r,a,function(l,u){return l<u})}function n(r,a){for(var l=r.length;l--;)r[l]=a;return r}function s(r,a,l){if(!(!r||r.length===0)){var u=r.length-1,c=a?r[u][a]:r[u];if(a)for(;u--;)l(r[u][a],c)&&(c=r[u][a]);else for(;u--;)l(r[u],c)&&(c=r[u]);return c}}b.util.array={fill:n,invoke:t,min:o,max:i}})();(function(){function e(i,o,n){if(n)if(!b.isLikelyNode&&o instanceof Element)i=o;else if(o instanceof Array){i=[];for(var s=0,r=o.length;s<r;s++)i[s]=e({},o[s],n)}else if(o&&typeof o=="object")for(var a in o)a==="canvas"||a==="group"?i[a]=null:o.hasOwnProperty(a)&&(i[a]=e({},o[a],n));else i=o;else for(var a in o)i[a]=o[a];return i}function t(i,o){return e({},i,o)}b.util.object={extend:e,clone:t},b.util.object.extend(b.util,b.Observable)})();(function(){function e(s){return s.replace(/-+(.)?/g,function(r,a){return a?a.toUpperCase():""})}function t(s,r){return s.charAt(0).toUpperCase()+(r?s.slice(1):s.slice(1).toLowerCase())}function i(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(s){var r=0,a,l=[];for(r=0,a;r<s.length;r++)(a=n(s,r))!==!1&&l.push(a);return l}function n(s,r){var a=s.charCodeAt(r);if(isNaN(a))return"";if(a<55296||a>57343)return s.charAt(r);if(55296<=a&&a<=56319){if(s.length<=r+1)throw"High surrogate without following low surrogate";var l=s.charCodeAt(r+1);if(56320>l||l>57343)throw"High surrogate without following low surrogate";return s.charAt(r)+s.charAt(r+1)}if(r===0)throw"Low surrogate without preceding high surrogate";var u=s.charCodeAt(r-1);if(55296>u||u>56319)throw"Low surrogate without preceding high surrogate";return!1}b.util.string={camelize:e,capitalize:t,escapeXml:i,graphemeSplit:o}})();(function(){var e=Array.prototype.slice,t=function(){},i=function(){for(var a in{toString:1})if(a==="toString")return!1;return!0}(),o=function(a,l,u){for(var c in l)c in a.prototype&&typeof a.prototype[c]=="function"&&(l[c]+"").indexOf("callSuper")>-1?a.prototype[c]=function(h){return function(){var d=this.constructor.superclass;this.constructor.superclass=u;var g=l[h].apply(this,arguments);if(this.constructor.superclass=d,h!=="initialize")return g}}(c):a.prototype[c]=l[c],i&&(l.toString!==Object.prototype.toString&&(a.prototype.toString=l.toString),l.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=l.valueOf))};function n(){}function s(a){for(var l=null,u=this;u.constructor.superclass;){var c=u.constructor.superclass.prototype[a];if(u[a]!==c){l=c;break}u=u.constructor.superclass.prototype}return l?arguments.length>1?l.apply(this,e.call(arguments,1)):l.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}function r(){var a=null,l=e.call(arguments,0);typeof l[0]=="function"&&(a=l.shift());function u(){this.initialize.apply(this,arguments)}u.superclass=a,u.subclasses=[],a&&(n.prototype=a.prototype,u.prototype=new n,a.subclasses.push(u));for(var c=0,h=l.length;c<h;c++)o(u,l[c],a);return u.prototype.initialize||(u.prototype.initialize=t),u.prototype.constructor=u,u.prototype.callSuper=s,u}b.util.createClass=r})();(function(){var e=!!b.document.createElement("div").attachEvent,t=["touchstart","touchmove","touchend"];b.util.addListener=function(o,n,s,r){o&&o.addEventListener(n,s,e?!1:r)},b.util.removeListener=function(o,n,s,r){o&&o.removeEventListener(n,s,e?!1:r)};function i(o){var n=o.changedTouches;return n&&n[0]?n[0]:o}b.util.getPointer=function(o){var n=o.target,s=b.util.getScrollLeftTop(n),r=i(o);return{x:r.clientX+s.left,y:r.clientY+s.top}},b.util.isTouchEvent=function(o){return t.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function e(r,a){var l=r.style;if(!l)return r;if(typeof a=="string")return r.style.cssText+=";"+a,a.indexOf("opacity")>-1?s(r,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):r;for(var u in a)if(u==="opacity")s(r,a[u]);else{var c=u==="float"||u==="cssFloat"?typeof l.styleFloat>"u"?"cssFloat":"styleFloat":u;l.setProperty(c,a[u])}return r}var t=b.document.createElement("div"),i=typeof t.style.opacity=="string",o=typeof t.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(r){return r};i?s=function(r,a){return r.style.opacity=a,r}:o&&(s=function(r,a){var l=r.style;return r.currentStyle&&!r.currentStyle.hasLayout&&(l.zoom=1),n.test(l.filter)?(a=a>=.9999?"":"alpha(opacity="+a*100+")",l.filter=l.filter.replace(n,a)):l.filter+=" alpha(opacity="+a*100+")",r}),b.util.setStyle=e})();(function(){var e=Array.prototype.slice;function t(g){return typeof g=="string"?b.document.getElementById(g):g}var i,o=function(g){return e.call(g,0)};try{i=o(b.document.childNodes)instanceof Array}catch{}i||(o=function(g){for(var m=new Array(g.length),y=g.length;y--;)m[y]=g[y];return m});function n(g,m){var y=b.document.createElement(g);for(var C in m)C==="class"?y.className=m[C]:C==="for"?y.htmlFor=m[C]:y.setAttribute(C,m[C]);return y}function s(g,m){g&&(" "+g.className+" ").indexOf(" "+m+" ")===-1&&(g.className+=(g.className?" ":"")+m)}function r(g,m,y){return typeof m=="string"&&(m=n(m,y)),g.parentNode&&g.parentNode.replaceChild(m,g),m.appendChild(g),m}function a(g){for(var m=0,y=0,C=b.document.documentElement,w=b.document.body||{scrollLeft:0,scrollTop:0};g&&(g.parentNode||g.host)&&(g=g.parentNode||g.host,g===b.document?(m=w.scrollLeft||C.scrollLeft||0,y=w.scrollTop||C.scrollTop||0):(m+=g.scrollLeft||0,y+=g.scrollTop||0),!(g.nodeType===1&&g.style.position==="fixed")););return{left:m,top:y}}function l(g){var m,y=g&&g.ownerDocument,C={left:0,top:0},w={left:0,top:0},F,B={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!y)return w;for(var U in B)w[B[U]]+=parseInt(u(g,U),10)||0;return m=y.documentElement,typeof g.getBoundingClientRect<"u"&&(C=g.getBoundingClientRect()),F=a(g),{left:C.left+F.left-(m.clientLeft||0)+w.left,top:C.top+F.top-(m.clientTop||0)+w.top}}var u;b.document.defaultView&&b.document.defaultView.getComputedStyle?u=function(g,m){var y=b.document.defaultView.getComputedStyle(g,null);return y?y[m]:void 0}:u=function(g,m){var y=g.style[m];return!y&&g.currentStyle&&(y=g.currentStyle[m]),y},function(){var g=b.document.documentElement.style,m="userSelect"in g?"userSelect":"MozUserSelect"in g?"MozUserSelect":"WebkitUserSelect"in g?"WebkitUserSelect":"KhtmlUserSelect"in g?"KhtmlUserSelect":"";function y(w){return typeof w.onselectstart<"u"&&(w.onselectstart=b.util.falseFunction),m?w.style[m]="none":typeof w.unselectable=="string"&&(w.unselectable="on"),w}function C(w){return typeof w.onselectstart<"u"&&(w.onselectstart=null),m?w.style[m]="":typeof w.unselectable=="string"&&(w.unselectable=""),w}b.util.makeElementUnselectable=y,b.util.makeElementSelectable=C}();function c(g){var m=b.jsdomImplForWrapper(g);return m._canvas||m._image}function h(g){if(b.isLikelyNode){var m=b.jsdomImplForWrapper(g);m&&(m._image=null,m._canvas=null,m._currentSrc=null,m._attributes=null,m._classList=null)}}function d(g,m){g.imageSmoothingEnabled=g.imageSmoothingEnabled||g.webkitImageSmoothingEnabled||g.mozImageSmoothingEnabled||g.msImageSmoothingEnabled||g.oImageSmoothingEnabled,g.imageSmoothingEnabled=m}b.util.setImageSmoothing=d,b.util.getById=t,b.util.toArray=o,b.util.addClass=s,b.util.makeElement=n,b.util.wrapElement=r,b.util.getScrollLeftTop=a,b.util.getElementOffset=l,b.util.getNodeCanvas=c,b.util.cleanUpJsdomNode=h})();(function(){function e(o,n){return o+(/\?/.test(o)?"&":"?")+n}function t(){}function i(o,n){n||(n={});var s=n.method?n.method.toUpperCase():"GET",r=n.onComplete||function(){},a=new b.window.XMLHttpRequest,l=n.body||n.parameters;return a.onreadystatechange=function(){a.readyState===4&&(r(a),a.onreadystatechange=t)},s==="GET"&&(l=null,typeof n.parameters=="string"&&(o=e(o,n.parameters))),a.open(s,o,!0),(s==="POST"||s==="PUT")&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(l),a}b.util.request=i})();b.log=console.log;b.warn=console.warn;(function(){var e=b.util.object.extend,t=b.util.object.clone,i=[];b.util.object.extend(i,{cancelAll:function(){var c=this.splice(0);return c.forEach(function(h){h.cancel()}),c},cancelByCanvas:function(c){if(!c)return[];var h=this.filter(function(d){return typeof d.target=="object"&&d.target.canvas===c});return h.forEach(function(d){d.cancel()}),h},cancelByTarget:function(c){var h=this.findAnimationsByTarget(c);return h.forEach(function(d){d.cancel()}),h},findAnimationIndex:function(c){return this.indexOf(this.findAnimation(c))},findAnimation:function(c){return this.find(function(h){return h.cancel===c})},findAnimationsByTarget:function(c){return c?this.filter(function(h){return h.target===c}):[]}});function o(){return!1}function n(c,h,d,g){return-d*Math.cos(c/g*(Math.PI/2))+d+h}function s(c){c||(c={});var h=!1,d,g=function(){var m=b.runningAnimations.indexOf(d);return m>-1&&b.runningAnimations.splice(m,1)[0]};return d=e(t(c),{cancel:function(){return h=!0,g()},currentValue:"startValue"in c?c.startValue:0,completionRate:0,durationRate:0}),b.runningAnimations.push(d),l(function(m){var y=m||+new Date,C=c.duration||500,w=y+C,F,B=c.onChange||o,U=c.abort||o,R=c.onComplete||o,W=c.easing||n,X="startValue"in c?c.startValue.length>0:!1,$="startValue"in c?c.startValue:0,st="endValue"in c?c.endValue:100,pt=c.byValue||(X?$.map(function(dt,x){return st[x]-$[x]}):st-$);c.onStart&&c.onStart(),function dt(x){F=x||+new Date;var P=F>w?C:F-y,I=P/C,k=X?$.map(function(S,_){return W(P,$[_],pt[_],C)}):W(P,$,pt,C),K=Math.abs(X?(k[0]-$[0])/pt[0]:(k-$)/pt);if(d.currentValue=X?k.slice():k,d.completionRate=K,d.durationRate=I,!h){if(U(k,K,I)){g();return}if(F>w){d.currentValue=X?st.slice():st,d.completionRate=1,d.durationRate=1,B(X?st.slice():st,1,1),R(st,1,1),g();return}else B(k,K,I),l(dt)}}(y)}),d.cancel}var r=b.window.requestAnimationFrame||b.window.webkitRequestAnimationFrame||b.window.mozRequestAnimationFrame||b.window.oRequestAnimationFrame||b.window.msRequestAnimationFrame||function(c){return b.window.setTimeout(c,1e3/60)},a=b.window.cancelAnimationFrame||b.window.clearTimeout;function l(){return r.apply(b.window,arguments)}function u(){return a.apply(b.window,arguments)}b.util.animate=s,b.util.requestAnimFrame=l,b.util.cancelAnimFrame=u,b.runningAnimations=i})();(function(){function e(i,o,n){var s="rgba("+parseInt(i[0]+n*(o[0]-i[0]),10)+","+parseInt(i[1]+n*(o[1]-i[1]),10)+","+parseInt(i[2]+n*(o[2]-i[2]),10);return s+=","+(i&&o?parseFloat(i[3]+n*(o[3]-i[3])):1),s+=")",s}function t(i,o,n,s){var r=new b.Color(i).getSource(),a=new b.Color(o).getSource(),l=s.onComplete,u=s.onChange;return s=s||{},b.util.animate(b.util.object.extend(s,{duration:n||500,startValue:r,endValue:a,byValue:a,easing:function(c,h,d,g){var m=s.colorEasing?s.colorEasing(c,g):1-Math.cos(c/g*(Math.PI/2));return e(h,d,m)},onComplete:function(c,h,d){if(l)return l(e(a,a,0),h,d)},onChange:function(c,h,d){if(u){if(Array.isArray(c))return u(e(c,c,0),h,d);u(c,h,d)}}}))}b.util.animateColor=t})();(function(){function e(x,P,I,k){return x<Math.abs(P)?(x=P,k=I/4):P===0&&x===0?k=I/(2*Math.PI)*Math.asin(1):k=I/(2*Math.PI)*Math.asin(P/x),{a:x,c:P,p:I,s:k}}function t(x,P,I){return x.a*Math.pow(2,10*(P-=1))*Math.sin((P*I-x.s)*(2*Math.PI)/x.p)}function i(x,P,I,k){return I*((x=x/k-1)*x*x+1)+P}function o(x,P,I,k){return x/=k/2,x<1?I/2*x*x*x+P:I/2*((x-=2)*x*x+2)+P}function n(x,P,I,k){return I*(x/=k)*x*x*x+P}function s(x,P,I,k){return-I*((x=x/k-1)*x*x*x-1)+P}function r(x,P,I,k){return x/=k/2,x<1?I/2*x*x*x*x+P:-I/2*((x-=2)*x*x*x-2)+P}function a(x,P,I,k){return I*(x/=k)*x*x*x*x+P}function l(x,P,I,k){return I*((x=x/k-1)*x*x*x*x+1)+P}function u(x,P,I,k){return x/=k/2,x<1?I/2*x*x*x*x*x+P:I/2*((x-=2)*x*x*x*x+2)+P}function c(x,P,I,k){return-I*Math.cos(x/k*(Math.PI/2))+I+P}function h(x,P,I,k){return I*Math.sin(x/k*(Math.PI/2))+P}function d(x,P,I,k){return-I/2*(Math.cos(Math.PI*x/k)-1)+P}function g(x,P,I,k){return x===0?P:I*Math.pow(2,10*(x/k-1))+P}function m(x,P,I,k){return x===k?P+I:I*(-Math.pow(2,-10*x/k)+1)+P}function y(x,P,I,k){return x===0?P:x===k?P+I:(x/=k/2,x<1?I/2*Math.pow(2,10*(x-1))+P:I/2*(-Math.pow(2,-10*--x)+2)+P)}function C(x,P,I,k){return-I*(Math.sqrt(1-(x/=k)*x)-1)+P}function w(x,P,I,k){return I*Math.sqrt(1-(x=x/k-1)*x)+P}function F(x,P,I,k){return x/=k/2,x<1?-I/2*(Math.sqrt(1-x*x)-1)+P:I/2*(Math.sqrt(1-(x-=2)*x)+1)+P}function B(x,P,I,k){var K=1.70158,S=0,_=I;if(x===0)return P;if(x/=k,x===1)return P+I;S||(S=k*.3);var O=e(_,I,S,K);return-t(O,x,k)+P}function U(x,P,I,k){var K=1.70158,S=0,_=I;if(x===0)return P;if(x/=k,x===1)return P+I;S||(S=k*.3);var O=e(_,I,S,K);return O.a*Math.pow(2,-10*x)*Math.sin((x*k-O.s)*(2*Math.PI)/O.p)+O.c+P}function R(x,P,I,k){var K=1.70158,S=0,_=I;if(x===0)return P;if(x/=k/2,x===2)return P+I;S||(S=k*(.3*1.5));var O=e(_,I,S,K);return x<1?-.5*t(O,x,k)+P:O.a*Math.pow(2,-10*(x-=1))*Math.sin((x*k-O.s)*(2*Math.PI)/O.p)*.5+O.c+P}function W(x,P,I,k,K){return K===void 0&&(K=1.70158),I*(x/=k)*x*((K+1)*x-K)+P}function X(x,P,I,k,K){return K===void 0&&(K=1.70158),I*((x=x/k-1)*x*((K+1)*x+K)+1)+P}function $(x,P,I,k,K){return K===void 0&&(K=1.70158),x/=k/2,x<1?I/2*(x*x*(((K*=1.525)+1)*x-K))+P:I/2*((x-=2)*x*(((K*=1.525)+1)*x+K)+2)+P}function st(x,P,I,k){return I-pt(k-x,0,I,k)+P}function pt(x,P,I,k){return(x/=k)<1/2.75?I*(7.5625*x*x)+P:x<2/2.75?I*(7.5625*(x-=1.5/2.75)*x+.75)+P:x<2.5/2.75?I*(7.5625*(x-=2.25/2.75)*x+.9375)+P:I*(7.5625*(x-=2.625/2.75)*x+.984375)+P}function dt(x,P,I,k){return x<k/2?st(x*2,0,I,k)*.5+P:pt(x*2-k,0,I,k)*.5+I*.5+P}b.util.ease={easeInQuad:function(x,P,I,k){return I*(x/=k)*x+P},easeOutQuad:function(x,P,I,k){return-I*(x/=k)*(x-2)+P},easeInOutQuad:function(x,P,I,k){return x/=k/2,x<1?I/2*x*x+P:-I/2*(--x*(x-2)-1)+P},easeInCubic:function(x,P,I,k){return I*(x/=k)*x*x+P},easeOutCubic:i,easeInOutCubic:o,easeInQuart:n,easeOutQuart:s,easeInOutQuart:r,easeInQuint:a,easeOutQuint:l,easeInOutQuint:u,easeInSine:c,easeOutSine:h,easeInOutSine:d,easeInExpo:g,easeOutExpo:m,easeInOutExpo:y,easeInCirc:C,easeOutCirc:w,easeInOutCirc:F,easeInElastic:B,easeOutElastic:U,easeInOutElastic:R,easeInBack:W,easeOutBack:X,easeInOutBack:$,easeInBounce:st,easeOutBounce:pt,easeInOutBounce:dt}})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.parseUnit,r=t.util.multiplyTransformMatrices,a=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],l=["symbol","image","marker","pattern","view","svg"],u=["pattern","defs","symbol","metadata","clipPath","mask","desc"],c=["symbol","g","a","svg","clipPath","defs"],h={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},d={stroke:"strokeOpacity",fill:"fillOpacity"},g="font-size",m="clip-path";t.svgValidTagNamesRegEx=w(a),t.svgViewBoxElementsRegEx=w(l),t.svgInvalidAncestorsRegEx=w(u),t.svgValidParentsRegEx=w(c),t.cssRules={},t.gradientDefs={},t.clipPaths={};function y(S){return S in h?h[S]:S}function C(S,_,O,j){var q=Array.isArray(_),N;if((S==="fill"||S==="stroke")&&_==="none")_="";else{if(S==="strokeUniform")return _==="non-scaling-stroke";if(S==="strokeDashArray")_==="none"?_=null:_=_.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(S==="transformMatrix")O&&O.transformMatrix?_=r(O.transformMatrix,t.parseTransformAttribute(_)):_=t.parseTransformAttribute(_);else if(S==="visible")_=_!=="none"&&_!=="hidden",O&&O.visible===!1&&(_=!1);else if(S==="opacity")_=parseFloat(_),O&&typeof O.opacity<"u"&&(_*=O.opacity);else if(S==="textAnchor")_=_==="start"?"left":_==="end"?"right":"center";else if(S==="charSpacing")N=s(_,j)/j*1e3;else if(S==="paintFirst"){var H=_.indexOf("fill"),Q=_.indexOf("stroke"),_="fill";(H>-1&&Q>-1&&Q<H||H===-1&&Q>-1)&&(_="stroke")}else{if(S==="href"||S==="xlink:href"||S==="font")return _;if(S==="imageSmoothing")return _==="optimizeQuality";N=q?_.map(s):s(_,j)}}return!q&&isNaN(N)?_:N}function w(S){return new RegExp("^("+S.join("|")+")\\b","i")}function F(S){for(var _ in d)if(!(typeof S[d[_]]>"u"||S[_]==="")){if(typeof S[_]>"u"){if(!t.Object.prototype[_])continue;S[_]=t.Object.prototype[_]}if(S[_].indexOf("url(")!==0){var O=new t.Color(S[_]);S[_]=O.setAlpha(n(O.getAlpha()*S[d[_]],2)).toRgba()}}return S}function B(S,_){var O,j=[],q,N,H;for(N=0,H=_.length;N<H;N++)O=_[N],q=S.getElementsByTagName(O),j=j.concat(Array.prototype.slice.call(q));return j}t.parseTransformAttribute=function(){function S(et,yt){var Tt=t.util.cos(yt[0]),It=t.util.sin(yt[0]),jt=0,Mt=0;yt.length===3&&(jt=yt[1],Mt=yt[2]),et[0]=Tt,et[1]=It,et[2]=-It,et[3]=Tt,et[4]=jt-(Tt*jt-It*Mt),et[5]=Mt-(It*jt+Tt*Mt)}function _(et,yt){var Tt=yt[0],It=yt.length===2?yt[1]:yt[0];et[0]=Tt,et[3]=It}function O(et,yt,Tt){et[Tt]=Math.tan(t.util.degreesToRadians(yt[0]))}function j(et,yt){et[4]=yt[0],yt.length===2&&(et[5]=yt[1])}var q=t.iMatrix,N=t.reNum,H=t.commaWsp,Q="(?:(skewX)\\s*\\(\\s*("+N+")\\s*\\))",ot="(?:(skewY)\\s*\\(\\s*("+N+")\\s*\\))",Y="(?:(rotate)\\s*\\(\\s*("+N+")(?:"+H+"("+N+")"+H+"("+N+"))?\\s*\\))",z="(?:(scale)\\s*\\(\\s*("+N+")(?:"+H+"("+N+"))?\\s*\\))",it="(?:(translate)\\s*\\(\\s*("+N+")(?:"+H+"("+N+"))?\\s*\\))",Z="(?:(matrix)\\s*\\(\\s*("+N+")"+H+"("+N+")"+H+"("+N+")"+H+"("+N+")"+H+"("+N+")"+H+"("+N+")\\s*\\))",J="(?:"+Z+"|"+it+"|"+z+"|"+Y+"|"+Q+"|"+ot+")",nt="(?:"+J+"(?:"+H+"*"+J+")*)",lt="^\\s*(?:"+nt+"?)\\s*$",At=new RegExp(lt),wt=new RegExp(J,"g");return function(et){var yt=q.concat(),Tt=[];if(!et||et&&!At.test(et))return yt;et.replace(wt,function(jt){var Mt=new RegExp(J).exec(jt).filter(function(Le){return!!Le}),se=Mt[1],Jt=Mt.slice(2).map(parseFloat);switch(se){case"translate":j(yt,Jt);break;case"rotate":Jt[0]=t.util.degreesToRadians(Jt[0]),S(yt,Jt);break;case"scale":_(yt,Jt);break;case"skewX":O(yt,Jt,2);break;case"skewY":O(yt,Jt,1);break;case"matrix":yt=Jt;break}Tt.push(yt.concat()),yt=q.concat()});for(var It=Tt[0];Tt.length>1;)Tt.shift(),It=t.util.multiplyTransformMatrices(It,Tt[0]);return It}}();function U(S,_){var O,j;S.replace(/;\s*$/,"").split(";").forEach(function(q){var N=q.split(":");O=N[0].trim().toLowerCase(),j=N[1].trim(),_[O]=j})}function R(S,_){var O,j;for(var q in S)typeof S[q]>"u"||(O=q.toLowerCase(),j=S[q],_[O]=j)}function W(S,_){var O={};for(var j in t.cssRules[_])if(X(S,j.split(" ")))for(var q in t.cssRules[_][j])O[q]=t.cssRules[_][j][q];return O}function X(S,_){var O,j=!0;return O=st(S,_.pop()),O&&_.length&&(j=$(S,_)),O&&j&&_.length===0}function $(S,_){for(var O,j=!0;S.parentNode&&S.parentNode.nodeType===1&&_.length;)j&&(O=_.pop()),S=S.parentNode,j=st(S,O);return _.length===0}function st(S,_){var O=S.nodeName,j=S.getAttribute("class"),q=S.getAttribute("id"),N,H;if(N=new RegExp("^"+O,"i"),_=_.replace(N,""),q&&_.length&&(N=new RegExp("#"+q+"(?![a-zA-Z\\-]+)","i"),_=_.replace(N,"")),j&&_.length)for(j=j.split(" "),H=j.length;H--;)N=new RegExp("\\."+j[H]+"(?![a-zA-Z\\-]+)","i"),_=_.replace(N,"");return _.length===0}function pt(S,_){var O;if(S.getElementById&&(O=S.getElementById(_)),O)return O;var j,q,N,H=S.getElementsByTagName("*");for(q=0,N=H.length;q<N;q++)if(j=H[q],_===j.getAttribute("id"))return j}function dt(S){for(var _=B(S,["use","svg:use"]),O=0;_.length&&O<_.length;){var j=_[O],q=j.getAttribute("xlink:href")||j.getAttribute("href");if(q===null)return;var N=q.slice(1),H=j.getAttribute("x")||0,Q=j.getAttribute("y")||0,ot=pt(S,N).cloneNode(!0),Y=(ot.getAttribute("transform")||"")+" translate("+H+", "+Q+")",z,it=_.length,Z,J,nt,lt,At=t.svgNS;if(P(ot),/^svg$/i.test(ot.nodeName)){var wt=ot.ownerDocument.createElementNS(At,"g");for(J=0,nt=ot.attributes,lt=nt.length;J<lt;J++)Z=nt.item(J),wt.setAttributeNS(At,Z.nodeName,Z.nodeValue);for(;ot.firstChild;)wt.appendChild(ot.firstChild);ot=wt}for(J=0,nt=j.attributes,lt=nt.length;J<lt;J++)Z=nt.item(J),!(Z.nodeName==="x"||Z.nodeName==="y"||Z.nodeName==="xlink:href"||Z.nodeName==="href")&&(Z.nodeName==="transform"?Y=Z.nodeValue+" "+Y:ot.setAttribute(Z.nodeName,Z.nodeValue));ot.setAttribute("transform",Y),ot.setAttribute("instantiated_by_use","1"),ot.removeAttribute("id"),z=j.parentNode,z.replaceChild(ot,j),_.length===it&&O++}}var x=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function P(S){if(!t.svgViewBoxElementsRegEx.test(S.nodeName))return{};var _=S.getAttribute("viewBox"),O=1,j=1,q=0,N=0,H,Q,ot,Y,z=S.getAttribute("width"),it=S.getAttribute("height"),Z=S.getAttribute("x")||0,J=S.getAttribute("y")||0,nt=S.getAttribute("preserveAspectRatio")||"",lt=!_||!(_=_.match(x)),At=!z||!it||z==="100%"||it==="100%",wt=lt&&At,et={},yt="",Tt=0,It=0;if(et.width=0,et.height=0,et.toBeParsed=wt,lt&&(Z||J)&&S.parentNode&&S.parentNode.nodeName!=="#document"&&(yt=" translate("+s(Z)+" "+s(J)+") ",ot=(S.getAttribute("transform")||"")+yt,S.setAttribute("transform",ot),S.removeAttribute("x"),S.removeAttribute("y")),wt)return et;if(lt)return et.width=s(z),et.height=s(it),et;if(q=-parseFloat(_[1]),N=-parseFloat(_[2]),H=parseFloat(_[3]),Q=parseFloat(_[4]),et.minX=q,et.minY=N,et.viewBoxWidth=H,et.viewBoxHeight=Q,At?(et.width=H,et.height=Q):(et.width=s(z),et.height=s(it),O=et.width/H,j=et.height/Q),nt=t.util.parsePreserveAspectRatioAttribute(nt),nt.alignX!=="none"&&(nt.meetOrSlice==="meet"&&(j=O=O>j?j:O),nt.meetOrSlice==="slice"&&(j=O=O>j?O:j),Tt=et.width-H*O,It=et.height-Q*O,nt.alignX==="Mid"&&(Tt/=2),nt.alignY==="Mid"&&(It/=2),nt.alignX==="Min"&&(Tt=0),nt.alignY==="Min"&&(It=0)),O===1&&j===1&&q===0&&N===0&&Z===0&&J===0)return et;if((Z||J)&&S.parentNode.nodeName!=="#document"&&(yt=" translate("+s(Z)+" "+s(J)+") "),ot=yt+" matrix("+O+" 0 0 "+j+" "+(q*O+Tt)+" "+(N*j+It)+") ",S.nodeName==="svg"){for(Y=S.ownerDocument.createElementNS(t.svgNS,"g");S.firstChild;)Y.appendChild(S.firstChild);S.appendChild(Y)}else Y=S,Y.removeAttribute("x"),Y.removeAttribute("y"),ot=Y.getAttribute("transform")+ot;return Y.setAttribute("transform",ot),et}function I(S,_){for(;S&&(S=S.parentNode);)if(S.nodeName&&_.test(S.nodeName.replace("svg:",""))&&!S.getAttribute("instantiated_by_use"))return!0;return!1}t.parseSVGDocument=function(S,_,O,j){if(S){dt(S);var q=t.Object.__uid++,N,H,Q=P(S),ot=t.util.toArray(S.getElementsByTagName("*"));if(Q.crossOrigin=j&&j.crossOrigin,Q.svgUid=q,ot.length===0&&t.isLikelyNode){ot=S.selectNodes('//*[name(.)!="svg"]');var Y=[];for(N=0,H=ot.length;N<H;N++)Y[N]=ot[N];ot=Y}var z=ot.filter(function(Z){return P(Z),t.svgValidTagNamesRegEx.test(Z.nodeName.replace("svg:",""))&&!I(Z,t.svgInvalidAncestorsRegEx)});if(!z||z&&!z.length){_&&_([],{});return}var it={};ot.filter(function(Z){return Z.nodeName.replace("svg:","")==="clipPath"}).forEach(function(Z){var J=Z.getAttribute("id");it[J]=t.util.toArray(Z.getElementsByTagName("*")).filter(function(nt){return t.svgValidTagNamesRegEx.test(nt.nodeName.replace("svg:",""))})}),t.gradientDefs[q]=t.getGradientDefs(S),t.cssRules[q]=t.getCSSRules(S),t.clipPaths[q]=it,t.parseElements(z,function(Z,J){_&&(_(Z,Q,J,ot),delete t.gradientDefs[q],delete t.cssRules[q],delete t.clipPaths[q])},o(Q),O,j)}};function k(S,_){var O=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],j="xlink:href",q=_.getAttribute(j).slice(1),N=pt(S,q);if(N&&N.getAttribute(j)&&k(S,N),O.forEach(function(Q){N&&!_.hasAttribute(Q)&&N.hasAttribute(Q)&&_.setAttribute(Q,N.getAttribute(Q))}),!_.children.length)for(var H=N.cloneNode(!0);H.firstChild;)_.appendChild(H.firstChild);_.removeAttribute(j)}var K=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");i(t,{parseFontDeclaration:function(S,_){var O=S.match(K);if(O){var j=O[1],q=O[3],N=O[4],H=O[5],Q=O[6];j&&(_.fontStyle=j),q&&(_.fontWeight=isNaN(parseFloat(q))?q:parseFloat(q)),N&&(_.fontSize=s(N)),Q&&(_.fontFamily=Q),H&&(_.lineHeight=H==="normal"?1:H)}},getGradientDefs:function(S){var _=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],O=B(S,_),j,q=0,N={};for(q=O.length;q--;)j=O[q],j.getAttribute("xlink:href")&&k(S,j),N[j.getAttribute("id")]=j;return N},parseAttributes:function(S,_,O){if(S){var j,q={},N,H;typeof O>"u"&&(O=S.getAttribute("svgUid")),S.parentNode&&t.svgValidParentsRegEx.test(S.parentNode.nodeName)&&(q=t.parseAttributes(S.parentNode,_,O));var Q=_.reduce(function(nt,lt){return j=S.getAttribute(lt),j&&(nt[lt]=j),nt},{}),ot=i(W(S,O),t.parseStyleAttribute(S));Q=i(Q,ot),ot[m]&&S.setAttribute(m,ot[m]),N=H=q.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,Q[g]&&(Q[g]=N=s(Q[g],H));var Y,z,it={};for(var Z in Q)Y=y(Z),z=C(Y,Q[Z],q,N),it[Y]=z;it&&it.font&&t.parseFontDeclaration(it.font,it);var J=i(q,it);return t.svgValidParentsRegEx.test(S.nodeName)?J:F(J)}},parseElements:function(S,_,O,j,q){new t.ElementsParser(S,_,O,j,q).parse()},parseStyleAttribute:function(S){var _={},O=S.getAttribute("style");return O&&(typeof O=="string"?U(O,_):R(O,_)),_},parsePointsAttribute:function(S){if(!S)return null;S=S.replace(/,/g," ").trim(),S=S.split(/\s+/);var _=[],O,j;for(O=0,j=S.length;O<j;O+=2)_.push({x:parseFloat(S[O]),y:parseFloat(S[O+1])});return _},getCSSRules:function(S){var _=S.getElementsByTagName("style"),O,j,q={},N;for(O=0,j=_.length;O<j;O++){var H=_[O].textContent;H=H.replace(/\/\*[\s\S]*?\*\//g,""),H.trim()!==""&&(N=H.split("}"),N=N.filter(function(Q){return Q.trim()}),N.forEach(function(Q){var ot=Q.split("{"),Y={},z=ot[1].trim(),it=z.split(";").filter(function(lt){return lt.trim()});for(O=0,j=it.length;O<j;O++){var Z=it[O].split(":"),J=Z[0].trim(),nt=Z[1].trim();Y[J]=nt}Q=ot[0].trim(),Q.split(",").forEach(function(lt){lt=lt.replace(/^svg/i,"").trim(),lt!==""&&(q[lt]?t.util.object.extend(q[lt],Y):q[lt]=t.util.object.clone(Y))})}))}return q},loadSVGFromURL:function(S,_,O,j){S=S.replace(/^\n\s*/,"").trim(),new t.util.request(S,{method:"get",onComplete:q});function q(N){var H=N.responseXML;if(!H||!H.documentElement)return _&&_(null),!1;t.parseSVGDocument(H.documentElement,function(Q,ot,Y,z){_&&_(Q,ot,Y,z)},O,j)}},loadSVGFromString:function(S,_,O,j){var q=new t.window.DOMParser,N=q.parseFromString(S.trim(),"text/xml");t.parseSVGDocument(N.documentElement,function(H,Q,ot,Y){_(H,Q,ot,Y)},O,j)}})})(_t);b.ElementsParser=function(e,t,i,o,n,s){this.elements=e,this.callback=t,this.options=i,this.reviver=o,this.svgUid=i&&i.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s};(function(e){e.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},e.createObjects=function(){var t=this;this.elements.forEach(function(i,o){i.setAttribute("svgUid",t.svgUid),t.createObject(i,o)})},e.findTag=function(t){return b[b.util.string.capitalize(t.tagName.replace("svg:",""))]},e.createObject=function(t,i){var o=this.findTag(t);if(o&&o.fromElement)try{o.fromElement(t,this.createCallback(i,t),this.options)}catch(n){b.log(n)}else this.checkIfDone()},e.createCallback=function(t,i){var o=this;return function(n){var s;o.resolveGradient(n,i,"fill"),o.resolveGradient(n,i,"stroke"),n instanceof b.Image&&n._originalElement&&(s=n.parsePreserveAspectRatioAttribute(i)),n._removeTransformMatrix(s),o.resolveClipPath(n,i),o.reviver&&o.reviver(i,n),o.instances[t]=n,o.checkIfDone()}},e.extractPropertyDefinition=function(t,i,o){var n=t[i],s=this.regexUrl;if(s.test(n)){s.lastIndex=0;var r=s.exec(n)[1];return s.lastIndex=0,b[o][this.svgUid][r]}},e.resolveGradient=function(t,i,o){var n=this.extractPropertyDefinition(t,o,"gradientDefs");if(n){var s=i.getAttribute(o+"-opacity"),r=b.Gradient.fromElement(n,t,s,this.options);t.set(o,r)}},e.createClipPathCallback=function(t,i){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,i.push(o)}},e.resolveClipPath=function(t,i){var o=this.extractPropertyDefinition(t,"clipPath","clipPaths"),n,s,r,a,l,u;if(o){a=[],r=b.util.invertTransform(t.calcTransformMatrix());for(var c=o[0].parentNode,h=i;h.parentNode&&h.getAttribute("clip-path")!==t.clipPath;)h=h.parentNode;h.parentNode.appendChild(c);for(var d=0;d<o.length;d++)n=o[d],s=this.findTag(n),s.fromElement(n,this.createClipPathCallback(t,a),this.options);a.length===1?o=a[0]:o=new b.Group(a),l=b.util.multiplyTransformMatrices(r,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,h);var u=b.util.qrDecompose(l);o.flipX=!1,o.flipY=!1,o.set("scaleX",u.scaleX),o.set("scaleY",u.scaleY),o.angle=u.angle,o.skewX=u.skewX,o.skewY=0,o.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),t.clipPath=o}else delete t.clipPath},e.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(t){return t!=null}),this.callback(this.instances,this.elements))}})(b.ElementsParser.prototype);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Point){t.warn("fabric.Point is already defined");return}t.Point=i;function i(o,n){this.x=o,this.y=n}i.prototype={type:"point",constructor:i,add:function(o){return new i(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new i(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new i(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new i(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new i(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new i(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new i(this.x+(o.x-this.x)*n,this.y+(o.y-this.y)*n)},distanceFrom:function(o){var n=this.x-o.x,s=this.y-o.y;return Math.sqrt(n*n+s*s)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new i(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new i(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,n){return this.x=o,this.y=n,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var n=this.x,s=this.y;this.x=o.x,this.y=o.y,o.x=n,o.y=s},clone:function(){return new i(this.x,this.y)}}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Intersection){t.warn("fabric.Intersection is already defined");return}function i(o){this.status=o,this.points=[]}t.Intersection=i,t.Intersection.prototype={constructor:i,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},t.Intersection.intersectLineLine=function(o,n,s,r){var a,l=(r.x-s.x)*(o.y-s.y)-(r.y-s.y)*(o.x-s.x),u=(n.x-o.x)*(o.y-s.y)-(n.y-o.y)*(o.x-s.x),c=(r.y-s.y)*(n.x-o.x)-(r.x-s.x)*(n.y-o.y);if(c!==0){var h=l/c,d=u/c;0<=h&&h<=1&&0<=d&&d<=1?(a=new i("Intersection"),a.appendPoint(new t.Point(o.x+h*(n.x-o.x),o.y+h*(n.y-o.y)))):a=new i}else l===0||u===0?a=new i("Coincident"):a=new i("Parallel");return a},t.Intersection.intersectLinePolygon=function(o,n,s){var r=new i,a=s.length,l,u,c,h;for(h=0;h<a;h++)l=s[h],u=s[(h+1)%a],c=i.intersectLineLine(o,n,l,u),r.appendPoints(c.points);return r.points.length>0&&(r.status="Intersection"),r},t.Intersection.intersectPolygonPolygon=function(o,n){var s=new i,r=o.length,a;for(a=0;a<r;a++){var l=o[a],u=o[(a+1)%r],c=i.intersectLinePolygon(l,u,n);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},t.Intersection.intersectPolygonRectangle=function(o,n,s){var r=n.min(s),a=n.max(s),l=new t.Point(a.x,r.y),u=new t.Point(r.x,a.y),c=i.intersectLinePolygon(r,l,o),h=i.intersectLinePolygon(l,a,o),d=i.intersectLinePolygon(a,u,o),g=i.intersectLinePolygon(u,r,o),m=new i;return m.appendPoints(c.points),m.appendPoints(h.points),m.appendPoints(d.points),m.appendPoints(g.points),m.points.length>0&&(m.status="Intersection"),m}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Color){t.warn("fabric.Color is already defined.");return}function i(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}t.Color=i,t.Color.prototype={_tryParsingColor:function(n){var s;n in i.colorNameMap&&(n=i.colorNameMap[n]),n==="transparent"&&(s=[255,255,255,0]),s||(s=i.sourceFromHex(n)),s||(s=i.sourceFromRgb(n)),s||(s=i.sourceFromHsl(n)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(n,s,r){n/=255,s/=255,r/=255;var a,l,u,c=t.util.array.max([n,s,r]),h=t.util.array.min([n,s,r]);if(u=(c+h)/2,c===h)a=l=0;else{var d=c-h;switch(l=u>.5?d/(2-c-h):d/(c+h),c){case n:a=(s-r)/d+(s<r?6:0);break;case s:a=(r-n)/d+2;break;case r:a=(n-s)/d+4;break}a/=6}return[Math.round(a*360),Math.round(l*100),Math.round(u*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),s,r,a;return s=n[0].toString(16),s=s.length===1?"0"+s:s,r=n[1].toString(16),r=r.length===1?"0"+r:r,a=n[2].toString(16),a=a.length===1?"0"+a:a,s.toUpperCase()+r.toUpperCase()+a.toUpperCase()},toHexa:function(){var n=this.getSource(),s;return s=Math.round(n[3]*255),s=s.toString(16),s=s.length===1?"0"+s:s,this.toHex()+s.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var s=this.getSource();return s[3]=n,this.setSource(s),this},toGrayscale:function(){var n=this.getSource(),s=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),r=n[3];return this.setSource([s,s,s,r]),this},toBlackWhite:function(n){var s=this.getSource(),r=(s[0]*.3+s[1]*.59+s[2]*.11).toFixed(0),a=s[3];return n=n||127,r=Number(r)<Number(n)?0:255,this.setSource([r,r,r,a]),this},overlayWith:function(n){n instanceof i||(n=new i(n));var s=[],r=this.getAlpha(),a=.5,l=this.getSource(),u=n.getSource(),c;for(c=0;c<3;c++)s.push(Math.round(l[c]*(1-a)+u[c]*a));return s[3]=r,this.setSource(s),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(n,s,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(s-n)*6*r:r<1/2?s:r<2/3?n+(s-n)*(2/3-r)*6:n}t.Color.fromRgb=function(n){return i.fromSource(i.sourceFromRgb(n))},t.Color.sourceFromRgb=function(n){var s=n.match(i.reRGBa);if(s){var r=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),a=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),l=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(r,10),parseInt(a,10),parseInt(l,10),s[4]?parseFloat(s[4]):1]}},t.Color.fromRgba=i.fromRgb,t.Color.fromHsl=function(n){return i.fromSource(i.sourceFromHsl(n))},t.Color.sourceFromHsl=function(n){var s=n.match(i.reHSLa);if(s){var r=(parseFloat(s[1])%360+360)%360/360,a=parseFloat(s[2])/(/%$/.test(s[2])?100:1),l=parseFloat(s[3])/(/%$/.test(s[3])?100:1),u,c,h;if(a===0)u=c=h=l;else{var d=l<=.5?l*(a+1):l+a-l*a,g=l*2-d;u=o(g,d,r+1/3),c=o(g,d,r),h=o(g,d,r-1/3)}return[Math.round(u*255),Math.round(c*255),Math.round(h*255),s[4]?parseFloat(s[4]):1]}},t.Color.fromHsla=i.fromHsl,t.Color.fromHex=function(n){return i.fromSource(i.sourceFromHex(n))},t.Color.sourceFromHex=function(n){if(n.match(i.reHex)){var s=n.slice(n.indexOf("#")+1),r=s.length===3||s.length===4,a=s.length===8||s.length===4,l=r?s.charAt(0)+s.charAt(0):s.substring(0,2),u=r?s.charAt(1)+s.charAt(1):s.substring(2,4),c=r?s.charAt(2)+s.charAt(2):s.substring(4,6),h=a?r?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(l,16),parseInt(u,16),parseInt(c,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},t.Color.fromSource=function(n){var s=new i;return s.setSource(n),s}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],n={},s="left",r="top",a="right",l="bottom",u="center",c={top:l,bottom:r,left:a,right:s,center:u},h=t.util.radiansToDegrees,d=Math.sign||function(Y){return(Y>0)-(Y<0)||+Y};function g(Y,z){var it=Y.angle+h(Math.atan2(z.y,z.x))+360;return Math.round(it%360/45)}function m(Y,z){var it=z.transform.target,Z=it.canvas,J=t.util.object.clone(z);J.target=it,Z&&Z.fire("object:"+Y,J),it.fire(Y,z)}function y(Y,z){var it=z.canvas,Z=it.uniScaleKey,J=Y[Z];return it.uniformScaling&&!J||!it.uniformScaling&&J}function C(Y){return Y.originX===u&&Y.originY===u}function w(Y,z,it){var Z=Y.lockScalingX,J=Y.lockScalingY;return!!(Z&&J||!z&&(Z||J)&&it||Z&&z==="x"||J&&z==="y")}function F(Y,z,it){var Z="not-allowed",J=y(Y,it),nt="";if(z.x!==0&&z.y===0?nt="x":z.x===0&&z.y!==0&&(nt="y"),w(it,nt,J))return Z;var lt=g(it,z);return i[lt]+"-resize"}function B(Y,z,it){var Z="not-allowed";if(z.x!==0&&it.lockSkewingY||z.y!==0&&it.lockSkewingX)return Z;var J=g(it,z)%4;return o[J]+"-resize"}function U(Y,z,it){return Y[it.canvas.altActionKey]?n.skewCursorStyleHandler(Y,z,it):n.scaleCursorStyleHandler(Y,z,it)}function R(Y,z,it){var Z=Y[it.canvas.altActionKey];if(z.x===0)return Z?"skewX":"scaleY";if(z.y===0)return Z?"skewY":"scaleX"}function W(Y,z,it){return it.lockRotation?"not-allowed":z.cursorStyle}function X(Y,z,it,Z){return{e:Y,transform:z,pointer:{x:it,y:Z}}}function $(Y){return function(z,it,Z,J){var nt=it.target,lt=nt.getCenterPoint(),At=nt.translateToOriginPoint(lt,it.originX,it.originY),wt=Y(z,it,Z,J);return nt.setPositionByOrigin(At,it.originX,it.originY),wt}}function st(Y,z){return function(it,Z,J,nt){var lt=z(it,Z,J,nt);return lt&&m(Y,X(it,Z,J,nt)),lt}}function pt(Y,z,it,Z,J){var nt=Y.target,lt=nt.controls[Y.corner],At=nt.canvas.getZoom(),wt=nt.padding/At,et=nt.toLocalPoint(new t.Point(Z,J),z,it);return et.x>=wt&&(et.x-=wt),et.x<=-wt&&(et.x+=wt),et.y>=wt&&(et.y-=wt),et.y<=wt&&(et.y+=wt),et.x-=lt.offsetX,et.y-=lt.offsetY,et}function dt(Y){return Y.flipX!==Y.flipY}function x(Y,z,it,Z,J){if(Y[z]!==0){var nt=Y._getTransformedDimensions()[Z],lt=J/nt*Y[it];Y.set(it,lt)}}function P(Y,z,it,Z){var J=z.target,nt=J._getTransformedDimensions(0,J.skewY),lt=pt(z,z.originX,z.originY,it,Z),At=Math.abs(lt.x*2)-nt.x,wt=J.skewX,et;At<2?et=0:(et=h(Math.atan2(At/J.scaleX,nt.y/J.scaleY)),z.originX===s&&z.originY===l&&(et=-et),z.originX===a&&z.originY===r&&(et=-et),dt(J)&&(et=-et));var yt=wt!==et;if(yt){var Tt=J._getTransformedDimensions().y;J.set("skewX",et),x(J,"skewY","scaleY","y",Tt)}return yt}function I(Y,z,it,Z){var J=z.target,nt=J._getTransformedDimensions(J.skewX,0),lt=pt(z,z.originX,z.originY,it,Z),At=Math.abs(lt.y*2)-nt.y,wt=J.skewY,et;At<2?et=0:(et=h(Math.atan2(At/J.scaleY,nt.x/J.scaleX)),z.originX===s&&z.originY===l&&(et=-et),z.originX===a&&z.originY===r&&(et=-et),dt(J)&&(et=-et));var yt=wt!==et;if(yt){var Tt=J._getTransformedDimensions().x;J.set("skewY",et),x(J,"skewX","scaleX","x",Tt)}return yt}function k(Y,z,it,Z){var J=z.target,nt=J.skewX,lt,At=z.originY;if(J.lockSkewingX)return!1;if(nt===0){var wt=pt(z,u,u,it,Z);wt.x>0?lt=s:lt=a}else nt>0&&(lt=At===r?s:a),nt<0&&(lt=At===r?a:s),dt(J)&&(lt=lt===s?a:s);z.originX=lt;var et=st("skewing",$(P));return et(Y,z,it,Z)}function K(Y,z,it,Z){var J=z.target,nt=J.skewY,lt,At=z.originX;if(J.lockSkewingY)return!1;if(nt===0){var wt=pt(z,u,u,it,Z);wt.y>0?lt=r:lt=l}else nt>0&&(lt=At===s?r:l),nt<0&&(lt=At===s?l:r),dt(J)&&(lt=lt===r?l:r);z.originY=lt;var et=st("skewing",$(I));return et(Y,z,it,Z)}function S(Y,z,it,Z){var J=z,nt=J.target,lt=nt.translateToOriginPoint(nt.getCenterPoint(),J.originX,J.originY);if(nt.lockRotation)return!1;var At=Math.atan2(J.ey-lt.y,J.ex-lt.x),wt=Math.atan2(Z-lt.y,it-lt.x),et=h(wt-At+J.theta),yt=!0;if(nt.snapAngle>0){var Tt=nt.snapAngle,It=nt.snapThreshold||Tt,jt=Math.ceil(et/Tt)*Tt,Mt=Math.floor(et/Tt)*Tt;Math.abs(et-Mt)<It?et=Mt:Math.abs(et-jt)<It&&(et=jt)}return et<0&&(et=360+et),et%=360,yt=nt.angle!==et,nt.angle=et,yt}function _(Y,z,it,Z,J){J=J||{};var nt=z.target,lt=nt.lockScalingX,At=nt.lockScalingY,wt=J.by,et,yt,Tt,It,jt=y(Y,nt),Mt=w(nt,wt,jt),se,Jt,Le=z.gestureScale;if(Mt)return!1;if(Le)yt=z.scaleX*Le,Tt=z.scaleY*Le;else{if(et=pt(z,z.originX,z.originY,it,Z),se=wt!=="y"?d(et.x):1,Jt=wt!=="x"?d(et.y):1,z.signX||(z.signX=se),z.signY||(z.signY=Jt),nt.lockScalingFlip&&(z.signX!==se||z.signY!==Jt))return!1;if(It=nt._getTransformedDimensions(),jt&&!wt){var qe=Math.abs(et.x)+Math.abs(et.y),Ce=z.original,Ei=Math.abs(It.x*Ce.scaleX/nt.scaleX)+Math.abs(It.y*Ce.scaleY/nt.scaleY),Ft=qe/Ei;yt=Ce.scaleX*Ft,Tt=Ce.scaleY*Ft}else yt=Math.abs(et.x*nt.scaleX/It.x),Tt=Math.abs(et.y*nt.scaleY/It.y);C(z)&&(yt*=2,Tt*=2),z.signX!==se&&wt!=="y"&&(z.originX=c[z.originX],yt*=-1,z.signX=se),z.signY!==Jt&&wt!=="x"&&(z.originY=c[z.originY],Tt*=-1,z.signY=Jt)}var Bt=nt.scaleX,Gt=nt.scaleY;return wt?(wt==="x"&&nt.set("scaleX",yt),wt==="y"&&nt.set("scaleY",Tt)):(!lt&&nt.set("scaleX",yt),!At&&nt.set("scaleY",Tt)),Bt!==nt.scaleX||Gt!==nt.scaleY}function O(Y,z,it,Z){return _(Y,z,it,Z)}function j(Y,z,it,Z){return _(Y,z,it,Z,{by:"x"})}function q(Y,z,it,Z){return _(Y,z,it,Z,{by:"y"})}function N(Y,z,it,Z){return Y[z.target.canvas.altActionKey]?n.skewHandlerX(Y,z,it,Z):n.scalingY(Y,z,it,Z)}function H(Y,z,it,Z){return Y[z.target.canvas.altActionKey]?n.skewHandlerY(Y,z,it,Z):n.scalingX(Y,z,it,Z)}function Q(Y,z,it,Z){var J=z.target,nt=pt(z,z.originX,z.originY,it,Z),lt=J.strokeWidth/(J.strokeUniform?J.scaleX:1),At=C(z)?2:1,wt=J.width,et=Math.abs(nt.x*At/J.scaleX)-lt;return J.set("width",Math.max(et,0)),wt!==et}function ot(Y,z,it,Z){var J=z.target,nt=it-z.offsetX,lt=Z-z.offsetY,At=!J.get("lockMovementX")&&J.left!==nt,wt=!J.get("lockMovementY")&&J.top!==lt;return At&&J.set("left",nt),wt&&J.set("top",lt),(At||wt)&&m("moving",X(Y,z,it,Z)),At||wt}n.scaleCursorStyleHandler=F,n.skewCursorStyleHandler=B,n.scaleSkewCursorStyleHandler=U,n.rotationWithSnapping=st("rotating",$(S)),n.scalingEqually=st("scaling",$(O)),n.scalingX=st("scaling",$(j)),n.scalingY=st("scaling",$(q)),n.scalingYOrSkewingX=N,n.scalingXOrSkewingY=H,n.changeWidth=st("resizing",$(Q)),n.skewHandlerX=k,n.skewHandlerY=K,n.dragHandler=ot,n.scaleOrSkewActionName=R,n.rotationStyleHandler=W,n.fireEvent=m,n.wrapWithFixedAnchor=$,n.wrapWithFireEvent=st,n.getLocalPoint=pt,t.controlsUtils=n})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians,o=t.controlsUtils;function n(r,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=a,w=l,F;r.save(),r.fillStyle=u.cornerColor||c.cornerColor,r.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,h>d?(F=h,r.scale(1,d/h),w=l*h/d):d>h?(F=d,r.scale(h/d,1),C=a*d/h):F=h,r.lineWidth=1,r.beginPath(),r.arc(C,w,F/2,0,2*Math.PI,!1),r[m](),y&&r.stroke(),r.restore()}function s(r,a,l,u,c){u=u||{};var h=this.sizeX||u.cornerSize||c.cornerSize,d=this.sizeY||u.cornerSize||c.cornerSize,g=typeof u.transparentCorners<"u"?u.transparentCorners:c.transparentCorners,m=g?"stroke":"fill",y=!g&&(u.cornerStrokeColor||c.cornerStrokeColor),C=h/2,w=d/2;r.save(),r.fillStyle=u.cornerColor||c.cornerColor,r.strokeStyle=u.cornerStrokeColor||c.cornerStrokeColor,r.lineWidth=1,r.translate(a,l),r.rotate(i(c.angle)),r[m+"Rect"](-C,-w,h,d),y&&r.strokeRect(-C,-w,h,d),r.restore()}o.renderCircleControl=n,o.renderSquareControl=s})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={});function i(o){for(var n in o)this[n]=o[n]}t.Control=i,t.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,n){return n.cursorStyle},getActionName:function(o,n){return n.actionName},getVisibility:function(o,n){var s=o._controlsVisibility;return s&&typeof s[n]<"u"?s[n]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,n){var s=t.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},n);return s},calcCornerCoords:function(o,n,s,r,a){var l,u,c,h,d=a?this.touchSizeX:this.sizeX,g=a?this.touchSizeY:this.sizeY;if(d&&g&&d!==g){var m=Math.atan2(g,d),y=Math.sqrt(d*d+g*g)/2,C=m-t.util.degreesToRadians(o),w=Math.PI/2-m-t.util.degreesToRadians(o);l=y*t.util.cos(C),u=y*t.util.sin(C),c=y*t.util.cos(w),h=y*t.util.sin(w)}else{var F=d&&g?d:n;y=F*.7071067812;var C=t.util.degreesToRadians(45-o);l=c=y*t.util.cos(C),u=h=y*t.util.sin(C)}return{tl:{x:s-h,y:r-c},tr:{x:s+l,y:r-u},bl:{x:s-l,y:r+u},br:{x:s+h,y:r+c}}},render:function(o,n,s,r,a){switch(r=r||{},r.cornerStyle||a.cornerStyle){case"circle":t.controlsUtils.renderCircleControl.call(this,o,n,s,r,a);break;default:t.controlsUtils.renderSquareControl.call(this,o,n,s,r,a)}}}})(_t);(function(){function e(s,r){var a=s.getAttribute("style"),l=s.getAttribute("offset")||0,u,c,h,d;if(l=parseFloat(l)/(/%$/.test(l)?100:1),l=l<0?0:l>1?1:l,a){var g=a.split(/\s*;\s*/);for(g[g.length-1]===""&&g.pop(),d=g.length;d--;){var m=g[d].split(/\s*:\s*/),y=m[0].trim(),C=m[1].trim();y==="stop-color"?u=C:y==="stop-opacity"&&(h=C)}}return u||(u=s.getAttribute("stop-color")||"rgb(0,0,0)"),h||(h=s.getAttribute("stop-opacity")),u=new b.Color(u),c=u.getAlpha(),h=isNaN(parseFloat(h))?1:parseFloat(h),h*=c*r,{offset:l,color:u.toRgb(),opacity:h}}function t(s){return{x1:s.getAttribute("x1")||0,y1:s.getAttribute("y1")||0,x2:s.getAttribute("x2")||"100%",y2:s.getAttribute("y2")||0}}function i(s){return{x1:s.getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}}var o=b.util.object.clone;b.Gradient=b.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(s){s||(s={}),s.coords||(s.coords={});var r,a=this;Object.keys(s).forEach(function(l){a[l]=s[l]}),this.id?this.id+="_"+b.Object.__uid++:this.id=b.Object.__uid++,r={x1:s.coords.x1||0,y1:s.coords.y1||0,x2:s.coords.x2||0,y2:s.coords.y2||0},this.type==="radial"&&(r.r1=s.coords.r1||0,r.r2=s.coords.r2||0),this.coords=r,this.colorStops=s.colorStops.slice()},addColorStop:function(s){for(var r in s){var a=new b.Color(s[r]);this.colorStops.push({offset:parseFloat(r),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(s){var r={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return b.util.populateWithProperties(this,r,s),r},toSVG:function(s,c){var a=o(this.coords,!0),l,u,c=c||{},h,d,g=o(this.colorStops,!0),m=a.r1>a.r2,y=this.gradientTransform?this.gradientTransform.concat():b.iMatrix.concat(),C=-this.offsetX,w=-this.offsetY,F=!!c.additionalTransform,B=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(g.sort(function($,st){return $.offset-st.offset}),B==="objectBoundingBox"?(C/=s.width,w/=s.height):(C+=s.width/2,w+=s.height/2),s.type==="path"&&this.gradientUnits!=="percentage"&&(C-=s.pathOffset.x,w-=s.pathOffset.y),y[4]-=C,y[5]-=w,d='id="SVGID_'+this.id+'" gradientUnits="'+B+'"',d+=' gradientTransform="'+(F?c.additionalTransform+" ":"")+b.util.matrixToSVG(y)+'" ',this.type==="linear"?h=["<linearGradient ",d,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`">
`]:this.type==="radial"&&(h=["<radialGradient ",d,' cx="',m?a.x1:a.x2,'" cy="',m?a.y1:a.y2,'" r="',m?a.r1:a.r2,'" fx="',m?a.x2:a.x1,'" fy="',m?a.y2:a.y1,`">
`]),this.type==="radial"){if(m)for(g=g.concat(),g.reverse(),l=0,u=g.length;l<u;l++)g[l].offset=1-g[l].offset;var U=Math.min(a.r1,a.r2);if(U>0){var R=Math.max(a.r1,a.r2),W=U/R;for(l=0,u=g.length;l<u;l++)g[l].offset+=W*(1-g[l].offset)}}for(l=0,u=g.length;l<u;l++){var X=g[l];h.push("<stop ",'offset="',X.offset*100+"%",'" style="stop-color:',X.color,typeof X.opacity<"u"?";stop-opacity: "+X.opacity:";",`"/>
`)}return h.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),h.join("")},toLive:function(s){var r,a=b.util.object.clone(this.coords),l,u;if(this.type){for(this.type==="linear"?r=s.createLinearGradient(a.x1,a.y1,a.x2,a.y2):this.type==="radial"&&(r=s.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),l=0,u=this.colorStops.length;l<u;l++){var c=this.colorStops[l].color,h=this.colorStops[l].opacity,d=this.colorStops[l].offset;typeof h<"u"&&(c=new b.Color(c).setAlpha(h).toRgba()),r.addColorStop(d,c)}return r}}}),b.util.object.extend(b.Gradient,{fromElement:function(s,r,a,l){var u=parseFloat(a)/(/%$/.test(a)?100:1);u=u<0?0:u>1?1:u,isNaN(u)&&(u=1);var c=s.getElementsByTagName("stop"),h,d=s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",g=s.getAttribute("gradientTransform")||"",m=[],y,C,w=0,F=0,B;for(s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?(h="linear",y=t(s)):(h="radial",y=i(s)),C=c.length;C--;)m.push(e(c[C],u));B=b.parseTransformAttribute(g),n(r,y,l,d),d==="pixels"&&(w=-r.left,F=-r.top);var U=new b.Gradient({id:s.getAttribute("id"),type:h,coords:y,colorStops:m,gradientUnits:d,gradientTransform:B,offsetX:w,offsetY:F});return U}});function n(s,r,a,l){var u,c;Object.keys(r).forEach(function(h){u=r[h],u==="Infinity"?c=1:u==="-Infinity"?c=0:(c=parseFloat(r[h],10),typeof u=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(u)&&(c*=.01,l==="pixels"&&((h==="x1"||h==="x2"||h==="r2")&&(c*=a.viewBoxWidth||a.width),(h==="y1"||h==="y2")&&(c*=a.viewBoxHeight||a.height)))),r[h]=c})}})();(function(){"use strict";var e=b.util.toFixed;b.Pattern=b.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,i){if(t||(t={}),this.id=b.Object.__uid++,this.setOptions(t),!t.source||t.source&&typeof t.source!="string"){i&&i(this);return}else{var o=this;this.source=b.util.createImage(),b.util.loadImage(t.source,function(n,s){o.source=n,i&&i(o,s)},null,this.crossOrigin)}},toObject:function(t){var i=b.Object.NUM_FRACTION_DIGITS,o,n;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),n={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:e(this.offsetX,i),offsetY:e(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},b.util.populateWithProperties(this,n,t),n},toSVG:function(t){var i=typeof this.source=="function"?this.source():this.source,o=i.width/t.width,n=i.height/t.height,s=this.offsetX/t.width,r=this.offsetY/t.height,a="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,r&&(n+=Math.abs(r))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,s&&(o+=Math.abs(s))),i.src?a=i.src:i.toDataURL&&(a=i.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+r+'" width="'+o+'" height="'+n+`">
<image x="0" y="0" width="`+i.width+'" height="'+i.height+'" xlink:href="'+a+`"></image>
</pattern>
`},setOptions:function(t){for(var i in t)this[i]=t[i]},toLive:function(t){var i=this.source;return!i||typeof i.src<"u"&&(!i.complete||i.naturalWidth===0||i.naturalHeight===0)?"":t.createPattern(i,this.repeat)}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.toFixed;if(t.Shadow){t.warn("fabric.Shadow is already defined.");return}t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var n in o)this[n]=o[n];this.id=t.Object.__uid++},_parseShadow:function(o){var n=o.trim(),s=t.Shadow.reOffsetsAndBlur.exec(n)||[],r=n.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:r.trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var n=40,s=40,r=t.Object.NUM_FRACTION_DIGITS,a=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-o.angle)),l=20,u=new t.Color(this.color);return o.width&&o.height&&(n=i((Math.abs(a.x)+this.blur)/o.width,r)*100+l,s=i((Math.abs(a.y)+this.blur)/o.height,r)*100+l),o.flipX&&(a.x*=-1),o.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+i(this.blur?this.blur/2:0,r)+`"></feGaussianBlur>
	<feOffset dx="`+i(a.x,r)+'" dy="'+i(a.y,r)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+u.toRgb()+'" flood-opacity="'+u.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},n=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==n[s]&&(o[s]=this[s])},this),o}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(_t);(function(){"use strict";if(b.StaticCanvas){b.warn("fabric.StaticCanvas is already defined.");return}var e=b.util.object.extend,t=b.util.getElementOffset,i=b.util.removeFromArray,o=b.util.toFixed,n=b.util.transformPoint,s=b.util.invertTransform,r=b.util.getNodeCanvas,a=b.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");b.StaticCanvas=b.util.createClass(b.CommonMethods,{initialize:function(u,c){c||(c={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(u,c)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:b.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(u,c){var h=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(u),this._initOptions(c),this.interactive||this._initRetinaScaling(),c.overlayImage&&this.setOverlayImage(c.overlayImage,h),c.backgroundImage&&this.setBackgroundImage(c.backgroundImage,h),c.backgroundColor&&this.setBackgroundColor(c.backgroundColor,h),c.overlayColor&&this.setOverlayColor(c.overlayColor,h),this.calcOffset()},_isRetinaScaling:function(){return b.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,b.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var u=b.devicePixelRatio;this.__initRetinaScaling(u,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(u,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(u,c,h){c.setAttribute("width",this.width*u),c.setAttribute("height",this.height*u),h.scale(u,u)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(u,c,h){return this.__setBgOverlayImage("overlayImage",u,c,h)},setBackgroundImage:function(u,c,h){return this.__setBgOverlayImage("backgroundImage",u,c,h)},setOverlayColor:function(u,c){return this.__setBgOverlayColor("overlayColor",u,c)},setBackgroundColor:function(u,c){return this.__setBgOverlayColor("backgroundColor",u,c)},__setBgOverlayImage:function(u,c,h,d){return typeof c=="string"?b.util.loadImage(c,function(g,m){if(g){var y=new b.Image(g,d);this[u]=y,y.canvas=this}h&&h(g,m)},this,d&&d.crossOrigin):(d&&c.setOptions(d),this[u]=c,c&&(c.canvas=this),h&&h(c,!1)),this},__setBgOverlayColor:function(u,c,h){return this[u]=c,this._initGradient(c,u),this._initPattern(c,u,h),this},_createCanvasElement:function(){var u=a();if(!u||(u.style||(u.style={}),typeof u.getContext>"u"))throw l;return u},_initOptions:function(u){var c=this.lowerCanvasEl;this._setOptions(u),this.width=this.width||parseInt(c.width,10)||0,this.height=this.height||parseInt(c.height,10)||0,this.lowerCanvasEl.style&&(c.width=this.width,c.height=this.height,c.style.width=this.width+"px",c.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(u){u&&u.getContext?this.lowerCanvasEl=u:this.lowerCanvasEl=b.util.getById(u)||this._createCanvasElement(),b.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(u,c){return this.setDimensions({width:u},c)},setHeight:function(u,c){return this.setDimensions({height:u},c)},setDimensions:function(u,c){var h;c=c||{};for(var d in u)h=u[d],c.cssOnly||(this._setBackstoreDimension(d,u[d]),h+="px",this.hasLostContext=!0),c.backstoreOnly||this._setCssDimension(d,h);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),c.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(u,c){return this.lowerCanvasEl[u]=c,this.upperCanvasEl&&(this.upperCanvasEl[u]=c),this.cacheCanvasEl&&(this.cacheCanvasEl[u]=c),this[u]=c,this},_setCssDimension:function(u,c){return this.lowerCanvasEl.style[u]=c,this.upperCanvasEl&&(this.upperCanvasEl.style[u]=c),this.wrapperEl&&(this.wrapperEl.style[u]=c),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(u){var c=this._activeObject,h=this.backgroundImage,d=this.overlayImage,g,m,y;for(this.viewportTransform=u,m=0,y=this._objects.length;m<y;m++)g=this._objects[m],g.group||g.setCoords(!0);return c&&c.setCoords(),h&&h.setCoords(!0),d&&d.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(u,c){var h=u,d=this.viewportTransform.slice(0);u=n(u,s(this.viewportTransform)),d[0]=c,d[3]=c;var g=n(u,d);return d[4]+=h.x-g.x,d[5]+=h.y-g.y,this.setViewportTransform(d)},setZoom:function(u){return this.zoomToPoint(new b.Point(0,0),u),this},absolutePan:function(u){var c=this.viewportTransform.slice(0);return c[4]=-u.x,c[5]=-u.y,this.setViewportTransform(c)},relativePan:function(u){return this.absolutePan(new b.Point(-u.x-this.viewportTransform[4],-u.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(u){this.stateful&&u.setupState(),u._set("canvas",this),u.setCoords(),this.fire("object:added",{target:u}),u.fire("added")},_onObjectRemoved:function(u){this.fire("object:removed",{target:u}),u.fire("removed"),delete u.canvas},clearContext:function(u){return u.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var u=this.contextContainer;return this.renderCanvas(u,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=b.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var u={},c=this.width,h=this.height,d=s(this.viewportTransform);return u.tl=n({x:0,y:0},d),u.br=n({x:c,y:h},d),u.tr=new b.Point(u.br.x,u.tl.y),u.bl=new b.Point(u.tl.x,u.br.y),this.vptCoords=u,u},cancelRequestedRender:function(){this.isRendering&&(b.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(u,c){var h=this.viewportTransform,d=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(u),b.util.setImageSmoothing(u,this.imageSmoothingEnabled),this.fire("before:render",{ctx:u}),this._renderBackground(u),u.save(),u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._renderObjects(u,c),u.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),d&&(d.canvas=this,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(u)),this._renderOverlay(u),this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),this.fire("after:render",{ctx:u})},drawClipPathOnCanvas:function(u){var c=this.viewportTransform,h=this.clipPath;u.save(),u.transform(c[0],c[1],c[2],c[3],c[4],c[5]),u.globalCompositeOperation="destination-in",h.transform(u),u.scale(1/h.zoomX,1/h.zoomY),u.drawImage(h._cacheCanvas,-h.cacheTranslationX,-h.cacheTranslationY),u.restore()},_renderObjects:function(u,c){var h,d;for(h=0,d=c.length;h<d;++h)c[h]&&c[h].render(u)},_renderBackgroundOrOverlay:function(u,c){var h=this[c+"Color"],d=this[c+"Image"],g=this.viewportTransform,m=this[c+"Vpt"];if(!(!h&&!d)){if(h){u.save(),u.beginPath(),u.moveTo(0,0),u.lineTo(this.width,0),u.lineTo(this.width,this.height),u.lineTo(0,this.height),u.closePath(),u.fillStyle=h.toLive?h.toLive(u,this):h,m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),u.transform(1,0,0,1,h.offsetX||0,h.offsetY||0);var y=h.gradientTransform||h.patternTransform;y&&u.transform(y[0],y[1],y[2],y[3],y[4],y[5]),u.fill(),u.restore()}d&&(u.save(),m&&u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),d.render(u),u.restore())}},_renderBackground:function(u){this._renderBackgroundOrOverlay(u,"background")},_renderOverlay:function(u){this._renderBackgroundOrOverlay(u,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new b.Point(this.width/2,this.height/2)},centerObjectH:function(u){return this._centerObject(u,new b.Point(this.getCenterPoint().x,u.getCenterPoint().y))},centerObjectV:function(u){return this._centerObject(u,new b.Point(u.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(u){var c=this.getCenterPoint();return this._centerObject(u,c)},viewportCenterObject:function(u){var c=this.getVpCenter();return this._centerObject(u,c)},viewportCenterObjectH:function(u){var c=this.getVpCenter();return this._centerObject(u,new b.Point(c.x,u.getCenterPoint().y)),this},viewportCenterObjectV:function(u){var c=this.getVpCenter();return this._centerObject(u,new b.Point(u.getCenterPoint().x,c.y))},getVpCenter:function(){var u=this.getCenterPoint(),c=s(this.viewportTransform);return n(u,c)},_centerObject:function(u,c){return u.setPositionByOrigin(c,"center","center"),u.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(u){return this.toDatalessObject(u)},toObject:function(u){return this._toObjectMethod("toObject",u)},toDatalessObject:function(u){return this._toObjectMethod("toDatalessObject",u)},_toObjectMethod:function(u,c){var h=this.clipPath,d={version:b.version,objects:this._toObjects(u,c)};return h&&!h.excludeFromExport&&(d.clipPath=this._toObject(this.clipPath,u,c)),e(d,this.__serializeBgOverlay(u,c)),b.util.populateWithProperties(this,d,c),d},_toObjects:function(u,c){return this._objects.filter(function(h){return!h.excludeFromExport}).map(function(h){return this._toObject(h,u,c)},this)},_toObject:function(u,c,h){var d;this.includeDefaultValues||(d=u.includeDefaultValues,u.includeDefaultValues=!1);var g=u[c](h);return this.includeDefaultValues||(u.includeDefaultValues=d),g},__serializeBgOverlay:function(u,c){var h={},d=this.backgroundImage,g=this.overlayImage,m=this.backgroundColor,y=this.overlayColor;return m&&m.toObject?m.excludeFromExport||(h.background=m.toObject(c)):m&&(h.background=m),y&&y.toObject?y.excludeFromExport||(h.overlay=y.toObject(c)):y&&(h.overlay=y),d&&!d.excludeFromExport&&(h.backgroundImage=this._toObject(d,u,c)),g&&!g.excludeFromExport&&(h.overlayImage=this._toObject(g,u,c)),h},svgViewportTransformation:!0,toSVG:function(u,c){u||(u={}),u.reviver=c;var h=[];return this._setSVGPreamble(h,u),this._setSVGHeader(h,u),this.clipPath&&h.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(h,"background"),this._setSVGBgOverlayImage(h,"backgroundImage",c),this._setSVGObjects(h,c),this.clipPath&&h.push(`</g>
`),this._setSVGBgOverlayColor(h,"overlay"),this._setSVGBgOverlayImage(h,"overlayImage",c),h.push("</svg>"),h.join("")},_setSVGPreamble:function(u,c){c.suppressPreamble||u.push('<?xml version="1.0" encoding="',c.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(u,c){var h=c.width||this.width,d=c.height||this.height,g,m='viewBox="0 0 '+this.width+" "+this.height+'" ',y=b.Object.NUM_FRACTION_DIGITS;c.viewBox?m='viewBox="'+c.viewBox.x+" "+c.viewBox.y+" "+c.viewBox.width+" "+c.viewBox.height+'" ':this.svgViewportTransformation&&(g=this.viewportTransform,m='viewBox="'+o(-g[4]/g[0],y)+" "+o(-g[5]/g[3],y)+" "+o(this.width/g[0],y)+" "+o(this.height/g[3],y)+'" '),u.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',h,'" ','height="',d,'" ',m,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",b.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(c),`</defs>
`)},createSVGClipPathMarkup:function(u){var c=this.clipPath;return c?(c.clipPathId="CLIPPATH_"+b.Object.__uid++,'<clipPath id="'+c.clipPathId+`" >
`+this.clipPath.toClipPathSVG(u.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var u=this,c=["background","overlay"].map(function(h){var d=u[h+"Color"];if(d&&d.toLive){var g=u[h+"Vpt"],m=u.viewportTransform,y={width:u.width/(g?m[0]:1),height:u.height/(g?m[3]:1)};return d.toSVG(y,{additionalTransform:g?b.util.matrixToSVG(m):""})}});return c.join("")},createSVGFontFacesMarkup:function(){var u="",c={},h,d,g,m,y,C,w,F,B,U=b.fontPaths,R=[];for(this._objects.forEach(function X($){R.push($),$._objects&&$._objects.forEach(X)}),F=0,B=R.length;F<B;F++)if(h=R[F],d=h.fontFamily,!(h.type.indexOf("text")===-1||c[d]||!U[d])&&(c[d]=!0,!!h.styles)){g=h.styles;for(y in g){m=g[y];for(w in m)C=m[w],d=C.fontFamily,!c[d]&&U[d]&&(c[d]=!0)}}for(var W in c)u+=[`		@font-face {
`,"			font-family: '",W,`';
`,"			src: url('",U[W],`');
`,`		}
`].join("");return u&&(u=['	<style type="text/css">',`<![CDATA[
`,u,"]]>",`</style>
`].join("")),u},_setSVGObjects:function(u,c){var h,d,g,m=this._objects;for(d=0,g=m.length;d<g;d++)h=m[d],!h.excludeFromExport&&this._setSVGObject(u,h,c)},_setSVGObject:function(u,c,h){u.push(c.toSVG(h))},_setSVGBgOverlayImage:function(u,c,h){this[c]&&!this[c].excludeFromExport&&this[c].toSVG&&u.push(this[c].toSVG(h))},_setSVGBgOverlayColor:function(u,c){var h=this[c+"Color"],d=this.viewportTransform,g=this.width,m=this.height;if(h)if(h.toLive){var y=h.repeat,C=b.util.invertTransform(d),w=this[c+"Vpt"],F=w?b.util.matrixToSVG(C):"";u.push('<rect transform="'+F+" translate(",g/2,",",m/2,')"',' x="',h.offsetX-g/2,'" y="',h.offsetY-m/2,'" ','width="',y==="repeat-y"||y==="no-repeat"?h.source.width:g,'" height="',y==="repeat-x"||y==="no-repeat"?h.source.height:m,'" fill="url(#SVGID_'+h.id+')"',`></rect>
`)}else u.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',h,'"',`></rect>
`)},sendToBack:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=g.length;h--;)d=g[h],i(this._objects,d),this._objects.unshift(d);else i(this._objects,u),this._objects.unshift(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(u){if(!u)return this;var c=this._activeObject,h,d,g;if(u===c&&u.type==="activeSelection")for(g=c._objects,h=0;h<g.length;h++)d=g[h],i(this._objects,d),this._objects.push(d);else i(this._objects,u),this._objects.push(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,w=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=0;d<C.length;d++)g=C[d],m=this._objects.indexOf(g),m>0+w&&(y=m-1,i(this._objects,g),this._objects.splice(y,0,g)),w++;else m=this._objects.indexOf(u),m!==0&&(y=this._findNewLowerIndex(u,m,c),i(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(u,c,h){var d,g;if(h)for(d=c,g=c-1;g>=0;--g){var m=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(m){d=g;break}}else d=c-1;return d},bringForward:function(u,c){if(!u)return this;var h=this._activeObject,d,g,m,y,C,w=0;if(u===h&&u.type==="activeSelection")for(C=h._objects,d=C.length;d--;)g=C[d],m=this._objects.indexOf(g),m<this._objects.length-1-w&&(y=m+1,i(this._objects,g),this._objects.splice(y,0,g)),w++;else m=this._objects.indexOf(u),m!==this._objects.length-1&&(y=this._findNewUpperIndex(u,m,c),i(this._objects,u),this._objects.splice(y,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(u,c,h){var d,g,m;if(h)for(d=c,g=c+1,m=this._objects.length;g<m;++g){var y=u.intersectsWithObject(this._objects[g])||u.isContainedWithinObject(this._objects[g])||this._objects[g].isContainedWithinObject(u);if(y){d=g;break}}else d=c+1;return d},moveTo:function(u,c){return i(this._objects,u),this._objects.splice(c,0,u),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(b.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),b.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),b.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),e(b.StaticCanvas.prototype,b.Observable),e(b.StaticCanvas.prototype,b.Collection),e(b.StaticCanvas.prototype,b.DataURLExporter),e(b.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(u){var c=a();if(!c||!c.getContext)return null;var h=c.getContext("2d");if(!h)return null;switch(u){case"setLineDash":return typeof h.setLineDash<"u";default:return null}}}),b.StaticCanvas.prototype.toJSON=b.StaticCanvas.prototype.toObject,b.isLikelyNode&&(b.StaticCanvas.prototype.createPNGStream=function(){var u=r(this.lowerCanvasEl);return u&&u.createPNGStream()},b.StaticCanvas.prototype.createJPEGStream=function(u){var c=r(this.lowerCanvasEl);return c&&c.createJPEGStream(u)})})();b.BaseBrush=b.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(e){var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var e=this.canvas,t=this.shadow,i=e.contextTop,o=e.getZoom();e&&e._isRetinaScaling()&&(o*=b.devicePixelRatio),i.shadowColor=t.color,i.shadowBlur=t.blur*o,i.shadowOffsetX=t.offsetX*o,i.shadowOffsetY=t.offsetY*o}},needsFullRender:function(){var e=new b.Color(this.color);return e.getAlpha()<1||!!this.shadow},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0},_isOutSideCanvas:function(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}});(function(){b.PencilBrush=b.util.createClass(b.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(e){this.canvas=e,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(e,t,i){var o=t.midPointFrom(i);return e.quadraticCurveTo(t.x,t.y,o.x,o.y),o},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],this._prepareForDrawing(e),this._captureDrawingPath(e),this._render())},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e))&&this._captureDrawingPath(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var i=this._points,o=i.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,i[o-2],i[o-1],!0),n.stroke(),n.restore()}},onMouseUp:function(e){return this.canvas._isMainEvent(e.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(e){var t=new b.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){return this._points.length>1&&e.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(e){var t=new b.Point(e.x,e.y);return this._addPoint(t)},_render:function(e){var t,i,o=this._points[0],n=this._points[1];if(e=e||this.canvas.contextTop,this._saveAndTransform(e),e.beginPath(),this._points.length===2&&o.x===n.x&&o.y===n.y){var s=this.width/1e3;o=new b.Point(o.x,o.y),n=new b.Point(n.x,n.y),o.x-=s,n.x+=s}for(e.moveTo(o.x,o.y),t=1,i=this._points.length;t<i;t++)this._drawSegment(e,o,n),o=this._points[t],n=this._points[t+1];e.lineTo(o.x,o.y),e.stroke(),e.restore()},convertPointsToSVGPath:function(e){var t=this.width/1e3;return b.util.getSmoothPathFromPoints(e,t)},_isEmptySVGPath:function(e){var t=b.util.joinPath(e);return t==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(e){var t=new b.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new b.Shadow(this.shadow)),t},decimatePoints:function(e,t){if(e.length<=2)return e;var i=this.canvas.getZoom(),o=Math.pow(t/i,2),n,s=e.length-1,r=e[0],a=[r],l;for(n=1;n<s-1;n++)l=Math.pow(r.x-e[n].x,2)+Math.pow(r.y-e[n].y,2),l>=o&&(r=e[n],a.push(r));return a.push(e[s]),a},_finalizeAndAddPath:function(){var e=this.canvas.contextTop;e.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(t)){this.canvas.requestRenderAll();return}var i=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:i}),this.canvas.add(i),this.canvas.requestRenderAll(),i.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:i})}})})();b.CircleBrush=b.util.createClass(b.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),i=this.canvas.contextTop;this._saveAndTransform(i),this.dot(i,t),i.restore()},dot:function(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,Math.PI*2,!1),e.closePath(),e.fill()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},_render:function(){var e=this.canvas.contextTop,t,i,o=this.points;for(this._saveAndTransform(e),t=0,i=o.length;t<i;t++)this.dot(e,o[t]);e.restore()},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove,t,i;this.canvas.renderOnAddRemove=!1;var o=[];for(t=0,i=this.points.length;t<i;t++){var n=this.points[t],s=new b.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(s.shadow=new b.Shadow(this.shadow)),o.push(s)}var r=new b.Group(o);r.canvas=this.canvas,this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.fire("path:created",{path:r}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},addPoint:function(e){var t=new b.Point(e.x,e.y),i=b.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new b.Color(this.color).setAlpha(b.util.getRandomInt(0,100)/100).toRgba();return t.radius=i,t.fill=o,this.points.push(t),t}});b.SprayBrush=b.util.createClass(b.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseMove:function(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.render(this.sprayChunkPoints))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],i=0,o=this.sprayChunks.length;i<o;i++)for(var n=this.sprayChunks[i],s=0,r=n.length;s<r;s++){var a=new b.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});t.push(a)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var l=new b.Group(t);this.shadow&&l.set("shadow",new b.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},_getOptimizedRects:function(e){var t={},i,o,n;for(o=0,n=e.length;o<n;o++)i=e[o].left+""+e[o].top,t[i]||(t[i]=e[o]);var s=[];for(i in t)s.push(t[i]);return s},render:function(e){var t=this.canvas.contextTop,i,o;for(t.fillStyle=this.color,this._saveAndTransform(t),i=0,o=e.length;i<o;i++){var n=e[i];typeof n.opacity<"u"&&(t.globalAlpha=n.opacity),t.fillRect(n.x,n.y,n.width,n.width)}t.restore()},_render:function(){var e=this.canvas.contextTop,t,i;for(e.fillStyle=this.color,this._saveAndTransform(e),t=0,i=this.sprayChunks.length;t<i;t++)this.render(this.sprayChunks[t]);e.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,i,o,n=this.width/2,s;for(s=0;s<this.density;s++){t=b.util.getRandomInt(e.x-n,e.x+n),i=b.util.getRandomInt(e.y-n,e.y+n),this.dotWidthVariance?o=b.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var r=new b.Point(t,i);r.width=o,this.randomOpacity&&(r.opacity=b.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(r)}this.sprayChunks.push(this.sprayChunkPoints)}});b.PatternBrush=b.util.createClass(b.PencilBrush,{getPatternSrc:function(){var e=20,t=5,i=b.util.createCanvasElement(),o=i.getContext("2d");return i.width=i.height=e+t,o.fillStyle=this.color,o.beginPath(),o.arc(e/2,e/2,e/2,0,Math.PI*2,!1),o.closePath(),o.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(e){this.callSuper("_setBrushStyles",e),e.strokeStyle=this.getPattern(e)},createPath:function(e){var t=this.callSuper("createPath",e),i=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new b.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),t}});(function(){var e=b.util.getPointer,t=b.util.degreesToRadians,i=b.util.isTouchEvent;b.Canvas=b.util.createClass(b.StaticCanvas,{initialize:function(n,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=b.PencilBrush&&new b.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),s,r,a;if(n.length>0&&!this.preserveObjectStacking){r=[],a=[];for(var l=0,u=this._objects.length;l<u;l++)s=this._objects[l],n.indexOf(s)===-1?r.push(s):a.push(s);n.length>1&&(this._activeObject._objects=a),r.push.apply(r,a)}else r=this._objects;return r},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,s){var r=n.calcTransformMatrix(),a=b.util.invertTransform(r),l=this.restorePointerVpt(s);return b.util.transformPoint(l,a)},isTargetTransparent:function(n,s,r){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var a=this._normalizePointer(n,{x:s,y:r}),l=Math.max(n.cacheTranslationX+a.x*n.zoomX,0),u=Math.max(n.cacheTranslationY+a.y*n.zoomY,0),g=b.util.isTransparent(n._cacheContext,Math.round(l),Math.round(u),this.targetFindTolerance);return g}var c=this.contextCache,h=n.selectionBackgroundColor,d=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(c),c.save(),c.transform(d[0],d[1],d[2],d[3],d[4],d[5]),n.render(c),c.restore(),n.selectionBackgroundColor=h;var g=b.util.isTransparent(c,s,r,this.targetFindTolerance);return g},_isSelectionKeyPressed:function(n){var s=!1;return Array.isArray(this.selectionKey)?s=!!this.selectionKey.find(function(r){return n[r]===!0}):s=n[this.selectionKey],s},_shouldClearSelection:function(n,s){var r=this.getActiveObjects(),a=this._activeObject;return!s||s&&a&&r.length>1&&r.indexOf(s)===-1&&a!==s&&!this._isSelectionKeyPressed(n)||s&&!s.evented||s&&!s.selectable&&a&&a!==s},_shouldCenterTransform:function(n,s,r){if(n){var a;return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?a=this.centeredScaling||n.centeredScaling:s==="rotate"&&(a=this.centeredRotation||n.centeredRotation),a?!r:r}},_getOriginFromCorner:function(n,s){var r={x:n.originX,y:n.originY};return s==="ml"||s==="tl"||s==="bl"?r.x="right":(s==="mr"||s==="tr"||s==="br")&&(r.x="left"),s==="tl"||s==="mt"||s==="tr"?r.y="bottom":(s==="bl"||s==="mb"||s==="br")&&(r.y="top"),r},_getActionFromCorner:function(n,s,r,a){if(!s||!n)return"drag";var l=a.controls[s];return l.getActionName(r,l,a)},_setupCurrentTransform:function(n,s,r){if(s){var a=this.getPointer(n),l=s.__corner,u=s.controls[l],c=r&&l?u.getActionHandler(n,s,u):b.controlsUtils.dragHandler,h=this._getActionFromCorner(r,l,n,s),d=this._getOriginFromCorner(s,l),g=n[this.centeredKey],m={target:s,action:h,actionHandler:c,corner:l,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:a.x-s.left,offsetY:a.y-s.top,originX:d.x,originY:d.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:t(s.angle),width:s.width*s.scaleX,shiftKey:n.shiftKey,altKey:g,original:b.util.saveObjectTransform(s)};this._shouldCenterTransform(s,h,g)&&(m.originX="center",m.originY="center"),m.original.originX=d.x,m.original.originY=d.y,this._currentTransform=m,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var s=this._groupSelector,r=new b.Point(s.ex,s.ey),a=b.util.transformPoint(r,this.viewportTransform),l=new b.Point(s.ex+s.left,s.ey+s.top),u=b.util.transformPoint(l,this.viewportTransform),c=Math.min(a.x,u.x),h=Math.min(a.y,u.y),d=Math.max(a.x,u.x),g=Math.max(a.y,u.y),m=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(c,h,d-c,g-h)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,c+=m,h+=m,d-=m,g-=m,b.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(c,h,d-c,g-h))},findTarget:function(n,s){if(!this.skipTargetFind){var r=!0,a=this.getPointer(n,r),l=this._activeObject,u=this.getActiveObjects(),c,h,d=i(n),g=u.length>1&&!s||u.length===1;if(this.targets=[],g&&l._findTargetCorner(a,d)||u.length>1&&!s&&l===this._searchPossibleTargets([l],a))return l;if(u.length===1&&l===this._searchPossibleTargets([l],a))if(this.preserveObjectStacking)c=l,h=this.targets,this.targets=[];else return l;var m=this._searchPossibleTargets(this._objects,a);return n[this.altSelectionKey]&&m&&c&&m!==c&&(m=c,this.targets=h),m}},_checkTarget:function(n,s,r){if(s&&s.visible&&s.evented&&s.containsPoint(n))if((this.perPixelTargetFind||s.perPixelTargetFind)&&!s.isEditing){var a=this.isTargetTransparent(s,r.x,r.y);if(!a)return!0}else return!0},_searchPossibleTargets:function(n,s){for(var r,a=n.length,l;a--;){var u=n[a],c=u.group?this._normalizePointer(u.group,s):s;if(this._checkTarget(c,u,s)){r=n[a],r.subTargetCheck&&r instanceof b.Group&&(l=this._searchPossibleTargets(r._objects,s),l&&this.targets.push(l));break}}return r},restorePointerVpt:function(n){return b.util.transformPoint(n,b.util.invertTransform(this.viewportTransform))},getPointer:function(n,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var r=e(n),a=this.upperCanvasEl,l=a.getBoundingClientRect(),u=l.width||0,c=l.height||0,h;(!u||!c)&&("top"in l&&"bottom"in l&&(c=Math.abs(l.top-l.bottom)),"right"in l&&"left"in l&&(u=Math.abs(l.right-l.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,s||(r=this.restorePointerVpt(r));var d=this.getRetinaScaling();return d!==1&&(r.x/=d,r.y/=d),u===0||c===0?h={width:1,height:1}:h={width:a.width/u,height:a.height/c},{x:r.x*h.width,y:r.y*h.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,r=this.upperCanvasEl;r?r.className="":(r=this._createCanvasElement(),this.upperCanvasEl=r),b.util.addClass(r,"upper-canvas "+n),this.wrapperEl.appendChild(r),this._copyCanvasStyle(s,r),this._applyCanvasStyle(r),this.contextTop=r.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=b.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),b.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),b.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var s=this.width||n.width,r=this.height||n.height;b.util.setStyle(n,{position:"absolute",width:s+"px",height:r+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=s,n.height=r,b.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,s){s.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,s){var r=!1,a=this.getActiveObjects(),l=[],u=[];n.forEach(function(c){a.indexOf(c)===-1&&(r=!0,c.fire("deselected",{e:s,target:c}),u.push(c))}),a.forEach(function(c){n.indexOf(c)===-1&&(r=!0,c.fire("selected",{e:s,target:c}),l.push(c))}),n.length>0&&a.length>0?r&&this.fire("selection:updated",{e:s,selected:l,deselected:u}):a.length>0?this.fire("selection:created",{e:s,selected:l}):n.length>0&&this.fire("selection:cleared",{e:s,deselected:u})},setActiveObject:function(n,s){var r=this.getActiveObjects();return this._setActiveObject(n,s),this._fireSelectionEvents(r,s),this},_setActiveObject:function(n,s){return this._activeObject===n||!this._discardActiveObject(s,n)||n.onSelect({e:s})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,s){var r=this._activeObject;if(r){if(r.onDeselect({e:n,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var s=this.getActiveObjects(),r=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:r,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(s,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){b.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,b.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var s=this._activeObject;s&&s._renderControls(n)},_toObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(n),l=this.callSuper("_toObject",n,s,r);return this._unwindGroupTransformOnObject(n,a),l},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var s=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],r={};return s.forEach(function(a){r[a]=n[a]}),b.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),r}else return null},_unwindGroupTransformOnObject:function(n,s){s&&n.set(s)},_setSVGObject:function(n,s,r){var a=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",n,s,r),this._unwindGroupTransformOnObject(s,a)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),b.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var o in b.StaticCanvas)o!=="prototype"&&(b.Canvas[o]=b.StaticCanvas[o])})();(function(){var e=b.util.addListener,t=b.util.removeListener,i=3,o=2,n=1,s={passive:!1};function r(a,l){return a.button&&a.button===l-1}b.util.object.extend(b.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,l){var u=this.upperCanvasEl,c=this._getEventPrefix();a(b.window,"resize",this._onResize),a(u,c+"down",this._onMouseDown),a(u,c+"move",this._onMouseMove,s),a(u,c+"out",this._onMouseOut),a(u,c+"enter",this._onMouseEnter),a(u,"wheel",this._onMouseWheel),a(u,"contextmenu",this._onContextMenu),a(u,"dblclick",this._onDoubleClick),a(u,"dragover",this._onDragOver),a(u,"dragenter",this._onDragEnter),a(u,"dragleave",this._onDragLeave),a(u,"drop",this._onDrop),this.enablePointerEvents||a(u,"touchstart",this._onTouchStart,s),typeof eventjs<"u"&&l in eventjs&&(eventjs[l](u,"gesture",this._onGesture),eventjs[l](u,"drag",this._onDrag),eventjs[l](u,"orientation",this._onOrientationChange),eventjs[l](u,"shake",this._onShake),eventjs[l](u,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(t,"remove");var a=this._getEventPrefix();t(b.document,a+"up",this._onMouseUp),t(b.document,"touchend",this._onTouchEnd,s),t(b.document,a+"move",this._onMouseMove,s),t(b.document,"touchmove",this._onMouseMove,s)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,l){this.__onTransformGesture&&this.__onTransformGesture(a,l)},_onDrag:function(a,l){this.__onDrag&&this.__onDrag(a,l)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var l=this._hoveredTarget;this.fire("mouse:out",{target:l,e:a}),this._hoveredTarget=null,l&&l.fire("mouseout",{e:a});var u=this;this._hoveredTargets.forEach(function(c){u.fire("mouse:out",{target:l,e:a}),c&&l.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,l){this.__onOrientationChange&&this.__onOrientationChange(a,l)},_onShake:function(a,l){this.__onShake&&this.__onShake(a,l)},_onLongPress:function(a,l){this.__onLongPress&&this.__onLongPress(a,l)},_onDragOver:function(a){a.preventDefault();var l=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(l,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var l=a.changedTouches;return l?l[0]&&l[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return a.isPrimary===!0?!0:a.isPrimary===!1?!1:a.type==="touchend"&&a.touches.length===0?!0:a.changedTouches?a.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(a){a.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();e(b.document,"touchend",this._onTouchEnd,s),e(b.document,"touchmove",this._onMouseMove,s),t(l,u+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();t(l,u+"move",this._onMouseMove,s),e(b.document,u+"up",this._onMouseUp),e(b.document,u+"move",this._onMouseMove,s)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var l=this._getEventPrefix();t(b.document,"touchend",this._onTouchEnd,s),t(b.document,"touchmove",this._onMouseMove,s);var u=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){e(u.upperCanvasEl,l+"down",u._onMouseDown),u._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var l=this.upperCanvasEl,u=this._getEventPrefix();this._isMainEvent(a)&&(t(b.document,u+"up",this._onMouseUp),t(b.document,u+"move",this._onMouseMove,s),e(l,u+"move",this._onMouseMove,s))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var l=this._activeObject;return!!l!=!!a||l&&a&&l!==a?!0:(l&&l.isEditing,!1)},__onMouseUp:function(a){var l,u=this._currentTransform,c=this._groupSelector,h=!1,d=!c||c.left===0&&c.top===0;if(this._cacheTransformEventData(a),l=this._target,this._handleEvent(a,"up:before"),r(a,i)){this.fireRightClick&&this._handleEvent(a,"up",i,d);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"up",o,d),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(a);return}if(this._isMainEvent(a)){if(u&&(this._finalizeCurrentTransform(a),h=u.actionPerformed),!d){var g=l===this._activeObject;this._maybeGroupObjects(a),h||(h=this._shouldRender(l)||!g&&l===this._activeObject)}var m,y;if(l){if(m=l._findTargetCorner(this.getPointer(a,!0),b.util.isTouchEvent(a)),l.selectable&&l!==this._activeObject&&l.activeOn==="up")this.setActiveObject(l,a),h=!0;else{var C=l.controls[m],w=C&&C.getMouseUpHandler(a,l,C);w&&(y=this.getPointer(a),w(a,u,y.x,y.y))}l.isMoving=!1}if(u&&(u.target!==l||u.corner!==m)){var F=u.target&&u.target.controls[u.corner],B=F&&F.getMouseUpHandler(a,l,C);y=y||this.getPointer(a),B&&B(a,u,y.x,y.y)}this._setCursorFromEvent(a,l),this._handleEvent(a,"up",n,d),this._groupSelector=null,this._currentTransform=null,l&&(l.__corner=0),h?this.requestRenderAll():d||this.renderTop()}},_simpleEventHandler:function(a,l){var u=this.findTarget(l),c=this.targets,h={e:l,target:u,subTargets:c};if(this.fire(a,h),u&&u.fire(a,h),!c)return u;for(var d=0;d<c.length;d++)c[d].fire(a,h);return u},_handleEvent:function(a,l,u,c){var h=this._target,d=this.targets||[],g={e:a,target:h,subTargets:d,button:u||n,isClick:c||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};l==="up"&&(g.currentTarget=this.findTarget(a),g.currentSubTargets=this.targets),this.fire("mouse:"+l,g),h&&h.fire("mouse"+l,g);for(var m=0;m<d.length;m++)d[m].fire("mouse"+l,g)},_finalizeCurrentTransform:function(a){var l=this._currentTransform,u=l.target,c={e:a,target:u,transform:l,action:l.action};u._scaling&&(u._scaling=!1),u.setCoords(),(l.actionPerformed||this.stateful&&u.hasStateChanged())&&this._fire("modified",c)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var l=this.getPointer(a);this.freeDrawingBrush.onMouseDown(l,{e:a,pointer:l}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var l=this.getPointer(a);this.freeDrawingBrush.onMouseMove(l,{e:a,pointer:l})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var l=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:l}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var l=this._target;if(r(a,i)){this.fireRightClick&&this._handleEvent(a,"down",i);return}if(r(a,o)){this.fireMiddleClick&&this._handleEvent(a,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(a);return}if(this._isMainEvent(a)&&!this._currentTransform){var u=this._pointer;this._previousPointer=u;var c=this._shouldRender(l),h=this._shouldGroup(a,l);if(this._shouldClearSelection(a,l)?this.discardActiveObject(a):h&&(this._handleGrouping(a,l),l=this._activeObject),this.selection&&(!l||!l.selectable&&!l.isEditing&&l!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),l){var d=l===this._activeObject;l.selectable&&l.activeOn==="down"&&this.setActiveObject(l,a);var g=l._findTargetCorner(this.getPointer(a,!0),b.util.isTouchEvent(a));if(l.__corner=g,l===this._activeObject&&(g||!h)){this._setupCurrentTransform(a,l,d);var m=l.controls[g],u=this.getPointer(a),y=m&&m.getMouseDownHandler(a,l,m);y&&y(a,this._currentTransform,u.x,u.y)}}this._handleEvent(a,"down"),(c||h)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var l=this._currentTransform;this.stateful&&l.target.saveState(),this.fire("before:transform",{e:a,transform:l})},__onMouseMove:function(a){this._handleEvent(a,"move:before"),this._cacheTransformEventData(a);var l,u;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(a);return}if(this._isMainEvent(a)){var c=this._groupSelector;c?(u=this._absolutePointer,c.left=u.x-c.ex,c.top=u.y-c.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(l=this.findTarget(a)||null,this._setCursorFromEvent(a,l),this._fireOverOutEvents(l,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,l){var u=this._hoveredTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,l){var u=this._draggedoverTarget,c=this._hoveredTargets,h=this.targets,d=Math.max(c.length,h.length);this.fireSyntheticInOutEvents(a,l,{oldTarget:u,evtOut:"dragleave",evtIn:"dragenter"});for(var g=0;g<d;g++)this.fireSyntheticInOutEvents(h[g],l,{oldTarget:c[g],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,l,u){var c,h,d=u.oldTarget,g,m,y=d!==a,C=u.canvasEvtIn,w=u.canvasEvtOut;y&&(c={e:l,target:a,previousTarget:d},h={e:l,target:d,nextTarget:a}),m=a&&y,g=d&&y,g&&(w&&this.fire(w,h),d.fire(u.evtOut,h)),m&&(C&&this.fire(C,c),a.fire(u.evtIn,c))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var l=this.getPointer(a),u=this._currentTransform;u.reset=!1,u.shiftKey=a.shiftKey,u.altKey=a[this.centeredKey],this._performTransformAction(a,u,l),u.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,l,u){var c=u.x,h=u.y,d=l.action,g=!1,m=l.actionHandler;m&&(g=m(a,l,c,h)),d==="drag"&&g&&(l.target.isMoving=!0,this.setCursor(l.target.moveCursor||this.moveCursor)),l.actionPerformed=l.actionPerformed||g},_fire:b.controlsUtils.fireEvent,_setCursorFromEvent:function(a,l){if(!l)return this.setCursor(this.defaultCursor),!1;var u=l.hoverCursor||this.hoverCursor,c=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,h=(!c||!c.contains(l))&&l._findTargetCorner(this.getPointer(a,!0));h?this.setCursor(this.getCornerCursor(h,l,a)):(l.subTargetCheck&&this.targets.concat().reverse().map(function(d){u=d.hoverCursor||u}),this.setCursor(u))},getCornerCursor:function(a,l,u){var c=l.controls[a];return c.cursorStyleHandler(u,c,l)}})})();(function(){var e=Math.min,t=Math.max;b.util.object.extend(b.Canvas.prototype,{_shouldGroup:function(i,o){var n=this._activeObject;return n&&this._isSelectionKeyPressed(i)&&o&&o.selectable&&this.selection&&(n!==o||n.type==="activeSelection")&&!o.onSelect({e:i})},_handleGrouping:function(i,o){var n=this._activeObject;n.__corner||o===n&&(o=this.findTarget(i,!0),!o||!o.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(o,i):this._createActiveSelection(o,i))},_updateActiveSelection:function(i,o){var n=this._activeObject,s=n._objects.slice(0);n.contains(i)?(n.removeWithUpdate(i),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),o)):(n.addWithUpdate(i),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(s,o)},_createActiveSelection:function(i,o){var n=this.getActiveObjects(),s=this._createGroup(i);this._hoveredTarget=s,this._setActiveObject(s,o),this._fireSelectionEvents(n,o)},_createGroup:function(i){var o=this._objects,n=o.indexOf(this._activeObject)<o.indexOf(i),s=n?[this._activeObject,i]:[i,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new b.ActiveSelection(s,{canvas:this})},_groupSelectedObjects:function(i){var o=this._collectObjects(i),n;o.length===1?this.setActiveObject(o[0],i):o.length>1&&(n=new b.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(n,i))},_collectObjects:function(i){for(var o=[],n,s=this._groupSelector.ex,r=this._groupSelector.ey,a=s+this._groupSelector.left,l=r+this._groupSelector.top,u=new b.Point(e(s,a),e(r,l)),c=new b.Point(t(s,a),t(r,l)),h=!this.selectionFullyContained,d=s===a&&r===l,g=this._objects.length;g--&&(n=this._objects[g],!(!(!n||!n.selectable||!n.visible)&&(h&&n.intersectsWithRect(u,c,!0)||n.isContainedWithinRect(u,c,!0)||h&&n.containsPoint(u,null,!0)||h&&n.containsPoint(c,null,!0))&&(o.push(n),d))););return o.length>1&&(o=o.filter(function(m){return!m.onSelect({e:i})})),o},_maybeGroupObjects:function(i){this.selection&&this._groupSelector&&this._groupSelectedObjects(i),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){b.util.object.extend(b.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",i=e.quality||1,o=(e.multiplier||1)*(e.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(o,e);return b.util.toDataURL(n,t,i)},toCanvasElement:function(e,t){e=e||1,t=t||{};var i=(t.width||this.width)*e,o=(t.height||this.height)*e,n=this.getZoom(),s=this.width,r=this.height,a=n*e,l=this.viewportTransform,u=(l[4]-(t.left||0))*e,c=(l[5]-(t.top||0))*e,h=this.interactive,d=[a,0,0,a,u,c],g=this.enableRetinaScaling,m=b.util.createCanvasElement(),y=this.contextTop;return m.width=i,m.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=d,this.width=i,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),this._objects),this.viewportTransform=l,this.width=s,this.height=r,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=g,this.contextTop=y,m}})})();b.util.object.extend(b.StaticCanvas.prototype,{loadFromJSON:function(e,t,i){if(e){var o=typeof e=="string"?JSON.parse(e):b.util.object.clone(e),n=this,s=o.clipPath,r=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(a){n.clear(),n._setBgOverlay(o,function(){s?n._enlivenObjects([s],function(l){n.clipPath=l[0],n.__setupCanvas.call(n,o,a,r,t)}):n.__setupCanvas.call(n,o,a,r,t)})},i),this}},__setupCanvas:function(e,t,i,o){var n=this;t.forEach(function(s,r){n.insertAt(s,r)}),this.renderOnAddRemove=i,delete e.objects,delete e.backgroundImage,delete e.overlayImage,delete e.background,delete e.overlay,this._setOptions(e),this.renderAll(),o&&o()},_setBgOverlay:function(e,t){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!e.backgroundImage&&!e.overlayImage&&!e.background&&!e.overlay){t&&t();return}var o=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",e.backgroundImage,i,o),this.__setBgOverlay("overlayImage",e.overlayImage,i,o),this.__setBgOverlay("backgroundColor",e.background,i,o),this.__setBgOverlay("overlayColor",e.overlay,i,o)},__setBgOverlay:function(e,t,i,o){var n=this;if(!t){i[e]=!0,o&&o();return}e==="backgroundImage"||e==="overlayImage"?b.util.enlivenObjects([t],function(s){n[e]=s[0],i[e]=!0,o&&o()}):this["set"+b.util.string.capitalize(e,!0)](t,function(){i[e]=!0,o&&o()})},_enlivenObjects:function(e,t,i){if(!e||e.length===0){t&&t([]);return}b.util.enlivenObjects(e,function(o){t&&t(o)},null,i)},_toDataURL:function(e,t){this.clone(function(i){t(i.toDataURL(e))})},_toDataURLWithMultiplier:function(e,t,i){this.clone(function(o){i(o.toDataURLWithMultiplier(e,t))})},clone:function(e,t){var i=JSON.stringify(this.toJSON(t));this.cloneWithoutData(function(o){o.loadFromJSON(i,function(){e&&e(o)})})},cloneWithoutData:function(e){var t=b.util.createCanvasElement();t.width=this.width,t.height=this.height;var i=new b.Canvas(t);this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),e&&e(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):e&&e(i)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n=t.util.toFixed,s=t.util.string.capitalize,r=t.util.degreesToRadians,a=!t.isLikelyNode,l=2;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:a,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(u){u&&this.setOptions(u)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(u){var c=t.perfLimitSizeTotal,h=u.width,d=u.height,g=t.maxCacheSideLimit,m=t.minCacheSideLimit;if(h<=g&&d<=g&&h*d<=c)return h<m&&(u.width=m),d<m&&(u.height=m),u;var y=h/d,C=t.util.limitDimsByArea(y,c),w=t.util.capValue,F=w(m,C.x,g),B=w(m,C.y,g);return h>F&&(u.zoomX/=h/F,u.width=F,u.capped=!0),d>B&&(u.zoomY/=d/B,u.height=B,u.capped=!0),u},_getCacheCanvasDimensions:function(){var u=this.getTotalObjectScaling(),c=this._getTransformedDimensions(0,0),h=c.x*u.scaleX/this.scaleX,d=c.y*u.scaleY/this.scaleY;return{width:h+l,height:d+l,zoomX:u.scaleX,zoomY:u.scaleY,x:h,y:d}},_updateCacheCanvas:function(){var u=this.canvas;if(this.noScaleCache&&u&&u._currentTransform){var c=u._currentTransform.target,h=u._currentTransform.action;if(this===c&&h.slice&&h.slice(0,5)==="scale")return!1}var d=this._cacheCanvas,g=this._limitCacheSize(this._getCacheCanvasDimensions()),m=t.minCacheSideLimit,y=g.width,C=g.height,w,F,B=g.zoomX,U=g.zoomY,R=y!==this.cacheWidth||C!==this.cacheHeight,W=this.zoomX!==B||this.zoomY!==U,X=R||W,$=0,st=0,pt=!1;if(R){var dt=this._cacheCanvas.width,x=this._cacheCanvas.height,P=y>dt||C>x,I=(y<dt*.9||C<x*.9)&&dt>m&&x>m;pt=P||I,P&&!g.capped&&(y>m||C>m)&&($=y*.1,st=C*.1)}return this instanceof t.Text&&this.path&&(X=!0,pt=!0,$+=this.getHeightOfLine(0)*this.zoomX,st+=this.getHeightOfLine(0)*this.zoomY),X?(pt?(d.width=Math.ceil(y+$),d.height=Math.ceil(C+st)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,d.width,d.height)),w=g.x/2,F=g.y/2,this.cacheTranslationX=Math.round(d.width/2-w)+w,this.cacheTranslationY=Math.round(d.height/2-F)+F,this.cacheWidth=y,this.cacheHeight=C,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(B,U),this.zoomX=B,this.zoomY=U,!0):!1},setOptions:function(u){this._setOptions(u),this._initGradient(u.fill,"fill"),this._initGradient(u.stroke,"stroke"),this._initPattern(u.fill,"fill"),this._initPattern(u.stroke,"stroke")},transform:function(u){var c=this.group&&!this.group._transformDone||this.group&&this.canvas&&u===this.canvas.contextTop,h=this.calcTransformMatrix(!c);u.transform(h[0],h[1],h[2],h[3],h[4],h[5])},toObject:function(u){var c=t.Object.NUM_FRACTION_DIGITS,h={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:n(this.left,c),top:n(this.top,c),width:n(this.width,c),height:n(this.height,c),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,c),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,c),scaleX:n(this.scaleX,c),scaleY:n(this.scaleY,c),angle:n(this.angle,c),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,c),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,c),skewY:n(this.skewY,c)};return this.clipPath&&!this.clipPath.excludeFromExport&&(h.clipPath=this.clipPath.toObject(u),h.clipPath.inverted=this.clipPath.inverted,h.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,h,u),this.includeDefaultValues||(h=this._removeDefaultValues(h)),h},toDatalessObject:function(u){return this.toObject(u)},_removeDefaultValues:function(u){var c=t.util.getKlass(u.type).prototype,h=c.stateProperties;return h.forEach(function(d){d==="left"||d==="top"||(u[d]===c[d]&&delete u[d],Array.isArray(u[d])&&Array.isArray(c[d])&&u[d].length===0&&c[d].length===0&&delete u[d])}),u},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var u=t.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(u.scaleX),scaleY:Math.abs(u.scaleY)}},getTotalObjectScaling:function(){var u=this.getObjectScaling(),c=u.scaleX,h=u.scaleY;if(this.canvas){var d=this.canvas.getZoom(),g=this.canvas.getRetinaScaling();c*=d*g,h*=d*g}return{scaleX:c,scaleY:h}},getObjectOpacity:function(){var u=this.opacity;return this.group&&(u*=this.group.getObjectOpacity()),u},_set:function(u,c){var h=u==="scaleX"||u==="scaleY",d=this[u]!==c,g=!1;return h&&(c=this._constrainScale(c)),u==="scaleX"&&c<0?(this.flipX=!this.flipX,c*=-1):u==="scaleY"&&c<0?(this.flipY=!this.flipY,c*=-1):u==="shadow"&&c&&!(c instanceof t.Shadow)?c=new t.Shadow(c):u==="dirty"&&this.group&&this.group.set("dirty",c),this[u]=c,d&&(g=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(u)>-1?(this.dirty=!0,g&&this.group.set("dirty",!0)):g&&this.stateProperties.indexOf(u)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(u){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(u.save(),this._setupCompositeOperation(u),this.drawSelectionBackground(u),this.transform(u),this._setOpacity(u),this._setShadow(u,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(u)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(u),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),u.restore())},renderCache:function(u){u=u||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,u.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(u,c){if(u.save(),c.inverted?u.globalCompositeOperation="destination-out":u.globalCompositeOperation="destination-in",c.absolutePositioned){var h=t.util.invertTransform(this.calcTransformMatrix());u.transform(h[0],h[1],h[2],h[3],h[4],h[5])}c.transform(u),u.scale(1/c.zoomX,1/c.zoomY),u.drawImage(c._cacheCanvas,-c.cacheTranslationX,-c.cacheTranslationY),u.restore()},drawObject:function(u,c){var h=this.fill,d=this.stroke;c?(this.fill="black",this.stroke="",this._setClippingProperties(u)):this._renderBackground(u),this._render(u),this._drawClipPath(u,this.clipPath),this.fill=h,this.stroke=d},_drawClipPath:function(u,c){c&&(c.canvas=this.canvas,c.shouldCache(),c._transformDone=!0,c.renderCache({forClipping:!0}),this.drawClipPathOnCache(u,c))},drawCacheOnCanvas:function(u){u.scale(1/this.zoomX,1/this.zoomY),u.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(u){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!u&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!u){var c=this.cacheWidth/this.zoomX,h=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-c/2,-h/2,c,h)}return!0}return!1},_renderBackground:function(u){if(this.backgroundColor){var c=this._getNonTransformedDimensions();u.fillStyle=this.backgroundColor,u.fillRect(-c.x/2,-c.y/2,c.x,c.y),this._removeShadow(u)}},_setOpacity:function(u){this.group&&!this.group._transformDone?u.globalAlpha=this.getObjectOpacity():u.globalAlpha*=this.opacity},_setStrokeStyles:function(u,c){var h=c.stroke;h&&(u.lineWidth=c.strokeWidth,u.lineCap=c.strokeLineCap,u.lineDashOffset=c.strokeDashOffset,u.lineJoin=c.strokeLineJoin,u.miterLimit=c.strokeMiterLimit,h.toLive?h.gradientUnits==="percentage"||h.gradientTransform||h.patternTransform?this._applyPatternForTransformedGradient(u,h):(u.strokeStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,h)):u.strokeStyle=c.stroke)},_setFillStyles:function(u,c){var h=c.fill;h&&(h.toLive?(u.fillStyle=h.toLive(u,this),this._applyPatternGradientTransform(u,c.fill)):u.fillStyle=h)},_setClippingProperties:function(u){u.globalAlpha=1,u.strokeStyle="transparent",u.fillStyle="#000000"},_setLineDash:function(u,c){!c||c.length===0||(1&c.length&&c.push.apply(c,c),u.setLineDash(c))},_renderControls:function(u,c){var h=this.getViewportTransform(),d=this.calcTransformMatrix(),g,m,y;c=c||{},m=typeof c.hasBorders<"u"?c.hasBorders:this.hasBorders,y=typeof c.hasControls<"u"?c.hasControls:this.hasControls,d=t.util.multiplyTransformMatrices(h,d),g=t.util.qrDecompose(d),u.save(),u.translate(g.translateX,g.translateY),u.lineWidth=1*this.borderScaleFactor,this.group||(u.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(g.angle-=180),u.rotate(r(this.group?g.angle:this.angle)),c.forActiveSelection||this.group?m&&this.drawBordersInGroup(u,g,c):m&&this.drawBorders(u,c),y&&this.drawControls(u,c),u.restore()},_setShadow:function(u){if(this.shadow){var c=this.shadow,h=this.canvas,d,g=h&&h.viewportTransform[0]||1,m=h&&h.viewportTransform[3]||1;c.nonScaling?d={scaleX:1,scaleY:1}:d=this.getObjectScaling(),h&&h._isRetinaScaling()&&(g*=t.devicePixelRatio,m*=t.devicePixelRatio),u.shadowColor=c.color,u.shadowBlur=c.blur*t.browserShadowBlurConstant*(g+m)*(d.scaleX+d.scaleY)/4,u.shadowOffsetX=c.offsetX*g*d.scaleX,u.shadowOffsetY=c.offsetY*m*d.scaleY}},_removeShadow:function(u){this.shadow&&(u.shadowColor="",u.shadowBlur=u.shadowOffsetX=u.shadowOffsetY=0)},_applyPatternGradientTransform:function(u,c){if(!c||!c.toLive)return{offsetX:0,offsetY:0};var h=c.gradientTransform||c.patternTransform,d=-this.width/2+c.offsetX||0,g=-this.height/2+c.offsetY||0;return c.gradientUnits==="percentage"?u.transform(this.width,0,0,this.height,d,g):u.transform(1,0,0,1,d,g),h&&u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),{offsetX:d,offsetY:g}},_renderPaintInOrder:function(u){this.paintFirst==="stroke"?(this._renderStroke(u),this._renderFill(u)):(this._renderFill(u),this._renderStroke(u))},_render:function(){},_renderFill:function(u){this.fill&&(u.save(),this._setFillStyles(u,this),this.fillRule==="evenodd"?u.fill("evenodd"):u.fill(),u.restore())},_renderStroke:function(u){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(u),u.save(),this.strokeUniform&&this.group){var c=this.getObjectScaling();u.scale(1/c.scaleX,1/c.scaleY)}else this.strokeUniform&&u.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(u,this.strokeDashArray),this._setStrokeStyles(u,this),u.stroke(),u.restore()}},_applyPatternForTransformedGradient:function(u,c){var h=this._limitCacheSize(this._getCacheCanvasDimensions()),d=t.util.createCanvasElement(),g,m=this.canvas.getRetinaScaling(),y=h.x/this.scaleX/m,C=h.y/this.scaleY/m;d.width=y,d.height=C,g=d.getContext("2d"),g.beginPath(),g.moveTo(0,0),g.lineTo(y,0),g.lineTo(y,C),g.lineTo(0,C),g.closePath(),g.translate(y/2,C/2),g.scale(h.zoomX/this.scaleX/m,h.zoomY/this.scaleY/m),this._applyPatternGradientTransform(g,c),g.fillStyle=c.toLive(u),g.fill(),u.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),u.scale(m*this.scaleX/h.zoomX,m*this.scaleY/h.zoomY),u.strokeStyle=g.createPattern(d,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var u=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",u.scaleX),this.set("scaleY",u.scaleY),this.angle=u.angle,this.skewX=u.skewX,this.skewY=0}},_removeTransformMatrix:function(u){var c=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),c=t.util.transformPoint(c,this.transformMatrix)),this.transformMatrix=null,u&&(this.scaleX*=u.scaleX,this.scaleY*=u.scaleY,this.cropX=u.cropX,this.cropY=u.cropY,c.x+=u.offsetLeft,c.y+=u.offsetTop,this.width=u.width,this.height=u.height),this.setPositionByOrigin(c,"center","center")},clone:function(u,c){var h=this.toObject(c);this.constructor.fromObject?this.constructor.fromObject(h,u):t.Object._fromObject("Object",h,u)},cloneAsImage:function(u,c){var h=this.toCanvasElement(c);return u&&u(new t.Image(h)),this},toCanvasElement:function(u){u||(u={});var c=t.util,h=c.saveObjectTransform(this),d=this.group,g=this.shadow,m=Math.abs,y=(u.multiplier||1)*(u.enableRetinaScaling?t.devicePixelRatio:1);delete this.group,u.withoutTransform&&c.resetObjectTransform(this),u.withoutShadow&&(this.shadow=null);var C=t.util.createCanvasElement(),w=this.getBoundingRect(!0,!0),F=this.shadow,B,U={x:0,y:0},R,W,X;F&&(R=F.blur,F.nonScaling?B={scaleX:1,scaleY:1}:B=this.getObjectScaling(),U.x=2*Math.round(m(F.offsetX)+R)*m(B.scaleX),U.y=2*Math.round(m(F.offsetY)+R)*m(B.scaleY)),W=w.width+U.x,X=w.height+U.y,C.width=Math.ceil(W),C.height=Math.ceil(X);var $=new t.StaticCanvas(C,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});u.format==="jpeg"&&($.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point($.width/2,$.height/2),"center","center");var st=this.canvas;$.add(this);var pt=$.toCanvasElement(y||1,u);return this.shadow=g,this.set("canvas",st),d&&(this.group=d),this.set(h).setCoords(),$._objects=[],$.dispose(),$=null,pt},toDataURL:function(u){return u||(u={}),t.util.toDataURL(this.toCanvasElement(u),u.format||"png",u.quality||1)},isType:function(u){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===u},complexity:function(){return 1},toJSON:function(u){return this.toObject(u)},rotate:function(u){var c=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return c&&this._setOriginToCenter(),this.set("angle",u),c&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(u,c){c=c||this.canvas.getPointer(u);var h=new t.Point(c.x,c.y),d=this._getLeftTopCoords();return this.angle&&(h=t.util.rotatePoint(h,d,r(-this.angle))),{x:h.x-d.x,y:h.y-d.y}},_setupCompositeOperation:function(u){this.globalCompositeOperation&&(u.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){t.runningAnimations&&t.runningAnimations.cancelByTarget(this)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),i(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.ENLIVEN_PROPS=["clipPath"],t.Object._fromObject=function(u,c,h,d){var g=t[u];c=o(c,!0),t.util.enlivenPatterns([c.fill,c.stroke],function(m){typeof m[0]<"u"&&(c.fill=m[0]),typeof m[1]<"u"&&(c.stroke=m[1]),t.util.enlivenObjectEnlivables(c,c,function(){var y=d?new g(c[d],c):new g(c);h&&h(y)})})},t.Object.__uid=0)})(_t);(function(){var e=b.util.degreesToRadians,t={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};b.util.object.extend(b.Object.prototype,{translateToGivenOrigin:function(o,n,s,r,a){var l=o.x,u=o.y,c,h,d;return typeof n=="string"?n=t[n]:n-=.5,typeof r=="string"?r=t[r]:r-=.5,c=r-n,typeof s=="string"?s=i[s]:s-=.5,typeof a=="string"?a=i[a]:a-=.5,h=a-s,(c||h)&&(d=this._getTransformedDimensions(),l=o.x+c*d.x,u=o.y+h*d.y),new b.Point(l,u)},translateToCenterPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,n,s,"center","center");return this.angle?b.util.rotatePoint(r,o,e(this.angle)):r},translateToOriginPoint:function(o,n,s){var r=this.translateToGivenOrigin(o,"center","center",n,s);return this.angle?b.util.rotatePoint(r,o,e(this.angle)):r},getCenterPoint:function(){var o=new b.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,n){var s=this.getCenterPoint();return this.translateToOriginPoint(s,o,n)},toLocalPoint:function(o,n,s){var r=this.getCenterPoint(),a,l;return typeof n<"u"&&typeof s<"u"?a=this.translateToGivenOrigin(r,"center","center",n,s):a=new b.Point(this.left,this.top),l=new b.Point(o.x,o.y),this.angle&&(l=b.util.rotatePoint(l,r,-e(this.angle))),l.subtractEquals(a)},setPositionByOrigin:function(o,n,s){var r=this.translateToCenterPoint(o,n,s),a=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(o){var n=e(this.angle),s=this.getScaledWidth(),r=b.util.cos(n)*s,a=b.util.sin(n)*s,l,u;typeof this.originX=="string"?l=t[this.originX]:l=this.originX-.5,typeof o=="string"?u=t[o]:u=o-.5,this.left+=r*(u-l),this.top+=a*(u-l),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function e(s){return[new b.Point(s.tl.x,s.tl.y),new b.Point(s.tr.x,s.tr.y),new b.Point(s.br.x,s.br.y),new b.Point(s.bl.x,s.bl.y)]}var t=b.util,i=t.degreesToRadians,o=t.multiplyTransformMatrices,n=t.transformPoint;t.object.extend(b.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(s,r){return r?s?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),s?this.aCoords:this.lineCoords)},getCoords:function(s,r){return e(this._getCoords(s,r))},intersectsWithRect:function(s,r,a,l){var u=this.getCoords(a,l),c=b.Intersection.intersectPolygonRectangle(u,s,r);return c.status==="Intersection"},intersectsWithObject:function(s,r,a){var l=b.Intersection.intersectPolygonPolygon(this.getCoords(r,a),s.getCoords(r,a));return l.status==="Intersection"||s.isContainedWithinObject(this,r,a)||this.isContainedWithinObject(s,r,a)},isContainedWithinObject:function(s,r,a){for(var l=this.getCoords(r,a),u=r?s.aCoords:s.lineCoords,c=0,h=s._getImageLines(u);c<4;c++)if(!s.containsPoint(l[c],h))return!1;return!0},isContainedWithinRect:function(s,r,a,l){var u=this.getBoundingRect(a,l);return u.left>=s.x&&u.left+u.width<=r.x&&u.top>=s.y&&u.top+u.height<=r.y},containsPoint:function(s,c,a,l){var u=this._getCoords(a,l),c=c||this._getImageLines(u),h=this._findCrossPoints(s,c);return h!==0&&h%2===1},isOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br,l=this.getCoords(!0,s);return l.some(function(u){return u.x<=a.x&&u.x>=r.x&&u.y<=a.y&&u.y>=r.y})||this.intersectsWithRect(r,a,!0,s)?!0:this._containsCenterOfCanvas(r,a,s)},_containsCenterOfCanvas:function(s,r,a){var l={x:(s.x+r.x)/2,y:(s.y+r.y)/2};return!!this.containsPoint(l,null,!0,a)},isPartiallyOnScreen:function(s){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;if(this.intersectsWithRect(r,a,!0,s))return!0;var l=this.getCoords(!0,s).every(function(u){return(u.x>=a.x||u.x<=r.x)&&(u.y>=a.y||u.y<=r.y)});return l&&this._containsCenterOfCanvas(r,a,s)},_getImageLines:function(s){var r={topline:{o:s.tl,d:s.tr},rightline:{o:s.tr,d:s.br},bottomline:{o:s.br,d:s.bl},leftline:{o:s.bl,d:s.tl}};return r},_findCrossPoints:function(s,r){var a,l,u,c,h,d=0,g;for(var m in r)if(g=r[m],!(g.o.y<s.y&&g.d.y<s.y)&&!(g.o.y>=s.y&&g.d.y>=s.y)&&(g.o.x===g.d.x&&g.o.x>=s.x?h=g.o.x:(a=0,l=(g.d.y-g.o.y)/(g.d.x-g.o.x),u=s.y-a*s.x,c=g.o.y-l*g.o.x,h=-(u-c)/(a-l)),h>=s.x&&(d+=1),d===2))break;return d},getBoundingRect:function(s,r){var a=this.getCoords(s,r);return t.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(s){return Math.abs(s)<this.minScaleLimit?s<0?-this.minScaleLimit:this.minScaleLimit:s===0?1e-4:s},scale:function(s){return this._set("scaleX",s),this._set("scaleY",s),this.setCoords()},scaleToWidth:function(s,r){var a=this.getBoundingRect(r).width/this.getScaledWidth();return this.scale(s/this.width/a)},scaleToHeight:function(s,r){var a=this.getBoundingRect(r).height/this.getScaledHeight();return this.scale(s/this.height/a)},calcLineCoords:function(){var s=this.getViewportTransform(),r=this.padding,a=i(this.angle),l=t.cos(a),u=t.sin(a),c=l*r,h=u*r,d=c+h,g=c-h,m=this.calcACoords(),y={tl:n(m.tl,s),tr:n(m.tr,s),bl:n(m.bl,s),br:n(m.br,s)};return r&&(y.tl.x-=g,y.tl.y-=d,y.tr.x+=d,y.tr.y-=g,y.bl.x-=d,y.bl.y+=g,y.br.x+=g,y.br.y+=d),y},calcOCoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=this.getViewportTransform(),l=o(a,r),u=o(l,s),u=o(u,[1/a[0],0,0,1/a[3],0,0]),c=this._calculateCurrentDimensions(),h={};return this.forEachControl(function(d,g,m){h[g]=d.positionHandler(c,u,m)}),h},calcACoords:function(){var s=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),a=o(r,s),l=this._getTransformedDimensions(),u=l.x/2,c=l.y/2;return{tl:n({x:-u,y:-c},a),tr:n({x:u,y:-c},a),bl:n({x:-u,y:c},a),br:n({x:u,y:c},a)}},setCoords:function(s){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),s?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var s=this.getCenterPoint();return[1,0,0,1,s.x,s.y]},transformMatrixKey:function(s){var r="_",a="";return!s&&this.group&&(a=this.group.transformMatrixKey(s)+r),a+this.top+r+this.left+r+this.scaleX+r+this.scaleY+r+this.skewX+r+this.skewY+r+this.angle+r+this.originX+r+this.originY+r+this.width+r+this.height+r+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(s){var r=this.calcOwnMatrix();if(s||!this.group)return r;var a=this.transformMatrixKey(s),l=this.matrixCache||(this.matrixCache={});return l.key===a?l.value:(this.group&&(r=o(this.group.calcTransformMatrix(!1),r)),l.key=a,l.value=r,r)},calcOwnMatrix:function(){var s=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===s)return r.value;var a=this._calcTranslateMatrix(),l={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=s,r.value=t.composeMatrix(l),r.value},_getNonTransformedDimensions:function(){var s=this.strokeWidth,r=this.width+s,a=this.height+s;return{x:r,y:a}},_getTransformedDimensions:function(s,r){typeof s>"u"&&(s=this.skewX),typeof r>"u"&&(r=this.skewY);var a,l,u,c=s===0&&r===0;if(this.strokeUniform?(l=this.width,u=this.height):(a=this._getNonTransformedDimensions(),l=a.x,u=a.y),c)return this._finalizeDimensions(l*this.scaleX,u*this.scaleY);var h=t.sizeAfterTransform(l,u,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:s,skewY:r});return this._finalizeDimensions(h.x,h.y)},_finalizeDimensions:function(s,r){return this.strokeUniform?{x:s+this.strokeWidth,y:r+this.strokeWidth}:{x:s,y:r}},_calculateCurrentDimensions:function(){var s=this.getViewportTransform(),r=this._getTransformedDimensions(),a=n(r,s,!0);return a.scalarAdd(2*this.padding)}})})();b.util.object.extend(b.Object.prototype,{sendToBack:function(){return this.group?b.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?b.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?b.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas&&this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?b.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas&&this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group&&this.group.type!=="activeSelection"?b.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas&&this.canvas.moveTo(this,e),this}});(function(){function e(i,o){if(o){if(o.toLive)return i+": url(#SVGID_"+o.id+"); ";var n=new b.Color(o),s=i+": "+n.toRgb()+"; ",r=n.getAlpha();return r!==1&&(s+=i+"-opacity: "+r.toString()+"; "),s}else return i+": none; "}var t=b.util.toFixed;b.util.object.extend(b.Object.prototype,{getSvgStyles:function(i){var o=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",r=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=typeof this.opacity<"u"?this.opacity:"1",h=this.visible?"":" visibility: hidden;",d=i?"":this.getSvgFilter(),g=e("fill",this.fill),m=e("stroke",this.stroke);return[m,"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",o,"; ","opacity: ",c,";",d,h].join("")},getSvgSpanStyles:function(i,o){var n="; ",r=i.fontFamily?"font-family: "+(i.fontFamily.indexOf("'")===-1&&i.fontFamily.indexOf('"')===-1?"'"+i.fontFamily+"'":i.fontFamily)+n:"",s=i.strokeWidth?"stroke-width: "+i.strokeWidth+n:"",r=r,a=i.fontSize?"font-size: "+i.fontSize+"px"+n:"",l=i.fontStyle?"font-style: "+i.fontStyle+n:"",u=i.fontWeight?"font-weight: "+i.fontWeight+n:"",c=i.fill?e("fill",i.fill):"",h=i.stroke?e("stroke",i.stroke):"",d=this.getSvgTextDecoration(i),g=i.deltaY?"baseline-shift: "+-i.deltaY+"; ":"";return d&&(d="text-decoration: "+d+n),[h,s,r,a,l,u,d,c,g,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(i){return["overline","underline","line-through"].filter(function(o){return i[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(i,o){var n=i?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'+b.util.matrixToSVG(n);return s+(o||"")+'" '},_setSVGBg:function(i){if(this.backgroundColor){var o=b.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,o),'" y="',t(-this.height/2,o),'" width="',t(this.width,o),'" height="',t(this.height,o),`"></rect>
`)}},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(i),{reviver:i})},toClipPathSVG:function(i){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(i),{reviver:i})},_createBaseClipPathSVGMarkup:function(i,o){o=o||{};var n=o.reviver,s=o.additionalTransform||"",r=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),a=i.indexOf("COMMON_PARTS");return i[a]=r,n?n(i.join("")):i.join("")},_createBaseSVGMarkup:function(i,o){o=o||{};var n=o.noStyle,s=o.reviver,r=n?"":'style="'+this.getSvgStyles()+'" ',a=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=l&&l.absolutePositioned,h=this.stroke,d=this.fill,g=this.shadow,m,y=[],C,w=i.indexOf("COMMON_PARTS"),F=o.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+b.Object.__uid++,C='<clipPath id="'+l.clipPathId+`" >
`+l.toClipPathSVG(s)+`</clipPath>
`),c&&y.push("<g ",a,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),c?"":a+this.getSvgCommons(),` >
`),m=[r,u,n?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),i[w]=m,d&&d.toLive&&y.push(d.toSVG(this)),h&&h.toLive&&y.push(h.toSVG(this)),g&&y.push(g.toSVG(this)),l&&y.push(C),y.push(i.join("")),y.push(`</g>
`),c&&y.push(`</g>
`),s?s(y.join("")):y.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var e=b.util.object.extend,t="stateProperties";function i(n,s,r){var a={},l=!0;r.forEach(function(u){a[u]=n[u]}),e(n[s],a,l)}function o(n,s,r){if(n===s)return!0;if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var a=0,l=n.length;a<l;a++)if(!o(n[a],s[a]))return!1;return!0}else if(n&&typeof n=="object"){var u=Object.keys(n),c;if(!s||typeof s!="object"||!r&&u.length!==Object.keys(s).length)return!1;for(var a=0,l=u.length;a<l;a++)if(c=u[a],!(c==="canvas"||c==="group")&&!o(n[c],s[c]))return!1;return!0}}b.util.object.extend(b.Object.prototype,{hasStateChanged:function(n){n=n||t;var s="_"+n;return Object.keys(this[s]).length<this[n].length?!0:!o(this[s],this,!0)},saveState:function(n){var s=n&&n.propertySet||t,r="_"+s;return this[r]?(i(this,r,this[s]),n&&n.stateProperties&&i(this,r,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var s=n.propertySet||t;return n.propertySet=s,this["_"+s]={},this.saveState(n),this}})})();(function(){var e=b.util.degreesToRadians;b.util.object.extend(b.Object.prototype,{_findTargetCorner:function(t,i){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=t.x,n=t.y,s,r,a=Object.keys(this.oCoords),l=a.length-1,u;for(this.__corner=0;l>=0;l--)if(u=a[l],!!this.isControlVisible(u)&&(r=this._getImageLines(i?this.oCoords[u].touchCorner:this.oCoords[u].corner),s=this._findCrossPoints({x:o,y:n},r),s!==0&&s%2===1))return this.__corner=u,u;return!1},forEachControl:function(t){for(var i in this.controls)t(this.controls[i],i,this)},_setCornerCoords:function(){var t=this.oCoords;for(var i in t){var o=this.controls[i];t[i].corner=o.calcCornerCoords(this.angle,this.cornerSize,t[i].x,t[i].y,!1),t[i].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,t[i].x,t[i].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var i=this.getCenterPoint(),o=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return t.translate(i.x,i.y),t.scale(1/n[0],1/n[3]),t.rotate(e(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-o.x/2,-o.y/2,o.x,o.y),t.restore(),this},drawBorders:function(t,i){i=i||{};var o=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=o.x+n,r=o.y+n,a=typeof i.hasControls<"u"?i.hasControls:this.hasControls,l=!1;return t.save(),t.strokeStyle=i.borderColor||this.borderColor,this._setLineDash(t,i.borderDashArray||this.borderDashArray),t.strokeRect(-s/2,-r/2,s,r),a&&(t.beginPath(),this.forEachControl(function(u,c,h){u.withConnection&&u.getVisibility(h,c)&&(l=!0,t.moveTo(u.x*s,u.y*r),t.lineTo(u.x*s+u.offsetX,u.y*r+u.offsetY))}),l&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,i,o){o=o||{};var n=b.util.sizeAfterTransform(this.width,this.height,i),s=this.strokeWidth,r=this.strokeUniform,a=this.borderScaleFactor,l=n.x+s*(r?this.canvas.getZoom():i.scaleX)+a,u=n.y+s*(r?this.canvas.getZoom():i.scaleY)+a;return t.save(),this._setLineDash(t,o.borderDashArray||this.borderDashArray),t.strokeStyle=o.borderColor||this.borderColor,t.strokeRect(-l/2,-u/2,l,u),t.restore(),this},drawControls:function(t,i){i=i||{},t.save();var o=this.canvas.getRetinaScaling(),n,s;return t.setTransform(o,0,0,o,0,0),t.strokeStyle=t.fillStyle=i.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=i.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,i.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(r,a,l){s=l.oCoords[a],r.getVisibility(l,a)&&(n&&(s=b.util.transformPoint(s,n)),r.render(t,s.x,s.y,i,l))}),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,i){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=i,this},setControlsVisibility:function(t){t||(t={});for(var i in t)this.setControlVisible(i,t[i]);return this},onDeselect:function(){},onSelect:function(){}})})();b.util.object.extend(b.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return b.util.animate({target:this,startValue:e.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(r){e.set("left",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxCenterObjectV:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return b.util.animate({target:this,startValue:e.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(r){e.set("top",r),s.requestRenderAll(),n()},onComplete:function(){e.setCoords(),o()}})},fxRemove:function(e,t){t=t||{};var i=function(){},o=t.onComplete||i,n=t.onChange||i,s=this;return b.util.animate({target:this,startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(r){e.set("opacity",r),s.requestRenderAll(),n()},onComplete:function(){s.remove(e),o()}})}});b.util.object.extend(b.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var e=[],t,i,o=[];for(t in arguments[0])e.push(t);for(var n=0,s=e.length;n<s;n++)t=e[n],i=n!==s-1,o.push(this._animate(t,arguments[0][t],arguments[1],i));return o}else return this._animate.apply(this,arguments)},_animate:function(e,t,i,o){var n=this,s;t=t.toString(),i?i=b.util.object.clone(i):i={},~e.indexOf(".")&&(s=e.split("."));var r=n.colorProperties.indexOf(e)>-1||s&&n.colorProperties.indexOf(s[1])>-1,a=s?this.get(s[0])[s[1]]:this.get(e);"from"in i||(i.from=a),r||(~t.indexOf("=")?t=a+parseFloat(t.replace("=","")):t=parseFloat(t));var l={target:this,startValue:i.from,endValue:t,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(u,c,h){return i.abort.call(n,u,c,h)},onChange:function(u,c,h){s?n[s[0]][s[1]]=u:n.set(e,u),!o&&i.onChange&&i.onChange(u,c,h)},onComplete:function(u,c,h){o||(n.setCoords(),i.onComplete&&i.onComplete(u,c,h))}};return r?b.util.animateColor(l.startValue,l.endValue,l.duration,l):b.util.animate(l)}});(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(t.Line){t.warn("fabric.Line is already defined");return}t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(r,a){r||(r=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",r[0]),this.set("y1",r[1]),this.set("x2",r[2]),this.set("y2",r[3]),this._setWidthHeight(a)},_setWidthHeight:function(r){r||(r={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in r?r.left:this._getLeftToOriginX(),this.top="top"in r?r.top:this._getTopToOriginY()},_set:function(r,a){return this.callSuper("_set",r,a),typeof n[r]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(r){r.beginPath();var a=this.calcLinePoints();r.moveTo(a.x1,a.y1),r.lineTo(a.x2,a.y2),r.lineWidth=this.strokeWidth;var l=r.strokeStyle;r.strokeStyle=this.stroke||r.fillStyle,this.stroke&&this._renderStroke(r),r.strokeStyle=l},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(r){return i(this.callSuper("toObject",r),this.calcLinePoints())},_getNonTransformedDimensions:function(){var r=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(r.y-=this.strokeWidth),this.height===0&&(r.x-=this.strokeWidth)),r},calcLinePoints:function(){var r=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1,l=r*this.width*.5,u=a*this.height*.5,c=r*this.width*-.5,h=a*this.height*-.5;return{x1:l,x2:c,y1:u,y2:h}},_toSVG:function(){var r=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,`" />
`]}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(r,a,l){l=l||{};var u=t.parseAttributes(r,t.Line.ATTRIBUTE_NAMES),c=[u.x1||0,u.y1||0,u.x2||0,u.y2||0];a(new t.Line(c,i(u,l)))},t.Line.fromObject=function(r,a){function l(c){delete c.points,a&&a(c)}var u=o(r,!0);u.points=[r.x1,r.y1,r.x2,r.y2],t.Object._fromObject("Line",u,l,"points")};function s(r,a){var l=r.origin,u=r.axis1,c=r.axis2,h=r.dimension,d=a.nearest,g=a.center,m=a.farthest;return function(){switch(this.get(l)){case d:return Math.min(this.get(u),this.get(c));case g:return Math.min(this.get(u),this.get(c))+.5*this.get(h);case m:return Math.max(this.get(u),this.get(c))}}}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.degreesToRadians;if(t.Circle){t.warn("fabric.Circle is already defined.");return}t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,s){return this.callSuper("_set",n,s),n==="radius"&&this.setRadius(s),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,s=0,r=0,a=(this.endAngle-this.startAngle)%360;if(a===0)n=["<circle ","COMMON_PARTS",'cx="'+s+'" cy="'+r+'" ','r="',this.radius,`" />
`];else{var l=i(this.startAngle),u=i(this.endAngle),c=this.radius,h=t.util.cos(l)*c,d=t.util.sin(l)*c,g=t.util.cos(u)*c,m=t.util.sin(u)*c,y=a>180?"1":"0";n=['<path d="M '+h+" "+d," A "+c+" "+c," 0 ",+y+" 1"," "+g+" "+m,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,i(this.startAngle),i(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(n,s){var r=t.parseAttributes(n,t.Circle.ATTRIBUTE_NAMES);if(!o(r))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,s(new t.Circle(r))};function o(n){return"radius"in n&&n.radius>=0}t.Circle.fromObject=function(n,s){t.Object._fromObject("Circle",n,s)}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Triangle){t.warn("fabric.Triangle is already defined");return}t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(i){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,n),i.lineTo(0,-n),i.lineTo(o,n),i.closePath(),this._renderPaintInOrder(i)},_toSVG:function(){var i=this.width/2,o=this.height/2,n=[-i+" "+o,"0 "+-o,i+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),t.Triangle.fromObject=function(i,o){return t.Object._fromObject("Triangle",i,o)}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.PI*2;if(t.Ellipse){t.warn("fabric.Ellipse is already defined.");return}t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,n){switch(this.callSuper("_set",o,n),o){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,i,!1),o.restore(),this._renderPaintInOrder(o)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(o,n){var s=t.parseAttributes(o,t.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,n(new t.Ellipse(s))},t.Ellipse.fromObject=function(o,n){t.Object._fromObject("Ellipse",o,n)}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend;if(t.Rect){t.warn("fabric.Rect is already defined");return}t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var n=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,a=this.height,l=-this.width/2,u=-this.height/2,c=n!==0||s!==0,h=1-.5522847498;o.beginPath(),o.moveTo(l+n,u),o.lineTo(l+r-n,u),c&&o.bezierCurveTo(l+r-h*n,u,l+r,u+h*s,l+r,u+s),o.lineTo(l+r,u+a-s),c&&o.bezierCurveTo(l+r,u+a-h*s,l+r-h*n,u+a,l+r-n,u+a),o.lineTo(l+n,u+a),c&&o.bezierCurveTo(l+h*n,u+a,l,u+a-h*s,l,u+a-s),o.lineTo(l,u+s),c&&o.bezierCurveTo(l,u+h*s,l+h*n,u,l+n,u),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(o,n,s){if(!o)return n(null);s=s||{};var r=t.parseAttributes(o,t.Rect.ATTRIBUTE_NAMES);r.left=r.left||0,r.top=r.top||0,r.height=r.height||0,r.width=r.width||0;var a=new t.Rect(i(s?t.util.object.clone(s):{},r));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},t.Rect.fromObject=function(o,n){return t.Object._fromObject("Rect",o,n)}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.util.array.min,n=t.util.array.max,s=t.util.toFixed,r=t.util.projectStrokeOnPoints;if(t.Polyline){t.warn("fabric.Polyline is already defined");return}t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(a,l){l=l||{},this.points=a||[],this.callSuper("initialize",l),this._setPositionDimensions(l)},_projectStrokeOnPoints:function(){return r(this.points,this,!0)},_setPositionDimensions:function(a){var l=this._calcDimensions(a),u,c=this.exactBoundingBox?this.strokeWidth:0;this.width=l.width-c,this.height=l.height-c,a.fromSVG||(u=this.translateToGivenOrigin({x:l.left-this.strokeWidth/2+c/2,y:l.top-this.strokeWidth/2+c/2},"left","top",this.originX,this.originY)),typeof a.left>"u"&&(this.left=a.fromSVG?l.left:u.x),typeof a.top>"u"&&(this.top=a.fromSVG?l.top:u.y),this.pathOffset={x:l.left+this.width/2+c/2,y:l.top+this.height/2+c/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,l=o(a,"x")||0,u=o(a,"y")||0,c=n(a,"x")||0,h=n(a,"y")||0,d=c-l,g=h-u;return{left:l,top:u,width:d,height:g}},toObject:function(a){return i(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],l=this.pathOffset.x,u=this.pathOffset.y,c=t.Object.NUM_FRACTION_DIGITS,h=0,d=this.points.length;h<d;h++)a.push(s(this.points[h].x-l,c),",",s(this.points[h].y-u,c)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),`" />
`]},commonRender:function(a){var l,u=this.points.length,c=this.pathOffset.x,h=this.pathOffset.y;if(!u||isNaN(this.points[u-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-c,this.points[0].y-h);for(var d=0;d<u;d++)l=this.points[d],a.lineTo(l.x-c,l.y-h);return!0},_render:function(a){this.commonRender(a)&&this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(a){return function(l,u,c){if(!l)return u(null);c||(c={});var h=t.parsePointsAttribute(l.getAttribute("points")),d=t.parseAttributes(l,t[a].ATTRIBUTE_NAMES);d.fromSVG=!0,u(new t[a](h,i(d,c)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(a,l){return t.Object._fromObject("Polyline",a,l,"points")}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.projectStrokeOnPoints;if(t.Polygon){t.warn("fabric.Polygon is already defined");return}t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return i(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(o,n){t.Object._fromObject("Polygon",o,n,"points")}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max,n=t.util.object.extend,s=t.util.object.clone,r=t.util.toFixed;if(t.Path){t.warn("fabric.Path is already defined");return}t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(a,l){l=s(l||{}),delete l.path,this.callSuper("initialize",l),this._setPath(a||[],l)},_setPath:function(a,l){this.path=t.util.makePathSimpler(Array.isArray(a)?a:t.util.parsePath(a)),t.Polyline.prototype._setPositionDimensions.call(this,l||{})},_renderPathCommands:function(a){var l,u=0,c=0,h=0,d=0,g=0,m=0,y=-this.pathOffset.x,C=-this.pathOffset.y;a.beginPath();for(var w=0,F=this.path.length;w<F;++w)switch(l=this.path[w],l[0]){case"L":h=l[1],d=l[2],a.lineTo(h+y,d+C);break;case"M":h=l[1],d=l[2],u=h,c=d,a.moveTo(h+y,d+C);break;case"C":h=l[5],d=l[6],g=l[3],m=l[4],a.bezierCurveTo(l[1]+y,l[2]+C,g+y,m+C,h+y,d+C);break;case"Q":a.quadraticCurveTo(l[1]+y,l[2]+C,l[3]+y,l[4]+C),h=l[3],d=l[4],g=l[1],m=l[2];break;case"z":case"Z":h=u,d=c,a.closePath();break}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return n(this.callSuper("toObject",a),{path:this.path.map(function(l){return l.slice()})})},toDatalessObject:function(a){var l=this.toObject(["sourcePath"].concat(a));return l.sourcePath&&delete l.path,l},_toSVG:function(){var a=t.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',a,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var a=t.Object.NUM_FRACTION_DIGITS;return" translate("+r(-this.pathOffset.x,a)+", "+r(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var l=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},toSVG:function(a){var l=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:l})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var a=[],l=[],u,c=0,h=0,d=0,g=0,m,y=0,C=this.path.length;y<C;++y){switch(u=this.path[y],u[0]){case"L":d=u[1],g=u[2],m=[];break;case"M":d=u[1],g=u[2],c=d,h=g,m=[];break;case"C":m=t.util.getBoundsOfCurve(d,g,u[1],u[2],u[3],u[4],u[5],u[6]),d=u[5],g=u[6];break;case"Q":m=t.util.getBoundsOfCurve(d,g,u[1],u[2],u[1],u[2],u[3],u[4]),d=u[3],g=u[4];break;case"z":case"Z":d=c,g=h;break}m.forEach(function(X){a.push(X.x),l.push(X.y)}),a.push(d),l.push(g)}var w=i(a)||0,F=i(l)||0,B=o(a)||0,U=o(l)||0,R=B-w,W=U-F;return{left:w,top:F,width:R,height:W}}}),t.Path.fromObject=function(a,l){if(typeof a.sourcePath=="string"){var u=a.sourcePath;t.loadSVGFromURL(u,function(c){var h=c[0];h.setOptions(a),a.clipPath?t.util.enlivenObjects([a.clipPath],function(d){h.clipPath=d[0],l&&l(h)}):l&&l(h)})}else t.Object._fromObject("Path",a,l,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(a,l,u){var c=t.parseAttributes(a,t.Path.ATTRIBUTE_NAMES);c.fromSVG=!0,l(new t.Path(c.d,n(c,u)))}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.array.min,o=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,s,r){s=s||{},this._objects=[],r&&this.callSuper("initialize",s),this._objects=n||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(r)this._updateObjectsACoords();else{var l=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),l||this._calcBounds(),this._updateObjectsCoords(l),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,s=this._objects.length;s--;)this._objects[s].setCoords(n)},_updateObjectsCoords:function(s){for(var s=s||this.getCenterPoint(),r=this._objects.length;r--;)this._updateObjectCoords(this._objects[r],s)},_updateObjectCoords:function(n,s){var r=n.left,a=n.top,l=!0;n.set({left:r-s.x,top:a-s.y}),n.group=this,n.setCoords(l)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var s=!!this.group;return this._restoreObjectsState(),t.util.resetObjectTransform(this),n&&(s&&t.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,s){var r=this._objects.length;if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(n,s);if(n==="canvas")for(;r--;)this._objects[r]._set(n,s);t.Object.prototype._set.call(this,n,s)},toObject:function(n){var s=this.includeDefaultValues,r=this._objects.filter(function(l){return!l.excludeFromExport}).map(function(l){var u=l.includeDefaultValues;l.includeDefaultValues=s;var c=l.toObject(n);return l.includeDefaultValues=u,c}),a=t.Object.prototype.toObject.call(this,n);return a.objects=r,a},toDatalessObject:function(n){var s,r=this.sourcePath;if(r)s=r;else{var a=this.includeDefaultValues;s=this._objects.map(function(u){var c=u.includeDefaultValues;u.includeDefaultValues=a;var h=u.toDatalessObject(n);return u.includeDefaultValues=c,h})}var l=t.Object.prototype.toDatalessObject.call(this,n);return l.objects=s,l},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=t.Object.prototype.shouldCache.call(this);if(n){for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(t.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,s=this._objects.length;n<s;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var s=0,r=this._objects.length;s<r;s++)this._objects[s].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var s=0,r=this._objects.length;s<r;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,l=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-l/2,a,l)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(s){t.util.addTransformToObject(s,n),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,s=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var a=new t.ActiveSelection([]);return a.set(r),a.type="activeSelection",s.remove(this),n.forEach(function(l){l.group=a,l.dirty=!0,s.add(l)}),a.canvas=s,a._objects=n,s._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(s){s.setCoords(n)}),this},_calcBounds:function(n){for(var s=[],r=[],a,l,u,c=["tr","br","bl","tl"],h=0,d=this._objects.length,g,m=c.length;h<d;++h){for(a=this._objects[h],u=a.calcACoords(),g=0;g<m;g++)l=c[g],s.push(u[l].x),r.push(u[l].y);a.aCoords=u}this._getBounds(s,r,n)},_getBounds:function(n,s,r){var a=new t.Point(i(n),i(s)),l=new t.Point(o(n),o(s)),u=a.y||0,c=a.x||0,h=l.x-a.x||0,d=l.y-a.y||0;this.width=h,this.height=d,r||this.setPositionByOrigin({x:c,y:u},"left","top")},_toSVG:function(n){for(var s=["<g ","COMMON_PARTS",` >
`],r=0,a=this._objects.length;r<a;r++)s.push("		",this._objects[r].toSVG(n));return s.push(`</g>
`),s},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),s].join("")},toClipPathSVG:function(n){for(var s=[],r=0,a=this._objects.length;r<a;r++)s.push("	",this._objects[r].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(s,{reviver:n})}}),t.Group.fromObject=function(n,s){var r=n.objects,a=t.util.object.clone(n,!0);if(delete a.objects,typeof r=="string"){t.loadSVGFromURL(r,function(l){var u=t.util.groupSVGElements(l,n,r),c=a.clipPath;delete a.clipPath,u.set(a),c?t.util.enlivenObjects([c],function(h){u.clipPath=h[0],s&&s(u)}):s&&s(u)});return}t.util.enlivenObjects(r,function(l){t.util.enlivenObjectEnlivables(n,a,function(){s&&s(new t.Group(l,a,!0))})})})})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(i,o){o=o||{},this._objects=i||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var i=this._objects.concat();this._objects=[];var o=t.Object.prototype.toObject.call(this),n=new t.Group([]);if(delete o.type,n.set(o),i.forEach(function(r){r.canvas.remove(r),r.group=n}),n._objects=i,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(i,o,n){i.save(),i.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",i,o),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var s=0,r=this._objects.length;s<r;s++)this._objects[s]._renderControls(i,n);i.restore()}}),t.ActiveSelection.fromObject=function(i,o){t.util.enlivenObjects(i.objects,function(n){delete i.objects,o&&o(new t.ActiveSelection(n,i,!0))})})})(_t);(function(e){"use strict";var t=b.util.object.extend;if(e.fabric||(e.fabric={}),e.fabric.Image){b.warn("fabric.Image is already defined.");return}b.Image=b.util.createClass(b.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:b.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:b.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(i,o){o||(o={}),this.filters=[],this.cacheKey="texture"+b.Object.__uid++,this.callSuper("initialize",o),this._initElement(i,o)},getElement:function(){return this._element||{}},setElement:function(i,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=i,this._originalElement=i,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(i){var o=b.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(i)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(i){b.util.cleanUpJsdomNode(this[i]),this[i]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var i=this.getElement();return{width:i.naturalWidth||i.width,height:i.naturalHeight||i.height}},_stroke:function(i){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,n=this.height/2;i.beginPath(),i.moveTo(-o,-n),i.lineTo(o,-n),i.lineTo(o,n),i.lineTo(-o,n),i.lineTo(-o,-n),i.closePath()}},toObject:function(i){var o=[];this.filters.forEach(function(s){s&&o.push(s.toObject())});var n=t(this.callSuper("toObject",["cropX","cropY"].concat(i)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var i=[],o=[],n,s=this._element,r=-this.width/2,a=-this.height/2,l="",u="";if(!s)return[];if(this.hasCrop()){var c=b.Object.__uid++;i.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+r+'" y="'+a+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(u='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',r-this.cropX,'" y="',a-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,u,'"',l,`></image>
`),this.stroke||this.strokeDashArray){var h=this.fill;this.fill=null,n=["	<rect ",'x="',r,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=h}return this.paintFirst!=="fill"?i=i.concat(n,o):i=i.concat(o,n),i},getSrc:function(i){var o=i?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(i,o,n){return b.util.loadImage(i,function(s,r){this.setElement(s,n),this._setWidthHeight(),o&&o(this,r)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var i=this.resizeFilter,o=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.scaleX,r=n.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!i||s>o&&r>o){this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,this._lastScaleY=r;return}b.filterBackend||(b.filterBackend=b.initFilterBackend());var l=b.util.createCanvasElement(),u=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,c=a.width,h=a.height;l.width=c,l.height=h,this._element=l,this._lastScaleX=i.scaleX=s,this._lastScaleY=i.scaleY=r,b.filterBackend.applyFilters([i],a,c,h,this._element,u),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height},applyFilters:function(i){if(i=i||this.filters||[],i=i.filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),i.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,n=o.naturalWidth||o.width,s=o.naturalHeight||o.height;if(this._element===this._originalElement){var r=b.util.createCanvasElement();r.width=n,r.height=s,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1;return b.filterBackend||(b.filterBackend=b.initFilterBackend()),b.filterBackend.applyFilters(i,this._originalElement,n,s,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(i){b.util.setImageSmoothing(i,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(i),this._renderPaintInOrder(i)},drawCacheOnCanvas:function(i){b.util.setImageSmoothing(i,this.imageSmoothing),b.Object.prototype.drawCacheOnCanvas.call(this,i)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(i){var o=this._element;if(o){var n=this._filterScalingX,s=this._filterScalingY,r=this.width,a=this.height,l=Math.min,u=Math.max,c=u(this.cropX,0),h=u(this.cropY,0),d=o.naturalWidth||o.width,g=o.naturalHeight||o.height,m=c*n,y=h*s,C=l(r*n,d-m),w=l(a*s,g-y),F=-r/2,B=-a/2,U=l(r,d/n-c),R=l(a,g/s-h);o&&i.drawImage(o,m,y,C,w,F,B,U,R)}},_needsResize:function(){var i=this.getTotalObjectScaling();return i.scaleX!==this._lastScaleX||i.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(i,o){this.setElement(b.util.getById(i),o),b.util.addClass(this.getElement(),b.Image.CSS_CANVAS)},_initConfig:function(i){i||(i={}),this.setOptions(i),this._setWidthHeight(i)},_initFilters:function(i,o){i&&i.length?b.util.enlivenObjects(i,function(n){o&&o(n)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(i){i||(i={});var o=this.getElement();this.width=i.width||o.naturalWidth||o.width||0,this.height=i.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var i=b.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,n=this._element.height,s=1,r=1,a=0,l=0,u=0,c=0,h,d=this.width,g=this.height,m={width:d,height:g};return i&&(i.alignX!=="none"||i.alignY!=="none")?(i.meetOrSlice==="meet"&&(s=r=b.util.findScaleToFit(this._element,m),h=(d-o*s)/2,i.alignX==="Min"&&(a=-h),i.alignX==="Max"&&(a=h),h=(g-n*r)/2,i.alignY==="Min"&&(l=-h),i.alignY==="Max"&&(l=h)),i.meetOrSlice==="slice"&&(s=r=b.util.findScaleToCover(this._element,m),h=o-d/s,i.alignX==="Mid"&&(u=h/2),i.alignX==="Max"&&(u=h),h=n-g/r,i.alignY==="Mid"&&(c=h/2),i.alignY==="Max"&&(c=h),o=d/s,n=g/r)):(s=d/o,r=g/n),{width:o,height:n,scaleX:s,scaleY:r,offsetLeft:a,offsetTop:l,cropX:u,cropY:c}}}),b.Image.CSS_CANVAS="canvas-img",b.Image.prototype.getSvgSrc=b.Image.prototype.getSrc,b.Image.fromObject=function(i,o){var n=b.util.object.clone(i);b.util.loadImage(n.src,function(s,r){if(r){o&&o(null,!0);return}b.Image.prototype._initFilters.call(n,n.filters,function(a){n.filters=a||[],b.Image.prototype._initFilters.call(n,[n.resizeFilter],function(l){n.resizeFilter=l[0],b.util.enlivenObjectEnlivables(n,n,function(){var u=new b.Image(s,n);o(u,!1)})})})},null,n.crossOrigin)},b.Image.fromURL=function(i,o,n){b.util.loadImage(i,function(s,r){o&&o(new b.Image(s,n),r)},null,n&&n.crossOrigin)},b.Image.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),b.Image.fromElement=function(i,o,n){var s=b.parseAttributes(i,b.Image.ATTRIBUTE_NAMES);b.Image.fromURL(s["xlink:href"],o,t(n?b.util.object.clone(n):{},s))}})(_t);b.util.object.extend(b.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.angle%360;return e>0?Math.round((e-1)/90)*90:Math.round(e/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(e){e=e||{};var t=function(){},i=e.onComplete||t,o=e.onChange||t,n=this;return b.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){n.rotate(s),o()},onComplete:function(){n.setCoords(),i()}})}});b.util.object.extend(b.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function e(i,o){var n="precision "+o+` float;
void main(){}`,s=i.createShader(i.FRAGMENT_SHADER);return i.shaderSource(s,n),i.compileShader(s),!!i.getShaderParameter(s,i.COMPILE_STATUS)}b.isWebglSupported=function(i){if(b.isLikelyNode)return!1;i=i||b.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),n=o.getContext("webgl")||o.getContext("experimental-webgl"),s=!1;if(n){b.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=b.maxTextureSize>=i;for(var r=["highp","mediump","lowp"],a=0;a<3;a++)if(e(n,r[a])){b.webGlPrecision=r[a];break}}return this.isSupported=s,s},b.WebglFilterBackend=t;function t(i){i&&i.tileSize&&(this.tileSize=i.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}t.prototype={tileSize:2048,resources:{},setupGLContext:function(i,o){this.dispose(),this.createWebGLCanvas(i,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(i,o)},chooseFastestCopyGLTo2DMethod:function(i,o){var n=typeof window.performance<"u",s;try{new ImageData(1,1),s=!0}catch{s=!1}var r=typeof ArrayBuffer<"u",a=typeof Uint8ClampedArray<"u";if(n&&s&&r&&a){var l=b.util.createCanvasElement(),u=new ArrayBuffer(i*o*4);if(b.forceGLPutImageData){this.imageBuffer=u,this.copyGLTo2D=em;return}var c={imageBuffer:u,destinationWidth:i,destinationHeight:o,targetCanvas:l},h,d,g;l.width=i,l.height=o,h=window.performance.now(),tm.call(c,this.gl,c),d=window.performance.now()-h,h=window.performance.now(),em.call(c,this.gl,c),g=window.performance.now()-h,d>g?(this.imageBuffer=u,this.copyGLTo2D=em):this.copyGLTo2D=tm}},createWebGLCanvas:function(i,o){var n=b.util.createCanvasElement();n.width=i,n.height=o;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=n.getContext("webgl",s);r||(r=n.getContext("experimental-webgl",s)),r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)},applyFilters:function(i,o,n,s,r,a){var l=this.gl,u;a&&(u=this.getCachedTexture(a,o));var c={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:l,sourceTexture:this.createTexture(l,n,s,!u&&o),targetTexture:this.createTexture(l,n,s),originalTexture:u||this.createTexture(l,n,s,!u&&o),passes:i.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},h=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,h),i.forEach(function(d){d&&d.applyTo(c)}),pF(c),this.copyGLTo2D(l,c),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(c.sourceTexture),l.deleteTexture(c.targetTexture),l.deleteFramebuffer(h),r.getContext("2d").setTransform(1,0,0,1,0,0),c},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(i,o,n,s){var r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),s?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,o,n,0,i.RGBA,i.UNSIGNED_BYTE,null),r},getCachedTexture:function(i,o){if(this.textureCache[i])return this.textureCache[i];var n=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[i]=n,n},evictCachesForKey:function(i){this.textureCache[i]&&(this.gl.deleteTexture(this.textureCache[i]),delete this.textureCache[i])},copyGLTo2D:tm,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var i=this.gl,o={renderer:"",vendor:""};if(!i)return o;var n=i.getExtension("WEBGL_debug_renderer_info");if(n){var s=i.getParameter(n.UNMASKED_RENDERER_WEBGL),r=i.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(o.renderer=s.toLowerCase()),r&&(o.vendor=r.toLowerCase())}return this.gpuInfo=o,o}}})();function pF(e){var t=e.targetCanvas,i=t.width,o=t.height,n=e.destinationWidth,s=e.destinationHeight;(i!==n||o!==s)&&(t.width=n,t.height=s)}function tm(e,t){var i=e.canvas,o=t.targetCanvas,n=o.getContext("2d");n.translate(0,o.height),n.scale(1,-1);var s=i.height-o.height;n.drawImage(i,0,s,o.width,o.height,0,0,o.width,o.height)}function em(e,t){var i=t.targetCanvas,o=i.getContext("2d"),n=t.destinationWidth,s=t.destinationHeight,r=n*s*4,a=new Uint8Array(this.imageBuffer,0,r),l=new Uint8ClampedArray(this.imageBuffer,0,r);e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,a);var u=new ImageData(l,n,s);o.putImageData(u,0,0)}(function(){"use strict";var e=function(){};b.Canvas2dFilterBackend=t;function t(){}t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(i,o,n,s,r){var a=r.getContext("2d");a.drawImage(o,0,0,n,s);var l=a.getImageData(0,0,n,s),u=a.getImageData(0,0,n,s),c={sourceWidth:n,sourceHeight:s,imageData:l,originalEl:o,originalImageData:u,canvasEl:r,ctx:a,filterBackend:this};return i.forEach(function(h){h.applyTo(c)}),(c.imageData.width!==n||c.imageData.height!==s)&&(r.width=c.imageData.width,r.height=c.imageData.height),a.putImageData(c.imageData,0,0),c}}})();b.Image=b.Image||{};b.Image.filters=b.Image.filters||{};b.Image.filters.BaseFilter=b.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},createProgram:function(e,t,i){t=t||this.fragmentSource,i=i||this.vertexSource,b.webGlPrecision!=="highp"&&(t=t.replace(/precision highp float/g,"precision "+b.webGlPrecision+" float"));var o=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(o,i),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+e.getShaderInfoLog(o));var n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+e.getShaderInfoLog(n));var s=e.createProgram();if(e.attachShader(s,o),e.attachShader(s,n),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+e.getProgramInfoLog(s));var r=this.getAttributeLocations(e,s),a=this.getUniformLocations(e,s)||{};return a.uStepW=e.getUniformLocation(s,"uStepW"),a.uStepH=e.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:r,uniformLocations:a}},getAttributeLocations:function(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(e,t,i){var o=t.aPosition,n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW)},_setupFrameBuffer:function(e){var t=e.context,i,o;e.passes>1?(i=e.destinationWidth,o=e.destinationHeight,(e.sourceWidth!==i||e.sourceHeight!==o)&&(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,i,o)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish())},_swapTextures:function(e){e.passes--,e.pass++;var t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t},isNeutralState:function(){var e=this.mainParameter,t=b.Image.filters[this.type].prototype;if(e)if(Array.isArray(t[e])){for(var i=t[e].length;i--;)if(this[e][i]!==t[e][i])return!1;return!0}else return t[e]===this[e];else return!1},applyTo:function(e){e.webgl?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},retrieveShader:function(e){return e.programCache.hasOwnProperty(this.type)||(e.programCache[this.type]=this.createProgram(e.context)),e.programCache[this.type]},applyToWebGL:function(e){var t=e.context,i=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(i.program),this.sendAttributeData(t,i.attributeLocations,e.aPosition),t.uniform1f(i.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(i.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,i.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(e,t,i){e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)},unbindAdditionalTexture:function(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(e){this[this.mainParameter]=e},sendUniformData:function(){},createHelpLayer:function(e){if(!e.helpLayer){var t=document.createElement("canvas");t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}},toObject:function(){var e={type:this.type},t=this.mainParameter;return t&&(e[t]=this[t]),e},toJSON:function(){return this.toObject()}});b.Image.filters.BaseFilter.fromObject=function(e,t){var i=new b.Image.filters[e.type](e);return t&&t(i),i};(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.ColorMatrix=o(i.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,l=this.matrix,u,c,h,d,g,m=this.colorsOnly;for(g=0;g<a;g+=4)u=r[g],c=r[g+1],h=r[g+2],m?(r[g]=u*l[0]+c*l[1]+h*l[2]+l[4]*255,r[g+1]=u*l[5]+c*l[6]+h*l[7]+l[9]*255,r[g+2]=u*l[10]+c*l[11]+h*l[12]+l[14]*255):(d=r[g+3],r[g]=u*l[0]+c*l[1]+h*l[2]+d*l[3]+l[4]*255,r[g+1]=u*l[5]+c*l[6]+h*l[7]+d*l[8]+l[9]*255,r[g+2]=u*l[10]+c*l[11]+h*l[12]+d*l[13]+l[14]*255,r[g+3]=u*l[15]+c*l[16]+h*l[17]+d*l[18]+l[19]*255)},getUniformLocations:function(n,s){return{uColorMatrix:n.getUniformLocation(s,"uColorMatrix"),uConstants:n.getUniformLocation(s,"uConstants")}},sendUniformData:function(n,s){var r=this.matrix,a=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],l=[r[4],r[9],r[14],r[19]];n.uniformMatrix4fv(s.uColorMatrix,!1,a),n.uniform4fv(s.uConstants,l)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Brightness=o(i.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var s=n.imageData,r=s.data,a,l=r.length,u=Math.round(this.brightness*255);for(a=0;a<l;a+=4)r[a]=r[a]+u,r[a+1]=r[a+1]+u,r[a+2]=r[a+2]+u}},getUniformLocations:function(n,s){return{uBrightness:n.getUniformLocation(s,"uBrightness")}},sendUniformData:function(n,s){n.uniform1f(s.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Convolute=n(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var r=Math.sqrt(this.matrix.length),a=this.type+"_"+r+"_"+(this.opaque?1:0),l=this.fragmentSource[a];return s.programCache.hasOwnProperty(a)||(s.programCache[a]=this.createProgram(s.context,l)),s.programCache[a]},applyTo2d:function(s){var r=s.imageData,a=r.data,l=this.matrix,u=Math.round(Math.sqrt(l.length)),c=Math.floor(u/2),h=r.width,d=r.height,g=s.ctx.createImageData(h,d),m=g.data,y=this.opaque?1:0,C,w,F,B,U,R,W,X,$,st,pt,dt,x;for(pt=0;pt<d;pt++)for(st=0;st<h;st++){for(U=(pt*h+st)*4,C=0,w=0,F=0,B=0,x=0;x<u;x++)for(dt=0;dt<u;dt++)W=pt+x-c,R=st+dt-c,!(W<0||W>=d||R<0||R>=h)&&(X=(W*h+R)*4,$=l[x*u+dt],C+=a[X]*$,w+=a[X+1]*$,F+=a[X+2]*$,y||(B+=a[X+3]*$));m[U]=C,m[U+1]=w,m[U+2]=F,y?m[U+3]=a[U+3]:m[U+3]=B}s.imageData=g},getUniformLocations:function(s,r){return{uMatrix:s.getUniformLocation(r,"uMatrix"),uOpaque:s.getUniformLocation(r,"uOpaque"),uHalfSize:s.getUniformLocation(r,"uHalfSize"),uSize:s.getUniformLocation(r,"uSize")}},sendUniformData:function(s,r){s.uniform1fv(r.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Grayscale=o(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var s=n.imageData,r=s.data,a,l=r.length,u,c=this.mode;for(a=0;a<l;a+=4)c==="average"?u=(r[a]+r[a+1]+r[a+2])/3:c==="lightness"?u=(Math.min(r[a],r[a+1],r[a+2])+Math.max(r[a],r[a+1],r[a+2]))/2:c==="luminosity"&&(u=.21*r[a]+.72*r[a+1]+.07*r[a+2]),r[a]=u,r[a+1]=u,r[a+2]=u},retrieveShader:function(n){var s=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(s)){var r=this.fragmentSource[this.mode];n.programCache[s]=this.createProgram(n.context,r)}return n.programCache[s]},getUniformLocations:function(n,s){return{uMode:n.getUniformLocation(s,"uMode")}},sendUniformData:function(n,s){var r=1;n.uniform1i(s.uMode,r)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Invert=o(i.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var s=n.imageData,r=s.data,a,l=r.length;for(a=0;a<l;a+=4)r[a]=255-r[a],r[a+1]=255-r[a+1],r[a+2]=255-r[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,s){return{uInvert:n.getUniformLocation(s,"uInvert")}},sendUniformData:function(n,s){n.uniform1i(s.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.Noise=n(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var r=s.imageData,a=r.data,l,u=a.length,c=this.noise,h;for(l=0,u=a.length;l<u;l+=4)h=(.5-Math.random())*c,a[l]+=h,a[l+1]+=h,a[l+2]+=h}},getUniformLocations:function(s,r){return{uNoise:s.getUniformLocation(r,"uNoise"),uSeed:s.getUniformLocation(r,"uSeed")}},sendUniformData:function(s,r){s.uniform1f(r.uNoise,this.noise/255),s.uniform1f(r.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Pixelate=o(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var s=n.imageData,r=s.data,a=s.height,l=s.width,u,c,h,d,g,m,y,C,w,F,B;for(c=0;c<a;c+=this.blocksize)for(h=0;h<l;h+=this.blocksize)for(u=c*4*l+h*4,d=r[u],g=r[u+1],m=r[u+2],y=r[u+3],F=Math.min(c+this.blocksize,a),B=Math.min(h+this.blocksize,l),C=c;C<F;C++)for(w=h;w<B;w++)u=C*4*l+w*4,r[u]=d,r[u+1]=g,r[u+2]=m,r[u+3]=y},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,s){return{uBlocksize:n.getUniformLocation(s,"uBlocksize"),uStepW:n.getUniformLocation(s,"uStepW"),uStepH:n.getUniformLocation(s,"uStepH")}},sendUniformData:function(n,s){n.uniform1f(s.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.extend,o=t.Image.filters,n=t.util.createClass;o.RemoveColor=n(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var r=s.imageData,a=r.data,l,u=this.distance*255,c,h,d,g=new t.Color(this.color).getSource(),m=[g[0]-u,g[1]-u,g[2]-u],y=[g[0]+u,g[1]+u,g[2]+u];for(l=0;l<a.length;l+=4)c=a[l],h=a[l+1],d=a[l+2],c>m[0]&&h>m[1]&&d>m[2]&&c<y[0]&&h<y[1]&&d<y[2]&&(a[l+3]=0)},getUniformLocations:function(s,r){return{uLow:s.getUniformLocation(r,"uLow"),uHigh:s.getUniformLocation(r,"uHigh")}},sendUniformData:function(s,r){var a=new t.Color(this.color).getSource(),l=parseFloat(this.distance),u=[0+a[0]/255-l,0+a[1]/255-l,0+a[2]/255-l,1],c=[a[0]/255+l,a[1]/255+l,a[2]/255+l,1];s.uniform4fv(r.uLow,u),s.uniform4fv(r.uHigh,c)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)i[s]=o(i.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),t.Image.filters[s].fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendColor=o(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r;return n.programCache.hasOwnProperty(s)||(r=this.buildSource(this.mode),n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyTo2d:function(n){var s=n.imageData,r=s.data,a=r.length,l,u,c,h,d,g,m,y=1-this.alpha;m=new t.Color(this.color).getSource(),l=m[0]*this.alpha,u=m[1]*this.alpha,c=m[2]*this.alpha;for(var C=0;C<a;C+=4)switch(h=r[C],d=r[C+1],g=r[C+2],this.mode){case"multiply":r[C]=h*l/255,r[C+1]=d*u/255,r[C+2]=g*c/255;break;case"screen":r[C]=255-(255-h)*(255-l)/255,r[C+1]=255-(255-d)*(255-u)/255,r[C+2]=255-(255-g)*(255-c)/255;break;case"add":r[C]=h+l,r[C+1]=d+u,r[C+2]=g+c;break;case"diff":case"difference":r[C]=Math.abs(h-l),r[C+1]=Math.abs(d-u),r[C+2]=Math.abs(g-c);break;case"subtract":r[C]=h-l,r[C+1]=d-u,r[C+2]=g-c;break;case"darken":r[C]=Math.min(h,l),r[C+1]=Math.min(d,u),r[C+2]=Math.min(g,c);break;case"lighten":r[C]=Math.max(h,l),r[C+1]=Math.max(d,u),r[C+2]=Math.max(g,c);break;case"overlay":r[C]=l<128?2*h*l/255:255-2*(255-h)*(255-l)/255,r[C+1]=u<128?2*d*u/255:255-2*(255-d)*(255-u)/255,r[C+2]=c<128?2*g*c/255:255-2*(255-g)*(255-c)/255;break;case"exclusion":r[C]=l+h-2*l*h/255,r[C+1]=u+d-2*u*d/255,r[C+2]=c+g-2*c*g/255;break;case"tint":r[C]=l+h*y,r[C+1]=u+d*y,r[C+2]=c+g*y}},getUniformLocations:function(n,s){return{uColor:n.getUniformLocation(s,"uColor")}},sendUniformData:function(n,s){var r=new t.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,n.uniform4fv(s.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric,i=t.Image.filters,o=t.util.createClass;i.BlendImage=o(i.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,r=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,r)),n.programCache[s]},applyToWebGL:function(n){var s=n.context,r=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(s,r,s.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(n,s){return n.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var n=this.image,s=n._element.width,r=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/s,-n.top/r,1]},applyTo2d:function(n){var s=n.imageData,r=n.filterBackend.resources,a=s.data,l=a.length,u=s.width,c=s.height,h,d,g,m,y,C,w,F,B,U,R=this.image,W;r.blendImage||(r.blendImage=t.util.createCanvasElement()),B=r.blendImage,U=B.getContext("2d"),B.width!==u||B.height!==c?(B.width=u,B.height=c):U.clearRect(0,0,u,c),U.setTransform(R.scaleX,0,0,R.scaleY,R.left,R.top),U.drawImage(R._element,0,0,u,c),W=U.getImageData(0,0,u,c).data;for(var X=0;X<l;X+=4)switch(y=a[X],C=a[X+1],w=a[X+2],F=a[X+3],h=W[X],d=W[X+1],g=W[X+2],m=W[X+3],this.mode){case"multiply":a[X]=y*h/255,a[X+1]=C*d/255,a[X+2]=w*g/255,a[X+3]=F*m/255;break;case"mask":a[X+3]=m;break}},getUniformLocations:function(n,s){return{uTransformMatrix:n.getUniformLocation(s,"uTransformMatrix"),uImage:n.getUniformLocation(s,"uImage")}},sendUniformData:function(n,s){var r=this.calculateMatrix();n.uniform1i(s.uImage,1),n.uniformMatrix3fv(s.uTransformMatrix,!1,r)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(n,s){t.Image.fromObject(n.image,function(r){var a=t.util.object.clone(n);a.image=r,s(new t.Image.filters.BlendImage(a))})}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=Math.pow,o=Math.floor,n=Math.sqrt,s=Math.abs,r=Math.round,a=Math.sin,l=Math.ceil,u=t.Image.filters,c=t.util.createClass;u.Resize=c(u.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(h,d){return{uDelta:h.getUniformLocation(d,"uDelta"),uTaps:h.getUniformLocation(d,"uTaps")}},sendUniformData:function(h,d){h.uniform2fv(d.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),h.uniform1fv(d.uTaps,this.taps)},retrieveShader:function(h){var d=this.getFilterWindow(),g=this.type+"_"+d;if(!h.programCache.hasOwnProperty(g)){var m=this.generateShader(d);h.programCache[g]=this.createProgram(h.context,m)}return h.programCache[g]},getFilterWindow:function(){var h=this.tempScale;return Math.ceil(this.lanczosLobes/h)},getTaps:function(){for(var h=this.lanczosCreate(this.lanczosLobes),d=this.tempScale,g=this.getFilterWindow(),m=new Array(g),y=1;y<=g;y++)m[y-1]=h(y*d);return m},generateShader:function(m){for(var d=new Array(m),g=this.fragmentSourceTOP,m,y=1;y<=m;y++)d[y-1]=y+".0 * uDelta";return g+="uniform float uTaps["+m+`];
`,g+=`void main() {
`,g+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,g+=`  float sum = 1.0;
`,d.forEach(function(C,w){g+="  color += texture2D(uTexture, vTexCoord + "+C+") * uTaps["+w+`];
`,g+="  color += texture2D(uTexture, vTexCoord - "+C+") * uTaps["+w+`];
`,g+="  sum += 2.0 * uTaps["+w+`];
`}),g+=`  gl_FragColor = color / sum;
`,g+="}",g},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(h){h.webgl?(h.passes++,this.width=h.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=h.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),h.destinationWidth=this.dW,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceWidth=h.destinationWidth,this.height=h.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),h.destinationHeight=this.dH,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceHeight=h.destinationHeight):this.applyTo2d(h)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(h){return function(d){if(d>=h||d<=-h)return 0;if(d<11920929e-14&&d>-11920929e-14)return 1;d*=Math.PI;var g=d/h;return a(d)/d*a(g)/g}},applyTo2d:function(h){var d=h.imageData,g=this.scaleX,m=this.scaleY;this.rcpScaleX=1/g,this.rcpScaleY=1/m;var y=d.width,C=d.height,w=r(y*g),F=r(C*m),B;this.resizeType==="sliceHack"?B=this.sliceByTwo(h,y,C,w,F):this.resizeType==="hermite"?B=this.hermiteFastResize(h,y,C,w,F):this.resizeType==="bilinear"?B=this.bilinearFiltering(h,y,C,w,F):this.resizeType==="lanczos"&&(B=this.lanczosResize(h,y,C,w,F)),h.imageData=B},sliceByTwo:function(h,d,g,m,y){var C=h.imageData,w=.5,F=!1,B=!1,U=d*w,R=g*w,W=t.filterBackend.resources,X,$,st=0,pt=0,dt=d,x=0;for(W.sliceByTwo||(W.sliceByTwo=document.createElement("canvas")),X=W.sliceByTwo,(X.width<d*1.5||X.height<g)&&(X.width=d*1.5,X.height=g),$=X.getContext("2d"),$.clearRect(0,0,d*1.5,g),$.putImageData(C,0,0),m=o(m),y=o(y);!F||!B;)d=U,g=R,m<o(U*w)?U=o(U*w):(U=m,F=!0),y<o(R*w)?R=o(R*w):(R=y,B=!0),$.drawImage(X,st,pt,d,g,dt,x,U,R),st=dt,pt=x,x+=R;return $.getImageData(st,pt,m,y)},lanczosResize:function(h,d,g,m,y){function C(I){var k,K,S,_,O,j,q,N,H,Q,ot;for(x.x=(I+.5)*R,P.x=o(x.x),k=0;k<y;k++){for(x.y=(k+.5)*W,P.y=o(x.y),O=0,j=0,q=0,N=0,H=0,K=P.x-st;K<=P.x+st;K++)if(!(K<0||K>=d)){Q=o(1e3*s(K-x.x)),dt[Q]||(dt[Q]={});for(var Y=P.y-pt;Y<=P.y+pt;Y++)Y<0||Y>=g||(ot=o(1e3*s(Y-x.y)),dt[Q][ot]||(dt[Q][ot]=U(n(i(Q*X,2)+i(ot*$,2))/1e3)),S=dt[Q][ot],S>0&&(_=(Y*d+K)*4,O+=S,j+=S*w[_],q+=S*w[_+1],N+=S*w[_+2],H+=S*w[_+3]))}_=(k*m+I)*4,B[_]=j/O,B[_+1]=q/O,B[_+2]=N/O,B[_+3]=H/O}return++I<m?C(I):F}var w=h.imageData.data,F=h.ctx.createImageData(m,y),B=F.data,U=this.lanczosCreate(this.lanczosLobes),R=this.rcpScaleX,W=this.rcpScaleY,X=2/this.rcpScaleX,$=2/this.rcpScaleY,st=l(R*this.lanczosLobes/2),pt=l(W*this.lanczosLobes/2),dt={},x={},P={};return C(0)},bilinearFiltering:function(h,d,g,m,y){var C,w,F,B,U,R,W,X,$,st,pt,dt,x=0,P,I=this.rcpScaleX,k=this.rcpScaleY,K=4*(d-1),S=h.imageData,_=S.data,O=h.ctx.createImageData(m,y),j=O.data;for(W=0;W<y;W++)for(X=0;X<m;X++)for(U=o(I*X),R=o(k*W),$=I*X-U,st=k*W-R,P=4*(R*d+U),pt=0;pt<4;pt++)C=_[P+pt],w=_[P+4+pt],F=_[P+K+pt],B=_[P+K+4+pt],dt=C*(1-$)*(1-st)+w*$*(1-st)+F*st*(1-$)+B*$*st,j[x++]=dt;return O},hermiteFastResize:function(h,d,g,m,y){for(var C=this.rcpScaleX,w=this.rcpScaleY,F=l(C/2),B=l(w/2),U=h.imageData,R=U.data,W=h.ctx.createImageData(m,y),X=W.data,$=0;$<y;$++)for(var st=0;st<m;st++){for(var pt=(st+$*m)*4,dt=0,x=0,P=0,I=0,k=0,K=0,S=0,_=($+.5)*w,O=o($*w);O<($+1)*w;O++)for(var j=s(_-(O+.5))/B,q=(st+.5)*C,N=j*j,H=o(st*C);H<(st+1)*C;H++){var Q=s(q-(H+.5))/F,ot=n(N+Q*Q);ot>1&&ot<-1||(dt=2*ot*ot*ot-3*ot*ot+1,dt>0&&(Q=4*(H+O*d),S+=dt*R[Q+3],P+=dt,R[Q+3]<255&&(dt=dt*R[Q+3]/250),I+=dt*R[Q],k+=dt*R[Q+1],K+=dt*R[Q+2],x+=dt))}X[pt]=I/x,X[pt+1]=k/x,X[pt+2]=K/x,X[pt+3]=S/P}return W},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Contrast=o(i.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var s=n.imageData,r,l,a=s.data,l=a.length,u=Math.floor(this.contrast*255),c=259*(u+255)/(255*(259-u));for(r=0;r<l;r+=4)a[r]=c*(a[r]-128)+128,a[r+1]=c*(a[r+1]-128)+128,a[r+2]=c*(a[r+2]-128)+128}},getUniformLocations:function(n,s){return{uContrast:n.getUniformLocation(s,"uContrast")}},sendUniformData:function(n,s){n.uniform1f(s.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Saturation=o(i.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var s=n.imageData,r=s.data,a=r.length,l=-this.saturation,u,c;for(u=0;u<a;u+=4)c=Math.max(r[u],r[u+1],r[u+2]),r[u]+=c!==r[u]?(c-r[u])*l:0,r[u+1]+=c!==r[u+1]?(c-r[u+1])*l:0,r[u+2]+=c!==r[u+2]?(c-r[u+2])*l:0}},getUniformLocations:function(n,s){return{uSaturation:n.getUniformLocation(s,"uSaturation")}},sendUniformData:function(n,s){n.uniform1f(s.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Vibrance=o(i.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var s=n.imageData,r=s.data,a=r.length,l=-this.vibrance,u,c,h,d;for(u=0;u<a;u+=4)c=Math.max(r[u],r[u+1],r[u+2]),h=(r[u]+r[u+1]+r[u+2])/3,d=Math.abs(c-h)*2/255*l,r[u]+=c!==r[u]?(c-r[u])*d:0,r[u+1]+=c!==r[u+1]?(c-r[u+1])*d:0,r[u+2]+=c!==r[u+2]?(c-r[u+2])*d:0}},getUniformLocations:function(n,s){return{uVibrance:n.getUniformLocation(s,"uVibrance")}},sendUniformData:function(n,s){n.uniform1f(s.uVibrance,-this.vibrance)}}),t.Image.filters.Vibrance.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Blur=o(i.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var s=n.filterBackend.resources,r,a,l=n.imageData.width,u=n.imageData.height;s.blurLayer1||(s.blurLayer1=t.util.createCanvasElement(),s.blurLayer2=t.util.createCanvasElement()),r=s.blurLayer1,a=s.blurLayer2,(r.width!==l||r.height!==u)&&(a.width=r.width=l,a.height=r.height=u);var c=r.getContext("2d"),h=a.getContext("2d"),d=15,g,m,y,C,w=this.blur*.06*.5;for(c.putImageData(n.imageData,0,0),h.clearRect(0,0,l,u),C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=w*m*l+g,h.globalAlpha=1-Math.abs(m),h.drawImage(r,y,g),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);for(C=-d;C<=d;C++)g=(Math.random()-.5)/4,m=C/d,y=w*m*u+g,h.globalAlpha=1-Math.abs(m),h.drawImage(r,g,y),c.drawImage(a,0,0),h.globalAlpha=1,h.clearRect(0,0,a.width,a.height);n.ctx.drawImage(r,0,0);var F=n.ctx.getImageData(0,0,r.width,r.height);return c.globalAlpha=1,c.clearRect(0,0,r.width,r.height),F},getUniformLocations:function(n,s){return{delta:n.getUniformLocation(s,"uDelta")}},sendUniformData:function(n,s){var r=this.chooseRightDelta();n.uniform2fv(s.delta,r)},chooseRightDelta:function(){var n=1,s=[0,0],r;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),r=n*this.blur*.12,this.horizontal?s[0]=r:s[1]=r,s}}),i.Blur.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Gamma=o(i.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var s=n.imageData,r=s.data,a=this.gamma,l=r.length,u=1/a[0],c=1/a[1],h=1/a[2],d;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),d=0,l=256;d<l;d++)this.rVals[d]=Math.pow(d/255,u)*255,this.gVals[d]=Math.pow(d/255,c)*255,this.bVals[d]=Math.pow(d/255,h)*255;for(d=0,l=r.length;d<l;d+=4)r[d]=this.rVals[r[d]],r[d+1]=this.gVals[r[d+1]],r[d+2]=this.bVals[r[d+2]]},getUniformLocations:function(n,s){return{uGamma:n.getUniformLocation(s,"uGamma")}},sendUniformData:function(n,s){n.uniform3fv(s.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.Composed=o(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(n)})},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),t.Image.filters.Composed.fromObject=function(n,s){var r=n.subFilters||[],a=r.map(function(u){return new t.Image.filters[u.type](u)}),l=new t.Image.filters.Composed({subFilters:a});return s&&s(l),l}})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.Image.filters,o=t.util.createClass;i.HueRotation=o(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,s=t.util.cos(n),r=t.util.sin(n),a=1/3,l=Math.sqrt(a)*r,u=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+u/3,this.matrix[1]=a*u-l,this.matrix[2]=a*u+l,this.matrix[5]=a*u+l,this.matrix[6]=s+a*u,this.matrix[7]=a*u-l,this.matrix[10]=a*u-l,this.matrix[11]=a*u+l,this.matrix[12]=s+a*u},isNeutralState:function(n){return this.calculateMatrix(),i.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),i.BaseFilter.prototype.applyTo.call(this,n)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject})(_t);(function(e){"use strict";var t=e.fabric||(e.fabric={}),i=t.util.object.clone;if(t.Text){t.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat(o),cacheProperties:t.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,s){this.styles=s?s.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=t.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,s,r,a,l,u,c,h=0,d=this._textLines.length;h<d;h++)if(!(this.textAlign!=="justify"&&(h===d-1||this.isEndOfWrapping(h)))&&(a=0,l=this._textLines[h],s=this.getLineWidth(h),s<this.width&&(c=this.textLines[h].match(this._reSpacesAndTabs)))){r=c.length,n=(this.width-s)/r;for(var g=0,m=l.length;g<=m;g++)u=this.__charBounds[h][g],this._reSpaceAndTab.test(l[g])?(u.width+=n,u.kernedWidth+=n,u.left+=a,a+=n):u.left+=a}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return n.width+=s*n.zoomX,n.height+=s*n.zoomY,n},_render:function(n){var s=this.path;s&&!s.isNotVisible()&&s._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,s,r){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(s,r)},calcTextWidth:function(){for(var n=this.getLineWidth(0),s=1,r=this._textLines.length;s<r;s++){var a=this.getLineWidth(s);a>n&&(n=a)}return n},_renderTextLine:function(n,s,r,a,l,u){this._renderChars(n,s,r,a,l,u)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var s,r,a=n.fillStyle,l,u,c=this._getLeftOffset(),h=this._getTopOffset(),d=0,g=0,m,y,C=this.path,w,F=0,B=this._textLines.length;F<B;F++){if(s=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){h+=s;continue}l=this._textLines[F],r=this._getLineLeftOffset(F),g=0,d=0,u=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var U=0,R=l.length;U<R;U++)m=this.__charBounds[F][U],y=this.getValueOfPropertyAt(F,U,"textBackgroundColor"),C?(n.save(),n.translate(m.renderLeft,m.renderTop),n.rotate(m.angle),n.fillStyle=y,y&&n.fillRect(-m.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),m.width,s/this.lineHeight),n.restore()):y!==u?(w=c+r+d,this.direction==="rtl"&&(w=this.width-w-g),n.fillStyle=u,u&&n.fillRect(w,h,g,s/this.lineHeight),d=m.left,g=m.width,u=y):g+=m.kernedWidth;y&&!C&&(w=c+r+d,this.direction==="rtl"&&(w=this.width-w-g),n.fillStyle=y,n.fillRect(w,h,g,s/this.lineHeight)),h+=s}n.fillStyle=a,this._removeShadow(n)}},getFontCache:function(n){var s=n.fontFamily.toLowerCase();t.charWidthsCache[s]||(t.charWidthsCache[s]={});var r=t.charWidthsCache[s],a=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return r[a]||(r[a]={}),r[a]},_measureChar:function(n,s,r,a){var l=this.getFontCache(s),u=this._getFontDeclaration(s),c=this._getFontDeclaration(a),h=r+n,d=u===c,g,m,y,C=s.fontSize/this.CACHE_FONT_SIZE,w;if(r&&l[r]!==void 0&&(y=l[r]),l[n]!==void 0&&(w=g=l[n]),d&&l[h]!==void 0&&(m=l[h],w=m-y),g===void 0||y===void 0||m===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,s,!0)}return g===void 0&&(w=g=F.measureText(n).width,l[n]=g),y===void 0&&d&&r&&(y=F.measureText(r).width,l[r]=y),d&&m===void 0&&(m=F.measureText(h).width,l[h]=m,w=m-y),{width:g*C,kernedWidth:w*C}},getHeightOfChar:function(n,s){return this.getValueOfPropertyAt(n,s,"fontSize")},measureLine:function(n){var s=this._measureLine(n);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(n){var s=0,r,a,l=this._textLines[n],u,c,h=0,d=new Array(l.length),g=0,m,y,C=this.path,w=this.pathSide==="right";for(this.__charBounds[n]=d,r=0;r<l.length;r++)a=l[r],c=this._getGraphemeBox(a,n,r,u),d[r]=c,s+=c.kernedWidth,u=a;if(d[r]={left:c?c.left+c.width:0,width:0,kernedWidth:0,height:this.fontSize},C){switch(y=C.segmentsInfo[C.segmentsInfo.length-1].length,m=t.util.getPointOnPath(C.path,0,C.segmentsInfo),m.x+=C.pathOffset.x,m.y+=C.pathOffset.y,this.textAlign){case"left":g=w?y-s:0;break;case"center":g=(y-s)/2;break;case"right":g=w?0:y-s;break}for(g+=this.pathStartOffset*(w?-1:1),r=w?l.length-1:0;w?r>=0:r<l.length;w?r--:r++)c=d[r],g>y?g%=y:g<0&&(g+=y),this._setGraphemeOnPath(g,c,m),g+=c.kernedWidth}return{width:s,numOfSpaces:h}},_setGraphemeOnPath:function(n,s,r){var a=n+s.kernedWidth/2,l=this.path,u=t.util.getPointOnPath(l.path,a,l.segmentsInfo);s.renderLeft=u.x-r.x,s.renderTop=u.y-r.y,s.angle=u.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,s,r,a,l){var u=this.getCompleteStyleDeclaration(s,r),c=a?this.getCompleteStyleDeclaration(s,r-1):{},h=this._measureChar(n,u,a,c),d=h.kernedWidth,g=h.width,m;this.charSpacing!==0&&(m=this._getWidthOfCharSpacing(),g+=m,d+=m);var y={width:g,left:0,height:u.fontSize,kernedWidth:d,deltaY:u.deltaY};if(r>0&&!l){var C=this.__charBounds[s][r-1];y.left=C.left+C.width+h.kernedWidth-h.width}return y},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var s=this._textLines[n],r=this.getHeightOfChar(n,0),a=1,l=s.length;a<l;a++)r=Math.max(this.getHeightOfChar(n,a),r);return this.__lineHeights[n]=r*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,s=0,r=0,a=this._textLines.length;r<a;r++)n=this.getHeightOfLine(r),s+=r===a-1?n/this.lineHeight:n;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,s){n.save();for(var r=0,a=this._getLeftOffset(),l=this._getTopOffset(),u=0,c=this._textLines.length;u<c;u++){var h=this.getHeightOfLine(u),d=h/this.lineHeight,g=this._getLineLeftOffset(u);this._renderTextLine(s,n,this._textLines[u],a+g,l+r+d,u),r+=h}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,s,r,a,l,u){var c=this.getHeightOfLine(u),h=this.textAlign.indexOf("justify")!==-1,d,g,m="",y,C=0,w,F=this.path,B=!h&&this.charSpacing===0&&this.isEmptyStyles(u)&&!F,U=this.direction==="ltr",R=this.direction==="ltr"?1:-1,W,X=s.canvas.getAttribute("dir");if(s.save(),X!==this.direction&&(s.canvas.setAttribute("dir",U?"ltr":"rtl"),s.direction=U?"ltr":"rtl",s.textAlign=U?"left":"right"),l-=c*this._fontSizeFraction/this.lineHeight,B){this._renderChar(n,s,u,0,r.join(""),a,l,c),s.restore();return}for(var $=0,st=r.length-1;$<=st;$++)w=$===st||this.charSpacing||F,m+=r[$],y=this.__charBounds[u][$],C===0?(a+=R*(y.kernedWidth-y.width),C+=y.width):C+=y.kernedWidth,h&&!w&&this._reSpaceAndTab.test(r[$])&&(w=!0),w||(d=d||this.getCompleteStyleDeclaration(u,$),g=this.getCompleteStyleDeclaration(u,$+1),w=t.util.hasStyleChanged(d,g,!1)),w&&(F?(s.save(),s.translate(y.renderLeft,y.renderTop),s.rotate(y.angle),this._renderChar(n,s,u,$,m,-C/2,0,c),s.restore()):(W=a,this._renderChar(n,s,u,$,m,W,l,c)),m="",d=g,a+=R*C,C=0);s.restore()},_applyPatternGradientTransformText:function(n){var s=t.util.createCanvasElement(),r,a=this.width+this.strokeWidth,l=this.height+this.strokeWidth;return s.width=a,s.height=l,r=s.getContext("2d"),r.beginPath(),r.moveTo(0,0),r.lineTo(a,0),r.lineTo(a,l),r.lineTo(0,l),r.closePath(),r.translate(a/2,l/2),r.fillStyle=n.toLive(r),this._applyPatternGradientTransform(r,n),r.fill(),r.createPattern(s,"no-repeat")},handleFiller:function(n,s,r){var a,l;return r.toLive?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(a=-this.width/2,l=-this.height/2,n.translate(a,l),n[s]=this._applyPatternGradientTransformText(r),{offsetX:a,offsetY:l}):(n[s]=r.toLive(n,this),this._applyPatternGradientTransform(n,r)):(n[s]=r,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,s){return n.lineWidth=s.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",s.stroke)},_setFillStyles:function(n,s){return this.handleFiller(n,"fillStyle",s.fill)},_renderChar:function(n,s,r,a,l,u,c){var h=this._getStyleDeclaration(r,a),d=this.getCompleteStyleDeclaration(r,a),g=n==="fillText"&&d.fill,m=n==="strokeText"&&d.stroke&&d.strokeWidth,y,C;!m&&!g||(s.save(),g&&(y=this._setFillStyles(s,d)),m&&(C=this._setStrokeStyles(s,d)),s.font=this._getFontDeclaration(d),h&&h.textBackgroundColor&&this._removeShadow(s),h&&h.deltaY&&(c+=h.deltaY),g&&s.fillText(l,u-y.offsetX,c-y.offsetY),m&&s.strokeText(l,u-C.offsetX,c-C.offsetY),s.restore())},setSuperscript:function(n,s){return this._setScript(n,s,this.superscript)},setSubscript:function(n,s){return this._setScript(n,s,this.subscript)},_setScript:function(n,s,r){var a=this.get2DCursorLocation(n,!0),l=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY"),c={fontSize:l*r.size,deltaY:u+l*r.baseline};return this.setSelectionStyles(c,n,s),this},_getLineLeftOffset:function(n){var s=this.getLineWidth(n),r=this.width-s,a=this.textAlign,l=this.direction,c,u=0,c=this.isEndOfWrapping(n);return a==="justify"||a==="justify-center"&&!c||a==="justify-right"&&!c||a==="justify-left"&&!c?0:(a==="center"&&(u=r/2),a==="right"&&(u=r),a==="justify-center"&&(u=r/2),a==="justify-right"&&(u=r),l==="rtl"&&(u-=r),u)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var s=this.measureLine(n),r=s.width;return this.__lineWidths[n]=r,r},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,s,r){var a=this._getStyleDeclaration(n,s);return a&&typeof a[r]<"u"?a[r]:this[r]},_renderTextDecoration:function(n,s){if(!(!this[s]&&!this.styleHas(s))){for(var r,a,l,u,c,h,d,g,m=this._getLeftOffset(),y=this._getTopOffset(),C,w,F,B,U,R,W,X,$=this.path,st=this._getWidthOfCharSpacing(),pt=this.offsets[s],dt=0,x=this._textLines.length;dt<x;dt++){if(r=this.getHeightOfLine(dt),!this[s]&&!this.styleHas(s,dt)){y+=r;continue}d=this._textLines[dt],R=r/this.lineHeight,u=this._getLineLeftOffset(dt),w=0,F=0,g=this.getValueOfPropertyAt(dt,0,s),X=this.getValueOfPropertyAt(dt,0,"fill"),C=y+R*(1-this._fontSizeFraction),a=this.getHeightOfChar(dt,0),c=this.getValueOfPropertyAt(dt,0,"deltaY");for(var P=0,I=d.length;P<I;P++)if(B=this.__charBounds[dt][P],U=this.getValueOfPropertyAt(dt,P,s),W=this.getValueOfPropertyAt(dt,P,"fill"),l=this.getHeightOfChar(dt,P),h=this.getValueOfPropertyAt(dt,P,"deltaY"),$&&U&&W)n.save(),n.fillStyle=X,n.translate(B.renderLeft,B.renderTop),n.rotate(B.angle),n.fillRect(-B.kernedWidth/2,pt*l+h,B.kernedWidth,this.fontSize/15),n.restore();else if((U!==g||W!==X||l!==a||h!==c)&&F>0){var k=m+u+w;this.direction==="rtl"&&(k=this.width-k-F),g&&X&&(n.fillStyle=X,n.fillRect(k,C+pt*a+c,F,this.fontSize/15)),w=B.left,F=B.width,g=U,X=W,a=l,c=h}else F+=B.kernedWidth;var k=m+u+w;this.direction==="rtl"&&(k=this.width-k-F),n.fillStyle=W,U&&W&&n.fillRect(k,C+pt*a+c,F-st,this.fontSize/15),y+=r}this._removeShadow(n)}},_getFontDeclaration:function(n,s){var r=n||this,a=this.fontFamily,l=t.Text.genericFonts.indexOf(a.toLowerCase())>-1,u=a===void 0||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||l?r.fontFamily:'"'+r.fontFamily+'"';return[t.isLikelyNode?r.fontWeight:r.fontStyle,t.isLikelyNode?r.fontStyle:r.fontWeight,s?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",u].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var s=n.split(this._reNewline),r=new Array(s.length),a=[`
`],l=[],u=0;u<s.length;u++)r[u]=t.util.string.graphemeSplit(s[u]),l=l.concat(r[u],a);return l.pop(),{_unwrappedLines:r,lines:s,graphemeText:l,graphemeLines:r}},toObject:function(n){var s=o.concat(n),r=this.callSuper("toObject",s);return r.styles=t.util.stylesToArray(this.styles,this.text),r.path&&(r.path=this.path.toObject()),r},set:function(n,s){this.callSuper("set",n,s);var r=!1,a=!1;if(typeof n=="object")for(var l in n)l==="path"&&this.setPathInfo(),r=r||this._dimensionAffectingProps.indexOf(l)!==-1,a=a||l==="path";else r=this._dimensionAffectingProps.indexOf(n)!==-1,a=n==="path";return a&&this.setPathInfo(),r&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(n,s,r){if(!n)return s(null);var a=t.parseAttributes(n,t.Text.ATTRIBUTE_NAMES),l=a.textAnchor||"left";if(r=t.util.object.extend(r?i(r):{},a),r.top=r.top||0,r.left=r.left||0,a.textDecoration){var u=a.textDecoration;u.indexOf("underline")!==-1&&(r.underline=!0),u.indexOf("overline")!==-1&&(r.overline=!0),u.indexOf("line-through")!==-1&&(r.linethrough=!0),delete r.textDecoration}"dx"in a&&(r.left+=a.dx),"dy"in a&&(r.top+=a.dy),"fontSize"in r||(r.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var c="";"textContent"in n?c=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(c=n.firstChild.data),c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var h=r.strokeWidth;r.strokeWidth=0;var d=new t.Text(c,r),g=d.getScaledHeight()/d.height,m=(d.height+d.strokeWidth)*d.lineHeight-d.height,y=m*g,C=d.getScaledHeight()+y,w=0;l==="center"&&(w=d.getScaledWidth()/2),l==="right"&&(w=d.getScaledWidth()),d.set({left:d.left-w,top:d.top-(C-d.fontSize*(.07+d._fontSizeFraction))/d.lineHeight,strokeWidth:typeof h<"u"?h:1}),s(d)},t.Text.fromObject=function(n,s){var r=i(n),a=n.path;return delete r.path,t.Object._fromObject("Text",r,function(l){l.styles=t.util.stylesFromArray(n.styles,n.text),a?t.Object._fromObject("Path",a,function(u){l.set("path",u),s(l)},"path"):s(l)},"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text)})(_t);(function(){b.util.object.extend(b.Text.prototype,{isEmptyStyles:function(e){if(!this.styles||typeof e<"u"&&!this.styles[e])return!0;var t=typeof e>"u"?this.styles:{line:this.styles[e]};for(var i in t)for(var o in t[i])for(var n in t[i][o])return!1;return!0},styleHas:function(e,t){if(!this.styles||!e||e===""||typeof t<"u"&&!this.styles[t])return!1;var i=typeof t>"u"?this.styles:{0:this.styles[t]};for(var o in i)for(var n in i[o])if(typeof i[o][n][e]<"u")return!0;return!1},cleanStyle:function(e){if(!this.styles||!e||e==="")return!1;var t=this.styles,i=0,o,n,s=!0,r=0,a;for(var l in t){o=0;for(var u in t[l]){var a=t[l][u],c=a.hasOwnProperty(e);i++,c?(n?a[e]!==n&&(s=!1):n=a[e],a[e]===this[e]&&delete a[e]):s=!1,Object.keys(a).length!==0?o++:delete t[l][u]}o===0&&delete t[l]}for(var h=0;h<this._textLines.length;h++)r+=this._textLines[h].length;s&&i===r&&(this[e]=n,this.removeStyle(e))},removeStyle:function(e){if(!(!this.styles||!e||e==="")){var t=this.styles,i,o,n;for(o in t){i=t[o];for(n in i)delete i[n][e],Object.keys(i[n]).length===0&&delete i[n];Object.keys(i).length===0&&delete t[o]}}},_extendStyles:function(e,t){var i=this.get2DCursorLocation(e);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),b.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),t)},get2DCursorLocation:function(e,t){typeof e>"u"&&(e=this.selectionStart);for(var i=t?this._unwrappedTextLines:this._textLines,o=i.length,n=0;n<o;n++){if(e<=i[n].length)return{lineIndex:n,charIndex:e};e-=i[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:i[n-1].length<e?i[n-1].length:e}},getSelectionStyles:function(e,t,i){typeof e>"u"&&(e=this.selectionStart||0),typeof t>"u"&&(t=this.selectionEnd||e);for(var o=[],n=e;n<t;n++)o.push(this.getStyleAtPosition(n,i));return o},getStyleAtPosition:function(e,t){var i=this.get2DCursorLocation(e),o=t?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex);return o||{}},setSelectionStyles:function(e,t,i){typeof t>"u"&&(t=this.selectionStart||0),typeof i>"u"&&(i=this.selectionEnd||t);for(var o=t;o<i;o++)this._extendStyles(o,e);return this._forceClearCache=!0,this},_getStyleDeclaration:function(e,t){var i=this.styles&&this.styles[e];return i?i[t]:null},getCompleteStyleDeclaration:function(e,t){for(var i=this._getStyleDeclaration(e,t)||{},o={},n,s=0;s<this._styleProperties.length;s++)n=this._styleProperties[s],o[n]=typeof i[n]>"u"?this[n]:i[n];return o},_setStyleDeclaration:function(e,t,i){this.styles[e][t]=i},_deleteStyleDeclaration:function(e,t){delete this.styles[e][t]},_getLineStyle:function(e){return!!this.styles[e]},_setLineStyle:function(e){this.styles[e]={}},_deleteLineStyle:function(e){delete this.styles[e]}})})();(function(){function e(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}b.IText=b.util.createClass(b.Text,b.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,i){this.callSuper("initialize",t,i),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,i){this[t]!==i&&(this._fireSelectionChanged(),this[t]=i),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var i=this.canvas.contextTop,o=this.canvas.viewportTransform;i.save(),i.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(i),this._clearTextArea(i),t||i.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var t=this._getCursorBoundaries(),i=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,i):this.renderSelection(t,i),i.restore()}},_clearTextArea:function(t){var i=this.width+4,o=this.height+4;t.clearRect(-i/2,-o/2,i,o)},_getCursorBoundaries:function(t){typeof t>"u"&&(t=this.selectionStart);var i=this._getLeftOffset(),o=this._getTopOffset(),n=this._getCursorBoundariesOffsets(t);return{left:i,top:o,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var i,o,n,s=0,r=0,a,l=this.get2DCursorLocation(t);n=l.charIndex,o=l.lineIndex;for(var u=0;u<o;u++)s+=this.getHeightOfLine(u);i=this._getLineLeftOffset(o);var c=this.__charBounds[o][n];return c&&(r=c.left),this.charSpacing!==0&&n===this._textLines[o].length&&(r-=this._getWidthOfCharSpacing()),a={top:s,left:i+(r>0?r:0)},this.direction==="rtl"&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(t,i){var o=this.get2DCursorLocation(),n=o.lineIndex,s=o.charIndex>0?o.charIndex-1:0,r=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.scaleX*this.canvas.getZoom(),l=this.cursorWidth/a,u=t.topOffset,c=this.getValueOfPropertyAt(n,s,"deltaY");u+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-r*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,i),i.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),i.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,i.fillRect(t.left+t.leftOffset-l/2,u+t.top+c,l,r)},renderSelection:function(t,i){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,r=this.get2DCursorLocation(o),a=this.get2DCursorLocation(n),l=r.lineIndex,u=a.lineIndex,c=r.charIndex<0?0:r.charIndex,h=a.charIndex<0?0:a.charIndex,d=l;d<=u;d++){var g=this._getLineLeftOffset(d)||0,m=this.getHeightOfLine(d),y=0,C=0,w=0;if(d===l&&(C=this.__charBounds[l][c].left),d>=l&&d<u)w=s&&!this.isEndOfWrapping(d)?this.width:this.getLineWidth(d)||5;else if(d===u)if(h===0)w=this.__charBounds[u][h].left;else{var F=this._getWidthOfCharSpacing();w=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-F}y=m,(this.lineHeight<1||d===u&&this.lineHeight>1)&&(m/=this.lineHeight);var B=t.left+g+C,U=w-C,R=m,W=0;this.inCompositionMode?(i.fillStyle=this.compositionColor||"black",R=1,W=m):i.fillStyle=this.selectionColor,this.direction==="rtl"&&(B=this.width-B-U),i.fillRect(B,t.top+t.topOffset+W,U,R),t.topOffset+=y}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),i=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:i}}}),b.IText.fromObject=function(t,i){var o=b.util.stylesFromArray(t.styles,t.text),n=Object.assign({},t,{styles:o});if(e(n),n.styles)for(var s in n.styles)for(var r in n.styles[s])e(n.styles[s][r]);b.Object._fromObject("IText",n,i,"text")}})();(function(){var e=b.util.object.clone;b.util.object.extend(b.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",function(){var i=t.canvas;i&&(i._hasITextHandlers||(i._hasITextHandlers=!0,t._initCanvasHandlers(i)),i._iTextInstances=i._iTextInstances||[],i._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var i=t.canvas;i&&(i._iTextInstances=i._iTextInstances||[],b.util.removeFromArray(i._iTextInstances,t),i._iTextInstances.length===0&&(i._hasITextHandlers=!1,t._removeCanvasHandlers(i)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.__isMousedown=!1})},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,i,o,n){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",i,{duration:o,onComplete:function(){s.isAborted||t[n]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var i=this,o=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){i._tick()},o)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,i=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&i&&i.clearContext(i.contextTop||i.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var i=0,o=t-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o--;for(;/\S/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findWordBoundaryRight:function(t){var i=0,o=t;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)i++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},findLineBoundaryLeft:function(t){for(var i=0,o=t-1;!/\n/.test(this._text[o])&&o>-1;)i++,o--;return t-i},findLineBoundaryRight:function(t){for(var i=0,o=t;!/\n/.test(this._text[o])&&o<this._text.length;)i++,o++;return t+i},searchWordBoundary:function(t,i){for(var o=this._text,n=this._reSpace.test(o[t])?t-1:t,s=o[n],r=b.reNonWord;!r.test(s)&&n>0&&n<o.length;)n+=i,s=o[n];return r.test(s)&&(n+=i===1?0:1),n},selectWord:function(t){t=t||this.selectionStart;var i=this.searchWordBoundary(t,-1),o=this.searchWordBoundary(t,1);this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var i=this.findLineBoundaryLeft(t),o=this.findLineBoundaryRight(t);return this.selectionStart=i,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(i){i.selected=!1,i.isEditing&&i.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var i=this.getSelectionStartFromPointer(t.e),o=this.selectionStart,n=this.selectionEnd;(i!==this.__selectionStartOnMouseDown||o===n)&&(o===i||n===i)||(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,i,o){var n=o.slice(0,t),s=b.util.string.graphemeSplit(n).length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=b.util.string.graphemeSplit(r).length;return{selectionStart:s,selectionEnd:s+a}},fromGraphemeToStringSelection:function(t,i,o){var n=o.slice(0,t),s=n.join("").length;if(t===i)return{selectionStart:s,selectionEnd:s};var r=o.slice(t,i),a=r.join("").length;return{selectionStart:s,selectionEnd:s+a}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,i=this._getCursorBoundaries(t),o=this.get2DCursorLocation(t),n=o.lineIndex,s=o.charIndex,r=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=i.leftOffset,l=this.calcTransformMatrix(),u={x:i.left+a,y:i.top+i.topOffset+r},c=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/c,g=h.height/c,m=d-r,y=g-r,C=h.clientWidth/d,w=h.clientHeight/g;return u=b.util.transformPoint(u,l),u=b.util.transformPoint(u,this.canvas.viewportTransform),u.x*=C,u.y*=w,u.x<0&&(u.x=0),u.x>m&&(u.x=m),u.y<0&&(u.y=0),u.y>y&&(u.y=y),u.x+=this.canvas._offset.left,u.y+=this.canvas._offset.top,{left:u.x+"px",top:u.y+"px",fontSize:r+"px",charHeight:r}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,i=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,i&&(i.blur&&i.blur(),i.parentNode&&i.parentNode.removeChild(i)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,i){var o=this.get2DCursorLocation(t,!0),n=this.get2DCursorLocation(i,!0),s=o.lineIndex,r=o.charIndex,a=n.lineIndex,l=n.charIndex,u,c;if(s!==a){if(this.styles[s])for(u=r;u<this._unwrappedTextLines[s].length;u++)delete this.styles[s][u];if(this.styles[a])for(u=l;u<this._unwrappedTextLines[a].length;u++)c=this.styles[a][u],c&&(this.styles[s]||(this.styles[s]={}),this.styles[s][r+u-l]=c);for(u=s+1;u<=a;u++)delete this.styles[u];this.shiftLineStyles(a,s-a)}else if(this.styles[s]){c=this.styles[s];var h=l-r,d,g;for(u=r;u<l;u++)delete c[u];for(g in this.styles[s])d=parseInt(g,10),d>=l&&(c[d-h]=c[g],delete c[g])}},shiftLineStyles:function(t,i){var o=e(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>t&&(this.styles[s+i]=o[s],o[s-i]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(t,i,o,n){var s,r={},a=!1,l=this._unwrappedTextLines[t].length===i;o||(o=1),this.shiftLineStyles(t,o),this.styles[t]&&(s=this.styles[t][i===0?i:i-1]);for(var u in this.styles[t]){var c=parseInt(u,10);c>=i&&(a=!0,r[c-i]=this.styles[t][u],l&&i===0||delete this.styles[t][u])}var h=!1;for(a&&!l&&(this.styles[t+o]=r,h=!0),h&&o--;o>0;)n&&n[o-1]?this.styles[t+o]={0:e(n[o-1])}:s?this.styles[t+o]={0:e(s)}:delete this.styles[t+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(t,i,o,n){this.styles||(this.styles={});var s=this.styles[t],r=s?e(s):{};o||(o=1);for(var a in r){var l=parseInt(a,10);l>=i&&(s[l+o]=r[l],r[l-o]||delete s[l])}if(this._forceClearCache=!0,n){for(;o--;)Object.keys(n[o]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][i+o]=e(n[o]));return}if(s)for(var u=s[i?i-1:1];u&&o--;)this.styles[t][i+o]=e(u)},insertNewStyleBlock:function(t,i,o){for(var n=this.get2DCursorLocation(i,!0),s=[0],r=0,a=0;a<t.length;a++)t[a]===`
`?(r++,s[r]=0):s[r]++;s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],o),o=o&&o.slice(s[0]+1)),r&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],r);for(var a=1;a<r;a++)s[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,s[a],o):o&&this.styles[n.lineIndex+a]&&o[0]&&(this.styles[n.lineIndex+a][0]=o[0]),o=o&&o.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,s[a],o)},setSelectionStartEndWithShift:function(t,i,o){o<=t?(i===t?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=o):o>t&&o<i?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(i===t?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=i),this.selectionEnd=o)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})})();b.util.object.extend(b.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(e){if(this.canvas){this.__newClickTime=+new Date;var t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))},tripleClickHandler:function(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(e.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(e){!this.canvas||!this.editable||e.e.button&&e.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(e){if(this.__isMousedown=!1,!(!this.editable||this.group||e.transform&&e.transform.actionPerformed||e.e.button&&e.e.button!==1)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e),i=this.selectionStart,o=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(i,o,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(e){for(var t=this.getLocalPointer(e),i=0,o=0,n=0,s=0,r=0,a,l,u=0,c=this._textLines.length;u<c&&n<=t.y;u++)n+=this.getHeightOfLine(u)*this.scaleY,r=u,u>0&&(s+=this._textLines[u-1].length+this.missingNewlineOffset(u-1));a=this._getLineLeftOffset(r),o=a*this.scaleX,l=this._textLines[r],this.direction==="rtl"&&(t.x=this.width*this.scaleX-t.x+o);for(var h=0,d=l.length;h<d&&(i=o,o+=this.__charBounds[r][h].kernedWidth*this.scaleX,o<=t.x);h++)s++;return this._getNewSelectionStartFromOffset(t,i,o,s,d)},_getNewSelectionStartFromOffset:function(e,t,i,o,n){var s=e.x-t,r=i-e.x,a=r>s||r<0?0:1,l=o+a;return this.flipX&&(l=n-l),l>this._text.length&&(l=this._text.length),l}});b.util.object.extend(b.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=b.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+e.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):b.document.body.appendChild(this.hiddenTextarea),b.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),b.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),b.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),b.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),b.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),b.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),b.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),b.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),b.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(b.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){var t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else if(e.keyCode in this.ctrlKeysMapDown&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapDown[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(e){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey))this[this.ctrlKeysMapUp[e.keyCode]](e);else return;e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(e){var t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!!this.isEditing){var i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,n=i.length,s,r,a=n-o,l=this.selectionStart,u=this.selectionEnd,c=l!==u,h,d,g;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var m=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=l>m.selectionStart;c?(s=this._text.slice(l,u),a+=u-l):n<o&&(y?s=this._text.slice(u+a,u):s=this._text.slice(l,l-a)),r=i.slice(m.selectionEnd-a,m.selectionEnd),s&&s.length&&(r.length&&(h=this.getSelectionStyles(l,l+1,!1),h=r.map(function(){return h[0]})),c?(d=l,g=u):y?(d=u-s.length,g=u):(d=u,g=u+s.length),this.removeStyleFromTo(d,g)),r.length&&(t&&r.join("")===b.copiedText&&!b.disableStyleCopyPaste&&(h=b.copiedTextStyle),this.insertNewStyleBlock(r,l,h)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(e){this.compositionStart=e.target.selectionStart,this.compositionEnd=e.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(b.copiedText=this.getSelectedText(),b.disableStyleCopyPaste?b.copiedTextStyle=null:b.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(e){return e&&e.clipboardData||b.window.clipboardData},_getWidthBeforeCursor:function(e,t){var i=this._getLineLeftOffset(e),o;return t>0&&(o=this.__charBounds[e][t-1],i+=o.left+o.width),i},getDownCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,r),l=this._textLines[n].slice(s);return l.length+a+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(e,t){var i=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(i),n=o.lineIndex;if(n===0||e.metaKey||e.keyCode===33)return-i;var s=o.charIndex,r=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,r),l=this._textLines[n].slice(0,s),u=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-l.length+(1-u)},_getIndexOnLine:function(e,t){for(var i=this._textLines[e],o=this._getLineLeftOffset(e),n=o,s=0,r,a,l=0,u=i.length;l<u;l++)if(r=this.__charBounds[e][l].width,n+=r,n>t){a=!0;var c=n-r,h=n,d=Math.abs(c-t),g=Math.abs(h-t);s=g<d?l:l-1;break}return a||(s=i.length-1),s},moveCursorDown:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)},moveCursorUp:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)},_moveCursorUpOrDown:function(e,t){var i="get"+e+"CursorOffset",o=this[i](t,this._selectionDirection==="right");t.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(e){var t=this._selectionDirection==="left"?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0},moveCursorWithoutShift:function(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0},moveCursorLeft:function(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)},_move:function(e,t,i){var o;if(e.altKey)o=this["findWordBoundary"+i](this[t]);else if(e.metaKey||e.keyCode===35||e.keyCode===36)o=this["findLineBoundary"+i](this[t]);else return this[t]+=i==="Left"?-1:1,!0;if(typeof o<"u"&&this[t]!==o)return this[t]=o,!0},_moveLeft:function(e,t){return this._move(e,t,"Left")},_moveRight:function(e,t){return this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(e){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(e,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(e,"selectionStart")},moveCursorRight:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)},_moveCursorLeftOrRight:function(e,t){var i="moveCursor"+e+"With";this._currentCursorOpacity=1,t.shiftKey?i+="Shift":i+="outShift",this[i](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(e){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(e,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(e,"selectionEnd")},moveCursorRightWithoutShift:function(e){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(e,t){typeof t>"u"&&(t=e+1),this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(e,t,i,o){typeof o>"u"&&(o=i),o>i&&this.removeStyleFromTo(i,o);var n=b.util.string.graphemeSplit(e);this.insertNewStyleBlock(n,i,t),this._text=[].concat(this._text.slice(0,i),n,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var e=b.util.toFixed,t=/  +/g;b.util.object.extend(b.Text.prototype,{_toSVG:function(){var i=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(i){return this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(i){var o=!0,n=this.getSvgTextDecoration(this);return[i.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",i.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(i,o){var n=[],s=[],r=i,a;this._setSVGBg(s);for(var l=0,u=this._textLines.length;l<u;l++)a=this._getLineLeftOffset(l),(this.textBackgroundColor||this.styleHas("textBackgroundColor",l))&&this._setSVGTextLineBg(s,l,o+a,r),this._setSVGTextLineText(n,l,o+a,r),r+=this.getHeightOfLine(l);return{textSpans:n,textBgRects:s}},_createTextCharSpan:function(i,o,n,s){var r=i!==i.trim()||i.match(t),a=this.getSvgSpanStyles(o,r),l=a?'style="'+a+'"':"",u=o.deltaY,c="",h=b.Object.NUM_FRACTION_DIGITS;return u&&(c=' dy="'+e(u,h)+'" '),['<tspan x="',e(n,h),'" y="',e(s,h),'" ',c,l,">",b.util.string.escapeXml(i),"</tspan>"].join("")},_setSVGTextLineText:function(i,o,n,s){var r=this.getHeightOfLine(o),a=this.textAlign.indexOf("justify")!==-1,l,u,c="",h,d,g=0,m=this._textLines[o],y;s+=r*(1-this._fontSizeFraction)/this.lineHeight;for(var C=0,w=m.length-1;C<=w;C++)y=C===w||this.charSpacing,c+=m[C],h=this.__charBounds[o][C],g===0?(n+=h.kernedWidth-h.width,g+=h.width):g+=h.kernedWidth,a&&!y&&this._reSpaceAndTab.test(m[C])&&(y=!0),y||(l=l||this.getCompleteStyleDeclaration(o,C),u=this.getCompleteStyleDeclaration(o,C+1),y=b.util.hasStyleChanged(l,u,!0)),y&&(d=this._getStyleDeclaration(o,C)||{},i.push(this._createTextCharSpan(c,d,n,s)),c="",l=u,n+=g,g=0)},_pushTextBgRect:function(i,o,n,s,r,a){var l=b.Object.NUM_FRACTION_DIGITS;i.push("		<rect ",this._getFillAttributes(o),' x="',e(n,l),'" y="',e(s,l),'" width="',e(r,l),'" height="',e(a,l),`"></rect>
`)},_setSVGTextLineBg:function(i,o,n,s){for(var r=this._textLines[o],a=this.getHeightOfLine(o)/this.lineHeight,l=0,u=0,c,h,d=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),g=0,m=r.length;g<m;g++)c=this.__charBounds[o][g],h=this.getValueOfPropertyAt(o,g,"textBackgroundColor"),h!==d?(d&&this._pushTextBgRect(i,d,n+u,s,l,a),u=c.left,l=c.width,d=h):l+=c.kernedWidth;h&&this._pushTextBgRect(i,h,n+u,s,l,a)},_getFillAttributes:function(i){var o=i&&typeof i=="string"?new b.Color(i):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+i+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(i){for(var o=0,n=0,s=0;s<i;s++)o+=this.getHeightOfLine(s);return n=this.getHeightOfLine(s),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(i){var o=b.Object.prototype.getSvgStyles.call(this,i);return o+" white-space: pre;"}})})();(function(e){"use strict";var t=e.fabric||(e.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(i){for(var o=0,n=0,s=0,r={},a=0;a<i.graphemeLines.length;a++)i.graphemeText[s]===`
`&&a>0?(n=0,s++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(i.graphemeText[s])&&a>0&&(n++,s++),r[a]={line:o,offset:n},s+=i.graphemeLines[a].length,n+=i.graphemeLines[a].length;return r},styleHas:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[o];n&&(o=n.line)}return t.Text.prototype.styleHas.call(this,i,o)},isEmptyStyles:function(i){if(!this.styles)return!0;var o=0,n=i+1,s,r,a=!1,l=this._styleMap[i],u=this._styleMap[i+1];l&&(i=l.line,o=l.offset),u&&(n=u.line,a=n===i,s=u.offset),r=typeof i>"u"?this.styles:{line:this.styles[i]};for(var c in r)for(var h in r[c])if(h>=o&&(!a||h<s))for(var d in r[c][h])return!1;return!0},_getStyleDeclaration:function(i,o){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[i];if(!n)return null;i=n.line,o=n.offset+o}return this.callSuper("_getStyleDeclaration",i,o)},_setStyleDeclaration:function(i,o,n){var s=this._styleMap[i];i=s.line,o=s.offset+o,this.styles[i][o]=n},_deleteStyleDeclaration:function(i,o){var n=this._styleMap[i];i=n.line,o=n.offset+o,delete this.styles[i][o]},_getLineStyle:function(i){var o=this._styleMap[i];return!!this.styles[o.line]},_setLineStyle:function(i){var o=this._styleMap[i];this.styles[o.line]={}},_wrapText:function(i,o){var n=[],s;for(this.isWrapping=!0,s=0;s<i.length;s++)n=n.concat(this._wrapLine(i[s],s,o));return this.isWrapping=!1,n},_measureWord:function(i,o,n){var s=0,r,a=!0;n=n||0;for(var l=0,u=i.length;l<u;l++){var c=this._getGraphemeBox(i[l],o,l+n,r,a);s+=c.kernedWidth,r=i[l]}return s},_wrapLine:function(i,o,n,B){var r=0,a=this.splitByGrapheme,l=[],u=[],c=a?t.util.string.graphemeSplit(i):i.split(this._wordJoiners),h="",d=0,g=a?"":" ",m=0,y=0,C=0,w=!0,F=this._getWidthOfCharSpacing(),B=B||0;c.length===0&&c.push([]),n-=B;for(var U=0;U<c.length;U++)h=a?c[U]:t.util.string.graphemeSplit(c[U]),m=this._measureWord(h,o,d),d+=h.length,r+=y+m-F,r>n&&!w?(l.push(u),u=[],r=m,w=!0):r+=F,!w&&!a&&u.push(g),u=u.concat(h),y=a?0:this._measureWord([g],o,d),d++,w=!1,m>C&&(C=m);return U&&l.push(u),C+B>this.dynamicMinWidth&&(this.dynamicMinWidth=C-F+B),l},isEndOfWrapping:function(i){return!this._styleMap[i+1]||this._styleMap[i+1].line!==this._styleMap[i].line},missingNewlineOffset:function(i){return this.splitByGrapheme?this.isEndOfWrapping(i)?1:0:1},_splitTextIntoLines:function(i){for(var o=t.Text.prototype._splitTextIntoLines.call(this,i),n=this._wrapText(o.lines,this.width),s=new Array(n.length),r=0;r<n.length;r++)s[r]=n[r].join("");return o.lines=s,o.graphemeLines=n,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var i={};for(var o in this._styleMap)this._textLines[o]&&(i[this._styleMap[o].line]=1);for(var o in this.styles)i[o]||delete this.styles[o]},toObject:function(i){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(i))}}),t.Textbox.fromObject=function(i,o){var n=t.util.stylesFromArray(i.styles,i.text),s=Object.assign({},i,{styles:n});return t.Object._fromObject("Textbox",s,o,"text")}})(_t);(function(){var e=b.controlsUtils,t=e.scaleSkewCursorStyleHandler,i=e.scaleCursorStyleHandler,o=e.scalingEqually,n=e.scalingYOrSkewingX,s=e.scalingXOrSkewingY,r=e.scaleOrSkewActionName,a=b.Object.prototype.controls;if(a.ml=new b.Control({x:-.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mr=new b.Control({x:.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:r}),a.mb=new b.Control({x:0,y:.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.mt=new b.Control({x:0,y:-.5,cursorStyleHandler:t,actionHandler:n,getActionName:r}),a.tl=new b.Control({x:-.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.tr=new b.Control({x:.5,y:-.5,cursorStyleHandler:i,actionHandler:o}),a.bl=new b.Control({x:-.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.br=new b.Control({x:.5,y:.5,cursorStyleHandler:i,actionHandler:o}),a.mtr=new b.Control({x:0,y:-.5,actionHandler:e.rotationWithSnapping,cursorStyleHandler:e.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),b.Textbox){var l=b.Textbox.prototype.controls={};l.mtr=a.mtr,l.tr=a.tr,l.br=a.br,l.tl=a.tl,l.bl=a.bl,l.mt=a.mt,l.mb=a.mb,l.mr=new b.Control({x:.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"}),l.ml=new b.Control({x:-.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"})}})()});var im=ue((p3,u_)=>{"use strict";function Or(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function a_(e,t){for(var i="",o=0,n=-1,s=0,r,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(r===47)break;r=47}if(r===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var l=i.lastIndexOf("/");if(l!==i.length-1){l===-1?(i="",o=0):(i=i.slice(0,l),o=i.length-1-i.lastIndexOf("/")),n=a,s=0;continue}}else if(i.length===2||i.length===1){i="",o=0,n=a,s=0;continue}}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(n+1,a):i=e.slice(n+1,a),o=a-n-1;n=a,s=0}else r===46&&s!==-1?++s:s=-1}return i}function gF(e,t){var i=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");return i?i===t.root?i+o:i+e+o:o}var ou={resolve:function(){for(var t="",i=!1,o,n=arguments.length-1;n>=-1&&!i;n--){var s;n>=0?s=arguments[n]:(o===void 0&&(o=process.cwd()),s=o),Or(s),s.length!==0&&(t=s+"/"+t,i=s.charCodeAt(0)===47)}return t=a_(t,!i),i?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(Or(t),t.length===0)return".";var i=t.charCodeAt(0)===47,o=t.charCodeAt(t.length-1)===47;return t=a_(t,!i),t.length===0&&!i&&(t="."),t.length>0&&o&&(t+="/"),i?"/"+t:t},isAbsolute:function(t){return Or(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,i=0;i<arguments.length;++i){var o=arguments[i];Or(o),o.length>0&&(t===void 0?t=o:t+="/"+o)}return t===void 0?".":ou.normalize(t)},relative:function(t,i){if(Or(t),Or(i),t===i||(t=ou.resolve(t),i=ou.resolve(i),t===i))return"";for(var o=1;o<t.length&&t.charCodeAt(o)===47;++o);for(var n=t.length,s=n-o,r=1;r<i.length&&i.charCodeAt(r)===47;++r);for(var a=i.length,l=a-r,u=s<l?s:l,c=-1,h=0;h<=u;++h){if(h===u){if(l>u){if(i.charCodeAt(r+h)===47)return i.slice(r+h+1);if(h===0)return i.slice(r+h)}else s>u&&(t.charCodeAt(o+h)===47?c=h:h===0&&(c=0));break}var d=t.charCodeAt(o+h),g=i.charCodeAt(r+h);if(d!==g)break;d===47&&(c=h)}var m="";for(h=o+c+1;h<=n;++h)(h===n||t.charCodeAt(h)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+i.slice(r+c):(r+=c,i.charCodeAt(r)===47&&++r,i.slice(r))},_makeLong:function(t){return t},dirname:function(t){if(Or(t),t.length===0)return".";for(var i=t.charCodeAt(0),o=i===47,n=-1,s=!0,r=t.length-1;r>=1;--r)if(i=t.charCodeAt(r),i===47){if(!s){n=r;break}}else s=!1;return n===-1?o?"/":".":o&&n===1?"//":t.slice(0,n)},basename:function(t,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');Or(t);var o=0,n=-1,s=!0,r;if(i!==void 0&&i.length>0&&i.length<=t.length){if(i.length===t.length&&i===t)return"";var a=i.length-1,l=-1;for(r=t.length-1;r>=0;--r){var u=t.charCodeAt(r);if(u===47){if(!s){o=r+1;break}}else l===-1&&(s=!1,l=r+1),a>=0&&(u===i.charCodeAt(a)?--a===-1&&(n=r):(a=-1,n=l))}return o===n?n=l:n===-1&&(n=t.length),t.slice(o,n)}else{for(r=t.length-1;r>=0;--r)if(t.charCodeAt(r)===47){if(!s){o=r+1;break}}else n===-1&&(s=!1,n=r+1);return n===-1?"":t.slice(o,n)}},extname:function(t){Or(t);for(var i=-1,o=0,n=-1,s=!0,r=0,a=t.length-1;a>=0;--a){var l=t.charCodeAt(a);if(l===47){if(!s){o=a+1;break}continue}n===-1&&(s=!1,n=a+1),l===46?i===-1?i=a:r!==1&&(r=1):i!==-1&&(r=-1)}return i===-1||n===-1||r===0||r===1&&i===n-1&&i===o+1?"":t.slice(i,n)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return gF("/",t)},parse:function(t){Or(t);var i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;var o=t.charCodeAt(0),n=o===47,s;n?(i.root="/",s=1):s=0;for(var r=-1,a=0,l=-1,u=!0,c=t.length-1,h=0;c>=s;--c){if(o=t.charCodeAt(c),o===47){if(!u){a=c+1;break}continue}l===-1&&(u=!1,l=c+1),o===46?r===-1?r=c:h!==1&&(h=1):r!==-1&&(h=-1)}return r===-1||l===-1||h===0||h===1&&r===l-1&&r===a+1?l!==-1&&(a===0&&n?i.base=i.name=t.slice(1,l):i.base=i.name=t.slice(a,l)):(a===0&&n?(i.name=t.slice(1,r),i.base=t.slice(1,l)):(i.name=t.slice(a,r),i.base=t.slice(a,l)),i.ext=t.slice(r,l)),a>0?i.dir=t.slice(0,a-1):n&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};ou.posix=ou;u_.exports=ou});var J_=ue((T3,Um)=>{var Nm=function(e){"use strict";var t=Object.prototype,i=t.hasOwnProperty,o=Object.defineProperty||function(S,_,O){S[_]=O.value},n,s=typeof Symbol=="function"?Symbol:{},r=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(S,_,O){return Object.defineProperty(S,_,{value:O,enumerable:!0,configurable:!0,writable:!0}),S[_]}try{u({},"")}catch{u=function(_,O,j){return _[O]=j}}function c(S,_,O,j){var q=_&&_.prototype instanceof w?_:w,N=Object.create(q.prototype),H=new I(j||[]);return o(N,"_invoke",{value:pt(S,O,H)}),N}e.wrap=c;function h(S,_,O){try{return{type:"normal",arg:S.call(_,O)}}catch(j){return{type:"throw",arg:j}}}var d="suspendedStart",g="suspendedYield",m="executing",y="completed",C={};function w(){}function F(){}function B(){}var U={};u(U,r,function(){return this});var R=Object.getPrototypeOf,W=R&&R(R(k([])));W&&W!==t&&i.call(W,r)&&(U=W);var X=B.prototype=w.prototype=Object.create(U);F.prototype=B,o(X,"constructor",{value:B,configurable:!0}),o(B,"constructor",{value:F,configurable:!0}),F.displayName=u(B,l,"GeneratorFunction");function $(S){["next","throw","return"].forEach(function(_){u(S,_,function(O){return this._invoke(_,O)})})}e.isGeneratorFunction=function(S){var _=typeof S=="function"&&S.constructor;return _?_===F||(_.displayName||_.name)==="GeneratorFunction":!1},e.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,B):(S.__proto__=B,u(S,l,"GeneratorFunction")),S.prototype=Object.create(X),S},e.awrap=function(S){return{__await:S}};function st(S,_){function O(N,H,Q,ot){var Y=h(S[N],S,H);if(Y.type==="throw")ot(Y.arg);else{var z=Y.arg,it=z.value;return it&&typeof it=="object"&&i.call(it,"__await")?_.resolve(it.__await).then(function(Z){O("next",Z,Q,ot)},function(Z){O("throw",Z,Q,ot)}):_.resolve(it).then(function(Z){z.value=Z,Q(z)},function(Z){return O("throw",Z,Q,ot)})}}var j;function q(N,H){function Q(){return new _(function(ot,Y){O(N,H,ot,Y)})}return j=j?j.then(Q,Q):Q()}o(this,"_invoke",{value:q})}$(st.prototype),u(st.prototype,a,function(){return this}),e.AsyncIterator=st,e.async=function(S,_,O,j,q){q===void 0&&(q=Promise);var N=new st(c(S,_,O,j),q);return e.isGeneratorFunction(_)?N:N.next().then(function(H){return H.done?H.value:N.next()})};function pt(S,_,O){var j=d;return function(N,H){if(j===m)throw new Error("Generator is already running");if(j===y){if(N==="throw")throw H;return K()}for(O.method=N,O.arg=H;;){var Q=O.delegate;if(Q){var ot=dt(Q,O);if(ot){if(ot===C)continue;return ot}}if(O.method==="next")O.sent=O._sent=O.arg;else if(O.method==="throw"){if(j===d)throw j=y,O.arg;O.dispatchException(O.arg)}else O.method==="return"&&O.abrupt("return",O.arg);j=m;var Y=h(S,_,O);if(Y.type==="normal"){if(j=O.done?y:g,Y.arg===C)continue;return{value:Y.arg,done:O.done}}else Y.type==="throw"&&(j=y,O.method="throw",O.arg=Y.arg)}}}function dt(S,_){var O=_.method,j=S.iterator[O];if(j===n)return _.delegate=null,O==="throw"&&S.iterator.return&&(_.method="return",_.arg=n,dt(S,_),_.method==="throw")||O!=="return"&&(_.method="throw",_.arg=new TypeError("The iterator does not provide a '"+O+"' method")),C;var q=h(j,S.iterator,_.arg);if(q.type==="throw")return _.method="throw",_.arg=q.arg,_.delegate=null,C;var N=q.arg;if(!N)return _.method="throw",_.arg=new TypeError("iterator result is not an object"),_.delegate=null,C;if(N.done)_[S.resultName]=N.value,_.next=S.nextLoc,_.method!=="return"&&(_.method="next",_.arg=n);else return N;return _.delegate=null,C}$(X),u(X,l,"Generator"),u(X,r,function(){return this}),u(X,"toString",function(){return"[object Generator]"});function x(S){var _={tryLoc:S[0]};1 in S&&(_.catchLoc=S[1]),2 in S&&(_.finallyLoc=S[2],_.afterLoc=S[3]),this.tryEntries.push(_)}function P(S){var _=S.completion||{};_.type="normal",delete _.arg,S.completion=_}function I(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(x,this),this.reset(!0)}e.keys=function(S){var _=Object(S),O=[];for(var j in _)O.push(j);return O.reverse(),function q(){for(;O.length;){var N=O.pop();if(N in _)return q.value=N,q.done=!1,q}return q.done=!0,q}};function k(S){if(S){var _=S[r];if(_)return _.call(S);if(typeof S.next=="function")return S;if(!isNaN(S.length)){var O=-1,j=function q(){for(;++O<S.length;)if(i.call(S,O))return q.value=S[O],q.done=!1,q;return q.value=n,q.done=!0,q};return j.next=j}}return{next:K}}e.values=k;function K(){return{value:n,done:!0}}return I.prototype={constructor:I,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!S)for(var _ in this)_.charAt(0)==="t"&&i.call(this,_)&&!isNaN(+_.slice(1))&&(this[_]=n)},stop:function(){this.done=!0;var S=this.tryEntries[0],_=S.completion;if(_.type==="throw")throw _.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var _=this;function O(ot,Y){return N.type="throw",N.arg=S,_.next=ot,Y&&(_.method="next",_.arg=n),!!Y}for(var j=this.tryEntries.length-1;j>=0;--j){var q=this.tryEntries[j],N=q.completion;if(q.tryLoc==="root")return O("end");if(q.tryLoc<=this.prev){var H=i.call(q,"catchLoc"),Q=i.call(q,"finallyLoc");if(H&&Q){if(this.prev<q.catchLoc)return O(q.catchLoc,!0);if(this.prev<q.finallyLoc)return O(q.finallyLoc)}else if(H){if(this.prev<q.catchLoc)return O(q.catchLoc,!0)}else if(Q){if(this.prev<q.finallyLoc)return O(q.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(S,_){for(var O=this.tryEntries.length-1;O>=0;--O){var j=this.tryEntries[O];if(j.tryLoc<=this.prev&&i.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var q=j;break}}q&&(S==="break"||S==="continue")&&q.tryLoc<=_&&_<=q.finallyLoc&&(q=null);var N=q?q.completion:{};return N.type=S,N.arg=_,q?(this.method="next",this.next=q.finallyLoc,C):this.complete(N)},complete:function(S,_){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&_&&(this.next=_),C},finish:function(S){for(var _=this.tryEntries.length-1;_>=0;--_){var O=this.tryEntries[_];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),P(O),C}},catch:function(S){for(var _=this.tryEntries.length-1;_>=0;--_){var O=this.tryEntries[_];if(O.tryLoc===S){var j=O.completion;if(j.type==="throw"){var q=j.arg;P(O)}return q}}throw new Error("illegal catch attempt")},delegateYield:function(S,_,O){return this.delegate={iterator:k(S),resultName:_,nextLoc:O},this.method==="next"&&(this.arg=n),C}},e}(typeof Um=="object"?Um.exports:{});try{regeneratorRuntime=Nm}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Nm:Function("r","regeneratorRuntime = r")(Nm)}});var mf=ue((F3,Q_)=>{Q_.exports=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`});var zm=ue((O3,tw)=>{var $k=mf(),Z_=0;tw.exports=({id:e,action:t,payload:i={}})=>{let o=e;return typeof o>"u"&&(o=$k("Job",Z_),Z_+=1),{id:o,action:t,payload:i}}});var vf=ue(Zl=>{var Wm=!1;Zl.logging=Wm;Zl.setLogging=e=>{Wm=e};Zl.log=(...e)=>Wm?console.log.apply(Zl,e):null});var rw=ue((iw,nw)=>{var Kk=zm(),{log:yf}=vf(),Jk=mf(),ew=0;nw.exports=()=>{let e=Jk("Scheduler",ew),t={},i={},o=[];ew+=1;let n=()=>o.length,s=()=>Object.keys(t).length,r=()=>{if(o.length!==0){let h=Object.keys(t);for(let d=0;d<h.length;d+=1)if(typeof i[h[d]]>"u"){o[0](t[h[d]]);break}}},a=(h,d)=>new Promise((g,m)=>{let y=Kk({action:h,payload:d});o.push(async C=>{o.shift(),i[C.id]=y;try{g(await C[h].apply(iw,[...d,y.id]))}catch(w){m(w)}finally{delete i[C.id],r()}}),yf(`[${e}]: Add ${y.id} to JobQueue`),yf(`[${e}]: JobQueue length=${o.length}`),r()});return{addWorker:h=>(t[h.id]=h,yf(`[${e}]: Add ${h.id}`),yf(`[${e}]: Number of workers=${s()}`),r(),h.id),addJob:async(h,...d)=>{if(s()===0)throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return a(h,d)},terminate:async()=>{Object.keys(t).forEach(async h=>{await t[h].terminate()}),o=[]},getQueueLen:n,getNumWorkers:s}}});var ow=ue((P3,sw)=>{function Qk(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}sw.exports=Qk});var uw=ue((I3,aw)=>{var Zk=ow();aw.exports=e=>{let t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":Zk()?t.type="electron":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof Uv=="function"&&(t.type="node"),typeof e>"u"?t:t[e]}});var cw=ue((L3,lw)=>{var tP=uw()("type")==="browser",eP=tP?e=>new URL(e,window.location.href).href:e=>e;lw.exports=e=>{let t={...e};return["corePath","workerPath","langPath"].forEach(i=>{e[i]&&(t[i]=eP(t[i]))}),t}});var fw=ue((M3,hw)=>{hw.exports=e=>{let t=[],i=[],o=[],n=[],s=[];return e.blocks&&e.blocks.forEach(r=>{r.paragraphs.forEach(a=>{a.lines.forEach(l=>{l.words.forEach(u=>{u.symbols.forEach(c=>{s.push({...c,page:e,block:r,paragraph:a,line:l,word:u})}),n.push({...u,page:e,block:r,paragraph:a,line:l})}),o.push({...l,page:e,block:r,paragraph:a})}),i.push({...a,page:e,block:r})}),t.push({...r,page:e})}),{...e,blocks:t,paragraphs:i,lines:o,words:n,symbols:s}}});var Gm=ue((R3,dw)=>{dw.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}});var pw=ue((j3,iP)=>{iP.exports={name:"tesseract.js",version:"5.0.5",description:"Pure Javascript Multilingual OCR",main:"src/index.js",types:"src/index.d.ts",unpkg:"dist/tesseract.min.js",jsdelivr:"dist/tesseract.min.js",scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},browser:{"./src/worker/node/index.js":"./src/worker/browser/index.js"},author:"",contributors:["jeromewu"],license:"Apache-2.0",devDependencies:{"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},dependencies:{"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-electron":"^2.2.2","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^5.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},overrides:{"@rollup/pluginutils":"^5.0.2"},repository:{type:"git",url:"https://github.com/naptha/tesseract.js.git"},bugs:{url:"https://github.com/naptha/tesseract.js/issues"},homepage:"https://github.com/naptha/tesseract.js",collective:{type:"opencollective",url:"https://opencollective.com/tesseractjs"}}});var mw=ue((N3,gw)=>{gw.exports={workerBlobURL:!0,logger:()=>{}}});var yw=ue((U3,vw)=>{var nP=pw().version,rP=mw();vw.exports={...rP,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${nP}/dist/worker.min.js`}});var _w=ue((z3,Cw)=>{Cw.exports=({workerPath:e,workerBlobURL:t})=>{let i;if(Blob&&URL&&t){let o=new Blob([`importScripts("${e}");`],{type:"application/javascript"});i=new Worker(URL.createObjectURL(o))}else i=new Worker(e);return i}});var Sw=ue((W3,ww)=>{ww.exports=e=>{e.terminate()}});var Dw=ue((G3,xw)=>{xw.exports=(e,t)=>{e.onmessage=({data:i})=>{t(i)}}});var Aw=ue((H3,bw)=>{bw.exports=async(e,t)=>{e.postMessage(t)}});var Tw=ue((X3,Ew)=>{var Hm=e=>new Promise((t,i)=>{let o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=({target:{error:{code:n}}})=>{i(Error(`File could not be read! Code=${n}`))},o.readAsArrayBuffer(e)}),Xm=async e=>{let t=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(i=>i.charCodeAt(0)):t=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(t=await Xm(e.src)),e.tagName==="VIDEO"&&(t=await Xm(e.poster)),e.tagName==="CANVAS"&&await new Promise(i=>{e.toBlob(async o=>{t=await Hm(o),i()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){let i=await e.convertToBlob();t=await Hm(i)}else(e instanceof File||e instanceof Blob)&&(t=await Hm(e));return new Uint8Array(t)};Ew.exports=Xm});var Ow=ue((Y3,Fw)=>{var sP=yw(),oP=_w(),aP=Sw(),uP=Dw(),lP=Aw(),cP=Tw();Fw.exports={defaultOptions:sP,spawnWorker:oP,terminateWorker:aP,onMessage:uP,send:lP,loadImage:cP}});var Ym=ue((V3,Bw)=>{var hP=cw(),fP=fw(),dr=zm(),{log:kw}=vf(),dP=mf(),Vo=Gm(),{defaultOptions:pP,spawnWorker:gP,terminateWorker:mP,onMessage:vP,loadImage:Pw,send:yP}=Ow(),Iw=0;Bw.exports=async(e="eng",t=Vo.LSTM_ONLY,i={},o={})=>{let n=dP("Worker",Iw),{logger:s,errorHandler:r,...a}=hP({...pP,...i}),l={},u={},c=typeof e=="string"?e.split("+"):e,h=t,d=o,g=[Vo.DEFAULT,Vo.LSTM_ONLY].includes(t)&&!a.legacyCore,m,y,C=new Promise((H,Q)=>{y=H,m=Q}),w=H=>{m(H.message)},F=gP(a);F.onerror=w,Iw+=1;let B=(H,Q)=>{l[H]=Q},U=(H,Q)=>{u[H]=Q},R=({id:H,action:Q,payload:ot})=>new Promise((Y,z)=>{kw(`[${n}]: Start ${H}, action=${Q}`);let it=`${Q}-${H}`;B(it,Y),U(it,z),yP(F,{workerId:n,jobId:H,action:Q,payload:ot})}),W=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),X=H=>R(dr({id:H,action:"load",payload:{options:{lstmOnly:g,corePath:a.corePath,logging:a.logging}}})),$=(H,Q,ot)=>R(dr({id:ot,action:"FS",payload:{method:"writeFile",args:[H,Q]}})),st=(H,Q)=>R(dr({id:Q,action:"FS",payload:{method:"readFile",args:[H,{encoding:"utf8"}]}})),pt=(H,Q)=>R(dr({id:Q,action:"FS",payload:{method:"unlink",args:[H]}})),dt=(H,Q,ot)=>R(dr({id:ot,action:"FS",payload:{method:H,args:Q}})),x=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),P=(H,Q)=>R(dr({id:Q,action:"loadLanguage",payload:{langs:H,options:{langPath:a.langPath,dataPath:a.dataPath,cachePath:a.cachePath,cacheMethod:a.cacheMethod,gzip:a.gzip,lstmOnly:[Vo.LSTM_ONLY,Vo.TESSERACT_LSTM_COMBINED].includes(h)&&!a.legacyLang}}})),I=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),k=(H,Q,ot,Y)=>R(dr({id:Y,action:"initialize",payload:{langs:H,oem:Q,config:ot}})),K=(H="eng",Q,ot,Y)=>{if(g&&[Vo.TESSERACT_ONLY,Vo.TESSERACT_LSTM_COMBINED].includes(Q))throw Error("Legacy model requested but code missing.");let z=Q||h;h=z;let it=ot||d;d=it;let J=(typeof H=="string"?H.split("+"):H).filter(nt=>!c.includes(nt));return c.push(...J),J.length>0?P(J,Y).then(()=>k(H,z,it,Y)):k(H,z,it,Y)},S=(H={},Q)=>R(dr({id:Q,action:"setParameters",payload:{params:H}})),_=async(H,Q={},ot={blocks:!0,text:!0,hocr:!0,tsv:!0},Y)=>R(dr({id:Y,action:"recognize",payload:{image:await Pw(H),options:Q,output:ot}})),O=(H="Tesseract OCR Result",Q=!1,ot)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),R(dr({id:ot,action:"getPDF",payload:{title:H,textonly:Q}}))),j=async(H,Q)=>{if(g)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return R(dr({id:Q,action:"detect",payload:{image:await Pw(H)}}))},q=async()=>(F!==null&&(mP(F),F=null),Promise.resolve());vP(F,({workerId:H,jobId:Q,status:ot,action:Y,data:z})=>{let it=`${Y}-${Q}`;if(ot==="resolve"){kw(`[${H}]: Complete ${Q}`);let Z=z;Y==="recognize"?Z=fP(z):Y==="getPDF"&&(Z=Array.from({...z,length:Object.keys(z).length})),l[it]({jobId:Q,data:Z})}else if(ot==="reject")if(u[it](z),Y==="load"&&m(z),r)r(z);else throw Error(z);else ot==="progress"&&s({...z,userJobId:Q})});let N={id:n,worker:F,setResolve:B,setReject:U,load:W,writeText:$,readText:st,removeFile:pt,FS:dt,loadLanguage:x,initialize:I,reinitialize:K,setParameters:S,recognize:_,getPDF:O,detect:j,terminate:q};return X().then(()=>P(e)).then(()=>k(e,t,o)).then(()=>y(N)).catch(()=>{}),C}});var Rw=ue((q3,Mw)=>{var Lw=Ym(),CP=async(e,t,i)=>{let o=await Lw(t,1,i);return o.recognize(e).finally(async()=>{await o.terminate()})},_P=async(e,t)=>{let i=await Lw("osd",0,t);return i.detect(e).finally(async()=>{await i.terminate()})};Mw.exports={recognize:CP,detect:_P}});var Nw=ue(($3,jw)=>{jw.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}});var zw=ue((K3,Uw)=>{Uw.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}});var Gw=ue((J3,Ww)=>{J_();var wP=rw(),SP=Ym(),xP=Rw(),DP=Nw(),bP=Gm(),AP=zw(),{setLogging:EP}=vf();Ww.exports={languages:DP,OEM:bP,PSM:AP,createScheduler:wP,createWorker:SP,setLogging:EP,...xP}});var Hw=ue((Yn,pr)=>{(function(e,t){typeof Yn=="object"&&typeof pr=="object"?pr.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Yn=="object"?Yn.LSPluginEntry=t():e.LSPluginEntry=t()})(self,()=>(()=>{var e={227:(n,s,r)=>{var a=r(155);s.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;u.splice(1,0,c,"color: inherit");let h=0,d=0;u[0].replace(/%[a-zA-Z%]/g,g=>{g!=="%%"&&(h++,g==="%c"&&(d=h))}),u.splice(d,0,c)},s.save=function(u){try{u?s.storage.setItem("debug",u):s.storage.removeItem("debug")}catch{}},s.load=function(){let u;try{u=s.storage.getItem("debug")}catch{}return!u&&a!==void 0&&"env"in a&&(u=a.env.DEBUG),u},s.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},s.storage=function(){try{return localStorage}catch{}}(),s.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],s.log=console.debug||console.log||(()=>{}),n.exports=r(447)(s);let{formatters:l}=n.exports;l.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}},447:(n,s,r)=>{n.exports=function(a){function l(h){let d,g,m,y=null;function C(...w){if(!C.enabled)return;let F=C,B=Number(new Date),U=B-(d||B);F.diff=U,F.prev=d,F.curr=B,d=B,w[0]=l.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");let R=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,(W,X)=>{if(W==="%%")return"%";R++;let $=l.formatters[X];if(typeof $=="function"){let st=w[R];W=$.call(F,st),w.splice(R,1),R--}return W}),l.formatArgs.call(F,w),(F.log||l.log).apply(F,w)}return C.namespace=h,C.useColors=l.useColors(),C.color=l.selectColor(h),C.extend=u,C.destroy=l.destroy,Object.defineProperty(C,"enabled",{enumerable:!0,configurable:!1,get:()=>y!==null?y:(g!==l.namespaces&&(g=l.namespaces,m=l.enabled(h)),m),set:w=>{y=w}}),typeof l.init=="function"&&l.init(C),C}function u(h,d){let g=l(this.namespace+(d===void 0?":":d)+h);return g.log=this.log,g}function c(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}return l.debug=l,l.default=l,l.coerce=function(h){return h instanceof Error?h.stack||h.message:h},l.disable=function(){let h=[...l.names.map(c),...l.skips.map(c).map(d=>"-"+d)].join(",");return l.enable(""),h},l.enable=function(h){let d;l.save(h),l.namespaces=h,l.names=[],l.skips=[];let g=(typeof h=="string"?h:"").split(/[\s,]+/),m=g.length;for(d=0;d<m;d++)g[d]&&((h=g[d].replace(/\*/g,".*?"))[0]==="-"?l.skips.push(new RegExp("^"+h.slice(1)+"$")):l.names.push(new RegExp("^"+h+"$")))},l.enabled=function(h){if(h[h.length-1]==="*")return!0;let d,g;for(d=0,g=l.skips.length;d<g;d++)if(l.skips[d].test(h))return!1;for(d=0,g=l.names.length;d<g;d++)if(l.names[d].test(h))return!0;return!1},l.humanize=r(824),l.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(h=>{l[h]=a[h]}),l.names=[],l.skips=[],l.formatters={},l.selectColor=function(h){let d=0;for(let g=0;g<h.length;g++)d=(d<<5)-d+h.charCodeAt(g),d|=0;return l.colors[Math.abs(d)%l.colors.length]},l.enable(l.load()),l}},996:n=>{"use strict";var s=function(m){return function(y){return!!y&&typeof y=="object"}(m)&&!function(y){var C=Object.prototype.toString.call(y);return C==="[object RegExp]"||C==="[object Date]"||function(w){return w.$$typeof===r}(y)}(m)},r=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.element"):60103;function a(m,y){return y.clone!==!1&&y.isMergeableObject(m)?d((C=m,Array.isArray(C)?[]:{}),m,y):m;var C}function l(m,y,C){return m.concat(y).map(function(w){return a(w,C)})}function u(m){return Object.keys(m).concat(function(y){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(y).filter(function(C){return Object.propertyIsEnumerable.call(y,C)}):[]}(m))}function c(m,y){try{return y in m}catch{return!1}}function h(m,y,C){var w={};return C.isMergeableObject(m)&&u(m).forEach(function(F){w[F]=a(m[F],C)}),u(y).forEach(function(F){(function(B,U){return c(B,U)&&!(Object.hasOwnProperty.call(B,U)&&Object.propertyIsEnumerable.call(B,U))})(m,F)||(c(m,F)&&C.isMergeableObject(y[F])?w[F]=function(B,U){if(!U.customMerge)return d;var R=U.customMerge(B);return typeof R=="function"?R:d}(F,C)(m[F],y[F],C):w[F]=a(y[F],C))}),w}function d(m,y,C){(C=C||{}).arrayMerge=C.arrayMerge||l,C.isMergeableObject=C.isMergeableObject||s,C.cloneUnlessOtherwiseSpecified=a;var w=Array.isArray(y);return w===Array.isArray(m)?w?C.arrayMerge(m,y,C):h(m,y,C):a(y,C)}d.all=function(m,y){if(!Array.isArray(m))throw new Error("first argument should be an array");return m.reduce(function(C,w){return d(C,w,y)},{})};var g=d;n.exports=g},856:function(n){n.exports=function(){"use strict";function s(Ft){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Bt){return typeof Bt}:function(Bt){return Bt&&typeof Symbol=="function"&&Bt.constructor===Symbol&&Bt!==Symbol.prototype?"symbol":typeof Bt},s(Ft)}function r(Ft,Bt){return r=Object.setPrototypeOf||function(Gt,ne){return Gt.__proto__=ne,Gt},r(Ft,Bt)}function a(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function l(Ft,Bt,Gt){return l=a()?Reflect.construct:function(ne,Oe,Ti){var Xi=[null];Xi.push.apply(Xi,Oe);var En=new(Function.bind.apply(ne,Xi));return Ti&&r(En,Ti.prototype),En},l.apply(null,arguments)}function u(Ft){return c(Ft)||h(Ft)||d(Ft)||m()}function c(Ft){if(Array.isArray(Ft))return g(Ft)}function h(Ft){if(typeof Symbol<"u"&&Ft[Symbol.iterator]!=null||Ft["@@iterator"]!=null)return Array.from(Ft)}function d(Ft,Bt){if(Ft){if(typeof Ft=="string")return g(Ft,Bt);var Gt=Object.prototype.toString.call(Ft).slice(8,-1);return Gt==="Object"&&Ft.constructor&&(Gt=Ft.constructor.name),Gt==="Map"||Gt==="Set"?Array.from(Ft):Gt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gt)?g(Ft,Bt):void 0}}function g(Ft,Bt){(Bt==null||Bt>Ft.length)&&(Bt=Ft.length);for(var Gt=0,ne=new Array(Bt);Gt<Bt;Gt++)ne[Gt]=Ft[Gt];return ne}function m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var y=Object.hasOwnProperty,C=Object.setPrototypeOf,w=Object.isFrozen,F=Object.getPrototypeOf,B=Object.getOwnPropertyDescriptor,U=Object.freeze,R=Object.seal,W=Object.create,X=typeof Reflect<"u"&&Reflect,$=X.apply,st=X.construct;$||($=function(Ft,Bt,Gt){return Ft.apply(Bt,Gt)}),U||(U=function(Ft){return Ft}),R||(R=function(Ft){return Ft}),st||(st=function(Ft,Bt){return l(Ft,u(Bt))});var pt=j(Array.prototype.forEach),dt=j(Array.prototype.pop),x=j(Array.prototype.push),P=j(String.prototype.toLowerCase),I=j(String.prototype.match),k=j(String.prototype.replace),K=j(String.prototype.indexOf),S=j(String.prototype.trim),_=j(RegExp.prototype.test),O=q(TypeError);function j(Ft){return function(Bt){for(var Gt=arguments.length,ne=new Array(Gt>1?Gt-1:0),Oe=1;Oe<Gt;Oe++)ne[Oe-1]=arguments[Oe];return $(Ft,Bt,ne)}}function q(Ft){return function(){for(var Bt=arguments.length,Gt=new Array(Bt),ne=0;ne<Bt;ne++)Gt[ne]=arguments[ne];return st(Ft,Gt)}}function N(Ft,Bt){C&&C(Ft,null);for(var Gt=Bt.length;Gt--;){var ne=Bt[Gt];if(typeof ne=="string"){var Oe=P(ne);Oe!==ne&&(w(Bt)||(Bt[Gt]=Oe),ne=Oe)}Ft[ne]=!0}return Ft}function H(Ft){var Bt,Gt=W(null);for(Bt in Ft)$(y,Ft,[Bt])&&(Gt[Bt]=Ft[Bt]);return Gt}function Q(Ft,Bt){for(;Ft!==null;){var Gt=B(Ft,Bt);if(Gt){if(Gt.get)return j(Gt.get);if(typeof Gt.value=="function")return j(Gt.value)}Ft=F(Ft)}function ne(Oe){return console.warn("fallback value for",Oe),null}return ne}var ot=U(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Y=U(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),z=U(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),it=U(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Z=U(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),J=U(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nt=U(["#text"]),lt=U(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),At=U(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),wt=U(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),et=U(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),yt=R(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Tt=R(/<%[\w\W]*|[\w\W]*%>/gm),It=R(/^data-[\-\w.\u00B7-\uFFFF]/),jt=R(/^aria-[\-\w]+$/),Mt=R(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),se=R(/^(?:\w+script|data):/i),Jt=R(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Le=R(/^html$/i),qe=function(){return typeof window>"u"?null:window},Ce=function(Ft,Bt){if(s(Ft)!=="object"||typeof Ft.createPolicy!="function")return null;var Gt=null,ne="data-tt-policy-suffix";Bt.currentScript&&Bt.currentScript.hasAttribute(ne)&&(Gt=Bt.currentScript.getAttribute(ne));var Oe="dompurify"+(Gt?"#"+Gt:"");try{return Ft.createPolicy(Oe,{createHTML:function(Ti){return Ti}})}catch{return console.warn("TrustedTypes policy "+Oe+" could not be created."),null}};function Ei(){var Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qe(),Bt=function(at){return Ei(at)};if(Bt.version="2.3.8",Bt.removed=[],!Ft||!Ft.document||Ft.document.nodeType!==9)return Bt.isSupported=!1,Bt;var Gt=Ft.document,ne=Ft.document,Oe=Ft.DocumentFragment,Ti=Ft.HTMLTemplateElement,Xi=Ft.Node,En=Ft.Element,Ir=Ft.NodeFilter,$o=Ft.NamedNodeMap,Vn=$o===void 0?Ft.NamedNodeMap||Ft.MozNamedAttrMap:$o,pu=Ft.HTMLFormElement,Ko=Ft.DOMParser,Jo=Ft.trustedTypes,hs=En.prototype,gu=Q(hs,"cloneNode"),mu=Q(hs,"nextSibling"),vu=Q(hs,"childNodes"),fs=Q(hs,"parentNode");if(typeof Ti=="function"){var fn=ne.createElement("template");fn.content&&fn.content.ownerDocument&&(ne=fn.content.ownerDocument)}var dn=Ce(Jo,Gt),Qo=dn?dn.createHTML(""):"",gr=ne,oo=gr.implementation,Tn=gr.createNodeIterator,Zo=gr.createDocumentFragment,ta=gr.getElementsByTagName,yu=Gt.importNode,ea={};try{ea=H(ne).documentMode?ne.documentMode:{}}catch{}var Fi={};Bt.isSupported=typeof fs=="function"&&oo&&oo.createHTMLDocument!==void 0&&ea!==9;var Br,Fn,ds=yt,Lr=Tt,ao=It,Cu=jt,ia=se,ps=Jt,_e=Mt,We=null,Mr=N({},[].concat(u(ot),u(Y),u(z),u(Z),u(nt))),Ge=null,pn=N({},[].concat(u(lt),u(At),u(wt),u(et))),ke=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),mr=null,gs=null,ms=!0,vs=!0,uo=!1,vr=!1,qn=!1,lo=!1,co=!1,$n=!1,Rr=!1,Kn=!1,ys=!0,ho=!0,Jn=!1,vi={},Qn=null,na=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),fo=null,po=N({},["audio","video","img","source","image","track"]),jr=null,Zn=N({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tr="http://www.w3.org/1998/Math/MathML",Nr="http://www.w3.org/2000/svg",Yi="http://www.w3.org/1999/xhtml",gn=Yi,go=!1,yr=["application/xhtml+xml","text/html"],Ur="text/html",er=null,ra=ne.createElement("form"),mo=function(at){return at instanceof RegExp||at instanceof Function},Cs=function(at){er&&er===at||(at&&s(at)==="object"||(at={}),at=H(at),We="ALLOWED_TAGS"in at?N({},at.ALLOWED_TAGS):Mr,Ge="ALLOWED_ATTR"in at?N({},at.ALLOWED_ATTR):pn,jr="ADD_URI_SAFE_ATTR"in at?N(H(Zn),at.ADD_URI_SAFE_ATTR):Zn,fo="ADD_DATA_URI_TAGS"in at?N(H(po),at.ADD_DATA_URI_TAGS):po,Qn="FORBID_CONTENTS"in at?N({},at.FORBID_CONTENTS):na,mr="FORBID_TAGS"in at?N({},at.FORBID_TAGS):{},gs="FORBID_ATTR"in at?N({},at.FORBID_ATTR):{},vi="USE_PROFILES"in at&&at.USE_PROFILES,ms=at.ALLOW_ARIA_ATTR!==!1,vs=at.ALLOW_DATA_ATTR!==!1,uo=at.ALLOW_UNKNOWN_PROTOCOLS||!1,vr=at.SAFE_FOR_TEMPLATES||!1,qn=at.WHOLE_DOCUMENT||!1,$n=at.RETURN_DOM||!1,Rr=at.RETURN_DOM_FRAGMENT||!1,Kn=at.RETURN_TRUSTED_TYPE||!1,co=at.FORCE_BODY||!1,ys=at.SANITIZE_DOM!==!1,ho=at.KEEP_CONTENT!==!1,Jn=at.IN_PLACE||!1,_e=at.ALLOWED_URI_REGEXP||_e,gn=at.NAMESPACE||Yi,at.CUSTOM_ELEMENT_HANDLING&&mo(at.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ke.tagNameCheck=at.CUSTOM_ELEMENT_HANDLING.tagNameCheck),at.CUSTOM_ELEMENT_HANDLING&&mo(at.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ke.attributeNameCheck=at.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),at.CUSTOM_ELEMENT_HANDLING&&typeof at.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ke.allowCustomizedBuiltInElements=at.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Br=Br=yr.indexOf(at.PARSER_MEDIA_TYPE)===-1?Ur:at.PARSER_MEDIA_TYPE,Fn=Br==="application/xhtml+xml"?function(Lt){return Lt}:P,vr&&(vs=!1),Rr&&($n=!0),vi&&(We=N({},u(nt)),Ge=[],vi.html===!0&&(N(We,ot),N(Ge,lt)),vi.svg===!0&&(N(We,Y),N(Ge,At),N(Ge,et)),vi.svgFilters===!0&&(N(We,z),N(Ge,At),N(Ge,et)),vi.mathMl===!0&&(N(We,Z),N(Ge,wt),N(Ge,et))),at.ADD_TAGS&&(We===Mr&&(We=H(We)),N(We,at.ADD_TAGS)),at.ADD_ATTR&&(Ge===pn&&(Ge=H(Ge)),N(Ge,at.ADD_ATTR)),at.ADD_URI_SAFE_ATTR&&N(jr,at.ADD_URI_SAFE_ATTR),at.FORBID_CONTENTS&&(Qn===na&&(Qn=H(Qn)),N(Qn,at.FORBID_CONTENTS)),ho&&(We["#text"]=!0),qn&&N(We,["html","head","body"]),We.table&&(N(We,["tbody"]),delete mr.tbody),U&&U(at),er=at)},sa=N({},["mi","mo","mn","ms","mtext"]),oa=N({},["foreignobject","desc","title","annotation-xml"]),_u=N({},["title","style","font","a","script"]),Vi=N({},Y);N(Vi,z),N(Vi,it);var _s=N({},Z);N(_s,J);var wu=function(at){var Lt=fs(at);Lt&&Lt.tagName||(Lt={namespaceURI:Yi,tagName:"template"});var Pt=P(at.tagName),we=P(Lt.tagName);return at.namespaceURI===Nr?Lt.namespaceURI===Yi?Pt==="svg":Lt.namespaceURI===tr?Pt==="svg"&&(we==="annotation-xml"||sa[we]):!!Vi[Pt]:at.namespaceURI===tr?Lt.namespaceURI===Yi?Pt==="math":Lt.namespaceURI===Nr?Pt==="math"&&oa[we]:!!_s[Pt]:at.namespaceURI===Yi&&!(Lt.namespaceURI===Nr&&!oa[we])&&!(Lt.namespaceURI===tr&&!sa[we])&&!_s[Pt]&&(_u[Pt]||!Vi[Pt])},mn=function(at){x(Bt.removed,{element:at});try{at.parentNode.removeChild(at)}catch{try{at.outerHTML=Qo}catch{at.remove()}}},zr=function(at,Lt){try{x(Bt.removed,{attribute:Lt.getAttributeNode(at),from:Lt})}catch{x(Bt.removed,{attribute:null,from:Lt})}if(Lt.removeAttribute(at),at==="is"&&!Ge[at])if($n||Rr)try{mn(Lt)}catch{}else try{Lt.setAttribute(at,"")}catch{}},ws=function(at){var Lt,Pt;if(co)at="<remove></remove>"+at;else{var we=I(at,/^[\r\n\t ]+/);Pt=we&&we[0]}Br==="application/xhtml+xml"&&(at='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+at+"</body></html>");var Pe=dn?dn.createHTML(at):at;if(gn===Yi)try{Lt=new Ko().parseFromString(Pe,Br)}catch{}if(!Lt||!Lt.documentElement){Lt=oo.createDocument(gn,"template",null);try{Lt.documentElement.innerHTML=go?"":Pe}catch{}}var Qe=Lt.body||Lt.documentElement;return at&&Pt&&Qe.insertBefore(ne.createTextNode(Pt),Qe.childNodes[0]||null),gn===Yi?ta.call(Lt,qn?"html":"body")[0]:qn?Lt.documentElement:Qe},aa=function(at){return Tn.call(at.ownerDocument||at,at,Ir.SHOW_ELEMENT|Ir.SHOW_COMMENT|Ir.SHOW_TEXT,null,!1)},Su=function(at){return at instanceof pu&&(typeof at.nodeName!="string"||typeof at.textContent!="string"||typeof at.removeChild!="function"||!(at.attributes instanceof Vn)||typeof at.removeAttribute!="function"||typeof at.setAttribute!="function"||typeof at.namespaceURI!="string"||typeof at.insertBefore!="function")},Wr=function(at){return s(Xi)==="object"?at instanceof Xi:at&&s(at)==="object"&&typeof at.nodeType=="number"&&typeof at.nodeName=="string"},ni=function(at,Lt,Pt){Fi[at]&&pt(Fi[at],function(we){we.call(Bt,Lt,Pt,er)})},Gr=function(at){var Lt;if(ni("beforeSanitizeElements",at,null),Su(at)||_(/[\u0080-\uFFFF]/,at.nodeName))return mn(at),!0;var Pt=Fn(at.nodeName);if(ni("uponSanitizeElement",at,{tagName:Pt,allowedTags:We}),at.hasChildNodes()&&!Wr(at.firstElementChild)&&(!Wr(at.content)||!Wr(at.content.firstElementChild))&&_(/<[/\w]/g,at.innerHTML)&&_(/<[/\w]/g,at.textContent)||Pt==="select"&&_(/<template/i,at.innerHTML))return mn(at),!0;if(!We[Pt]||mr[Pt]){if(!mr[Pt]&&de(Pt)&&(ke.tagNameCheck instanceof RegExp&&_(ke.tagNameCheck,Pt)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(Pt)))return!1;if(ho&&!Qn[Pt]){var we=fs(at)||at.parentNode,Pe=vu(at)||at.childNodes;if(Pe&&we)for(var Qe=Pe.length-1;Qe>=0;--Qe)we.insertBefore(gu(Pe[Qe],!0),mu(at))}return mn(at),!0}return at instanceof En&&!wu(at)?(mn(at),!0):Pt!=="noscript"&&Pt!=="noembed"||!_(/<\/no(script|embed)/i,at.innerHTML)?(vr&&at.nodeType===3&&(Lt=at.textContent,Lt=k(Lt,ds," "),Lt=k(Lt,Lr," "),at.textContent!==Lt&&(x(Bt.removed,{element:at.cloneNode()}),at.textContent=Lt)),ni("afterSanitizeElements",at,null),!1):(mn(at),!0)},xe=function(at,Lt,Pt){if(ys&&(Lt==="id"||Lt==="name")&&(Pt in ne||Pt in ra))return!1;if(!(vs&&!gs[Lt]&&_(ao,Lt))){if(!(ms&&_(Cu,Lt))){if(!Ge[Lt]||gs[Lt]){if(!(de(at)&&(ke.tagNameCheck instanceof RegExp&&_(ke.tagNameCheck,at)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(at))&&(ke.attributeNameCheck instanceof RegExp&&_(ke.attributeNameCheck,Lt)||ke.attributeNameCheck instanceof Function&&ke.attributeNameCheck(Lt))||Lt==="is"&&ke.allowCustomizedBuiltInElements&&(ke.tagNameCheck instanceof RegExp&&_(ke.tagNameCheck,Pt)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(Pt))))return!1}else if(!jr[Lt]){if(!_(_e,k(Pt,ps,""))){if((Lt!=="src"&&Lt!=="xlink:href"&&Lt!=="href"||at==="script"||K(Pt,"data:")!==0||!fo[at])&&!(uo&&!_(ia,k(Pt,ps,"")))){if(Pt)return!1}}}}}return!0},de=function(at){return at.indexOf("-")>0},Hr=function(at){var Lt,Pt,we,Pe;ni("beforeSanitizeAttributes",at,null);var Qe=at.attributes;if(Qe){var le={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ge};for(Pe=Qe.length;Pe--;){var ir=Lt=Qe[Pe],ri=ir.name,ui=ir.namespaceURI;if(Pt=ri==="value"?Lt.value:S(Lt.value),we=Fn(ri),le.attrName=we,le.attrValue=Pt,le.keepAttr=!0,le.forceKeepAttr=void 0,ni("uponSanitizeAttribute",at,le),Pt=le.attrValue,!le.forceKeepAttr&&(zr(ri,at),le.keepAttr))if(_(/\/>/i,Pt))zr(ri,at);else{vr&&(Pt=k(Pt,ds," "),Pt=k(Pt,Lr," "));var Xr=Fn(at.nodeName);if(xe(Xr,we,Pt))try{ui?at.setAttributeNS(ui,ri,Pt):at.setAttribute(ri,Pt),dt(Bt.removed)}catch{}}}ni("afterSanitizeAttributes",at,null)}},xu=function at(Lt){var Pt,we=aa(Lt);for(ni("beforeSanitizeShadowDOM",Lt,null);Pt=we.nextNode();)ni("uponSanitizeShadowNode",Pt,null),Gr(Pt)||(Pt.content instanceof Oe&&at(Pt.content),Hr(Pt));ni("afterSanitizeShadowDOM",Lt,null)};return Bt.sanitize=function(at,Lt){var Pt,we,Pe,Qe,le;if((go=!at)&&(at="<!-->"),typeof at!="string"&&!Wr(at)){if(typeof at.toString!="function")throw O("toString is not a function");if(typeof(at=at.toString())!="string")throw O("dirty is not a string, aborting")}if(!Bt.isSupported){if(s(Ft.toStaticHTML)==="object"||typeof Ft.toStaticHTML=="function"){if(typeof at=="string")return Ft.toStaticHTML(at);if(Wr(at))return Ft.toStaticHTML(at.outerHTML)}return at}if(lo||Cs(Lt),Bt.removed=[],typeof at=="string"&&(Jn=!1),Jn){if(at.nodeName){var ir=Fn(at.nodeName);if(!We[ir]||mr[ir])throw O("root node is forbidden and cannot be sanitized in-place")}}else if(at instanceof Xi)(we=(Pt=ws("<!---->")).ownerDocument.importNode(at,!0)).nodeType===1&&we.nodeName==="BODY"||we.nodeName==="HTML"?Pt=we:Pt.appendChild(we);else{if(!$n&&!vr&&!qn&&at.indexOf("<")===-1)return dn&&Kn?dn.createHTML(at):at;if(!(Pt=ws(at)))return $n?null:Kn?Qo:""}Pt&&co&&mn(Pt.firstChild);for(var ri=aa(Jn?at:Pt);Pe=ri.nextNode();)Pe.nodeType===3&&Pe===Qe||Gr(Pe)||(Pe.content instanceof Oe&&xu(Pe.content),Hr(Pe),Qe=Pe);if(Qe=null,Jn)return at;if($n){if(Rr)for(le=Zo.call(Pt.ownerDocument);Pt.firstChild;)le.appendChild(Pt.firstChild);else le=Pt;return Ge.shadowroot&&(le=yu.call(Gt,le,!0)),le}var ui=qn?Pt.outerHTML:Pt.innerHTML;return qn&&We["!doctype"]&&Pt.ownerDocument&&Pt.ownerDocument.doctype&&Pt.ownerDocument.doctype.name&&_(Le,Pt.ownerDocument.doctype.name)&&(ui="<!DOCTYPE "+Pt.ownerDocument.doctype.name+`>
`+ui),vr&&(ui=k(ui,ds," "),ui=k(ui,Lr," ")),dn&&Kn?dn.createHTML(ui):ui},Bt.setConfig=function(at){Cs(at),lo=!0},Bt.clearConfig=function(){er=null,lo=!1},Bt.isValidAttribute=function(at,Lt,Pt){er||Cs({});var we=Fn(at),Pe=Fn(Lt);return xe(we,Pe,Pt)},Bt.addHook=function(at,Lt){typeof Lt=="function"&&(Fi[at]=Fi[at]||[],x(Fi[at],Lt))},Bt.removeHook=function(at){if(Fi[at])return dt(Fi[at])},Bt.removeHooks=function(at){Fi[at]&&(Fi[at]=[])},Bt.removeAllHooks=function(){Fi={}},Bt}return Ei()}()},729:n=>{"use strict";var s=Object.prototype.hasOwnProperty,r="~";function a(){}function l(d,g,m){this.fn=d,this.context=g,this.once=m||!1}function u(d,g,m,y,C){if(typeof m!="function")throw new TypeError("The listener must be a function");var w=new l(m,y||d,C),F=r?r+g:g;return d._events[F]?d._events[F].fn?d._events[F]=[d._events[F],w]:d._events[F].push(w):(d._events[F]=w,d._eventsCount++),d}function c(d,g){--d._eventsCount==0?d._events=new a:delete d._events[g]}function h(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1)),h.prototype.eventNames=function(){var d,g,m=[];if(this._eventsCount===0)return m;for(g in d=this._events)s.call(d,g)&&m.push(r?g.slice(1):g);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(d)):m},h.prototype.listeners=function(d){var g=r?r+d:d,m=this._events[g];if(!m)return[];if(m.fn)return[m.fn];for(var y=0,C=m.length,w=new Array(C);y<C;y++)w[y]=m[y].fn;return w},h.prototype.listenerCount=function(d){var g=r?r+d:d,m=this._events[g];return m?m.fn?1:m.length:0},h.prototype.emit=function(d,g,m,y,C,w){var F=r?r+d:d;if(!this._events[F])return!1;var B,U,R=this._events[F],W=arguments.length;if(R.fn){switch(R.once&&this.removeListener(d,R.fn,void 0,!0),W){case 1:return R.fn.call(R.context),!0;case 2:return R.fn.call(R.context,g),!0;case 3:return R.fn.call(R.context,g,m),!0;case 4:return R.fn.call(R.context,g,m,y),!0;case 5:return R.fn.call(R.context,g,m,y,C),!0;case 6:return R.fn.call(R.context,g,m,y,C,w),!0}for(U=1,B=new Array(W-1);U<W;U++)B[U-1]=arguments[U];R.fn.apply(R.context,B)}else{var X,$=R.length;for(U=0;U<$;U++)switch(R[U].once&&this.removeListener(d,R[U].fn,void 0,!0),W){case 1:R[U].fn.call(R[U].context);break;case 2:R[U].fn.call(R[U].context,g);break;case 3:R[U].fn.call(R[U].context,g,m);break;case 4:R[U].fn.call(R[U].context,g,m,y);break;default:if(!B)for(X=1,B=new Array(W-1);X<W;X++)B[X-1]=arguments[X];R[U].fn.apply(R[U].context,B)}}return!0},h.prototype.on=function(d,g,m){return u(this,d,g,m,!1)},h.prototype.once=function(d,g,m){return u(this,d,g,m,!0)},h.prototype.removeListener=function(d,g,m,y){var C=r?r+d:d;if(!this._events[C])return this;if(!g)return c(this,C),this;var w=this._events[C];if(w.fn)w.fn!==g||y&&!w.once||m&&w.context!==m||c(this,C);else{for(var F=0,B=[],U=w.length;F<U;F++)(w[F].fn!==g||y&&!w[F].once||m&&w[F].context!==m)&&B.push(w[F]);B.length?this._events[C]=B.length===1?B[0]:B:c(this,C)}return this},h.prototype.removeAllListeners=function(d){var g;return d?(g=r?r+d:d,this._events[g]&&c(this,g)):(this._events=new a,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=r,h.EventEmitter=h,n.exports=h},717:n=>{typeof Object.create=="function"?n.exports=function(s,r){s.super_=r,s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(s,r){s.super_=r;var a=function(){};a.prototype=r.prototype,s.prototype=new a,s.prototype.constructor=s}},824:n=>{var s=1e3,r=60*s,a=60*r,l=24*a,u=7*l,c=365.25*l;function h(d,g,m,y){var C=g>=1.5*m;return Math.round(d/m)+" "+y+(C?"s":"")}n.exports=function(d,g){g=g||{};var m=typeof d;if(m==="string"&&d.length>0)return function(y){if(!((y=String(y)).length>100)){var C=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(C){var w=parseFloat(C[1]);switch((C[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return w*c;case"weeks":case"week":case"w":return w*u;case"days":case"day":case"d":return w*l;case"hours":case"hour":case"hrs":case"hr":case"h":return w*a;case"minutes":case"minute":case"mins":case"min":case"m":return w*r;case"seconds":case"second":case"secs":case"sec":case"s":return w*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}(d);if(m==="number"&&isFinite(d))return g.long?function(y){var C=Math.abs(y);return C>=l?h(y,C,l,"day"):C>=a?h(y,C,a,"hour"):C>=r?h(y,C,r,"minute"):C>=s?h(y,C,s,"second"):y+" ms"}(d):function(y){var C=Math.abs(y);return C>=l?Math.round(y/l)+"d":C>=a?Math.round(y/a)+"h":C>=r?Math.round(y/r)+"m":C>=s?Math.round(y/s)+"s":y+"ms"}(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},520:(n,s,r)=>{"use strict";var a=r(155),l=a.platform==="win32",u=r(539);function c(R,W){for(var X=[],$=0;$<R.length;$++){var st=R[$];st&&st!=="."&&(st===".."?X.length&&X[X.length-1]!==".."?X.pop():W&&X.push(".."):X.push(st))}return X}function h(R){for(var W=R.length-1,X=0;X<=W&&!R[X];X++);for(var $=W;$>=0&&!R[$];$--);return X===0&&$===W?R:X>$?[]:R.slice(X,$+1)}var d=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,g=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,m={};function y(R){var W=d.exec(R),X=(W[1]||"")+(W[2]||""),$=W[3]||"",st=g.exec($);return[X,st[1],st[2],st[3]]}function C(R){var W=d.exec(R),X=W[1]||"",$=!!X&&X[1]!==":";return{device:X,isUnc:$,isAbsolute:$||!!W[2],tail:W[3]}}function w(R){return"\\\\"+R.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}m.resolve=function(){for(var R="",W="",X=!1,$=arguments.length-1;$>=-1;$--){var st;if($>=0?st=arguments[$]:R?(st=a.env["="+R])&&st.substr(0,3).toLowerCase()===R.toLowerCase()+"\\"||(st=R+"\\"):st=a.cwd(),!u.isString(st))throw new TypeError("Arguments to path.resolve must be strings");if(st){var pt=C(st),dt=pt.device,x=pt.isUnc,P=pt.isAbsolute,I=pt.tail;if((!dt||!R||dt.toLowerCase()===R.toLowerCase())&&(R||(R=dt),X||(W=I+"\\"+W,X=P),R&&X))break}}return x&&(R=w(R)),R+(X?"\\":"")+(W=c(W.split(/[\\\/]+/),!X).join("\\"))||"."},m.normalize=function(R){var W=C(R),X=W.device,$=W.isUnc,st=W.isAbsolute,pt=W.tail,dt=/[\\\/]$/.test(pt);return(pt=c(pt.split(/[\\\/]+/),!st).join("\\"))||st||(pt="."),pt&&dt&&(pt+="\\"),$&&(X=w(X)),X+(st?"\\":"")+pt},m.isAbsolute=function(R){return C(R).isAbsolute},m.join=function(){for(var R=[],W=0;W<arguments.length;W++){var X=arguments[W];if(!u.isString(X))throw new TypeError("Arguments to path.join must be strings");X&&R.push(X)}var $=R.join("\\");return/^[\\\/]{2}[^\\\/]/.test(R[0])||($=$.replace(/^[\\\/]{2,}/,"\\")),m.normalize($)},m.relative=function(R,W){R=m.resolve(R),W=m.resolve(W);for(var X=R.toLowerCase(),$=W.toLowerCase(),st=h(W.split("\\")),pt=h(X.split("\\")),dt=h($.split("\\")),x=Math.min(pt.length,dt.length),P=x,I=0;I<x;I++)if(pt[I]!==dt[I]){P=I;break}if(P==0)return W;var k=[];for(I=P;I<pt.length;I++)k.push("..");return(k=k.concat(st.slice(P))).join("\\")},m._makeLong=function(R){if(!u.isString(R))return R;if(!R)return"";var W=m.resolve(R);return/^[a-zA-Z]\:\\/.test(W)?"\\\\?\\"+W:/^\\\\[^?.]/.test(W)?"\\\\?\\UNC\\"+W.substring(2):R},m.dirname=function(R){var W=y(R),X=W[0],$=W[1];return X||$?($&&($=$.substr(0,$.length-1)),X+$):"."},m.basename=function(R,W){var X=y(R)[2];return W&&X.substr(-1*W.length)===W&&(X=X.substr(0,X.length-W.length)),X},m.extname=function(R){return y(R)[3]},m.format=function(R){if(!u.isObject(R))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof R);var W=R.root||"";if(!u.isString(W))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof R.root);var X=R.dir,$=R.base||"";return X?X[X.length-1]===m.sep?X+$:X+m.sep+$:$},m.parse=function(R){if(!u.isString(R))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof R);var W=y(R);if(!W||W.length!==4)throw new TypeError("Invalid path '"+R+"'");return{root:W[0],dir:W[0]+W[1].slice(0,-1),base:W[2],ext:W[3],name:W[2].slice(0,W[2].length-W[3].length)}},m.sep="\\",m.delimiter=";";var F=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,B={};function U(R){return F.exec(R).slice(1)}B.resolve=function(){for(var R="",W=!1,X=arguments.length-1;X>=-1&&!W;X--){var $=X>=0?arguments[X]:a.cwd();if(!u.isString($))throw new TypeError("Arguments to path.resolve must be strings");$&&(R=$+"/"+R,W=$[0]==="/")}return(W?"/":"")+(R=c(R.split("/"),!W).join("/"))||"."},B.normalize=function(R){var W=B.isAbsolute(R),X=R&&R[R.length-1]==="/";return(R=c(R.split("/"),!W).join("/"))||W||(R="."),R&&X&&(R+="/"),(W?"/":"")+R},B.isAbsolute=function(R){return R.charAt(0)==="/"},B.join=function(){for(var R="",W=0;W<arguments.length;W++){var X=arguments[W];if(!u.isString(X))throw new TypeError("Arguments to path.join must be strings");X&&(R+=R?"/"+X:X)}return B.normalize(R)},B.relative=function(R,W){R=B.resolve(R).substr(1),W=B.resolve(W).substr(1);for(var X=h(R.split("/")),$=h(W.split("/")),st=Math.min(X.length,$.length),pt=st,dt=0;dt<st;dt++)if(X[dt]!==$[dt]){pt=dt;break}var x=[];for(dt=pt;dt<X.length;dt++)x.push("..");return(x=x.concat($.slice(pt))).join("/")},B._makeLong=function(R){return R},B.dirname=function(R){var W=U(R),X=W[0],$=W[1];return X||$?($&&($=$.substr(0,$.length-1)),X+$):"."},B.basename=function(R,W){var X=U(R)[2];return W&&X.substr(-1*W.length)===W&&(X=X.substr(0,X.length-W.length)),X},B.extname=function(R){return U(R)[3]},B.format=function(R){if(!u.isObject(R))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof R);var W=R.root||"";if(!u.isString(W))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof R.root);return(R.dir?R.dir+B.sep:"")+(R.base||"")},B.parse=function(R){if(!u.isString(R))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof R);var W=U(R);if(!W||W.length!==4)throw new TypeError("Invalid path '"+R+"'");return W[1]=W[1]||"",W[2]=W[2]||"",W[3]=W[3]||"",{root:W[0],dir:W[0]+W[1].slice(0,-1),base:W[2],ext:W[3],name:W[2].slice(0,W[2].length-W[3].length)}},B.sep="/",B.delimiter=":",n.exports=l?m:B,n.exports.posix=B,n.exports.win32=m},155:n=>{var s,r,a=n.exports={};function l(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(B){if(s===setTimeout)return setTimeout(B,0);if((s===l||!s)&&setTimeout)return s=setTimeout,setTimeout(B,0);try{return s(B,0)}catch{try{return s.call(null,B,0)}catch{return s.call(this,B,0)}}}(function(){try{s=typeof setTimeout=="function"?setTimeout:l}catch{s=l}try{r=typeof clearTimeout=="function"?clearTimeout:u}catch{r=u}})();var h,d=[],g=!1,m=-1;function y(){g&&h&&(g=!1,h.length?d=h.concat(d):m=-1,d.length&&C())}function C(){if(!g){var B=c(y);g=!0;for(var U=d.length;U;){for(h=d,d=[];++m<U;)h&&h[m].run();m=-1,U=d.length}h=null,g=!1,function(R){if(r===clearTimeout)return clearTimeout(R);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(R);try{r(R)}catch{try{return r.call(null,R)}catch{return r.call(this,R)}}}(B)}}function w(B,U){this.fun=B,this.array=U}function F(){}a.nextTick=function(B){var U=new Array(arguments.length-1);if(arguments.length>1)for(var R=1;R<arguments.length;R++)U[R-1]=arguments[R];d.push(new w(B,U)),d.length!==1||g||c(C)},w.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=F,a.addListener=F,a.once=F,a.off=F,a.removeListener=F,a.removeAllListeners=F,a.emit=F,a.prependListener=F,a.prependOnceListener=F,a.listeners=function(B){return[]},a.binding=function(B){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(B){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},384:n=>{n.exports=function(s){return s&&typeof s=="object"&&typeof s.copy=="function"&&typeof s.fill=="function"&&typeof s.readUInt8=="function"}},539:(n,s,r)=>{var a=r(155),l=/%[sdj%]/g;s.format=function(S){if(!R(S)){for(var _=[],O=0;O<arguments.length;O++)_.push(h(arguments[O]));return _.join(" ")}O=1;for(var j=arguments,q=j.length,N=String(S).replace(l,function(Q){if(Q==="%%")return"%";if(O>=q)return Q;switch(Q){case"%s":return String(j[O++]);case"%d":return Number(j[O++]);case"%j":try{return JSON.stringify(j[O++])}catch{return"[Circular]"}default:return Q}}),H=j[O];O<q;H=j[++O])B(H)||!$(H)?N+=" "+H:N+=" "+h(H);return N},s.deprecate=function(S,_){if(W(r.g.process))return function(){return s.deprecate(S,_).apply(this,arguments)};if(a.noDeprecation===!0)return S;var O=!1;return function(){if(!O){if(a.throwDeprecation)throw new Error(_);a.traceDeprecation?console.trace(_):console.error(_),O=!0}return S.apply(this,arguments)}};var u,c={};function h(S,_){var O={seen:[],stylize:g};return arguments.length>=3&&(O.depth=arguments[2]),arguments.length>=4&&(O.colors=arguments[3]),F(_)?O.showHidden=_:_&&s._extend(O,_),W(O.showHidden)&&(O.showHidden=!1),W(O.depth)&&(O.depth=2),W(O.colors)&&(O.colors=!1),W(O.customInspect)&&(O.customInspect=!0),O.colors&&(O.stylize=d),m(O,S,O.depth)}function d(S,_){var O=h.styles[_];return O?"\x1B["+h.colors[O][0]+"m"+S+"\x1B["+h.colors[O][1]+"m":S}function g(S,_){return S}function m(S,_,O){if(S.customInspect&&_&&dt(_.inspect)&&_.inspect!==s.inspect&&(!_.constructor||_.constructor.prototype!==_)){var j=_.inspect(O,S);return R(j)||(j=m(S,j,O)),j}var q=function(Z,J){if(W(J))return Z.stylize("undefined","undefined");if(R(J)){var nt="'"+JSON.stringify(J).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Z.stylize(nt,"string")}if(U(J))return Z.stylize(""+J,"number");if(F(J))return Z.stylize(""+J,"boolean");if(B(J))return Z.stylize("null","null")}(S,_);if(q)return q;var N=Object.keys(_),H=function(Z){var J={};return Z.forEach(function(nt,lt){J[nt]=!0}),J}(N);if(S.showHidden&&(N=Object.getOwnPropertyNames(_)),pt(_)&&(N.indexOf("message")>=0||N.indexOf("description")>=0))return y(_);if(N.length===0){if(dt(_)){var Q=_.name?": "+_.name:"";return S.stylize("[Function"+Q+"]","special")}if(X(_))return S.stylize(RegExp.prototype.toString.call(_),"regexp");if(st(_))return S.stylize(Date.prototype.toString.call(_),"date");if(pt(_))return y(_)}var ot,Y="",z=!1,it=["{","}"];return w(_)&&(z=!0,it=["[","]"]),dt(_)&&(Y=" [Function"+(_.name?": "+_.name:"")+"]"),X(_)&&(Y=" "+RegExp.prototype.toString.call(_)),st(_)&&(Y=" "+Date.prototype.toUTCString.call(_)),pt(_)&&(Y=" "+y(_)),N.length!==0||z&&_.length!=0?O<0?X(_)?S.stylize(RegExp.prototype.toString.call(_),"regexp"):S.stylize("[Object]","special"):(S.seen.push(_),ot=z?function(Z,J,nt,lt,At){for(var wt=[],et=0,yt=J.length;et<yt;++et)K(J,String(et))?wt.push(C(Z,J,nt,lt,String(et),!0)):wt.push("");return At.forEach(function(Tt){Tt.match(/^\d+$/)||wt.push(C(Z,J,nt,lt,Tt,!0))}),wt}(S,_,O,H,N):N.map(function(Z){return C(S,_,O,H,Z,z)}),S.seen.pop(),function(Z,J,nt){return Z.reduce(function(lt,At){return At.indexOf(`
`)>=0,lt+At.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?nt[0]+(J===""?"":J+`
 `)+" "+Z.join(`,
  `)+" "+nt[1]:nt[0]+J+" "+Z.join(", ")+" "+nt[1]}(ot,Y,it)):it[0]+Y+it[1]}function y(S){return"["+Error.prototype.toString.call(S)+"]"}function C(S,_,O,j,q,N){var H,Q,ot;if((ot=Object.getOwnPropertyDescriptor(_,q)||{value:_[q]}).get?Q=ot.set?S.stylize("[Getter/Setter]","special"):S.stylize("[Getter]","special"):ot.set&&(Q=S.stylize("[Setter]","special")),K(j,q)||(H="["+q+"]"),Q||(S.seen.indexOf(ot.value)<0?(Q=B(O)?m(S,ot.value,null):m(S,ot.value,O-1)).indexOf(`
`)>-1&&(Q=N?Q.split(`
`).map(function(Y){return"  "+Y}).join(`
`).substr(2):`
`+Q.split(`
`).map(function(Y){return"   "+Y}).join(`
`)):Q=S.stylize("[Circular]","special")),W(H)){if(N&&q.match(/^\d+$/))return Q;(H=JSON.stringify(""+q)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(H=H.substr(1,H.length-2),H=S.stylize(H,"name")):(H=H.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),H=S.stylize(H,"string"))}return H+": "+Q}function w(S){return Array.isArray(S)}function F(S){return typeof S=="boolean"}function B(S){return S===null}function U(S){return typeof S=="number"}function R(S){return typeof S=="string"}function W(S){return S===void 0}function X(S){return $(S)&&x(S)==="[object RegExp]"}function $(S){return typeof S=="object"&&S!==null}function st(S){return $(S)&&x(S)==="[object Date]"}function pt(S){return $(S)&&(x(S)==="[object Error]"||S instanceof Error)}function dt(S){return typeof S=="function"}function x(S){return Object.prototype.toString.call(S)}function P(S){return S<10?"0"+S.toString(10):S.toString(10)}s.debuglog=function(S){if(W(u)&&(u=a.env.NODE_DEBUG||""),S=S.toUpperCase(),!c[S])if(new RegExp("\\b"+S+"\\b","i").test(u)){var _=a.pid;c[S]=function(){var O=s.format.apply(s,arguments);console.error("%s %d: %s",S,_,O)}}else c[S]=function(){};return c[S]},s.inspect=h,h.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},h.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},s.isArray=w,s.isBoolean=F,s.isNull=B,s.isNullOrUndefined=function(S){return S==null},s.isNumber=U,s.isString=R,s.isSymbol=function(S){return typeof S=="symbol"},s.isUndefined=W,s.isRegExp=X,s.isObject=$,s.isDate=st,s.isError=pt,s.isFunction=dt,s.isPrimitive=function(S){return S===null||typeof S=="boolean"||typeof S=="number"||typeof S=="string"||typeof S=="symbol"||S===void 0},s.isBuffer=r(384);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var S=new Date,_=[P(S.getHours()),P(S.getMinutes()),P(S.getSeconds())].join(":");return[S.getDate(),I[S.getMonth()],_].join(" ")}function K(S,_){return Object.prototype.hasOwnProperty.call(S,_)}s.log=function(){console.log("%s - %s",k(),s.format.apply(s,arguments))},s.inherits=r(717),s._extend=function(S,_){if(!_||!$(_))return S;for(var O=Object.keys(_),j=O.length;j--;)S[O[j]]=_[O[j]];return S}}},t={};function i(n){var s=t[n];if(s!==void 0)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}i.n=n=>{var s=n&&n.__esModule?()=>n.default:()=>n;return i.d(s,{a:s}),s},i.d=(n,s)=>{for(var r in s)i.o(s,r)&&!i.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:s[r]})},i.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),i.o=(n,s)=>Object.prototype.hasOwnProperty.call(n,s),i.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var o={};return(()=>{"use strict";i.r(o),i.d(o,{LSPluginUser:()=>ku,setupPluginUserInstance:()=>Pu});var n=i(520),s=(i(856),i(996)),r=i.n(s),a=function(){return a=Object.assign||function(T){for(var A,L=1,tt=arguments.length;L<tt;L++)for(var ft in A=arguments[L])Object.prototype.hasOwnProperty.call(A,ft)&&(T[ft]=A[ft]);return T},a.apply(this,arguments)};function l(T){return T.toLowerCase()}var u=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],c=/[^A-Z0-9]+/gi;function h(T,A,L){return A instanceof RegExp?T.replace(A,L):A.reduce(function(tt,ft){return tt.replace(ft,L)},T)}function d(T,A){return A===void 0&&(A={}),function(L,tt){tt===void 0&&(tt={});for(var ft=tt.splitRegexp,mt=ft===void 0?u:ft,vt=tt.stripRegexp,bt=vt===void 0?c:vt,kt=tt.transform,Ut=kt===void 0?l:kt,re=tt.delimiter,Wt=re===void 0?" ":re,Xt=h(h(L,mt,"$1\0$2"),bt,"\0"),Vt=0,Yt=Xt.length;Xt.charAt(Vt)==="\0";)Vt++;for(;Xt.charAt(Yt-1)==="\0";)Yt--;return Xt.slice(Vt,Yt).split("\0").map(Ut).join(Wt)}(T,a({delimiter:"."},A))}var g=i(729),m=i.n(g);function y(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}let C=navigator.platform.toLowerCase()==="win32"?n.win32:n.posix,w=function(T,A){return A===void 0&&(A={}),d(T,a({delimiter:"_"},A))};class F extends m(){constructor(A,L){super(),y(this,"_tag",void 0),y(this,"_opts",void 0),y(this,"_logs",[]),this._tag=A,this._opts=L}write(A,L,tt){var ft;L!=null&&L.length&&L[L.length-1]===!0&&(tt=!0,L.pop());let mt=L.reduce((bt,kt)=>(kt&&kt instanceof Error?bt+=`${kt.message} ${kt.stack}`:bt+=kt.toString(),bt),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var vt;this._logs.push([A,mt]),(tt||(ft=this._opts)!==null&&ft!==void 0&&ft.console)&&((vt=console)===null||vt===void 0||vt[A==="ERROR"?"error":"debug"](`${A}: ${mt}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...A){this.write("INFO",A)}error(...A){this.write("ERROR",A)}warn(...A){this.write("WARN",A)}setTag(A){this._tag=A}toJSON(){return this._logs}}function B(T,...A){try{let L=new URL(T);if(!L.origin)throw new Error(null);let tt=C.join(T.substr(L.origin.length),...A);return L.origin+tt}catch{return C.join(T,...A)}}function U(T,A){let L,tt,ft=!1,mt=bt=>kt=>{T&&clearTimeout(T),bt(kt),ft=!0},vt=new Promise((bt,kt)=>{L=mt(bt),tt=mt(kt),T&&(T=setTimeout(()=>tt(new Error(`[deferred timeout] ${A}`)),T))});return{created:Date.now(),setTag:bt=>A=bt,resolve:L,reject:tt,promise:vt,get settled(){return ft}}}let R=new Map;window.__injectedUIEffects=R;var W=i(227),X=i.n(W);function $(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}let st="application/x-postmate-v1+json",pt=0,dt={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},x=(T,A)=>(typeof A!="string"||T.origin===A)&&!!T.data&&(typeof T.data!="object"||"postmate"in T.data)&&T.data.type===st&&!!dt[T.data.postmate];class P{constructor(A){$(this,"parent",void 0),$(this,"frame",void 0),$(this,"child",void 0),$(this,"events",{}),$(this,"childOrigin",void 0),$(this,"listener",void 0),this.parent=A.parent,this.frame=A.frame,this.child=A.child,this.childOrigin=A.childOrigin,this.listener=L=>{if(!x(L,this.childOrigin))return!1;let{data:tt,name:ft}=((L||{}).data||{}).value||{};L.data.postmate==="emit"&&ft in this.events&&this.events[ft].forEach(mt=>{mt.call(this,tt)})},this.parent.addEventListener("message",this.listener,!1)}get(A,...L){return new Promise((tt,ft)=>{let mt=++pt,vt=bt=>{bt.data.uid===mt&&bt.data.postmate==="reply"&&(this.parent.removeEventListener("message",vt,!1),bt.data.error?ft(bt.data.error):tt(bt.data.value))};this.parent.addEventListener("message",vt,!1),this.child.postMessage({postmate:"request",type:st,property:A,args:L,uid:mt},this.childOrigin)})}call(A,L){this.child.postMessage({postmate:"call",type:st,property:A,data:L},this.childOrigin)}on(A,L){this.events[A]||(this.events[A]=[]),this.events[A].push(L)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class I{constructor(A){$(this,"model",void 0),$(this,"parent",void 0),$(this,"parentOrigin",void 0),$(this,"child",void 0),this.model=A.model,this.parent=A.parent,this.parentOrigin=A.parentOrigin,this.child=A.child,this.child.addEventListener("message",L=>{if(!x(L,this.parentOrigin))return;let{property:tt,uid:ft,data:mt,args:vt}=L.data;L.data.postmate!=="call"?((bt,kt,Ut)=>{let re=typeof bt[kt]=="function"?bt[kt].apply(null,Ut):bt[kt];return Promise.resolve(re)})(this.model,tt,vt).then(bt=>{L.source.postMessage({property:tt,postmate:"reply",type:st,uid:ft,value:bt},L.origin)}).catch(bt=>{L.source.postMessage({property:tt,postmate:"reply",type:st,uid:ft,error:bt},L.origin)}):tt in this.model&&typeof this.model[tt]=="function"&&this.model[tt](mt)})}emit(A,L){this.parent.postMessage({postmate:"emit",type:st,value:{name:A,data:L}},this.parentOrigin)}}class k{constructor(A){$(this,"container",void 0),$(this,"parent",void 0),$(this,"frame",void 0),$(this,"child",void 0),$(this,"childOrigin",void 0),$(this,"url",void 0),$(this,"model",void 0),this.container=A.container,this.url=A.url,this.parent=window,this.frame=document.createElement("iframe"),A.id&&(this.frame.id=A.id),A.name&&(this.frame.name=A.name),this.frame.classList.add.apply(this.frame.classList,A.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=A.model||{}}sendHandshake(A){let L=(mt=>{let vt=document.createElement("a");vt.href=mt;let bt=vt.protocol.length>4?vt.protocol:window.location.protocol,kt=vt.host.length?vt.port==="80"||vt.port==="443"?vt.hostname:vt.host:window.location.host;return vt.origin||`${bt}//${kt}`})(A=A||this.url),tt,ft=0;return new Promise((mt,vt)=>{let bt=Ut=>!!x(Ut,L)&&(Ut.data.postmate==="handshake-reply"?(clearInterval(tt),this.parent.removeEventListener("message",bt,!1),this.childOrigin=Ut.origin,mt(new P(this))):vt("Failed handshake"));this.parent.addEventListener("message",bt,!1);let kt=()=>{ft++,this.child.postMessage({postmate:"handshake",type:st,model:this.model},L),ft===5&&clearInterval(tt)};this.frame.addEventListener("load",()=>{kt(),tt=setInterval(kt,500)}),this.frame.src=A})}destroy(){this.frame.parentNode.removeChild(this.frame)}}$(k,"debug",!1),$(k,"Model",void 0);class K{constructor(A){$(this,"child",void 0),$(this,"model",void 0),$(this,"parent",void 0),$(this,"parentOrigin",void 0),this.child=window,this.model=A,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((A,L)=>{let tt=ft=>{if(ft.data.postmate){if(ft.data.postmate==="handshake"){this.child.removeEventListener("message",tt,!1),ft.source.postMessage({postmate:"handshake-reply",type:st},ft.origin),this.parentOrigin=ft.origin;let mt=ft.data.model;return mt&&Object.keys(mt).forEach(vt=>{this.model[vt]=mt[vt]}),A(new I(this))}return L("Handshake Reply Failed")}};this.child.addEventListener("message",tt,!1)})}}function S(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}let{importHTML:_,createSandboxContainer:O}=window.QSandbox||{};function j(T,A){return T.startsWith("http")?fetch(T,A):(T=T.replace("file://",""),new Promise(async(L,tt)=>{try{let ft=await window.apis.doAction(["readFile",T]);L({text:()=>ft})}catch(ft){console.error(ft),tt(ft)}}))}class q extends m(){constructor(A){super(),S(this,"_pluginLocal",void 0),S(this,"_frame",void 0),S(this,"_root",void 0),S(this,"_loaded",!1),S(this,"_unmountFns",[]),this._pluginLocal=A,A._dispose(()=>{this._unmount()})}async load(){let{name:A,entry:L}=this._pluginLocal.options;if(this.loaded||!L)return;let{template:tt,execScripts:ft}=await _(L,{fetch:j});this._mount(tt,document.body);let mt=O(A,{elementGetter:()=>{var bt;return(bt=this._root)===null||bt===void 0?void 0:bt.firstChild}}).instance.proxy;mt.__shadow_mode__=!0,mt.LSPluginLocal=this._pluginLocal,mt.LSPluginShadow=this,mt.LSPluginUser=mt.logseq=new ku(this._pluginLocal.toJSON(),this._pluginLocal.caller);let vt=await ft(mt,!0);this._unmountFns.push(vt.unmount),this._loaded=!0}_mount(A,L){let tt=this._frame=document.createElement("div");tt.classList.add("lsp-shadow-sandbox"),tt.id=this._pluginLocal.id,this._root=tt.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${A}</div>`,L.appendChild(tt),this.emit("mounted")}_unmount(){for(let A of this._unmountFns)A&&A.call(null)}destroy(){var A,L;(A=this.frame)===null||A===void 0||(L=A.parentNode)===null||L===void 0||L.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var A;return(A=this._root)===null||A===void 0?void 0:A.firstChild}get frame(){return this._frame}}function N(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}let H=X()("LSPlugin:caller"),Q="#await#response#",ot="#lspmsg#",Y="#lspmsg#error#",z=T=>`#lspmsg#${T}`;class it extends m(){constructor(A){super(),N(this,"_pluginLocal",void 0),N(this,"_connected",!1),N(this,"_parent",void 0),N(this,"_child",void 0),N(this,"_shadow",void 0),N(this,"_status",void 0),N(this,"_userModel",{}),N(this,"_call",void 0),N(this,"_callUserModel",void 0),N(this,"_debugTag",""),this._pluginLocal=A,A&&(this._debugTag=A.debugTag)}async connectToChild(){if(this._connected)return;let{shadow:A}=this._pluginLocal;A?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(A={}){if(this._connected)return;let L=this,tt=this._pluginLocal!=null,ft=0,mt=0,vt=new Map,bt=U(6e4),kt=this._extendUserModel({"#lspmsg#ready#":async Wt=>{kt[z(Wt?.pid)]=({type:Xt,payload:Vt})=>{H(`[host (_call) -> *user] ${this._debugTag}`,Xt,Vt),L.emit(Xt,Vt)},await bt.resolve()},"#lspmsg#beforeunload#":async Wt=>{let Xt=U(1e4);L.emit("beforeunload",Object.assign({actor:Xt},Wt)),await Xt.promise},"#lspmsg#settings#":async({type:Wt,payload:Xt})=>{L.emit("settings:changed",Xt)},[ot]:async({ns:Wt,type:Xt,payload:Vt})=>{H(`[host (async) -> *user] ${this._debugTag} ns=${Wt} type=${Xt}`,Vt),Wt&&Wt.startsWith("hook")?L.emit(`${Wt}:${Xt}`,Vt):L.emit(Xt,Vt)},"#lspmsg#reply#":({_sync:Wt,result:Xt})=>{if(H(`[sync host -> *user] #${Wt}`,Xt),vt.has(Wt)){let Vt=vt.get(Wt);Vt&&(Xt!=null&&Xt.hasOwnProperty(Y)?Vt.reject(Xt[Y]):Vt.resolve(Xt),vt.delete(Wt))}},...A});var Ut;if(tt)return await bt.promise,JSON.parse(JSON.stringify((Ut=this._pluginLocal)===null||Ut===void 0?void 0:Ut.toJSON()));let re=new K(kt).sendHandshakeReply();return this._status="pending",await re.then(Wt=>{this._child=Wt,this._connected=!0,this._call=async(Xt,Vt={},Yt)=>{if(Yt){let ce=++mt;vt.set(ce,Yt),Vt._sync=ce,Yt.setTag(`async call #${ce}`),H(`async call #${ce}`)}return Wt.emit(z(kt.baseInfo.id),{type:Xt,payload:Vt}),Yt?.promise},this._callUserModel=async(Xt,Vt)=>{try{kt[Xt](Vt)}catch{H(`[model method] #${Xt} not existed`)}},ft=setInterval(()=>{if(vt.size>100)for(let[Xt,Vt]of vt)Vt.settled&&vt.delete(Xt)},18e5)}).finally(()=>{this._status=void 0}),await bt.promise,kt.baseInfo}async call(A,L={}){var tt;return(tt=this._call)===null||tt===void 0?void 0:tt.call(this,A,L)}async callAsync(A,L={}){var tt;let ft=U(1e4);return(tt=this._call)===null||tt===void 0?void 0:tt.call(this,A,L,ft)}async callUserModel(A,...L){var tt;return(tt=this._callUserModel)===null||tt===void 0?void 0:tt.apply(this,[A,...L])}async callUserModelAsync(A,...L){var tt;return A=`${Q}${A}`,(tt=this._callUserModel)===null||tt===void 0?void 0:tt.apply(this,[A,...L])}async _setupIframeSandbox(){let A=this._pluginLocal,L=A.id,tt=`${L}_lsp_main`,ft=new URL(A.options.entry);ft.searchParams.set("__v__",A.options.version);let mt=document.querySelector(`#${tt}`);mt&&mt.parentElement.removeChild(mt);let vt=document.createElement("div");vt.classList.add("lsp-iframe-sandbox-container"),vt.id=tt,vt.dataset.pid=L;try{var bt;let Wt=(bt=await this._pluginLocal._loadLayoutsData())===null||bt===void 0?void 0:bt.$$0;if(Wt){vt.dataset.inited_layout="true";let{width:Xt,height:Vt,left:Yt,top:ce,vw:Ee,vh:He}=Wt;Yt=Math.max(Yt,0),Yt=typeof Ee=="number"?`${Math.min(100*Yt/Ee,99)}%`:`${Yt}px`,ce=Math.max(ce,45),ce=typeof He=="number"?`${Math.min(100*ce/He,99)}%`:`${ce}px`,Object.assign(vt.style,{width:Xt+"px",height:Vt+"px",left:Yt,top:ce})}}catch(Wt){console.error("[Restore Layout Error]",Wt)}document.body.appendChild(vt);let kt=new k({id:L+"_iframe",container:vt,url:ft.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(A.toJSON()))}}),Ut,re=kt.sendHandshake();return this._status="pending",new Promise((Wt,Xt)=>{Ut=setTimeout(()=>{Xt(new Error("handshake Timeout")),kt.destroy()},4e3),re.then(Vt=>{this._parent=Vt,this._connected=!0,this.emit("connected"),Vt.on(z(A.id),({type:Yt,payload:ce})=>{var Ee,He;H("[user -> *host] ",Yt,ce),(Ee=this._pluginLocal)===null||Ee===void 0||Ee.emit(Yt,ce||{}),(He=this._pluginLocal)===null||He===void 0||He.caller.emit(Yt,ce||{})}),this._call=async(...Yt)=>{await Vt.call(z(A.id),{type:Yt[0],payload:Object.assign(Yt[1]||{},{$$pid:A.id})})},this._callUserModel=async(Yt,...ce)=>{if(Yt.startsWith(Q))return await Vt.get(Yt.replace(Q,""),...ce);Vt.call(Yt,ce?.[0])},Wt(null)}).catch(Vt=>{Xt(Vt)}).finally(()=>{clearTimeout(Ut)})}).catch(Wt=>{throw H("[iframe sandbox] error",Wt),Wt}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){let A=this._pluginLocal,L=this._shadow=new q(A);try{this._status="pending",await L.load(),this._connected=!0,this.emit("connected"),this._call=async(tt,ft={},mt)=>{var vt;return mt&&(ft.actor=mt),(vt=this._pluginLocal)===null||vt===void 0||vt.emit(tt,Object.assign(ft,{$$pid:A.id})),mt?.promise},this._callUserModel=async(...tt)=>{var ft;let mt=tt[0];(ft=mt)!==null&&ft!==void 0&&ft.startsWith(Q)&&(mt=mt.replace(Q,""));let vt=tt[1]||{},bt=this._userModel[mt];typeof bt=="function"&&await bt.call(null,vt)}}catch(tt){throw H("[shadow sandbox] error",tt),tt}finally{this._status=void 0}}_extendUserModel(A){return Object.assign(this._userModel,A)}_getSandboxIframeContainer(){var A;return(A=this._parent)===null||A===void 0?void 0:A.frame.parentNode}_getSandboxShadowContainer(){var A;return(A=this._shadow)===null||A===void 0?void 0:A.frame.parentNode}_getSandboxIframeRoot(){var A;return(A=this._parent)===null||A===void 0?void 0:A.frame}_getSandboxShadowRoot(){var A;return(A=this._shadow)===null||A===void 0?void 0:A.frame}set debugTag(A){this._debugTag=A}async destroy(){var A;let L=null;this._parent&&(L=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(L=this._getSandboxShadowContainer(),this._shadow.destroy()),(A=L)===null||A===void 0||A.parentNode.removeChild(L)}}function Z(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}class J{constructor(A,L){Z(this,"ctx",void 0),Z(this,"opts",void 0),this.ctx=A,this.opts=L}get ctxId(){return this.ctx.baseInfo.id}setItem(A,L){var tt;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,A,L,(tt=this.opts)===null||tt===void 0?void 0:tt.assets]})}getItem(A){var L;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,A,(L=this.opts)===null||L===void 0?void 0:L.assets]})}removeItem(A){var L;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,A,(L=this.opts)===null||L===void 0?void 0:L.assets]})}allKeys(){var A;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(A=this.opts)===null||A===void 0?void 0:A.assets]})}clear(){var A;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(A=this.opts)===null||A===void 0?void 0:A.assets]})}hasItem(A){var L;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,A,(L=this.opts)===null||L===void 0?void 0:L.assets]})}}class nt{constructor(A){var L,tt,ft;ft=void 0,(tt="ctx")in(L=this)?Object.defineProperty(L,tt,{value:ft,enumerable:!0,configurable:!0,writable:!0}):L[tt]=ft,this.ctx=A}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(A,...L){var tt,ft;let mt=this.ensureHostScope();return A=(tt=w(A))===null||tt===void 0?void 0:tt.toLowerCase(),(ft=mt.logseq.api["exper_"+A])===null||ft===void 0?void 0:ft.apply(mt,L)}async loadScripts(...A){(A=A.map(L=>L!=null&&L.startsWith("http")?L:this.ctx.resolveResourceFullUrl(L))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...A)}registerFencedCodeRenderer(A,L){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,A,L)}registerExtensionsEnhancer(A,L){let tt=this.ensureHostScope();return A==="katex"&&tt.katex&&L(tt.katex).catch(console.error),tt.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,A,L)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function lt(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}let At=T=>`task_callback_${T}`;class wt{constructor(A,L,tt={}){lt(this,"_client",void 0),lt(this,"_requestId",void 0),lt(this,"_requestOptions",void 0),lt(this,"_promise",void 0),lt(this,"_aborted",!1),this._client=A,this._requestId=L,this._requestOptions=tt,this._promise=new Promise((bt,kt)=>{if(!this._requestId)return kt(null);this._client.once(At(this._requestId),Ut=>{Ut&&Ut instanceof Error?kt(Ut):bt(Ut)})});let{success:ft,fail:mt,final:vt}=this._requestOptions;this._promise.then(bt=>{ft?.(bt)}).catch(bt=>{mt?.(bt)}).finally(()=>{vt?.()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class et extends g.EventEmitter{constructor(A){super(),lt(this,"_ctx",void 0),this._ctx=A,this.ctx.caller.on("#lsp#request#callback",L=>{let tt=L?.requestId;tt&&this.emit(At(tt),L?.payload)})}static createRequestTask(A,L,tt){return new wt(A,L,tt)}async _request(A){let L=this.ctx.baseInfo.id,{success:tt,fail:ft,final:mt,...vt}=A,bt=this.ctx.Experiments.invokeExperMethod("request",L,vt),kt=et.createRequestTask(this.ctx.Request,bt,A);return vt.abortable?kt:kt.promise}get ctx(){return this._ctx}}let yt=Array.isArray,Tt=typeof global=="object"&&global&&global.Object===Object&&global;var It=typeof self=="object"&&self&&self.Object===Object&&self;let jt=Tt||It||Function("return this")(),Mt=jt.Symbol;var se=Object.prototype,Jt=se.hasOwnProperty,Le=se.toString,qe=Mt?Mt.toStringTag:void 0;let Ce=function(T){var A=Jt.call(T,qe),L=T[qe];try{T[qe]=void 0;var tt=!0}catch{}var ft=Le.call(T);return tt&&(A?T[qe]=L:delete T[qe]),ft};var Ei=Object.prototype.toString;let Ft=function(T){return Ei.call(T)};var Bt=Mt?Mt.toStringTag:void 0;let Gt=function(T){return T==null?T===void 0?"[object Undefined]":"[object Null]":Bt&&Bt in Object(T)?Ce(T):Ft(T)},ne=function(T){var A=typeof T;return T!=null&&(A=="object"||A=="function")},Oe=function(T){if(!ne(T))return!1;var A=Gt(T);return A=="[object Function]"||A=="[object GeneratorFunction]"||A=="[object AsyncFunction]"||A=="[object Proxy]"},Ti=jt["__core-js_shared__"];var Xi,En=(Xi=/[^.]+$/.exec(Ti&&Ti.keys&&Ti.keys.IE_PROTO||""))?"Symbol(src)_1."+Xi:"";let Ir=function(T){return!!En&&En in T};var $o=Function.prototype.toString;let Vn=function(T){if(T!=null){try{return $o.call(T)}catch{}try{return T+""}catch{}}return""};var pu=/^\[object .+?Constructor\]$/,Ko=Function.prototype,Jo=Object.prototype,hs=Ko.toString,gu=Jo.hasOwnProperty,mu=RegExp("^"+hs.call(gu).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let vu=function(T){return!(!ne(T)||Ir(T))&&(Oe(T)?mu:pu).test(Vn(T))},fs=function(T,A){return T?.[A]},fn=function(T,A){var L=fs(T,A);return vu(L)?L:void 0},dn=function(){try{var T=fn(Object,"defineProperty");return T({},"",{}),T}catch{}}(),Qo=function(T,A,L){A=="__proto__"&&dn?dn(T,A,{configurable:!0,enumerable:!0,value:L,writable:!0}):T[A]=L},gr=function(T){return function(A,L,tt){for(var ft=-1,mt=Object(A),vt=tt(A),bt=vt.length;bt--;){var kt=vt[T?bt:++ft];if(L(mt[kt],kt,mt)===!1)break}return A}}(),oo=function(T,A){for(var L=-1,tt=Array(T);++L<T;)tt[L]=A(L);return tt},Tn=function(T){return T!=null&&typeof T=="object"},Zo=function(T){return Tn(T)&&Gt(T)=="[object Arguments]"};var ta=Object.prototype,yu=ta.hasOwnProperty,ea=ta.propertyIsEnumerable;let Fi=Zo(function(){return arguments}())?Zo:function(T){return Tn(T)&&yu.call(T,"callee")&&!ea.call(T,"callee")},Br=function(){return!1};var Fn=typeof Yn=="object"&&Yn&&!Yn.nodeType&&Yn,ds=Fn&&typeof pr=="object"&&pr&&!pr.nodeType&&pr,Lr=ds&&ds.exports===Fn?jt.Buffer:void 0;let ao=(Lr?Lr.isBuffer:void 0)||Br;var Cu=/^(?:0|[1-9]\d*)$/;let ia=function(T,A){var L=typeof T;return!!(A=A??9007199254740991)&&(L=="number"||L!="symbol"&&Cu.test(T))&&T>-1&&T%1==0&&T<A},ps=function(T){return typeof T=="number"&&T>-1&&T%1==0&&T<=9007199254740991};var _e={};_e["[object Float32Array]"]=_e["[object Float64Array]"]=_e["[object Int8Array]"]=_e["[object Int16Array]"]=_e["[object Int32Array]"]=_e["[object Uint8Array]"]=_e["[object Uint8ClampedArray]"]=_e["[object Uint16Array]"]=_e["[object Uint32Array]"]=!0,_e["[object Arguments]"]=_e["[object Array]"]=_e["[object ArrayBuffer]"]=_e["[object Boolean]"]=_e["[object DataView]"]=_e["[object Date]"]=_e["[object Error]"]=_e["[object Function]"]=_e["[object Map]"]=_e["[object Number]"]=_e["[object Object]"]=_e["[object RegExp]"]=_e["[object Set]"]=_e["[object String]"]=_e["[object WeakMap]"]=!1;let We=function(T){return Tn(T)&&ps(T.length)&&!!_e[Gt(T)]},Mr=function(T){return function(A){return T(A)}};var Ge=typeof Yn=="object"&&Yn&&!Yn.nodeType&&Yn,pn=Ge&&typeof pr=="object"&&pr&&!pr.nodeType&&pr,ke=pn&&pn.exports===Ge&&Tt.process,mr=function(){try{var T=pn&&pn.require&&pn.require("util").types;return T||ke&&ke.binding&&ke.binding("util")}catch{}}(),gs=mr&&mr.isTypedArray;let ms=gs?Mr(gs):We;var vs=Object.prototype.hasOwnProperty;let uo=function(T,A){var L=yt(T),tt=!L&&Fi(T),ft=!L&&!tt&&ao(T),mt=!L&&!tt&&!ft&&ms(T),vt=L||tt||ft||mt,bt=vt?oo(T.length,String):[],kt=bt.length;for(var Ut in T)!A&&!vs.call(T,Ut)||vt&&(Ut=="length"||ft&&(Ut=="offset"||Ut=="parent")||mt&&(Ut=="buffer"||Ut=="byteLength"||Ut=="byteOffset")||ia(Ut,kt))||bt.push(Ut);return bt};var vr=Object.prototype;let qn=function(T){var A=T&&T.constructor;return T===(typeof A=="function"&&A.prototype||vr)},lo=function(T,A){return function(L){return T(A(L))}}(Object.keys,Object);var co=Object.prototype.hasOwnProperty;let $n=function(T){if(!qn(T))return lo(T);var A=[];for(var L in Object(T))co.call(T,L)&&L!="constructor"&&A.push(L);return A},Rr=function(T){return T!=null&&ps(T.length)&&!Oe(T)},Kn=function(T){return Rr(T)?uo(T):$n(T)},ys=function(T,A){return T&&gr(T,A,Kn)},ho=function(){this.__data__=[],this.size=0},Jn=function(T,A){return T===A||T!=T&&A!=A},vi=function(T,A){for(var L=T.length;L--;)if(Jn(T[L][0],A))return L;return-1};var Qn=Array.prototype.splice;let na=function(T){var A=this.__data__,L=vi(A,T);return!(L<0)&&(L==A.length-1?A.pop():Qn.call(A,L,1),--this.size,!0)},fo=function(T){var A=this.__data__,L=vi(A,T);return L<0?void 0:A[L][1]},po=function(T){return vi(this.__data__,T)>-1},jr=function(T,A){var L=this.__data__,tt=vi(L,T);return tt<0?(++this.size,L.push([T,A])):L[tt][1]=A,this};function Zn(T){var A=-1,L=T==null?0:T.length;for(this.clear();++A<L;){var tt=T[A];this.set(tt[0],tt[1])}}Zn.prototype.clear=ho,Zn.prototype.delete=na,Zn.prototype.get=fo,Zn.prototype.has=po,Zn.prototype.set=jr;let tr=Zn,Nr=function(){this.__data__=new tr,this.size=0},Yi=function(T){var A=this.__data__,L=A.delete(T);return this.size=A.size,L},gn=function(T){return this.__data__.get(T)},go=function(T){return this.__data__.has(T)},yr=fn(jt,"Map"),Ur=fn(Object,"create"),er=function(){this.__data__=Ur?Ur(null):{},this.size=0},ra=function(T){var A=this.has(T)&&delete this.__data__[T];return this.size-=A?1:0,A};var mo=Object.prototype.hasOwnProperty;let Cs=function(T){var A=this.__data__;if(Ur){var L=A[T];return L==="__lodash_hash_undefined__"?void 0:L}return mo.call(A,T)?A[T]:void 0};var sa=Object.prototype.hasOwnProperty;let oa=function(T){var A=this.__data__;return Ur?A[T]!==void 0:sa.call(A,T)},_u=function(T,A){var L=this.__data__;return this.size+=this.has(T)?0:1,L[T]=Ur&&A===void 0?"__lodash_hash_undefined__":A,this};function Vi(T){var A=-1,L=T==null?0:T.length;for(this.clear();++A<L;){var tt=T[A];this.set(tt[0],tt[1])}}Vi.prototype.clear=er,Vi.prototype.delete=ra,Vi.prototype.get=Cs,Vi.prototype.has=oa,Vi.prototype.set=_u;let _s=Vi,wu=function(){this.size=0,this.__data__={hash:new _s,map:new(yr||tr),string:new _s}},mn=function(T){var A=typeof T;return A=="string"||A=="number"||A=="symbol"||A=="boolean"?T!=="__proto__":T===null},zr=function(T,A){var L=T.__data__;return mn(A)?L[typeof A=="string"?"string":"hash"]:L.map},ws=function(T){var A=zr(this,T).delete(T);return this.size-=A?1:0,A},aa=function(T){return zr(this,T).get(T)},Su=function(T){return zr(this,T).has(T)},Wr=function(T,A){var L=zr(this,T),tt=L.size;return L.set(T,A),this.size+=L.size==tt?0:1,this};function ni(T){var A=-1,L=T==null?0:T.length;for(this.clear();++A<L;){var tt=T[A];this.set(tt[0],tt[1])}}ni.prototype.clear=wu,ni.prototype.delete=ws,ni.prototype.get=aa,ni.prototype.has=Su,ni.prototype.set=Wr;let Gr=ni,xe=function(T,A){var L=this.__data__;if(L instanceof tr){var tt=L.__data__;if(!yr||tt.length<199)return tt.push([T,A]),this.size=++L.size,this;L=this.__data__=new Gr(tt)}return L.set(T,A),this.size=L.size,this};function de(T){var A=this.__data__=new tr(T);this.size=A.size}de.prototype.clear=Nr,de.prototype.delete=Yi,de.prototype.get=gn,de.prototype.has=go,de.prototype.set=xe;let Hr=de,xu=function(T){return this.__data__.set(T,"__lodash_hash_undefined__"),this},at=function(T){return this.__data__.has(T)};function Lt(T){var A=-1,L=T==null?0:T.length;for(this.__data__=new Gr;++A<L;)this.add(T[A])}Lt.prototype.add=Lt.prototype.push=xu,Lt.prototype.has=at;let Pt=Lt,we=function(T,A){for(var L=-1,tt=T==null?0:T.length;++L<tt;)if(A(T[L],L,T))return!0;return!1},Pe=function(T,A){return T.has(A)},Qe=function(T,A,L,tt,ft,mt){var vt=1&L,bt=T.length,kt=A.length;if(bt!=kt&&!(vt&&kt>bt))return!1;var Ut=mt.get(T),re=mt.get(A);if(Ut&&re)return Ut==A&&re==T;var Wt=-1,Xt=!0,Vt=2&L?new Pt:void 0;for(mt.set(T,A),mt.set(A,T);++Wt<bt;){var Yt=T[Wt],ce=A[Wt];if(tt)var Ee=vt?tt(ce,Yt,Wt,A,T,mt):tt(Yt,ce,Wt,T,A,mt);if(Ee!==void 0){if(Ee)continue;Xt=!1;break}if(Vt){if(!we(A,function(He,Ji){if(!Pe(Vt,Ji)&&(Yt===He||ft(Yt,He,L,tt,mt)))return Vt.push(Ji)})){Xt=!1;break}}else if(Yt!==ce&&!ft(Yt,ce,L,tt,mt)){Xt=!1;break}}return mt.delete(T),mt.delete(A),Xt},le=jt.Uint8Array,ir=function(T){var A=-1,L=Array(T.size);return T.forEach(function(tt,ft){L[++A]=[ft,tt]}),L},ri=function(T){var A=-1,L=Array(T.size);return T.forEach(function(tt){L[++A]=tt}),L};var ui=Mt?Mt.prototype:void 0,Xr=ui?ui.valueOf:void 0;let Oi=function(T,A,L,tt,ft,mt,vt){switch(L){case"[object DataView]":if(T.byteLength!=A.byteLength||T.byteOffset!=A.byteOffset)return!1;T=T.buffer,A=A.buffer;case"[object ArrayBuffer]":return!(T.byteLength!=A.byteLength||!mt(new le(T),new le(A)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Jn(+T,+A);case"[object Error]":return T.name==A.name&&T.message==A.message;case"[object RegExp]":case"[object String]":return T==A+"";case"[object Map]":var bt=ir;case"[object Set]":var kt=1&tt;if(bt||(bt=ri),T.size!=A.size&&!kt)return!1;var Ut=vt.get(T);if(Ut)return Ut==A;tt|=2,vt.set(T,A);var re=Qe(bt(T),bt(A),tt,ft,mt,vt);return vt.delete(T),re;case"[object Symbol]":if(Xr)return Xr.call(T)==Xr.call(A)}return!1},nc=function(T,A){for(var L=-1,tt=A.length,ft=T.length;++L<tt;)T[ft+L]=A[L];return T},rc=function(T,A,L){var tt=A(T);return yt(T)?tt:nc(tt,L(T))},sc=function(T,A){for(var L=-1,tt=T==null?0:T.length,ft=0,mt=[];++L<tt;){var vt=T[L];A(vt,L,T)&&(mt[ft++]=vt)}return mt},oc=function(){return[]};var ac=Object.prototype.propertyIsEnumerable,Du=Object.getOwnPropertySymbols;let ki=Du?function(T){return T==null?[]:(T=Object(T),sc(Du(T),function(A){return ac.call(T,A)}))}:oc,uc=function(T){return rc(T,Kn,ki)};var qi=Object.prototype.hasOwnProperty;let _f=function(T,A,L,tt,ft,mt){var vt=1&L,bt=uc(T),kt=bt.length;if(kt!=uc(A).length&&!vt)return!1;for(var Ut=kt;Ut--;){var re=bt[Ut];if(!(vt?re in A:qi.call(A,re)))return!1}var Wt=mt.get(T),Xt=mt.get(A);if(Wt&&Xt)return Wt==A&&Xt==T;var Vt=!0;mt.set(T,A),mt.set(A,T);for(var Yt=vt;++Ut<kt;){var ce=T[re=bt[Ut]],Ee=A[re];if(tt)var He=vt?tt(Ee,ce,re,A,T,mt):tt(ce,Ee,re,T,A,mt);if(!(He===void 0?ce===Ee||ft(ce,Ee,L,tt,mt):He)){Vt=!1;break}Yt||(Yt=re=="constructor")}if(Vt&&!Yt){var Ji=T.constructor,kn=A.constructor;Ji==kn||!("constructor"in T)||!("constructor"in A)||typeof Ji=="function"&&Ji instanceof Ji&&typeof kn=="function"&&kn instanceof kn||(Vt=!1)}return mt.delete(T),mt.delete(A),Vt},ua=fn(jt,"DataView"),On=fn(jt,"Promise"),Ss=fn(jt,"Set"),vo=fn(jt,"WeakMap");var Fe="[object Map]",nr="[object Promise]",la="[object Set]",lc="[object WeakMap]",ca="[object DataView]",wf=Vn(ua),Sf=Vn(yr),xf=Vn(On),cc=Vn(Ss),ha=Vn(vo),$i=Gt;(ua&&$i(new ua(new ArrayBuffer(1)))!=ca||yr&&$i(new yr)!=Fe||On&&$i(On.resolve())!=nr||Ss&&$i(new Ss)!=la||vo&&$i(new vo)!=lc)&&($i=function(T){var A=Gt(T),L=A=="[object Object]"?T.constructor:void 0,tt=L?Vn(L):"";if(tt)switch(tt){case wf:return ca;case Sf:return Fe;case xf:return nr;case cc:return la;case ha:return lc}return A});let hc=$i;var bu="[object Arguments]",Au="[object Array]",xs="[object Object]",fa=Object.prototype.hasOwnProperty;let fc=function(T,A,L,tt,ft,mt){var vt=yt(T),bt=yt(A),kt=vt?Au:hc(T),Ut=bt?Au:hc(A),re=(kt=kt==bu?xs:kt)==xs,Wt=(Ut=Ut==bu?xs:Ut)==xs,Xt=kt==Ut;if(Xt&&ao(T)){if(!ao(A))return!1;vt=!0,re=!1}if(Xt&&!re)return mt||(mt=new Hr),vt||ms(T)?Qe(T,A,L,tt,ft,mt):Oi(T,A,kt,L,tt,ft,mt);if(!(1&L)){var Vt=re&&fa.call(T,"__wrapped__"),Yt=Wt&&fa.call(A,"__wrapped__");if(Vt||Yt){var ce=Vt?T.value():T,Ee=Yt?A.value():A;return mt||(mt=new Hr),ft(ce,Ee,L,tt,mt)}}return!!Xt&&(mt||(mt=new Hr),_f(T,A,L,tt,ft,mt))},dc=function T(A,L,tt,ft,mt){return A===L||(A==null||L==null||!Tn(A)&&!Tn(L)?A!=A&&L!=L:fc(A,L,tt,ft,T,mt))},Eu=function(T,A,L,tt){var ft=L.length,mt=ft,vt=!tt;if(T==null)return!mt;for(T=Object(T);ft--;){var bt=L[ft];if(vt&&bt[2]?bt[1]!==T[bt[0]]:!(bt[0]in T))return!1}for(;++ft<mt;){var kt=(bt=L[ft])[0],Ut=T[kt],re=bt[1];if(vt&&bt[2]){if(Ut===void 0&&!(kt in T))return!1}else{var Wt=new Hr;if(tt)var Xt=tt(Ut,re,kt,T,A,Wt);if(!(Xt===void 0?dc(re,Ut,3,tt,Wt):Xt))return!1}}return!0},da=function(T){return T==T&&!ne(T)},Df=function(T){for(var A=Kn(T),L=A.length;L--;){var tt=A[L],ft=T[tt];A[L]=[tt,ft,da(ft)]}return A},Tu=function(T,A){return function(L){return L!=null&&L[T]===A&&(A!==void 0||T in Object(L))}},Pi=function(T){var A=Df(T);return A.length==1&&A[0][2]?Tu(A[0][0],A[0][1]):function(L){return L===T||Eu(L,T,A)}},yo=function(T){return typeof T=="symbol"||Tn(T)&&Gt(T)=="[object Symbol]"};var Co=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pc=/^\w*$/;let pa=function(T,A){if(yt(T))return!1;var L=typeof T;return!(L!="number"&&L!="symbol"&&L!="boolean"&&T!=null&&!yo(T))||pc.test(T)||!Co.test(T)||A!=null&&T in Object(A)};function Fu(T,A){if(typeof T!="function"||A!=null&&typeof A!="function")throw new TypeError("Expected a function");var L=function(){var tt=arguments,ft=A?A.apply(this,tt):tt[0],mt=L.cache;if(mt.has(ft))return mt.get(ft);var vt=T.apply(this,tt);return L.cache=mt.set(ft,vt)||mt,vt};return L.cache=new(Fu.Cache||Gr),L}Fu.Cache=Gr;let bf=Fu;var Af=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ef=/\\(\\)?/g;let Tf=function(T){var A=bf(T,function(tt){return L.size===500&&L.clear(),tt}),L=A.cache;return A}(function(T){var A=[];return T.charCodeAt(0)===46&&A.push(""),T.replace(Af,function(L,tt,ft,mt){A.push(ft?mt.replace(Ef,"$1"):tt||L)}),A}),Ds=function(T,A){for(var L=-1,tt=T==null?0:T.length,ft=Array(tt);++L<tt;)ft[L]=A(T[L],L,T);return ft};var gc=Mt?Mt.prototype:void 0,mc=gc?gc.toString:void 0;let Ou=function T(A){if(typeof A=="string")return A;if(yt(A))return Ds(A,T)+"";if(yo(A))return mc?mc.call(A):"";var L=A+"";return L=="0"&&1/A==-1/0?"-0":L},vc=function(T){return T==null?"":Ou(T)},rr=function(T,A){return yt(T)?T:pa(T,A)?[T]:Tf(vc(T))},Yr=function(T){if(typeof T=="string"||yo(T))return T;var A=T+"";return A=="0"&&1/T==-1/0?"-0":A},yc=function(T,A){for(var L=0,tt=(A=rr(A,T)).length;T!=null&&L<tt;)T=T[Yr(A[L++])];return L&&L==tt?T:void 0},Ff=function(T,A,L){var tt=T==null?void 0:yc(T,A);return tt===void 0?L:tt},Of=function(T,A){return T!=null&&A in Object(T)},bs=function(T,A,L){for(var tt=-1,ft=(A=rr(A,T)).length,mt=!1;++tt<ft;){var vt=Yr(A[tt]);if(!(mt=T!=null&&L(T,vt)))break;T=T[vt]}return mt||++tt!=ft?mt:!!(ft=T==null?0:T.length)&&ps(ft)&&ia(vt,ft)&&(yt(T)||Fi(T))},vn=function(T,A){return T!=null&&bs(T,A,Of)},Cc=function(T,A){return pa(T)&&da(A)?Tu(Yr(T),A):function(L){var tt=Ff(L,T);return tt===void 0&&tt===A?vn(L,T):dc(A,tt,3)}},kf=function(T){return T},Pf=function(T){return function(A){return A?.[T]}},If=function(T){return function(A){return yc(A,T)}},Bf=function(T){return pa(T)?Pf(Yr(T)):If(T)},Lf=function(T){return typeof T=="function"?T:T==null?kf:typeof T=="object"?yt(T)?Cc(T[0],T[1]):Pi(T):Bf(T)},Cr=function(T,A){var L={};return A=Lf(A,3),ys(T,function(tt,ft,mt){Qo(L,A(tt,ft,mt),tt)}),L};function ct(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}class St{constructor(A,L){ct(this,"ctx",void 0),ct(this,"serviceHooks",void 0),this.ctx=A,this.serviceHooks=L,A._execCallableAPI("register-search-service",A.baseInfo.id,L.name,L.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:tt=>(yt(tt?.blocks)&&(tt.blocks=tt.blocks.map(ft=>ft&&Cr(ft,(mt,vt)=>`block/${vt}`))),tt)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([tt,ft])=>{let mt=(vt=>`service:search:${vt}:${L.name}`)(tt);A.caller.on(mt,async vt=>{if(Oe(L?.[ft.f])){let bt=null;try{bt=await L[ft.f].apply(L,(ft.args||[]).map(kt=>{if(vt){if(kt===!0)return vt;if(vt.hasOwnProperty(kt)){let Ut=vt[kt];return delete vt[kt],Ut}}})),ft.transformOutput&&(bt=ft.transformOutput(bt))}catch(kt){console.error("[SearchService] ",kt),bt=kt}finally{ft.reply&&A.caller.call(`${mt}:reply`,bt)}}})})}}function gt(T,A,L){return A in T?Object.defineProperty(T,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[A]=L,T}let Nt=Symbol.for("proxy-continue"),Qt=X()("LSPlugin:user"),ve=new F("",{console:!0});function Ie(T,A,L){var tt;let{key:ft,label:mt,desc:vt,palette:bt,keybinding:kt,extras:Ut}=A;if(typeof L!="function")return this.logger.error(`${ft||mt}: command action should be function.`),!1;let re=function(Xt){if(typeof Xt=="string")return Xt.trim().replace(/\s/g,"_").toLowerCase()}(ft);if(!re)return this.logger.error(`${mt}: command key is required.`),!1;let Wt=`SimpleCommandHook${re}${++_o}`;this.Editor["on"+Wt](L),(tt=this.caller)===null||tt===void 0||tt.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:re,label:mt,type:T,desc:vt,keybinding:kt,extras:Ut},["editor/hook",Wt]],bt]})}function De(T){return!(typeof(A=T)!="string"||A.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(A))||(ve.error(`#${T} is not a valid UUID string.`),!1);var A}let As=null,_c=new Map,Ki={async getInfo(T){return As||(As=await this._execCallableAPIAsync("get-app-info")),typeof T=="string"?As[T]:As},registerCommand:Ie,registerSearchService(T){if(_c.has(T.name))throw new Error(`SearchService: #${T.name} has registered!`);_c.set(T.name,new St(this,T))},registerCommandPalette(T,A){let{key:L,label:tt,keybinding:ft}=T;return Ie.call(this,"$palette$",{key:L,label:tt,palette:!0,keybinding:ft},A)},registerCommandShortcut(T,A,L={}){typeof T=="string"&&(T={mode:"global",binding:T});let{binding:tt}=T,ft="$shortcut$",mt=L.key||ft+w(tt?.toString());return Ie.call(this,ft,{...L,key:mt,palette:!1,keybinding:T},A)},registerUIItem(T,A){var L;let tt=this.baseInfo.id;(L=this.caller)===null||L===void 0||L.call("api:call",{method:"register-plugin-ui-item",args:[tt,T,A]})},registerPageMenuItem(T,A){if(typeof A!="function")return!1;let L=T+"_"+this.baseInfo.id,tt=T;Ie.call(this,"page-menu-item",{key:L,label:tt},A)},onBlockRendererSlotted(T,A){if(!De(T))return;let L=this.baseInfo.id,tt=`hook:editor:${w(`slot:${T}`)}`;return this.caller.on(tt,A),this.App._installPluginHook(L,tt),()=>{this.caller.off(tt,A),this.App._uninstallPluginHook(L,tt)}},invokeExternalPlugin(T,...A){var L;if(!(T=(L=T)===null||L===void 0?void 0:L.trim()))return;let[tt,ft]=T.split(".");if(!["models","commands"].includes(ft?.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");let mt=T.replace(`${tt}.${ft}.`,"");if(!tt||!ft||!mt)throw new Error(`Illegal type of #${T} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",tt,ft.toLowerCase(),mt,A)},setFullScreen(T){let A=(...L)=>this._callWin("setFullScreen",...L);T==="toggle"?this._callWin("isFullScreen").then(L=>{L?A():A(!0)}):T?A(!0):A()}},_o=0,Mf={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(T,A){var L;Qt("Register slash command #",this.baseInfo.id,T,A),typeof A=="function"&&(A=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",A]]),A=A.map(tt=>{let[ft,...mt]=tt;if(ft==="editor/hook"){let vt=mt[0],bt=()=>{var Ut;(Ut=this.caller)===null||Ut===void 0||Ut.callUserModel(vt)};typeof vt=="function"&&(bt=vt);let kt=`SlashCommandHook${ft}${++_o}`;tt[1]=kt,this.Editor["on"+kt](bt)}return tt}),(L=this.caller)===null||L===void 0||L.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[T,A]]})},registerBlockContextMenuItem(T,A){if(typeof A!="function")return!1;let L=T+"_"+this.baseInfo.id;Ie.call(this,"block-context-menu-item",{key:L,label:T},A)},registerHighlightContextMenuItem(T,A,L){if(typeof A!="function")return!1;let tt=T+"_"+this.baseInfo.id;Ie.call(this,"highlight-context-menu-item",{key:tt,label:T,extras:L},A)},scrollToBlockInPage(T,A,L){let tt="block-content-"+A;L!=null&&L.replaceState?this.App.replaceState("page",{name:T},{anchor:tt}):this.App.pushState("page",{name:T},{anchor:tt})}},Es={onBlockChanged(T,A){if(!De(T))return;let L=this.baseInfo.id,tt=`hook:db:${w(`block:${T}`)}`,ft=({block:mt,txData:vt,txMeta:bt})=>{mt.uuid===T&&A(mt,vt,bt)};return this.caller.on(tt,ft),this.App._installPluginHook(L,tt),()=>{this.caller.off(tt,ft),this.App._uninstallPluginHook(L,tt)}},datascriptQuery(T,...A){return A.pop(),A!=null&&A.some(L=>typeof L=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(T,...A):this._execCallableAPIAsync("datascript_query",T,...A)}},ga={},ma={},Se={makeSandboxStorage(){return new J(this,{assets:!0})}};class ku extends m(){constructor(A,L){super(),gt(this,"_baseInfo",void 0),gt(this,"_caller",void 0),gt(this,"_version","0.0.17"),gt(this,"_debugTag",""),gt(this,"_settingsSchema",void 0),gt(this,"_connected",!1),gt(this,"_ui",new Map),gt(this,"_mFileStorage",void 0),gt(this,"_mRequest",void 0),gt(this,"_mExperiments",void 0),gt(this,"_beforeunloadCallback",void 0),this._baseInfo=A,this._caller=L,L.on("sys:ui:visible",tt=>{tt!=null&&tt.toggle&&this.toggleMainUI()}),L.on("settings:changed",tt=>{let ft=Object.assign({},this.settings),mt=Object.assign(this._baseInfo.settings,tt);this.emit("settings:changed",{...mt},ft)}),L.on("beforeunload",async tt=>{let{actor:ft,...mt}=tt,vt=this._beforeunloadCallback;try{vt&&await vt(mt),ft?.resolve(null)}catch(bt){this.logger.error("[beforeunload] ",bt),ft?.reject(bt)}})}async ready(A,L){var tt,ft;if(!this._connected)try{var mt;typeof A=="function"&&(L=A,A={});let vt=await this._caller.connectToParent(A);this._connected=!0,tt=this._baseInfo,ft=vt,vt=r()(tt,ft,{arrayMerge:(bt,kt)=>kt}),this._baseInfo=vt,(mt=vt)!==null&&mt!==void 0&&mt.id&&(this._debugTag=this._caller.debugTag=`#${vt.id} [${vt.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(vt.settings=function(bt,kt){let Ut=(kt||[]).reduce((re,Wt)=>("default"in Wt&&(re[Wt.key]=Wt.default),re),{});return Object.assign(Ut,bt)}(vt.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(bt){console.warn(bt)}L&&L.call(this,vt)}catch(vt){console.error(`${this._debugTag} [Ready Error]`,vt)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(A){typeof A=="function"&&(this._beforeunloadCallback=A)}provideModel(A){return this.caller._extendUserModel(A),this}provideTheme(A){return this.caller.call("provider:theme",A),this}provideStyle(A){return this.caller.call("provider:style",A),this}provideUI(A){return this.caller.call("provider:ui",A),this}useSettingsSchema(A){return this.connected&&this.caller.call("settings:schema",{schema:A,isSync:!0}),this._settingsSchema=A,this}updateSettings(A){this.caller.call("settings:update",A)}onSettingsChanged(A){let L="settings:changed";return this.on(L,A),()=>this.off(L,A)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(A){this.caller.call("main-ui:attrs",A)}setMainUIInlineStyle(A){this.caller.call("main-ui:style",A)}hideMainUI(A){let L={key:0,visible:!1,cursor:A?.restoreEditingCursor};this.caller.call("main-ui:visible",L),this.emit("ui:visible:changed",L),this._ui.set(L.key,L)}showMainUI(A){let L={key:0,visible:!0,autoFocus:A?.autoFocus};this.caller.call("main-ui:visible",L),this.emit("ui:visible:changed",L),this._ui.set(L.key,L)}toggleMainUI(){let L=this._ui.get(0);L&&L.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){let A=this._ui.get(0);return!!(A&&A.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(A=this)&&(((L=A.baseInfo)===null||L===void 0?void 0:L.effect)||!((tt=A.baseInfo)!==null&&tt!==void 0&&tt.iir));var A,L,tt}get logger(){return ve}get settings(){var A;return(A=this.baseInfo)===null||A===void 0?void 0:A.settings}get caller(){return this._caller}resolveResourceFullUrl(A){if(this.ensureConnected(),A)return A=A.replace(/^[.\\/]+/,""),B(this._baseInfo.lsr,A)}_makeUserProxy(A,L){let tt=this,ft=this.caller;return new Proxy(A,{get(mt,vt,bt){let kt=mt[vt];return function(...Ut){if(kt){let Wt=kt.apply(tt,Ut.concat(L));if(Wt!==Nt)return Wt}if(L){let Wt=vt.toString().match(/^(once|off|on)/i);if(Wt!=null){let Xt=Wt[0].toLowerCase(),Vt=Wt.input,Yt=Xt==="off",ce=tt.baseInfo.id,Ee=Vt.slice(Xt.length),He=Ut[0],Ji=Ut[1];typeof He=="string"&&typeof Ji=="function"&&(He=He.replace(/^logseq./,":"),Ee=`${Ee}${He}`,He=Ji,Ji=Ut[2]),Ee=`hook:${L}:${w(Ee)}`,ft[Xt](Ee,He);let kn=()=>{ft.off(Ee,He),ft.listenerCount(Ee)||tt.App._uninstallPluginHook(ce,Ee)};return Yt?void kn():(tt.App._installPluginHook(ce,Ee,Ji),kn)}}let re=vt;return["git","ui","assets"].includes(L)&&(re=L+"_"+re),ft.callAsync("api:call",{tag:L,method:re,args:Ut})}}})}_execCallableAPIAsync(A,...L){return this._caller.callAsync("api:call",{method:A,args:L})}_execCallableAPI(A,...L){this._caller.call("api:call",{method:A,args:L})}_callWin(...A){return this._execCallableAPIAsync("_callMainWin",...A)}get App(){return this._makeUserProxy(Ki,"app")}get Editor(){return this._makeUserProxy(Mf,"editor")}get DB(){return this._makeUserProxy(Es,"db")}get Git(){return this._makeUserProxy(ga,"git")}get UI(){return this._makeUserProxy(ma,"ui")}get Assets(){return this._makeUserProxy(Se,"assets")}get FileStorage(){let A=this._mFileStorage;return A||(A=this._mFileStorage=new J(this)),A}get Request(){let A=this._mRequest;return A||(A=this._mRequest=new et(this)),A}get Experiments(){let A=this._mExperiments;return A||(A=this._mExperiments=new nt(this)),A}}function Pu(T,A){return new ku(T,A)}if(window.__LSP__HOST__==null){let T=new it(null);window.logseq=Pu({},T)}})(),o})())});var Xw=ue(qo=>{"use strict";var Pr=qo&&qo.__classPrivateFieldGet||function(e,t,i,o){if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?o:i==="a"?o.call(e):o?o.value:t.get(e)},Vm=qo&&qo.__classPrivateFieldSet||function(e,t,i,o,n){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?n.call(e,i):n?n.value=i:t.set(e,i),i},cs,so;Object.defineProperty(qo,"__esModule",{value:!0});var qm=class{constructor(){cs.set(this,!1),so.set(this,new Set)}get acquired(){return Pr(this,cs,"f")}acquireAsync({timeout:t}={}){if(!Pr(this,cs,"f"))return Vm(this,cs,!0,"f"),Promise.resolve();if(t==null)return new Promise(n=>{Pr(this,so,"f").add(n)});let i,o;return Promise.race([new Promise(n=>{i=()=>{clearTimeout(o),n()},Pr(this,so,"f").add(i)}),new Promise((n,s)=>{o=setTimeout(()=>{Pr(this,so,"f").delete(i),s(new Error("Timed out waiting for lock"))},t)})])}tryAcquire(){return Pr(this,cs,"f")?!1:(Vm(this,cs,!0,"f"),!0)}release(){if(!Pr(this,cs,"f"))throw new Error("Cannot release an unacquired lock");if(Pr(this,so,"f").size>0){let[t]=Pr(this,so,"f");Pr(this,so,"f").delete(t),t()}else Vm(this,cs,!1,"f")}};qo.default=qm;cs=new WeakMap,so=new WeakMap});var Zm=Mi(Wv());var eS=Mi(Ea()),YP=Mi(r_()),VP=Mi(uf()),iS=Mi(o_()),qP=Mi(im());var ff={exports:{}};function mF(e){return e==="description"||e==="string"||e==="code"}function Gi(e,t,i){if(!mF(i))throw new Error("invalid Failure type: "+i);this.pexpr=e,this.text=t,this.type=i,this.fluffy=!1}Gi.prototype.getPExpr=function(){return this.pexpr};Gi.prototype.getText=function(){return this.text};Gi.prototype.getType=function(){return this.type};Gi.prototype.isDescription=function(){return this.type==="description"};Gi.prototype.isStringTerminal=function(){return this.type==="string"};Gi.prototype.isCode=function(){return this.type==="code"};Gi.prototype.isFluffy=function(){return this.fluffy};Gi.prototype.makeFluffy=function(){this.fluffy=!0};Gi.prototype.clearFluffy=function(){this.fluffy=!1};Gi.prototype.subsumes=function(e){return this.getText()===e.getText()&&this.type===e.type&&(!this.isFluffy()||this.isFluffy()&&e.isFluffy())};Gi.prototype.toString=function(){return this.type==="string"?JSON.stringify(this.getText()):this.getText()};Gi.prototype.clone=function(){let e=new Gi(this.pexpr,this.text,this.type);return this.isFluffy()&&e.makeFluffy(),e};Gi.prototype.toKey=function(){return this.toString()+"#"+this.type};var A_=Gi,Te={};(function(e){let t={};for(let o=0;o<128;o++)t[o]=String.fromCharCode(o);t["'".charCodeAt(0)]="\\'",t['"'.charCodeAt(0)]='\\"',t["\\".charCodeAt(0)]="\\\\",t["\b".charCodeAt(0)]="\\b",t["\f".charCodeAt(0)]="\\f",t[`
`.charCodeAt(0)]="\\n",t["\r".charCodeAt(0)]="\\r",t["	".charCodeAt(0)]="\\t",t["\v".charCodeAt(0)]="\\v",e.abstract=function(o){let n=o||"";return function(){throw new Error("this method "+n+" is abstract! (it has no implementation in class "+this.constructor.name+")")}},e.assert=function(o,n){if(!o)throw new Error(n||"Assertion failed")},e.defineLazyProperty=function(o,n,s){let r;Object.defineProperty(o,n,{get(){return r||(r=s.call(this)),r}})},e.clone=function(o){return o&&Object.assign({},o)},e.repeatFn=function(o,n){let s=[];for(;n-- >0;)s.push(o());return s},e.repeatStr=function(o,n){return new Array(n+1).join(o)},e.repeat=function(o,n){return e.repeatFn(()=>o,n)},e.getDuplicates=function(o){let n=[];for(let s=0;s<o.length;s++){let r=o[s];o.lastIndexOf(r)!==s&&n.indexOf(r)<0&&n.push(r)}return n},e.copyWithoutDuplicates=function(o){let n=[];return o.forEach(s=>{n.indexOf(s)<0&&n.push(s)}),n},e.isSyntactic=function(o){let n=o[0];return n===n.toUpperCase()},e.isLexical=function(o){return!e.isSyntactic(o)},e.padLeft=function(o,n,s){let r=s||" ";return o.length<n?e.repeatStr(r,n-o.length)+o:o},e.StringBuffer=function(){this.strings=[]},e.StringBuffer.prototype.append=function(o){this.strings.push(o)},e.StringBuffer.prototype.contents=function(){return this.strings.join("")};let i=o=>String.fromCodePoint(parseInt(o,16));e.unescapeCodePoint=function(o){if(o.charAt(0)==="\\")switch(o.charAt(1)){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"x":return i(o.slice(2,4));case"u":return o.charAt(2)==="{"?i(o.slice(3,-1)):i(o.slice(2,6));default:return o.charAt(1)}else return o},e.unexpectedObjToString=function(o){if(o==null)return String(o);let n=Object.prototype.toString.call(o);try{let s;return o.constructor&&o.constructor.name?s=o.constructor.name:n.indexOf("[object ")===0?s=n.slice(8,-1):s=typeof o,s+": "+JSON.stringify(String(o))}catch{return n}}})(Te);var l_=Te,au=class{constructor(t){this.matchLength=t}get ctorName(){throw new Error("subclass responsibility")}numChildren(){return this.children?this.children.length:0}childAt(t){if(this.children)return this.children[t]}indexOfChild(t){return this.children.indexOf(t)}hasChildren(){return this.numChildren()>0}hasNoChildren(){return!this.hasChildren()}onlyChild(){if(this.numChildren()!==1)throw new Error("cannot get only child of a node of type "+this.ctorName+" (it has "+this.numChildren()+" children)");return this.firstChild()}firstChild(){if(this.hasNoChildren())throw new Error("cannot get first child of a "+this.ctorName+" node, which has no children");return this.childAt(0)}lastChild(){if(this.hasNoChildren())throw new Error("cannot get last child of a "+this.ctorName+" node, which has no children");return this.childAt(this.numChildren()-1)}childBefore(t){let i=this.indexOfChild(t);if(i<0)throw new Error("Node.childBefore() called w/ an argument that is not a child");if(i===0)throw new Error("cannot get child before first child");return this.childAt(i-1)}childAfter(t){let i=this.indexOfChild(t);if(i<0)throw new Error("Node.childAfter() called w/ an argument that is not a child");if(i===this.numChildren()-1)throw new Error("cannot get child after last child");return this.childAt(i+1)}isTerminal(){return!1}isNonterminal(){return!1}isIteration(){return!1}isOptional(){return!1}},om=class extends au{get ctorName(){return"_terminal"}isTerminal(){return!0}get primitiveValue(){throw new Error("The `primitiveValue` property was removed in Ohm v17.")}},am=class extends au{constructor(t,i,o,n){super(n),this.ruleName=t,this.children=i,this.childOffsets=o}get ctorName(){return this.ruleName}isNonterminal(){return!0}isLexical(){return l_.isLexical(this.ctorName)}isSyntactic(){return l_.isSyntactic(this.ctorName)}},um=class extends au{constructor(t,i,o,n){super(o),this.children=t,this.childOffsets=i,this.optional=n}get ctorName(){return"_iter"}isIteration(){return!0}isOptional(){return this.optional}},Em={Node:au,TerminalNode:om,NonterminalNode:am,IterationNode:um},me={},vF={Lu:/[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21]/,Ll:/[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD83A[\uDD22-\uDD43]/,Lt:/[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]/,Lm:/[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5\u06E6\u07F4\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C\uA69D\uA717-\uA71F\uA770\uA788\uA7F8\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3\uAAF4\uAB5C-\uAB5F\uFF70\uFF9E\uFF9F]|\uD81A[\uDF40-\uDF43]|\uD81B[\uDF93-\uDF9F\uDFE0]/,Lo:/[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E45\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC50-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,Nl:/[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]|\uD800[\uDD40-\uDD74\uDF41\uDF4A\uDFD1-\uDFD5]|\uD809[\uDC00-\uDC6E]/,Nd:/[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD801[\uDCA0-\uDCA9]|\uD804[\uDC66-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDEF0-\uDEF9]|[\uD805\uD807][\uDC50-\uDC59\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9\uDF30-\uDF39]|\uD806[\uDCE0-\uDCE9]|\uD81A[\uDE60-\uDE69\uDF50-\uDF59]|\uD835[\uDFCE-\uDFFF]|\uD83A[\uDD50-\uDD59]/,Mn:/[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC\u0CCD\u0CE2\u0CE3\u0D01\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA8C4\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD804[\uDC01\uDC38-\uDC46\uDC7F-\uDC81\uDCB3-\uDCB6\uDCB9\uDCBA\uDD00-\uDD02\uDD27-\uDD2B\uDD2D-\uDD34\uDD73\uDD80\uDD81\uDDB6-\uDDBE\uDDCA-\uDDCC\uDE2F-\uDE31\uDE34\uDE36\uDE37\uDE3E\uDEDF\uDEE3-\uDEEA\uDF00\uDF01\uDF3C\uDF40\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC38-\uDC3F\uDC42-\uDC44\uDC46\uDCB3-\uDCB8\uDCBA\uDCBF\uDCC0\uDCC2\uDCC3\uDDB2-\uDDB5\uDDBC\uDDBD\uDDBF\uDDC0\uDDDC\uDDDD\uDE33-\uDE3A\uDE3D\uDE3F\uDE40\uDEAB\uDEAD\uDEB0-\uDEB5\uDEB7\uDF1D-\uDF1F\uDF22-\uDF25\uDF27-\uDF2B]|\uD807[\uDC30-\uDC36\uDC38-\uDC3D\uDC3F\uDC92-\uDCA7\uDCAA-\uDCB0\uDCB2\uDCB3\uDCB5\uDCB6]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF8F-\uDF92]|\uD82F[\uDC9D\uDC9E]|\uD834[\uDD67-\uDD69\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF]/,Mc:/[\u0903-\u0903]|[\u093E-\u0940]|[\u0949-\u094C]|[\u0982-\u0983]|[\u09BE-\u09C0]|[\u09C7-\u09C8]|[\u09CB-\u09CC]|[\u09D7-\u09D7]|[\u0A3E-\u0A40]|[\u0A83-\u0A83]|[\u0ABE-\u0AC0]|[\u0AC9-\u0AC9]|[\u0ACB-\u0ACC]|[\u0B02-\u0B03]|[\u0B3E-\u0B3E]|[\u0B40-\u0B40]|[\u0B47-\u0B48]|[\u0B4B-\u0B4C]|[\u0B57-\u0B57]|[\u0B83-\u0B83]|[\u0BBE-\u0BBF]|[\u0BC1-\u0BC2]|[\u0BC6-\u0BC8]|[\u0BCA-\u0BCC]|[\u0BD7-\u0BD7]|[\u0C01-\u0C03]|[\u0C41-\u0C44]|[\u0C82-\u0C83]|[\u0CBE-\u0CBE]|[\u0CC0-\u0CC4]|[\u0CC7-\u0CC8]|[\u0CCA-\u0CCB]|[\u0CD5-\u0CD6]|[\u0D02-\u0D03]|[\u0D3E-\u0D40]|[\u0D46-\u0D48]|[\u0D4A-\u0D4C]|[\u0D57-\u0D57]|[\u0F3E-\u0F3F]|[\u0F7F-\u0F7F]/,Pc:/[_\u203F\u2040\u2054\uFE33\uFE34\uFE4D-\uFE4F\uFF3F]/,Zs:/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,L:/[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,Ltmo:/[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]|[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5\u06E6\u07F4\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C\uA69D\uA717-\uA71F\uA770\uA788\uA7F8\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3\uAAF4\uAB5C-\uAB5F\uFF70\uFF9E\uFF9F]|\uD81A[\uDF40-\uDF43]|\uD81B[\uDF93-\uDF9F\uDFE0]|[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E45\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC50-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/},yF=vF,CF=Te,Ai=class e{constructor(){if(this.constructor===e)throw new Error("PExpr cannot be instantiated -- it's abstract")}withSource(t){return t&&(this.source=t.trimmed()),this}},_F=Object.create(Ai.prototype),wF=Object.create(Ai.prototype),lm=class extends Ai{constructor(t){super(),this.obj=t}},cm=class extends Ai{constructor(t,i){super(),this.from=t,this.to=i,this.matchCodePoint=t.length>1||i.length>1}},hm=class extends Ai{constructor(t){super(),this.index=t}},$l=class extends Ai{constructor(t){super(),this.terms=t}},fm=class extends $l{constructor(t,i,o){let n=t.rules[i].body;super([o,n]),this.superGrammar=t,this.name=i,this.body=o}},dm=class extends $l{constructor(t,i,o,n){let s=t.rules[i].body;super([...o,s,...n]),this.superGrammar=t,this.ruleName=i,this.expansionPos=o.length}},pm=class extends Ai{constructor(t){super(),this.factors=t}},uu=class extends Ai{constructor(t){super(),this.expr=t}},lu=class extends uu{},cu=class extends uu{},hu=class extends uu{};lu.prototype.operator="*";cu.prototype.operator="+";hu.prototype.operator="?";lu.prototype.minNumMatches=0;cu.prototype.minNumMatches=1;hu.prototype.minNumMatches=0;lu.prototype.maxNumMatches=Number.POSITIVE_INFINITY;cu.prototype.maxNumMatches=Number.POSITIVE_INFINITY;hu.prototype.maxNumMatches=1;var gm=class extends Ai{constructor(t){super(),this.expr=t}},mm=class extends Ai{constructor(t){super(),this.expr=t}},vm=class extends Ai{constructor(t){super(),this.expr=t}},ym=class extends Ai{constructor(t,i=[]){super(),this.ruleName=t,this.args=i}isSyntactic(){return CF.isSyntactic(this.ruleName)}toMemoKey(){return this._memoKey||Object.defineProperty(this,"_memoKey",{value:this.toString()}),this._memoKey}},Cm=class extends Ai{constructor(t){super(),this.category=t,this.pattern=yF[t]}};me.PExpr=Ai;me.any=_F;me.end=wF;me.Terminal=lm;me.Range=cm;me.Param=hm;me.Alt=$l;me.Extend=fm;me.Splice=dm;me.Seq=pm;me.Iter=uu;me.Star=lu;me.Plus=cu;me.Opt=hu;me.Not=gm;me.Lookahead=mm;me.Lex=vm;me.Apply=ym;me.UnicodeChar=Cm;var SF=Te,un=me;un.PExpr.prototype.allowsSkippingPrecedingSpace=SF.abstract("allowsSkippingPrecedingSpace");un.any.allowsSkippingPrecedingSpace=un.end.allowsSkippingPrecedingSpace=un.Apply.prototype.allowsSkippingPrecedingSpace=un.Terminal.prototype.allowsSkippingPrecedingSpace=un.Range.prototype.allowsSkippingPrecedingSpace=un.UnicodeChar.prototype.allowsSkippingPrecedingSpace=function(){return!0};un.Alt.prototype.allowsSkippingPrecedingSpace=un.Iter.prototype.allowsSkippingPrecedingSpace=un.Lex.prototype.allowsSkippingPrecedingSpace=un.Lookahead.prototype.allowsSkippingPrecedingSpace=un.Not.prototype.allowsSkippingPrecedingSpace=un.Param.prototype.allowsSkippingPrecedingSpace=un.Seq.prototype.allowsSkippingPrecedingSpace=function(){return!1};function Dn(){}Dn.prototype=Object.create(null);Dn.asNamespace=function(e){return e instanceof Dn?e:Dn.createNamespace(e)};Dn.createNamespace=function(e){return Dn.extend(Dn.prototype,e)};Dn.extend=function(e,t){if(e!==Dn.prototype&&!(e instanceof Dn))throw new TypeError("not a Namespace object: "+e);let i=Object.create(e,{constructor:{value:Dn,enumerable:!1,writable:!0,configurable:!0}});return Object.assign(i,t)};Dn.toString=function(e){return Object.prototype.toString.call(e)};var E_=Dn,{assert:xF}=Te,DF=E_,bF=me;function ze(e,t){let i;return t?(i=new Error(t.getLineAndColumnMessage()+e),i.shortMessage=e,i.interval=t):i=new Error(e),i}function AF(){return ze("Interval sources don't match")}function EF(e){let t=new Error;return Object.defineProperty(t,"message",{enumerable:!0,get(){return e.message}}),Object.defineProperty(t,"shortMessage",{enumerable:!0,get(){return"Expected "+e.getExpectedText()}}),t.interval=e.getInterval(),t}function TF(e,t,i){let o=t?"Grammar "+e+" is not declared in namespace "+DF.toString(t):"Undeclared grammar "+e;return ze(o,i)}function FF(e,t){return ze("Grammar "+e.name+" is already declared in this namespace")}function OF(e,t,i){return ze("Rule "+e+" is not declared in grammar "+t,i)}function kF(e,t,i){return ze("Cannot override rule "+e+" because it is not declared in "+t,i)}function PF(e,t,i){return ze("Cannot extend rule "+e+" because it is not declared in "+t,i)}function IF(e,t,i,o){let n="Duplicate declaration for rule '"+e+"' in grammar '"+t+"'";return t!==i&&(n+=" (originally declared in '"+i+"')"),ze(n,o)}function BF(e,t,i,o){return ze("Wrong number of parameters for rule "+e+" (expected "+t+", got "+i+")",o)}function LF(e,t,i,o){return ze("Wrong number of arguments for rule "+e+" (expected "+t+", got "+i+")",o)}function MF(e,t,i){return ze("Duplicate parameter names in rule "+e+": "+t.join(", "),i)}function RF(e,t){return ze("Invalid parameter to rule "+e+": "+t+" has arity "+t.getArity()+", but parameter expressions must have arity 1",t.source)}var jF="NOTE: A _syntactic rule_ is a rule whose name begins with a capital letter. See https://ohmjs.org/d/svl for more details.";function NF(e,t){return ze("Cannot apply syntactic rule "+e+" from here (inside a lexical context)",t.source)}function UF(e){let{ruleName:t}=e;return ze(`applySyntactic is for syntactic rules, but '${t}' is a lexical rule. `+jF,e.source)}function zF(e){return ze("applySyntactic is not required here (in a syntactic context)",e.source)}function WF(e,t){return ze("Incorrect argument type: expected "+e,t.source)}function GF(e){return ze("'...' can appear at most once in a rule body",e.source)}function HF(e){let t=e._node;xF(t&&t.isNonterminal()&&t.ctorName==="escapeChar_unicodeCodePoint");let i=e.children.slice(1,-1).map(n=>n.source),o=i[0].coverageWith(...i.slice(1));return ze(`U+${o.contents} is not a valid Unicode code point`,o)}function XF(e,t){let i=t.length>0?t[t.length-1].args:[],n="Nullable expression "+e.expr.substituteParams(i)+" is not allowed inside '"+e.operator+"' (possible infinite loop)";if(t.length>0){let s=t.map(r=>new bF.Apply(r.ruleName,r.args)).join(`
`);n+=`
Application stack (most recent application last):
`+s}return ze(n,e.expr.source)}function YF(e,t,i,o){return ze("Rule "+e+" involves an alternation which has inconsistent arity (expected "+t+", got "+i+")",o.source)}function VF(e){return ze("Object pattern has duplicate property names: "+e.join(", "))}function qF(e,t,i){return ze("Attempt to invoke constructor "+t+" with invalid or unexpected arguments")}function $F(e){let t=e.map(i=>i.message);return ze(["Errors:"].concat(t).join(`
- `),e[0].interval)}function KF(e,t,i,o){let n=o.slice(0,-1).map(l=>{let u="  "+l[0].name+" > "+l[1];return l.length===3?u+" for '"+l[2]+"'":u}).join(`
`);n+=`
  `+t+" > "+e;let s="";e==="_iter"&&(s=[`
NOTE: as of Ohm v16, there is no default action for iteration nodes \u2014 see `,"  https://ohmjs.org/d/dsa for details."].join(`
`));let r=[`Missing semantic action for '${e}' in ${i} '${t}'.${s}`,"Action stack (most recent call last):",n].join(`
`),a=ze(r);return a.name="missingSemanticAction",a}var ls={applicationOfSyntacticRuleFromLexicalContext:NF,applySyntacticWithLexicalRuleApplication:UF,cannotExtendUndeclaredRule:PF,cannotOverrideUndeclaredRule:kF,duplicateGrammarDeclaration:FF,duplicateParameterNames:MF,duplicatePropertyNames:VF,duplicateRuleDeclaration:IF,inconsistentArity:YF,incorrectArgumentType:WF,intervalSourcesDontMatch:AF,invalidCodePoint:HF,invalidConstructorCall:qF,invalidParameter:RF,grammarSyntaxError:EF,kleeneExprHasNullableOperand:XF,missingSemanticAction:KF,multipleSuperSplices:GF,undeclaredGrammar:TF,undeclaredRule:OF,unnecessaryExperimentalApplySyntactic:zF,wrongNumberOfArguments:LF,wrongNumberOfParameters:BF,throwErrors(e){if(e.length===1)throw e[0];if(e.length>1)throw $F(e)}},io={};(function(e){let t=Te;function i(r){let a=0;return r.map(u=>{let c=u.toString();return a=Math.max(a,c.length),c}).map(u=>t.padLeft(u,a))}function o(r,a,l){let u=r.length,c=r.slice(0,l),h=r.slice(l+a.length);return(c+a+h).substr(0,u)}function n(...r){let a=this,{offset:l}=a,{repeatStr:u}=t,c=new t.StringBuffer;c.append("Line "+a.lineNum+", col "+a.colNum+`:
`);let h=i([a.prevLine==null?0:a.lineNum-1,a.lineNum,a.nextLine==null?0:a.lineNum+1]),d=(C,w,F)=>{c.append(F+h[C]+" | "+w+`
`)};a.prevLine!=null&&d(0,a.prevLine,"  "),d(1,a.line,"> ");let g=a.line.length,m=u(" ",g+1);for(let C=0;C<r.length;++C){let w=r[C][0],F=r[C][1];t.assert(w>=0&&w<=F,"range start must be >= 0 and <= end");let B=l-a.colNum+1;w=Math.max(0,w-B),F=Math.min(F-B,g),m=o(m,u("~",F-w),w)}let y=2+h[1].length+3;return c.append(u(" ",y)),m=o(m,"^",a.colNum-1),c.append(m.replace(/ +$/,"")+`
`),a.nextLine!=null&&d(2,a.nextLine,"  "),c.contents()}let s=[];e.awaitBuiltInRules=r=>{s.push(r)},e.announceBuiltInRules=r=>{s.forEach(a=>{a(r)}),s=null},e.getLineAndColumn=(r,a)=>{let l=1,u=1,c=0,h=0,d=null,g=null,m=-1;for(;c<a;){let w=r.charAt(c++);w===`
`?(l++,u=1,m=h,h=c):w!=="\r"&&u++}let y=r.indexOf(`
`,h);if(y===-1)y=r.length;else{let w=r.indexOf(`
`,y+1);d=w===-1?r.slice(y):r.slice(y,w),d=d.replace(/^\r?\n/,"").replace(/\r$/,"")}m>=0&&(g=r.slice(m,h).replace(/\r?\n$/,""));let C=r.slice(h,y).replace(/\r$/,"");return{offset:a,lineNum:l,colNum:u,line:C,prevLine:g,nextLine:d,toString:n}},e.getLineAndColumnMessage=function(r,a,...l){return e.getLineAndColumn(r,a).toString(...l)},e.uniqueId=(()=>{let r=0;return a=>""+a+r++})()})(io);var{abstract:JF,isSyntactic:nm}=Te,to=ls,di=me,QF=io,Yl;QF.awaitBuiltInRules(e=>{Yl=e});var lf;di.PExpr.prototype.assertAllApplicationsAreValid=function(e,t){lf=0,this._assertAllApplicationsAreValid(e,t)};di.PExpr.prototype._assertAllApplicationsAreValid=JF("_assertAllApplicationsAreValid");di.any._assertAllApplicationsAreValid=di.end._assertAllApplicationsAreValid=di.Terminal.prototype._assertAllApplicationsAreValid=di.Range.prototype._assertAllApplicationsAreValid=di.Param.prototype._assertAllApplicationsAreValid=di.UnicodeChar.prototype._assertAllApplicationsAreValid=function(e,t){};di.Lex.prototype._assertAllApplicationsAreValid=function(e,t){lf++,this.expr._assertAllApplicationsAreValid(e,t),lf--};di.Alt.prototype._assertAllApplicationsAreValid=function(e,t){for(let i=0;i<this.terms.length;i++)this.terms[i]._assertAllApplicationsAreValid(e,t)};di.Seq.prototype._assertAllApplicationsAreValid=function(e,t){for(let i=0;i<this.factors.length;i++)this.factors[i]._assertAllApplicationsAreValid(e,t)};di.Iter.prototype._assertAllApplicationsAreValid=di.Not.prototype._assertAllApplicationsAreValid=di.Lookahead.prototype._assertAllApplicationsAreValid=function(e,t){this.expr._assertAllApplicationsAreValid(e,t)};di.Apply.prototype._assertAllApplicationsAreValid=function(e,t,i=!1){let o=t.rules[this.ruleName],n=nm(e)&&lf===0;if(!o)throw to.undeclaredRule(this.ruleName,t.name,this.source);if(!i&&nm(this.ruleName)&&!n)throw to.applicationOfSyntacticRuleFromLexicalContext(this.ruleName,this);let s=this.args.length,r=o.formals.length;if(s!==r)throw to.wrongNumberOfArguments(this.ruleName,r,s,this.source);let a=Yl&&o===Yl.rules.applySyntactic;if(Yl&&o===Yl.rules.caseInsensitive&&!(this.args[0]instanceof di.Terminal))throw to.incorrectArgumentType('a Terminal (e.g. "abc")',this.args[0]);if(a){let u=this.args[0];if(!(u instanceof di.Apply))throw to.incorrectArgumentType("a syntactic rule application",u);if(!nm(u.ruleName))throw to.applySyntacticWithLexicalRuleApplication(u);if(n)throw to.unnecessaryExperimentalApplySyntactic(this)}this.args.forEach(u=>{if(u._assertAllApplicationsAreValid(e,t,a),u.getArity()!==1)throw to.invalidParameter(this.ruleName,u)})};var ZF=Te,T_=ls,Ui=me;Ui.PExpr.prototype.assertChoicesHaveUniformArity=ZF.abstract("assertChoicesHaveUniformArity");Ui.any.assertChoicesHaveUniformArity=Ui.end.assertChoicesHaveUniformArity=Ui.Terminal.prototype.assertChoicesHaveUniformArity=Ui.Range.prototype.assertChoicesHaveUniformArity=Ui.Param.prototype.assertChoicesHaveUniformArity=Ui.Lex.prototype.assertChoicesHaveUniformArity=Ui.UnicodeChar.prototype.assertChoicesHaveUniformArity=function(e){};Ui.Alt.prototype.assertChoicesHaveUniformArity=function(e){if(this.terms.length===0)return;let t=this.terms[0].getArity();for(let i=0;i<this.terms.length;i++){let o=this.terms[i];o.assertChoicesHaveUniformArity();let n=o.getArity();if(t!==n)throw T_.inconsistentArity(e,t,n,o)}};Ui.Extend.prototype.assertChoicesHaveUniformArity=function(e){let t=this.terms[0].getArity(),i=this.terms[1].getArity();if(t!==i)throw T_.inconsistentArity(e,i,t,this.terms[0])};Ui.Seq.prototype.assertChoicesHaveUniformArity=function(e){for(let t=0;t<this.factors.length;t++)this.factors[t].assertChoicesHaveUniformArity(e)};Ui.Iter.prototype.assertChoicesHaveUniformArity=function(e){this.expr.assertChoicesHaveUniformArity(e)};Ui.Not.prototype.assertChoicesHaveUniformArity=function(e){};Ui.Lookahead.prototype.assertChoicesHaveUniformArity=function(e){this.expr.assertChoicesHaveUniformArity(e)};Ui.Apply.prototype.assertChoicesHaveUniformArity=function(e){};var tO=Te,eO=ls,zi=me;zi.PExpr.prototype.assertIteratedExprsAreNotNullable=tO.abstract("assertIteratedExprsAreNotNullable");zi.any.assertIteratedExprsAreNotNullable=zi.end.assertIteratedExprsAreNotNullable=zi.Terminal.prototype.assertIteratedExprsAreNotNullable=zi.Range.prototype.assertIteratedExprsAreNotNullable=zi.Param.prototype.assertIteratedExprsAreNotNullable=zi.UnicodeChar.prototype.assertIteratedExprsAreNotNullable=function(e){};zi.Alt.prototype.assertIteratedExprsAreNotNullable=function(e){for(let t=0;t<this.terms.length;t++)this.terms[t].assertIteratedExprsAreNotNullable(e)};zi.Seq.prototype.assertIteratedExprsAreNotNullable=function(e){for(let t=0;t<this.factors.length;t++)this.factors[t].assertIteratedExprsAreNotNullable(e)};zi.Iter.prototype.assertIteratedExprsAreNotNullable=function(e){if(this.expr.assertIteratedExprsAreNotNullable(e),this.expr.isNullable(e))throw eO.kleeneExprHasNullableOperand(this,[])};zi.Opt.prototype.assertIteratedExprsAreNotNullable=zi.Not.prototype.assertIteratedExprsAreNotNullable=zi.Lookahead.prototype.assertIteratedExprsAreNotNullable=zi.Lex.prototype.assertIteratedExprsAreNotNullable=function(e){this.expr.assertIteratedExprsAreNotNullable(e)};zi.Apply.prototype.assertIteratedExprsAreNotNullable=function(e){this.args.forEach(t=>{t.assertIteratedExprsAreNotNullable(e)})};var{assert:iO}=Te,_m=ls,c_=io;function Ni(e,t,i){this.sourceString=e,this.startIdx=t,this.endIdx=i}Ni.coverage=function(e,...t){let{startIdx:i,endIdx:o}=e;for(let n of t){if(n.sourceString!==e.sourceString)throw _m.intervalSourcesDontMatch();i=Math.min(i,n.startIdx),o=Math.max(o,n.endIdx)}return new Ni(e.sourceString,i,o)};Ni.prototype={coverageWith(...e){return Ni.coverage(...e,this)},collapsedLeft(){return new Ni(this.sourceString,this.startIdx,this.startIdx)},collapsedRight(){return new Ni(this.sourceString,this.endIdx,this.endIdx)},getLineAndColumn(){return c_.getLineAndColumn(this.sourceString,this.startIdx)},getLineAndColumnMessage(){let e=[this.startIdx,this.endIdx];return c_.getLineAndColumnMessage(this.sourceString,this.startIdx,e)},minus(e){if(this.sourceString!==e.sourceString)throw _m.intervalSourcesDontMatch();return this.startIdx===e.startIdx&&this.endIdx===e.endIdx?[]:this.startIdx<e.startIdx&&e.endIdx<this.endIdx?[new Ni(this.sourceString,this.startIdx,e.startIdx),new Ni(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.endIdx&&e.endIdx<this.endIdx?[new Ni(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.startIdx&&e.startIdx<this.endIdx?[new Ni(this.sourceString,this.startIdx,e.startIdx)]:[this]},relativeTo(e){if(this.sourceString!==e.sourceString)throw _m.intervalSourcesDontMatch();return iO(this.startIdx>=e.startIdx&&this.endIdx<=e.endIdx,"other interval does not cover this one"),new Ni(this.sourceString,this.startIdx-e.startIdx,this.endIdx-e.startIdx)},trimmed(){let{contents:e}=this,t=this.startIdx+e.match(/^\s*/)[0].length,i=this.endIdx-e.match(/\s*$/)[0].length;return new Ni(this.sourceString,t,i)},subInterval(e,t){let i=this.startIdx+e;return new Ni(this.sourceString,i,i+t)}};Object.defineProperties(Ni.prototype,{contents:{get(){return this._contents===void 0&&(this._contents=this.sourceString.slice(this.startIdx,this.endIdx)),this._contents},enumerable:!0},length:{get(){return this.endIdx-this.startIdx},enumerable:!0}});var Tm=Ni,nO=Tm,Fm=Te,rO="\u2717",sO="\u2713",oO="\u22C5",aO="\u21D2",uO="\u2409",lO="\u240A",cO="\u240D",wm={succeeded:1,isRootNode:2,isImplicitSpaces:4,isMemoized:8,isHeadOfLeftRecursion:16,terminatesLR:32};function hO(e){return Fm.repeat(" ",e).join("")}function fO(e,t,i){let o=F_(e.slice(t,t+i));return o.length<i?o+Fm.repeat(" ",i-o.length).join(""):o}function F_(e){return typeof e=="string"?e.replace(/ /g,oO).replace(/\t/g,uO).replace(/\n/g,lO).replace(/\r/g,cO):String(e)}function Xn(e,t,i,o,n,s,r){this.input=e,this.pos=this.pos1=t,this.pos2=i,this.source=new nO(e,t,i),this.expr=o,this.bindings=s,this.children=r||[],this.terminatingLREntry=null,this._flags=n?wm.succeeded:0}Xn.prototype.SKIP={};Object.defineProperty(Xn.prototype,"displayString",{get(){return this.expr.toDisplayString()}});Object.keys(wm).forEach(e=>{let t=wm[e];Object.defineProperty(Xn.prototype,e,{get(){return(this._flags&t)!==0},set(i){i?this._flags|=t:this._flags&=~t}})});Xn.prototype.clone=function(){return this.cloneWithExpr(this.expr)};Xn.prototype.cloneWithExpr=function(e){let t=new Xn(this.input,this.pos,this.pos2,e,this.succeeded,this.bindings,this.children);return t.isHeadOfLeftRecursion=this.isHeadOfLeftRecursion,t.isImplicitSpaces=this.isImplicitSpaces,t.isMemoized=this.isMemoized,t.isRootNode=this.isRootNode,t.terminatesLR=this.terminatesLR,t.terminatingLREntry=this.terminatingLREntry,t};Xn.prototype.recordLRTermination=function(e,t){this.terminatingLREntry=new Xn(this.input,this.pos,this.pos2,this.expr,!1,[t],[e]),this.terminatingLREntry.terminatesLR=!0};Xn.prototype.walk=function(e,t){let i=e;typeof i=="function"&&(i={enter:i});function o(n,s,r){let a=!0;i.enter&&i.enter.call(t,n,s,r)===Xn.prototype.SKIP&&(a=!1),a&&(n.children.forEach(l=>{o(l,n,r+1)}),i.exit&&i.exit.call(t,n,s,r))}this.isRootNode?this.children.forEach(n=>{o(n,null,0)}):o(this,null,0)};Xn.prototype.toString=function(){let e=new Fm.StringBuffer;return this.walk((t,i,o)=>{if(!t)return this.SKIP;if(t.expr.constructor.name!=="Alt"){if(e.append(fO(t.input,t.pos,10)+hO(o*2+1)),e.append((t.succeeded?sO:rO)+" "+t.displayString),t.isHeadOfLeftRecursion&&e.append(" (LR)"),t.succeeded){let s=F_(t.source.contents);e.append(" "+aO+"  "),e.append(typeof s=="string"?'"'+s+'"':s)}e.append(`
`)}}),e.contents()};var O_=Xn,dO=O_,k_=Te,pO=ls,Om=Em,ii=me,{TerminalNode:Jl}=Om,{NonterminalNode:gO}=Om,{IterationNode:mO}=Om;ii.PExpr.prototype.eval=k_.abstract("eval");ii.any.eval=function(e){let{inputStream:t}=e,i=t.pos,o=t.next();return o?(e.pushBinding(new Jl(o.length),i),!0):(e.processFailure(i,this),!1)};ii.end.eval=function(e){let{inputStream:t}=e,i=t.pos;return t.atEnd()?(e.pushBinding(new Jl(0),i),!0):(e.processFailure(i,this),!1)};ii.Terminal.prototype.eval=function(e){let{inputStream:t}=e,i=t.pos;return t.matchString(this.obj)?(e.pushBinding(new Jl(this.obj.length),i),!0):(e.processFailure(i,this),!1)};ii.Range.prototype.eval=function(e){let{inputStream:t}=e,i=t.pos,o=this.matchCodePoint?t.nextCodePoint():t.nextCharCode();return o!==void 0&&this.from.codePointAt(0)<=o&&o<=this.to.codePointAt(0)?(e.pushBinding(new Jl(String.fromCodePoint(o).length),i),!0):(e.processFailure(i,this),!1)};ii.Param.prototype.eval=function(e){return e.eval(e.currentApplication().args[this.index])};ii.Lex.prototype.eval=function(e){e.enterLexifiedContext();let t=e.eval(this.expr);return e.exitLexifiedContext(),t};ii.Alt.prototype.eval=function(e){for(let t=0;t<this.terms.length;t++)if(e.eval(this.terms[t]))return!0;return!1};ii.Seq.prototype.eval=function(e){for(let t=0;t<this.factors.length;t++){let i=this.factors[t];if(!e.eval(i))return!1}return!0};ii.Iter.prototype.eval=function(e){let{inputStream:t}=e,i=t.pos,o=this.getArity(),n=[],s=[];for(;n.length<o;)n.push([]),s.push([]);let r=0,a=i,l;for(;r<this.maxNumMatches&&e.eval(this.expr);){if(t.pos===a)throw pO.kleeneExprHasNullableOperand(this,e._applicationStack);a=t.pos,r++;let d=e._bindings.splice(e._bindings.length-o,o),g=e._bindingOffsets.splice(e._bindingOffsets.length-o,o);for(l=0;l<d.length;l++)n[l].push(d[l]),s[l].push(g[l])}if(r<this.minNumMatches)return!1;let u=e.posToOffset(i),c=0;if(r>0){let d=n[o-1],g=s[o-1],m=g[g.length-1]+d[d.length-1].matchLength;u=s[0][0],c=m-u}let h=this instanceof ii.Opt;for(l=0;l<n.length;l++)e._bindings.push(new mO(n[l],s[l],c,h)),e._bindingOffsets.push(u);return!0};ii.Not.prototype.eval=function(e){let{inputStream:t}=e,i=t.pos;e.pushFailuresInfo();let o=e.eval(this.expr);return e.popFailuresInfo(),o?(e.processFailure(i,this),!1):(t.pos=i,!0)};ii.Lookahead.prototype.eval=function(e){let{inputStream:t}=e,i=t.pos;return e.eval(this.expr)?(t.pos=i,!0):!1};ii.Apply.prototype.eval=function(e){let t=e.currentApplication(),i=t?t.args:[],o=this.substituteParams(i),n=e.getCurrentPosInfo();if(n.isActive(o))return o.handleCycle(e);let s=o.toMemoKey(),r=n.memo[s];if(r&&n.shouldUseMemoizedResult(r)){if(e.hasNecessaryInfo(r))return e.useMemoizedResult(e.inputStream.pos,r);delete n.memo[s]}return o.reallyEval(e)};ii.Apply.prototype.handleCycle=function(e){let t=e.getCurrentPosInfo(),{currentLeftRecursion:i}=t,o=this.toMemoKey(),n=t.memo[o];return i&&i.headApplication.toMemoKey()===o?n.updateInvolvedApplicationMemoKeys():n||(n=t.memoize(o,{matchLength:0,examinedLength:0,value:!1,rightmostFailureOffset:-1}),t.startLeftRecursion(this,n)),e.useMemoizedResult(e.inputStream.pos,n)};ii.Apply.prototype.reallyEval=function(e){let{inputStream:t}=e,i=t.pos,o=e.getCurrentPosInfo(),n=e.grammar.rules[this.ruleName],{body:s}=n,{description:r}=n;e.enterApplication(o,this),r&&e.pushFailuresInfo();let a=t.examinedLength;t.examinedLength=0;let l=this.evalOnce(s,e),u=o.currentLeftRecursion,c=this.toMemoKey(),h=u&&u.headApplication.toMemoKey()===c,d;h?(l=this.growSeedResult(s,e,i,u,l),o.endLeftRecursion(),d=u,d.examinedLength=t.examinedLength-i,d.rightmostFailureOffset=e._getRightmostFailureOffset(),o.memoize(c,d)):(!u||!u.isInvolved(c))&&(d=o.memoize(c,{matchLength:t.pos-i,examinedLength:t.examinedLength-i,value:l,failuresAtRightmostPosition:e.cloneRecordedFailures(),rightmostFailureOffset:e._getRightmostFailureOffset()}));let g=!!l;if(r&&(e.popFailuresInfo(),g||e.processFailure(i,this),d&&(d.failuresAtRightmostPosition=e.cloneRecordedFailures())),e.isTracing()&&d){let m=e.getTraceEntry(i,this,g,g?[l]:[]);h&&(k_.assert(m.terminatingLREntry!=null||!g),m.isHeadOfLeftRecursion=!0),d.traceEntry=m}return t.examinedLength=Math.max(t.examinedLength,a),e.exitApplication(o,l),g};ii.Apply.prototype.evalOnce=function(e,t){let{inputStream:i}=t,o=i.pos;if(t.eval(e)){let n=e.getArity(),s=t._bindings.splice(t._bindings.length-n,n),r=t._bindingOffsets.splice(t._bindingOffsets.length-n,n),a=i.pos-o;return new gO(this.ruleName,s,r,a)}else return!1};ii.Apply.prototype.growSeedResult=function(e,t,i,o,n){if(!n)return!1;let{inputStream:s}=t;for(;;){if(o.matchLength=s.pos-i,o.value=n,o.failuresAtRightmostPosition=t.cloneRecordedFailures(),t.isTracing()){let r=t.trace[t.trace.length-1];o.traceEntry=new dO(t.input,i,s.pos,this,!0,[n],[r.clone()])}if(s.pos=i,n=this.evalOnce(e,t),s.pos-i<=o.matchLength)break;t.isTracing()&&t.trace.splice(-2,1)}return t.isTracing()&&o.traceEntry.recordLRTermination(t.trace.pop(),n),s.pos=i+o.matchLength,o.value};ii.UnicodeChar.prototype.eval=function(e){let{inputStream:t}=e,i=t.pos,o=t.next();return o&&this.pattern.test(o)?(e.pushBinding(new Jl(o.length),i),!0):(e.processFailure(i,this),!1)};var vO=Te,ln=me;ln.PExpr.prototype.getArity=vO.abstract("getArity");ln.any.getArity=ln.end.getArity=ln.Terminal.prototype.getArity=ln.Range.prototype.getArity=ln.Param.prototype.getArity=ln.Apply.prototype.getArity=ln.UnicodeChar.prototype.getArity=function(){return 1};ln.Alt.prototype.getArity=function(){return this.terms.length===0?0:this.terms[0].getArity()};ln.Seq.prototype.getArity=function(){let e=0;for(let t=0;t<this.factors.length;t++)e+=this.factors[t].getArity();return e};ln.Iter.prototype.getArity=function(){return this.expr.getArity()};ln.Not.prototype.getArity=function(){return 0};ln.Lookahead.prototype.getArity=ln.Lex.prototype.getArity=function(){return this.expr.getArity()};var yO=Te,ai=me;function fr(e,t){let i={};if(e.source&&t){let o=e.source.relativeTo(t);i.sourceInterval=[o.startIdx,o.endIdx]}return i}ai.PExpr.prototype.outputRecipe=yO.abstract("outputRecipe");ai.any.outputRecipe=function(e,t){return["any",fr(this,t)]};ai.end.outputRecipe=function(e,t){return["end",fr(this,t)]};ai.Terminal.prototype.outputRecipe=function(e,t){return["terminal",fr(this,t),this.obj]};ai.Range.prototype.outputRecipe=function(e,t){return["range",fr(this,t),this.from,this.to]};ai.Param.prototype.outputRecipe=function(e,t){return["param",fr(this,t),this.index]};ai.Alt.prototype.outputRecipe=function(e,t){return["alt",fr(this,t)].concat(this.terms.map(i=>i.outputRecipe(e,t)))};ai.Extend.prototype.outputRecipe=function(e,t){return this.terms[0].outputRecipe(e,t)};ai.Splice.prototype.outputRecipe=function(e,t){let i=this.terms.slice(0,this.expansionPos),o=this.terms.slice(this.expansionPos+1);return["splice",fr(this,t),i.map(n=>n.outputRecipe(e,t)),o.map(n=>n.outputRecipe(e,t))]};ai.Seq.prototype.outputRecipe=function(e,t){return["seq",fr(this,t)].concat(this.factors.map(i=>i.outputRecipe(e,t)))};ai.Star.prototype.outputRecipe=ai.Plus.prototype.outputRecipe=ai.Opt.prototype.outputRecipe=ai.Not.prototype.outputRecipe=ai.Lookahead.prototype.outputRecipe=ai.Lex.prototype.outputRecipe=function(e,t){return[this.constructor.name.toLowerCase(),fr(this,t),this.expr.outputRecipe(e,t)]};ai.Apply.prototype.outputRecipe=function(e,t){return["app",fr(this,t),this.ruleName,this.args.map(i=>i.outputRecipe(e,t))]};ai.UnicodeChar.prototype.outputRecipe=function(e,t){return["unicodeChar",fr(this,t),this.category]};var CO=Te,Wi=me;Wi.PExpr.prototype.introduceParams=CO.abstract("introduceParams");Wi.any.introduceParams=Wi.end.introduceParams=Wi.Terminal.prototype.introduceParams=Wi.Range.prototype.introduceParams=Wi.Param.prototype.introduceParams=Wi.UnicodeChar.prototype.introduceParams=function(e){return this};Wi.Alt.prototype.introduceParams=function(e){return this.terms.forEach((t,i,o)=>{o[i]=t.introduceParams(e)}),this};Wi.Seq.prototype.introduceParams=function(e){return this.factors.forEach((t,i,o)=>{o[i]=t.introduceParams(e)}),this};Wi.Iter.prototype.introduceParams=Wi.Not.prototype.introduceParams=Wi.Lookahead.prototype.introduceParams=Wi.Lex.prototype.introduceParams=function(e){return this.expr=this.expr.introduceParams(e),this};Wi.Apply.prototype.introduceParams=function(e){let t=e.indexOf(this.ruleName);if(t>=0){if(this.args.length>0)throw new Error("Parameterized rules cannot be passed as arguments to another rule.");return new Wi.Param(t).withSource(this.source)}else return this.args.forEach((i,o,n)=>{n[o]=i.introduceParams(e)}),this};var _O=Te,pi=me;pi.PExpr.prototype.isNullable=function(e){return this._isNullable(e,Object.create(null))};pi.PExpr.prototype._isNullable=_O.abstract("_isNullable");pi.any._isNullable=pi.Range.prototype._isNullable=pi.Param.prototype._isNullable=pi.Plus.prototype._isNullable=pi.UnicodeChar.prototype._isNullable=function(e,t){return!1};pi.end._isNullable=function(e,t){return!0};pi.Terminal.prototype._isNullable=function(e,t){return typeof this.obj=="string"?this.obj==="":!1};pi.Alt.prototype._isNullable=function(e,t){return this.terms.length===0||this.terms.some(i=>i._isNullable(e,t))};pi.Seq.prototype._isNullable=function(e,t){return this.factors.every(i=>i._isNullable(e,t))};pi.Star.prototype._isNullable=pi.Opt.prototype._isNullable=pi.Not.prototype._isNullable=pi.Lookahead.prototype._isNullable=function(e,t){return!0};pi.Lex.prototype._isNullable=function(e,t){return this.expr._isNullable(e,t)};pi.Apply.prototype._isNullable=function(e,t){let i=this.toMemoKey();if(!Object.prototype.hasOwnProperty.call(t,i)){let{body:o}=e.rules[this.ruleName],n=o.substituteParams(this.args);t[i]=!1,t[i]=n._isNullable(e,t)}return t[i]};var wO=Te,gi=me;gi.PExpr.prototype.substituteParams=wO.abstract("substituteParams");gi.any.substituteParams=gi.end.substituteParams=gi.Terminal.prototype.substituteParams=gi.Range.prototype.substituteParams=gi.UnicodeChar.prototype.substituteParams=function(e){return this};gi.Param.prototype.substituteParams=function(e){return e[this.index]};gi.Alt.prototype.substituteParams=function(e){return new gi.Alt(this.terms.map(t=>t.substituteParams(e)))};gi.Seq.prototype.substituteParams=function(e){return new gi.Seq(this.factors.map(t=>t.substituteParams(e)))};gi.Iter.prototype.substituteParams=gi.Not.prototype.substituteParams=gi.Lookahead.prototype.substituteParams=gi.Lex.prototype.substituteParams=function(e){return new this.constructor(this.expr.substituteParams(e))};gi.Apply.prototype.substituteParams=function(e){if(this.args.length===0)return this;{let t=this.args.map(i=>i.substituteParams(e));return new gi.Apply(this.ruleName,t)}};var P_=Te,Hi=me,{copyWithoutDuplicates:SO}=P_;function h_(e){return/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)}function km(e){let t=Object.create(null);e.forEach(i=>{t[i]=(t[i]||0)+1}),Object.keys(t).forEach(i=>{if(t[i]<=1)return;let o=1;e.forEach((n,s)=>{n===i&&(e[s]=n+"_"+o++)})})}Hi.PExpr.prototype.toArgumentNameList=P_.abstract("toArgumentNameList");Hi.any.toArgumentNameList=function(e,t){return["any"]};Hi.end.toArgumentNameList=function(e,t){return["end"]};Hi.Terminal.prototype.toArgumentNameList=function(e,t){return typeof this.obj=="string"&&/^[_a-zA-Z0-9]+$/.test(this.obj)?["_"+this.obj]:["$"+e]};Hi.Range.prototype.toArgumentNameList=function(e,t){let i=this.from+"_to_"+this.to;return h_(i)||(i="_"+i),h_(i)||(i="$"+e),[i]};Hi.Alt.prototype.toArgumentNameList=function(e,t){let i=this.terms.map(s=>s.toArgumentNameList(e,!0)),o=[],n=i[0].length;for(let s=0;s<n;s++){let r=[];for(let l=0;l<this.terms.length;l++)r.push(i[l][s]);let a=SO(r);o.push(a.join("_or_"))}return t||km(o),o};Hi.Seq.prototype.toArgumentNameList=function(e,t){let i=[];return this.factors.forEach(o=>{let n=o.toArgumentNameList(e,!0);i=i.concat(n),e+=n.length}),t||km(i),i};Hi.Iter.prototype.toArgumentNameList=function(e,t){let i=this.expr.toArgumentNameList(e,t).map(o=>o[o.length-1]==="s"?o+"es":o+"s");return t||km(i),i};Hi.Opt.prototype.toArgumentNameList=function(e,t){return this.expr.toArgumentNameList(e,t).map(i=>"opt"+i[0].toUpperCase()+i.slice(1))};Hi.Not.prototype.toArgumentNameList=function(e,t){return[]};Hi.Lookahead.prototype.toArgumentNameList=Hi.Lex.prototype.toArgumentNameList=function(e,t){return this.expr.toArgumentNameList(e,t)};Hi.Apply.prototype.toArgumentNameList=function(e,t){return[this.ruleName]};Hi.UnicodeChar.prototype.toArgumentNameList=function(e,t){return["$"+e]};Hi.Param.prototype.toArgumentNameList=function(e,t){return["param"+this.index]};var xO=Te,an=me;an.PExpr.prototype.toDisplayString=xO.abstract("toDisplayString");an.Alt.prototype.toDisplayString=an.Seq.prototype.toDisplayString=function(){return this.source?this.source.trimmed().contents:"["+this.constructor.name+"]"};an.any.toDisplayString=an.end.toDisplayString=an.Iter.prototype.toDisplayString=an.Not.prototype.toDisplayString=an.Lookahead.prototype.toDisplayString=an.Lex.prototype.toDisplayString=an.Terminal.prototype.toDisplayString=an.Range.prototype.toDisplayString=an.Param.prototype.toDisplayString=function(){return this.toString()};an.Apply.prototype.toDisplayString=function(){if(this.args.length>0){let e=this.args.map(t=>t.toDisplayString());return this.ruleName+"<"+e.join(",")+">"}else return this.ruleName};an.UnicodeChar.prototype.toDisplayString=function(){return"Unicode ["+this.category+"] character"};var kr=A_,DO=Te,bn=me;bn.PExpr.prototype.toFailure=DO.abstract("toFailure");bn.any.toFailure=function(e){return new kr(this,"any object","description")};bn.end.toFailure=function(e){return new kr(this,"end of input","description")};bn.Terminal.prototype.toFailure=function(e){return new kr(this,this.obj,"string")};bn.Range.prototype.toFailure=function(e){return new kr(this,JSON.stringify(this.from)+".."+JSON.stringify(this.to),"code")};bn.Not.prototype.toFailure=function(e){let t=this.expr===bn.any?"nothing":"not "+this.expr.toFailure(e);return new kr(this,t,"description")};bn.Lookahead.prototype.toFailure=function(e){return this.expr.toFailure(e)};bn.Apply.prototype.toFailure=function(e){let{description:t}=e.rules[this.ruleName];return t||(t=(/^[aeiouAEIOU]/.test(this.ruleName)?"an":"a")+" "+this.ruleName),new kr(this,t,"description")};bn.UnicodeChar.prototype.toFailure=function(e){return new kr(this,"a Unicode ["+this.category+"] character","description")};bn.Alt.prototype.toFailure=function(e){let i="("+this.terms.map(o=>o.toFailure(e)).join(" or ")+")";return new kr(this,i,"description")};bn.Seq.prototype.toFailure=function(e){let i="("+this.factors.map(o=>o.toFailure(e)).join(" ")+")";return new kr(this,i,"description")};bn.Iter.prototype.toFailure=function(e){let t="("+this.expr.toFailure(e)+this.operator+")";return new kr(this,t,"description")};var bO=Te,cn=me;cn.PExpr.prototype.toString=bO.abstract("toString");cn.any.toString=function(){return"any"};cn.end.toString=function(){return"end"};cn.Terminal.prototype.toString=function(){return JSON.stringify(this.obj)};cn.Range.prototype.toString=function(){return JSON.stringify(this.from)+".."+JSON.stringify(this.to)};cn.Param.prototype.toString=function(){return"$"+this.index};cn.Lex.prototype.toString=function(){return"#("+this.expr.toString()+")"};cn.Alt.prototype.toString=function(){return this.terms.length===1?this.terms[0].toString():"("+this.terms.map(e=>e.toString()).join(" | ")+")"};cn.Seq.prototype.toString=function(){return this.factors.length===1?this.factors[0].toString():"("+this.factors.map(e=>e.toString()).join(" ")+")"};cn.Iter.prototype.toString=function(){return this.expr+this.operator};cn.Not.prototype.toString=function(){return"~"+this.expr};cn.Lookahead.prototype.toString=function(){return"&"+this.expr};cn.Apply.prototype.toString=function(){if(this.args.length>0){let e=this.args.map(t=>t.toString());return this.ruleName+"<"+e.join(",")+">"}else return this.ruleName};cn.UnicodeChar.prototype.toString=function(){return"\\p{"+this.category+"}"};var Yo=me,AO=A_,{TerminalNode:EO}=Em,{assert:TO}=Te,{PExpr:FO,Terminal:OO}=Yo,Sm=class e extends FO{constructor(t){super(),this.obj=t}_getString(t){let i=t.currentApplication().args[this.obj.index];return TO(i instanceof OO,"expected a Terminal expression"),i.obj}allowsSkippingPrecedingSpace(){return!0}eval(t){let{inputStream:i}=t,o=i.pos,n=this._getString(t);return i.matchString(n,!0)?(t.pushBinding(new EO(n.length),o),!0):(t.processFailure(o,this),!1)}getArity(){return 1}substituteParams(t){return new e(this.obj.substituteParams(t))}toDisplayString(){return this.obj.toDisplayString()+" (case-insensitive)"}toFailure(t){return new AO(this,this.obj.toFailure(t)+" (case-insensitive)","description")}_isNullable(t,i){return this.obj._isNullable(t,i)}},kO=Sm,PO=Tm;function I_(e){this.source=e,this.pos=0,this.examinedLength=0}I_.prototype={atEnd(){let e=this.pos===this.source.length;return this.examinedLength=Math.max(this.examinedLength,this.pos+1),e},next(){let e=this.source[this.pos++];return this.examinedLength=Math.max(this.examinedLength,this.pos),e},nextCharCode(){let e=this.next();return e&&e.charCodeAt(0)},nextCodePoint(){let e=this.source.slice(this.pos++).codePointAt(0);return e>65535&&(this.pos+=1),this.examinedLength=Math.max(this.examinedLength,this.pos),e},matchString(e,t){let i;if(t){for(i=0;i<e.length;i++){let o=this.next(),n=e[i];if(o==null||o.toUpperCase()!==n.toUpperCase())return!1}return!0}for(i=0;i<e.length;i++)if(this.next()!==e[i])return!1;return!0},sourceSlice(e,t){return this.source.slice(e,t)},interval(e,t){return new PO(this.source,e,t||this.pos)}};var Pm=I_,xm=Te,f_=io,IO=Tm;function no(e,t,i,o,n,s,r){this.matcher=e,this.input=t,this.startExpr=i,this._cst=o,this._cstOffset=n,this._rightmostFailurePosition=s,this._rightmostFailures=r,this.failed()&&(xm.defineLazyProperty(this,"message",function(){let a="Expected "+this.getExpectedText();return f_.getLineAndColumnMessage(this.input,this.getRightmostFailurePosition())+a}),xm.defineLazyProperty(this,"shortMessage",function(){let a="expected "+this.getExpectedText(),l=f_.getLineAndColumn(this.input,this.getRightmostFailurePosition());return"Line "+l.lineNum+", col "+l.colNum+": "+a}))}no.prototype.succeeded=function(){return!!this._cst};no.prototype.failed=function(){return!this.succeeded()};no.prototype.getRightmostFailurePosition=function(){return this._rightmostFailurePosition};no.prototype.getRightmostFailures=function(){if(!this._rightmostFailures){this.matcher.setInput(this.input);let e=this.matcher._match(this.startExpr,!1,this.getRightmostFailurePosition());this._rightmostFailures=e.getRightmostFailures()}return this._rightmostFailures};no.prototype.toString=function(){return this.succeeded()?"[match succeeded]":"[match failed at position "+this.getRightmostFailurePosition()+"]"};no.prototype.getExpectedText=function(){if(this.succeeded())throw new Error("cannot get expected text of a successful MatchResult");let e=new xm.StringBuffer,t=this.getRightmostFailures();t=t.filter(i=>!i.isFluffy());for(let i=0;i<t.length;i++)i>0&&(i===t.length-1?e.append(t.length>2?", or ":" or "):e.append(", ")),e.append(t[i].toString());return e.contents()};no.prototype.getInterval=function(){let e=this.getRightmostFailurePosition();return new IO(this.input,e,e)};var B_=no;function L_(){this.applicationMemoKeyStack=[],this.memo={},this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,this.currentLeftRecursion=void 0}L_.prototype={isActive(e){return this.applicationMemoKeyStack.indexOf(e.toMemoKey())>=0},enter(e){this.applicationMemoKeyStack.push(e.toMemoKey())},exit(){this.applicationMemoKeyStack.pop()},startLeftRecursion(e,t){t.isLeftRecursion=!0,t.headApplication=e,t.nextLeftRecursion=this.currentLeftRecursion,this.currentLeftRecursion=t;let{applicationMemoKeyStack:i}=this,o=i.indexOf(e.toMemoKey())+1,n=i.slice(o);t.isInvolved=function(s){return n.indexOf(s)>=0},t.updateInvolvedApplicationMemoKeys=function(){for(let s=o;s<i.length;s++){let r=i[s];this.isInvolved(r)||n.push(r)}}},endLeftRecursion(){this.currentLeftRecursion=this.currentLeftRecursion.nextLeftRecursion},shouldUseMemoizedResult(e){if(!e.isLeftRecursion)return!0;let{applicationMemoKeyStack:t}=this;for(let i=0;i<t.length;i++){let o=t[i];if(e.isInvolved(o))return!1}return!0},memoize(e,t){return this.memo[e]=t,this.maxExaminedLength=Math.max(this.maxExaminedLength,t.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,t.rightmostFailureOffset),t},clearObsoleteEntries(e,t){if(e+this.maxExaminedLength<=t)return;let{memo:i}=this;this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,Object.keys(i).forEach(o=>{let n=i[o];e+n.examinedLength>t?delete i[o]:(this.maxExaminedLength=Math.max(this.maxExaminedLength,n.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,n.rightmostFailureOffset))})}};var BO=L_,LO=Pm,MO=B_,RO=BO,jO=O_,Dm=Yo,NO=io,M_;NO.awaitBuiltInRules(e=>{M_=e.rules.applySyntactic.body});var rm=new Dm.Apply("spaces");function R_(e,t,i){this.matcher=e,this.startExpr=t,this.grammar=e.grammar,this.input=e.input,this.inputStream=new LO(e.input),this.memoTable=e.memoTable,this._bindings=[],this._bindingOffsets=[],this._applicationStack=[],this._posStack=[0],this.inLexifiedContextStack=[!1],this.rightmostFailurePosition=-1,this._rightmostFailurePositionStack=[],this._recordedFailuresStack=[],i!==void 0&&(this.positionToRecordFailures=i,this.recordedFailures=Object.create(null))}R_.prototype={posToOffset(e){return e-this._posStack[this._posStack.length-1]},enterApplication(e,t){this._posStack.push(this.inputStream.pos),this._applicationStack.push(t),this.inLexifiedContextStack.push(!1),e.enter(t),this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this.rightmostFailurePosition=-1},exitApplication(e,t){let i=this._posStack.pop();this._applicationStack.pop(),this.inLexifiedContextStack.pop(),e.exit(),this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,this._rightmostFailurePositionStack.pop()),t&&this.pushBinding(t,i)},enterLexifiedContext(){this.inLexifiedContextStack.push(!0)},exitLexifiedContext(){this.inLexifiedContextStack.pop()},currentApplication(){return this._applicationStack[this._applicationStack.length-1]},inSyntacticContext(){let e=this.currentApplication();return e?e.isSyntactic()&&!this.inLexifiedContext():this.startExpr.factors[0].isSyntactic()},inLexifiedContext(){return this.inLexifiedContextStack[this.inLexifiedContextStack.length-1]},skipSpaces(){return this.pushFailuresInfo(),this.eval(rm),this.popBinding(),this.popFailuresInfo(),this.inputStream.pos},skipSpacesIfInSyntacticContext(){return this.inSyntacticContext()?this.skipSpaces():this.inputStream.pos},maybeSkipSpacesBefore(e){return e.allowsSkippingPrecedingSpace()&&e!==rm?this.skipSpacesIfInSyntacticContext():this.inputStream.pos},pushBinding(e,t){this._bindings.push(e),this._bindingOffsets.push(this.posToOffset(t))},popBinding(){this._bindings.pop(),this._bindingOffsets.pop()},numBindings(){return this._bindings.length},truncateBindings(e){for(;this._bindings.length>e;)this.popBinding()},getCurrentPosInfo(){return this.getPosInfo(this.inputStream.pos)},getPosInfo(e){let t=this.memoTable[e];return t||(t=this.memoTable[e]=new RO),t},processFailure(e,t){if(this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,e),this.recordedFailures&&e===this.positionToRecordFailures){let i=this.currentApplication();i&&(t=t.substituteParams(i.args)),this.recordFailure(t.toFailure(this.grammar),!1)}},recordFailure(e,t){let i=e.toKey();this.recordedFailures[i]?this.recordedFailures[i].isFluffy()&&!e.isFluffy()&&this.recordedFailures[i].clearFluffy():this.recordedFailures[i]=t?e.clone():e},recordFailures(e,t){Object.keys(e).forEach(i=>{this.recordFailure(e[i],t)})},cloneRecordedFailures(){if(!this.recordedFailures)return;let e=Object.create(null);return Object.keys(this.recordedFailures).forEach(t=>{e[t]=this.recordedFailures[t].clone()}),e},getRightmostFailurePosition(){return this.rightmostFailurePosition},_getRightmostFailureOffset(){return this.rightmostFailurePosition>=0?this.posToOffset(this.rightmostFailurePosition):-1},getMemoizedTraceEntry(e,t){let i=this.memoTable[e];if(i&&t instanceof Dm.Apply){let o=i.memo[t.toMemoKey()];if(o&&o.traceEntry){let n=o.traceEntry.cloneWithExpr(t);return n.isMemoized=!0,n}}return null},getTraceEntry(e,t,i,o){if(t instanceof Dm.Apply){let n=this.currentApplication(),s=n?n.args:[];t=t.substituteParams(s)}return this.getMemoizedTraceEntry(e,t)||new jO(this.input,e,this.inputStream.pos,t,i,o,this.trace)},isTracing(){return!!this.trace},hasNecessaryInfo(e){return this.trace&&!e.traceEntry?!1:this.recordedFailures&&this.inputStream.pos+e.rightmostFailureOffset===this.positionToRecordFailures?!!e.failuresAtRightmostPosition:!0},useMemoizedResult(e,t){this.trace&&this.trace.push(t.traceEntry);let i=this.inputStream.pos+t.rightmostFailureOffset;return this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,i),this.recordedFailures&&this.positionToRecordFailures===i&&t.failuresAtRightmostPosition&&this.recordFailures(t.failuresAtRightmostPosition,!0),this.inputStream.examinedLength=Math.max(this.inputStream.examinedLength,t.examinedLength+e),t.value?(this.inputStream.pos+=t.matchLength,this.pushBinding(t.value,e),!0):!1},eval(e){let{inputStream:t}=this,i=this._bindings.length,o;this.recordedFailures&&(o=this.recordedFailures,this.recordedFailures=Object.create(null));let n=t.pos,s=this.maybeSkipSpacesBefore(e),r;this.trace&&(r=this.trace,this.trace=[]);let a=e.eval(this);if(this.trace){let l=this._bindings.slice(i),u=this.getTraceEntry(s,e,a,l);u.isImplicitSpaces=e===rm,u.isRootNode=e===this.startExpr,r.push(u),this.trace=r}return a?this.recordedFailures&&t.pos===this.positionToRecordFailures&&Object.keys(this.recordedFailures).forEach(l=>{this.recordedFailures[l].makeFluffy()}):(t.pos=n,this.truncateBindings(i)),this.recordedFailures&&this.recordFailures(o,!1),e===M_&&this.skipSpaces(),a},getMatchResult(){this.eval(this.startExpr);let e;this.recordedFailures&&(e=Object.keys(this.recordedFailures).map(i=>this.recordedFailures[i]));let t=this._bindings[0];return t&&(t.grammar=this.grammar),new MO(this.matcher,this.input,this.startExpr,t,this._bindingOffsets[0],this.rightmostFailurePosition,e)},getTrace(){this.trace=[];let e=this.getMatchResult(),t=this.trace[this.trace.length-1];return t.result=e,t},pushFailuresInfo(){this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this._recordedFailuresStack.push(this.recordedFailures)},popFailuresInfo(){this.rightmostFailurePosition=this._rightmostFailurePositionStack.pop(),this.recordedFailures=this._recordedFailuresStack.pop()}};var UO=R_,zO=UO,d_=Yo;function ro(e){this.grammar=e,this.memoTable=[],this.input=""}ro.prototype.getInput=function(){return this.input};ro.prototype.setInput=function(e){return this.input!==e&&this.replaceInputRange(0,this.input.length,e),this};ro.prototype.replaceInputRange=function(e,t,i){let o=this.input;if(e<0||e>o.length||t<0||t>o.length||e>t)throw new Error("Invalid indices: "+e+" and "+t);this.input=o.slice(0,e)+i+o.slice(t);let n=this.memoTable.slice(t);this.memoTable.length=e;for(let s=0;s<i.length;s++)this.memoTable.push(void 0);n.forEach(function(s){this.memoTable.push(s)},this);for(let s=0;s<e;s++){let r=this.memoTable[s];r&&r.clearObsoleteEntries(s,e)}return this};ro.prototype.match=function(e){return this._match(this._getStartExpr(e),!1)};ro.prototype.trace=function(e){return this._match(this._getStartExpr(e),!0)};ro.prototype._match=function(e,t,i){let o=new zO(this,e,i);return t?o.getTrace():o.getMatchResult()};ro.prototype._getStartExpr=function(e){let t=e||this.grammar.defaultStartRule;if(!t)throw new Error("Missing start rule argument -- the grammar has no default start rule.");let i=this.grammar.parseApplication(t);return new d_.Seq([i,d_.end])};var WO=ro,GO=Pm,{IterationNode:HO}=Em,XO=B_,Im=Te,YO=ls,j_=io,Vl=[],Bm=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),cf=class{constructor(t,i,o){this._node=t,this.source=i,this._baseInterval=o,t.isNonterminal()&&Im.assert(i===o),this._childWrappers=[]}toString(){return"[semantics wrapper for "+this._node.grammar.name+"]"}_forgetMemoizedResultFor(t){delete this._node[this._semantics.attributeKeys[t]],this.children.forEach(i=>{i._forgetMemoizedResultFor(t)})}child(t){if(!(0<=t&&t<this._node.numChildren()))return;let i=this._childWrappers[t];if(!i){let o=this._node.childAt(t),n=this._node.childOffsets[t],s=this._baseInterval.subInterval(n,o.matchLength),r=o.isNonterminal()?s:this._baseInterval;i=this._childWrappers[t]=this._semantics.wrap(o,s,r)}return i}_children(){for(let t=0;t<this._node.numChildren();t++)this.child(t);return this._childWrappers}isIteration(){return this._node.isIteration()}isTerminal(){return this._node.isTerminal()}isNonterminal(){return this._node.isNonterminal()}isSyntactic(){return this.isNonterminal()&&this._node.isSyntactic()}isLexical(){return this.isNonterminal()&&this._node.isLexical()}isOptional(){return this._node.isOptional()}iteration(t){let i=t||[],o=i.map(r=>r._node),n=new HO(o,[],-1,!1),s=this._semantics.wrap(n,null,null);return s._childWrappers=i,s}get children(){return this._children()}get ctorName(){return this._node.ctorName}get interval(){throw new Error("The `interval` property is deprecated -- use `source` instead")}get numChildren(){return this._node.numChildren()}get sourceString(){return this.source.contents}};function bi(e,t){let i=this;if(this.grammar=e,this.checkedActionDicts=!1,this.Wrapper=class extends(t?t.Wrapper:cf){constructor(o,n,s){super(o,n,s),i.checkActionDictsIfHaventAlready(),this._semantics=i}},this.super=t,t){if(!(e.equals(this.super.grammar)||e._inheritsFrom(this.super.grammar)))throw new Error("Cannot extend a semantics for grammar '"+this.super.grammar.name+"' for use with grammar '"+e.name+"' (not a sub-grammar)");this.operations=Object.create(this.super.operations),this.attributes=Object.create(this.super.attributes),this.attributeKeys=Object.create(null);for(let o in this.attributes)Object.defineProperty(this.attributeKeys,o,{value:j_.uniqueId(o)})}else this.operations=Object.create(null),this.attributes=Object.create(null),this.attributeKeys=Object.create(null)}bi.prototype.toString=function(){return"[semantics for "+this.grammar.name+"]"};bi.prototype.checkActionDictsIfHaventAlready=function(){this.checkedActionDicts||(this.checkActionDicts(),this.checkedActionDicts=!0)};bi.prototype.checkActionDicts=function(){let e;for(e in this.operations)this.operations[e].checkActionDict(this.grammar);for(e in this.attributes)this.attributes[e].checkActionDict(this.grammar)};bi.prototype.toRecipe=function(e){function t(o){return o.super!==bi.BuiltInSemantics._getSemantics()}let i=`(function(g) {
`;if(t(this)){i+="  var semantics = "+this.super.toRecipe(!0)+"(g";let o=this.super.grammar,n=this.grammar;for(;n!==o;)i+=".superGrammar",n=n.superGrammar;i+=`);
`,i+="  return g.extendSemantics(semantics)"}else i+="  return g.createSemantics()";return["Operation","Attribute"].forEach(o=>{let n=this[o.toLowerCase()+"s"];Object.keys(n).forEach(s=>{let{actionDict:r,formals:a,builtInDefault:l}=n[s],u=s;a.length>0&&(u+="("+a.join(", ")+")");let c;t(this)&&this.super[o.toLowerCase()+"s"][s]?c="extend"+o:c="add"+o,i+=`
    .`+c+"("+JSON.stringify(u)+", {";let h=[];Object.keys(r).forEach(d=>{if(r[d]!==l){let g=r[d].toString().trim();g=g.replace(/^.*\(/,"function("),h.push(`
      `+JSON.stringify(d)+": "+g)}}),i+=h.join(",")+`
    })`})}),i+=`;
  })`,e||(i=`(function() {
  var grammar = this.fromRecipe(`+this.grammar.toRecipe()+`);
  var semantics = `+i+`(grammar);
  return semantics;
});
`),i};function N_(e,t){if(!bi.prototypeGrammar)return Im.assert(e.indexOf("(")===-1),{name:e,formals:[]};let i=bi.prototypeGrammar.match(e,t==="operation"?"OperationSignature":"AttributeSignature");if(i.failed())throw new Error(i.message);return bi.prototypeGrammarSemantics(i).parse()}function VO(e,t,i){return function(...o){let s=(this._semantics.operations[t]||this._semantics.attributes[t]).formals.map(r=>this.args[r]);if(!this.isIteration()&&o.length===1)return i.apply(o[0],s);throw YO.missingSemanticAction(this.ctorName,t,e,Vl)}}bi.prototype.addOperationOrAttribute=function(e,t,i){let o=e+"s",n=N_(t,e),{name:s}=n,{formals:r}=n;this.assertNewName(s,e);let a=VO(e,s,c),l={_default:a};Object.keys(i).forEach(h=>{l[h]=i[h]});let u=e==="operation"?new Xo(s,r,l,a):new Kl(s,l,a);u.checkActionDict(this.grammar),this[o][s]=u;function c(...h){let d=this._semantics[o][s];if(arguments.length!==d.formals.length)throw new Error("Invalid number of arguments passed to "+s+" "+e+" (expected "+d.formals.length+", got "+arguments.length+")");let g=Object.create(null);for(let[C,w]of Object.entries(h)){let F=d.formals[C];g[F]=w}let m=this.args;this.args=g;let y=d.execute(this._semantics,this);return this.args=m,y}e==="operation"?(this.Wrapper.prototype[s]=c,this.Wrapper.prototype[s].toString=function(){return"["+s+" operation]"}):(Object.defineProperty(this.Wrapper.prototype,s,{get:c,configurable:!0}),Object.defineProperty(this.attributeKeys,s,{value:j_.uniqueId(s)}))};bi.prototype.extendOperationOrAttribute=function(e,t,i){let o=e+"s";if(N_(t,"attribute"),!(this.super&&t in this.super[o]))throw new Error("Cannot extend "+e+" '"+t+"': did not inherit an "+e+" with that name");if(Bm(this[o],t))throw new Error("Cannot extend "+e+" '"+t+"' again");let n=this[o][t].formals,s=this[o][t].actionDict,r=Object.create(s);Object.keys(i).forEach(a=>{r[a]=i[a]}),this[o][t]=e==="operation"?new Xo(t,n,r):new Kl(t,r),this[o][t].checkActionDict(this.grammar)};bi.prototype.assertNewName=function(e,t){if(Bm(cf.prototype,e))throw new Error("Cannot add "+t+" '"+e+"': that's a reserved name");if(e in this.operations)throw new Error("Cannot add "+t+" '"+e+"': an operation with that name already exists");if(e in this.attributes)throw new Error("Cannot add "+t+" '"+e+"': an attribute with that name already exists")};bi.prototype.wrap=function(e,t,i){let o=i||t;return e instanceof this.Wrapper?e:new this.Wrapper(e,t,o)};bi.createSemantics=function(e,t){let i=new bi(e,t!==void 0?t:bi.BuiltInSemantics._getSemantics()),o=function(s){if(!(s instanceof XO))throw new TypeError("Semantics expected a MatchResult, but got "+Im.unexpectedObjToString(s));if(s.failed())throw new TypeError("cannot apply Semantics to "+s.toString());let r=s._cst;if(r.grammar!==e)throw new Error("Cannot use a MatchResult from grammar '"+r.grammar.name+"' with a semantics for '"+e.name+"'");let a=new GO(s.input);return i.wrap(r,a.interval(s._cstOffset,s.input.length))};return o.addOperation=function(n,s){return i.addOperationOrAttribute("operation",n,s),o},o.extendOperation=function(n,s){return i.extendOperationOrAttribute("operation",n,s),o},o.addAttribute=function(n,s){return i.addOperationOrAttribute("attribute",n,s),o},o.extendAttribute=function(n,s){return i.extendOperationOrAttribute("attribute",n,s),o},o._getActionDict=function(n){let s=i.operations[n]||i.attributes[n];if(!s)throw new Error('"'+n+'" is not a valid operation or attribute name in this semantics for "'+e.name+'"');return s.actionDict},o._remove=function(n){let s;return n in i.operations?(s=i.operations[n],delete i.operations[n]):n in i.attributes&&(s=i.attributes[n],delete i.attributes[n]),delete i.Wrapper.prototype[n],s},o.getOperationNames=function(){return Object.keys(i.operations)},o.getAttributeNames=function(){return Object.keys(i.attributes)},o.getGrammar=function(){return i.grammar},o.toRecipe=function(n){return i.toRecipe(n)},o.toString=i.toString.bind(i),o._getSemantics=function(){return i},o};var Xo=class{constructor(t,i,o,n){this.name=t,this.formals=i,this.actionDict=o,this.builtInDefault=n}checkActionDict(t){t._checkTopDownActionDict(this.typeName,this.name,this.actionDict)}execute(t,i){try{let{ctorName:o}=i._node,n=this.actionDict[o];return n?(Vl.push([this,o]),n.apply(i,i._children())):i.isNonterminal()&&(n=this.actionDict._nonterminal,n)?(Vl.push([this,"_nonterminal",o]),n.apply(i,i._children())):(Vl.push([this,"default action",o]),this.actionDict._default.apply(i,i._children()))}finally{Vl.pop()}}};Xo.prototype.typeName="operation";var Kl=class extends Xo{constructor(t,i,o){super(t,[],i,o)}execute(t,i){let o=i._node,n=t.attributeKeys[this.name];return Bm(o,n)||(o[n]=Xo.prototype.execute.call(this,t,i)),o[n]}};Kl.prototype.typeName="attribute";var U_=bi,qO=kO,$O=WO,p_=U_,g_=Te,m_=ls,hr=Yo,v_=["_iter","_terminal","_nonterminal","_default"];function y_(e){return Object.keys(e.rules).sort().map(t=>e.rules[t])}var KO=e=>e.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");function Go(e,t,i,o){if(this.name=e,this.superGrammar=t,this.rules=i,o){if(!(o in i))throw new Error("Invalid start rule: '"+o+"' is not a rule in grammar '"+e+"'");this.defaultStartRule=o}}var z_,W_;Go.initApplicationParser=function(e,t){z_=e,W_=t};Go.prototype={matcher(){return new $O(this)},isBuiltIn(){return this===Go.ProtoBuiltInRules||this===Go.BuiltInRules},equals(e){if(this===e)return!0;if(e==null||this.name!==e.name||this.defaultStartRule!==e.defaultStartRule||!(this.superGrammar===e.superGrammar||this.superGrammar.equals(e.superGrammar)))return!1;let t=y_(this),i=y_(e);return t.length===i.length&&t.every((o,n)=>o.description===i[n].description&&o.formals.join(",")===i[n].formals.join(",")&&o.body.toString()===i[n].body.toString())},match(e,t){let i=this.matcher();return i.replaceInputRange(0,0,e),i.match(t)},trace(e,t){let i=this.matcher();return i.replaceInputRange(0,0,e),i.trace(t)},createSemantics(){return p_.createSemantics(this)},extendSemantics(e){return p_.createSemantics(this,e._getSemantics())},_checkTopDownActionDict(e,t,i){let o=[];for(let n in i){let s=i[n];if(!v_.includes(n)&&!(n in this.rules)){o.push(`'${n}' is not a valid semantic action for '${this.name}'`);continue}if(typeof s!="function"){o.push(`'${n}' must be a function in an action dictionary for '${this.name}'`);continue}let a=s.length,l=this._topDownActionArity(n);if(a!==l){let u;n==="_iter"||n==="_nonterminal"?u=`it should use a rest parameter, e.g. \`${n}(...children) {}\`. NOTE: this is new in Ohm v16 \u2014 see https://ohmjs.org/d/ati for details.`:u=`expected ${l}, got ${a}`,o.push(`Semantic action '${n}' has the wrong arity: ${u}`)}}if(o.length>0){let n=o.map(r=>"- "+r),s=new Error([`Found errors in the action dictionary of the '${t}' ${e}:`,...n].join(`
`));throw s.problems=o,s}},_topDownActionArity(e){return v_.includes(e)?0:this.rules[e].body.getArity()},_inheritsFrom(e){let t=this.superGrammar;for(;t;){if(t.equals(e,!0))return!0;t=t.superGrammar}return!1},toRecipe(e=void 0){let t={};this.source&&(t.source=this.source.contents);let i=null;this.defaultStartRule&&(i=this.defaultStartRule);let o={};Object.keys(this.rules).forEach(r=>{let a=this.rules[r],{body:l}=a,u=!this.superGrammar||!this.superGrammar.rules[r],c;u?c="define":c=l instanceof hr.Extend?"extend":"override";let h={};if(a.source&&this.source){let m=a.source.relativeTo(this.source);h.sourceInterval=[m.startIdx,m.endIdx]}let d=u?a.description:null,g=l.outputRecipe(a.formals,this.source);o[r]=[c,h,d,a.formals,g]});let n="null";e?n=e:this.superGrammar&&!this.superGrammar.isBuiltIn()&&(n=this.superGrammar.toRecipe());let s=[...["grammar",t,this.name].map(JSON.stringify),n,...[i,o].map(JSON.stringify)];return KO(`[${s.join(",")}]`)},toOperationActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()},toAttributeActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()},_toOperationOrAttributeActionDictionaryTemplate(){let e=new g_.StringBuffer;e.append("{");let t=!0;for(let i in this.rules){let{body:o}=this.rules[i];t?t=!1:e.append(","),e.append(`
`),e.append("  "),this.addSemanticActionTemplate(i,o,e)}return e.append(`
}`),e.contents()},addSemanticActionTemplate(e,t,i){i.append(e),i.append(": function(");let o=this._topDownActionArity(e);i.append(g_.repeat("_",o).join(", ")),i.append(`) {
`),i.append("  }")},parseApplication(e){let t;if(e.indexOf("<")===-1)t=new hr.Apply(e);else{let o=z_.match(e,"Base_application");t=W_(o,{})}if(!(t.ruleName in this.rules))throw m_.undeclaredRule(t.ruleName,this.name);let{formals:i}=this.rules[t.ruleName];if(i.length!==t.args.length){let{source:o}=this.rules[t.ruleName];throw m_.wrongNumberOfParameters(t.ruleName,i.length,t.args.length,o)}return t}};Go.ProtoBuiltInRules=new Go("ProtoBuiltInRules",void 0,{any:{body:hr.any,formals:[],description:"any character",primitive:!0},end:{body:hr.end,formals:[],description:"end of input",primitive:!0},caseInsensitive:{body:new qO(new hr.Param(0)),formals:["str"],primitive:!0},lower:{body:new hr.UnicodeChar("Ll"),formals:[],description:"a lowercase letter",primitive:!0},upper:{body:new hr.UnicodeChar("Lu"),formals:[],description:"an uppercase letter",primitive:!0},unicodeLtmo:{body:new hr.UnicodeChar("Ltmo"),formals:[],description:"a Unicode character in Lt, Lm, or Lo",primitive:!0},spaces:{body:new hr.Star(new hr.Apply("space")),formals:[]},space:{body:new hr.Range("\0"," "),formals:[],description:"a space"}});var df=Go,bm=df,JO=Pm,G_=Te,eo=ls,QO=Yo;function An(e){this.name=e}An.prototype.sourceInterval=function(e,t){return this.source.subInterval(e,t-e)};An.prototype.ensureSuperGrammar=function(){return this.superGrammar||this.withSuperGrammar(this.name==="BuiltInRules"?bm.ProtoBuiltInRules:bm.BuiltInRules),this.superGrammar};An.prototype.ensureSuperGrammarRuleForOverriding=function(e,t){let i=this.ensureSuperGrammar().rules[e];if(!i)throw eo.cannotOverrideUndeclaredRule(e,this.superGrammar.name,t);return i};An.prototype.installOverriddenOrExtendedRule=function(e,t,i,o){let n=G_.getDuplicates(t);if(n.length>0)throw eo.duplicateParameterNames(e,n,o);let s=this.ensureSuperGrammar().rules[e],r=s.formals,a=r?r.length:0;if(t.length!==a)throw eo.wrongNumberOfParameters(e,a,t.length,o);return this.install(e,t,i,s.description,o)};An.prototype.install=function(e,t,i,o,n){return this.rules[e]={body:i.introduceParams(t),formals:t,description:o,source:n},this};An.prototype.withSuperGrammar=function(e){if(this.superGrammar)throw new Error("the super grammar of a GrammarDecl cannot be set more than once");return this.superGrammar=e,this.rules=Object.create(e.rules),e.isBuiltIn()||(this.defaultStartRule=e.defaultStartRule),this};An.prototype.withDefaultStartRule=function(e){return this.defaultStartRule=e,this};An.prototype.withSource=function(e){return this.source=new JO(e).interval(0,e.length),this};An.prototype.build=function(){let e=new bm(this.name,this.ensureSuperGrammar(),this.rules,this.defaultStartRule),t=[],i=!1;return Object.keys(e.rules).forEach(o=>{let{body:n}=e.rules[o];try{n.assertChoicesHaveUniformArity(o)}catch(s){t.push(s)}try{n.assertAllApplicationsAreValid(o,e)}catch(s){t.push(s),i=!0}}),i||Object.keys(e.rules).forEach(o=>{let{body:n}=e.rules[o];try{n.assertIteratedExprsAreNotNullable(e,[])}catch(s){t.push(s)}}),t.length>0&&eo.throwErrors(t),this.source&&(e.source=this.source),e};An.prototype.define=function(e,t,i,o,n){if(this.ensureSuperGrammar(),this.superGrammar.rules[e])throw eo.duplicateRuleDeclaration(e,this.name,this.superGrammar.name,n);if(this.rules[e])throw eo.duplicateRuleDeclaration(e,this.name,this.name,n);let s=G_.getDuplicates(t);if(s.length>0)throw eo.duplicateParameterNames(e,s,n);return this.install(e,t,i,o,n)};An.prototype.override=function(e,t,i,o,n){return this.ensureSuperGrammarRuleForOverriding(e,n),this.installOverriddenOrExtendedRule(e,t,i,n),this};An.prototype.extend=function(e,t,i,o,n){if(!this.ensureSuperGrammar().rules[e])throw eo.cannotExtendUndeclaredRule(e,this.superGrammar.name,n);let r=new QO.Extend(this.superGrammar,e,i);return r.source=i.source,this.installOverriddenOrExtendedRule(e,t,r,n),this};var ZO=An,tk=df,C_=ZO,Ne=Yo;function H_(){}H_.prototype={currentDecl:null,currentRuleName:null,newGrammar(e){return new C_(e)},grammar(e,t,i,o,n){let s=new C_(t);return i&&s.withSuperGrammar(i instanceof tk?i:this.fromRecipe(i)),o&&s.withDefaultStartRule(o),e&&e.source&&s.withSource(e.source),this.currentDecl=s,Object.keys(n).forEach(r=>{this.currentRuleName=r;let a=n[r],l=a[0],u=a[1],c=a[2],h=a[3],d=this.fromRecipe(a[4]),g;s.source&&u&&u.sourceInterval&&(g=s.source.subInterval(u.sourceInterval[0],u.sourceInterval[1]-u.sourceInterval[0])),s[l](r,h,d,c,g)}),this.currentRuleName=this.currentDecl=null,s.build()},terminal(e){return new Ne.Terminal(e)},range(e,t){return new Ne.Range(e,t)},param(e){return new Ne.Param(e)},alt(...e){let t=[];for(let i of e)i instanceof Ne.PExpr||(i=this.fromRecipe(i)),i instanceof Ne.Alt?t=t.concat(i.terms):t.push(i);return t.length===1?t[0]:new Ne.Alt(t)},seq(...e){let t=[];for(let i of e)i instanceof Ne.PExpr||(i=this.fromRecipe(i)),i instanceof Ne.Seq?t=t.concat(i.factors):t.push(i);return t.length===1?t[0]:new Ne.Seq(t)},star(e){return e instanceof Ne.PExpr||(e=this.fromRecipe(e)),new Ne.Star(e)},plus(e){return e instanceof Ne.PExpr||(e=this.fromRecipe(e)),new Ne.Plus(e)},opt(e){return e instanceof Ne.PExpr||(e=this.fromRecipe(e)),new Ne.Opt(e)},not(e){return e instanceof Ne.PExpr||(e=this.fromRecipe(e)),new Ne.Not(e)},la(e){return this.lookahead(e)},lookahead(e){return e instanceof Ne.PExpr||(e=this.fromRecipe(e)),new Ne.Lookahead(e)},lex(e){return e instanceof Ne.PExpr||(e=this.fromRecipe(e)),new Ne.Lex(e)},app(e,t){return t&&t.length>0&&(t=t.map(function(i){return i instanceof Ne.PExpr?i:this.fromRecipe(i)},this)),new Ne.Apply(e,t)},splice(e,t){return new Ne.Splice(this.currentDecl.superGrammar,this.currentRuleName,e.map(i=>this.fromRecipe(i)),t.map(i=>this.fromRecipe(i)))},fromRecipe(e){let t=e[0]==="grammar"?e.slice(1):e.slice(2),i=this[e[0]](...t),o=e[1];return o&&o.sourceInterval&&this.currentDecl&&i.withSource(this.currentDecl.sourceInterval(...o.sourceInterval)),i}};var X_=H_,ek="ohm-js",ik="16.6.0",nk="An object-oriented language for parsing and pattern matching",rk="https://github.com/harc/ohm",sk=["parser","compiler","pattern matching","pattern-matching","ometa","ometa/js","ometa-js","ometajs","rapid","prototyping"],ok="https://ohmjs.org",ak="https://github.com/harc/ohm/issues",uk="index.js",lk="dist/ohm.esm.js",ck=["src","dist","extras","third_party","index.d.ts"],hk="index.d.ts",fk={prebootstrap:"bash scripts/prebootstrap",bootstrap:"bash scripts/bootstrap --test || (echo 'Bootstrap failed.' && mv -v dist/ohm-grammar.js.old dist/ohm-grammar.js && mv -v dist/built-in-rules.js.old dist/built-in-rules.js && mv -v dist/operations-and-attributes.js.old dist/operations-and-attributes.js)",build:"yarn build-debug && webpack --mode=production","build-debug":"webpack --mode=development && yarn build-esm && node scripts/generate-types.mjs","build-esm":"rollup -c rollup.config.mjs",clean:"rm -f dist/ohm.js dist/ohm.min.js",lint:"eslint . --ignore-path ../.eslintignore",format:"prettier . --write --ignore-path ../.prettierignore --config ../.prettierrc && eslint . --ignore-path ../.eslintignore --fix",test:"ava && ava --config ava-ts.config.js test/test-typings.ts","test-watch":"ava --watch","pre-commit":"yarn run lint && yarn run build && yarn run test",prepublishOnly:"bash scripts/prepublishOnly",prepack:"cp ../../README.md . && yarn build",postpack:"rm README.md",postpublish:"echo '\u{1F449}  Now go to https://github.com/harc/ohm/releases and create a release.'","unsafe-bootstrap":"bash scripts/bootstrap","update-contributors":"bash scripts/update-contributors",watch:"webpack --mode=development --watch"},dk="MIT",pk="Alex Warth <alexwarth@gmail.com> (http://tinlizzie.org/~awarth)",gk=["Patrick Dubroy <pdubroy@gmail.com>","Meixian Li <lmeixian@gmail.com>","Marko R\xF6der <m.roeder@photon-software.de>","Tony Garnock-Jones <tonygarnockjones@gmail.com>","Saketh Kasibatla <sake.kasi@gmail.com>","Lionel Landwerlin <llandwerlin@gmail.com>","Jason Merrill <jwmerrill@gmail.com>","Ray Toal <rtoal@lmu.edu>","Yoshiki Ohshima <Yoshiki.Ohshima@acm.org>","megabuz <3299889+megabuz@users.noreply.github.com>","Jonathan Edwards <JonathanMEdwards@gmail.com>","Milan Lajto\u0161 <milan.lajtos@me.com>","Neil Jewers <njjewers@uwaterloo.ca>","stagas <gstagas@gmail.com>","AngryPowman <angrypowman@qq.com>","Arthur Carabott <arthurc@gmail.com>","Casey Olson <casey.m.olson@gmail.com>","Daniel Tomlinson <DanielTomlinson@me.com>","Ian Harris <ian@fofgof.xyz>","Justin Chase <justin.m.chase@gmail.com>","Leslie Ying <acetophore@users.noreply.github.com>","Luca Guzzon <luca.guzzon@gmail.com>","Mike Niebling <(none)>","Patrick Dubroy <patrick@sourcegraph.com>","Pierre Donias <pierre.donias@gmail.com>","Stan Rozenraukh <stan@stanistan.com>","Stephan Seidt <stephan.seidt@gmail.com>","Steve Phillips <steve@tryingtobeawesome.com>","Szymon Kaliski <kaliskiszymon@gmail.com>","Thomas Nyberg <tomnyberg@gmail.com>","Vse Mozhet Byt <vsemozhetbyt@gmail.com>","Wil Chung <10446+iamwilhelm@users.noreply.github.com>","Zachary Sakowitz <zsakowitz@gmail.com>","abego <ub@abego-software.de>","acslk <d_vd415@hotmail.com>","codeZeilen <codeZeilen@users.noreply.github.com>","kassadin <kassadin@foxmail.com>","owch <bowenrainyday@gmail.com>","sfinnie <scott.finnie@gmail.com>"],mk={},vk={"@ohm-js/cli":"^1.0.0","@rollup/plugin-commonjs":"^21.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.1.3",ava:"^3.15.0","ava-spec":"^1.1.1",dedent:"^0.7.0",eslint:"^7.9.0","eslint-config-google":"^0.14.0","eslint-plugin-ava":"^11.0.0","eslint-plugin-camelcase-ohm":"^0.2.1","eslint-plugin-no-extension-in-require":"^0.2.0",husky:"^4.2.5",jsdom:"^9.9.1",json:"^9.0.6",markscript:"^0.5.0","node-static":"^0.7.11","ohm-grammar-ecmascript":"^1.0.0",rollup:"^2.63.0","ts-loader":"^8.0.4","ts-node":"^9.0.0",typescript:"^4.0.3","walk-sync":"^2.2.0",webpack:"^4.44.2","webpack-cli":"^3.3.12"},yk={node:">=0.12.1"},Ck={name:ek,version:ik,description:nk,repository:rk,keywords:sk,homepage:ok,bugs:ak,main:uk,module:lk,files:ck,types:hk,scripts:fk,license:dk,author:pk,contributors:gk,dependencies:mk,devDependencies:vk,engines:yk},_k=typeof __GLOBAL_OHM_VERSION__=="string"?__GLOBAL_OHM_VERSION__:Ck.version,Ql={},__=X_;function wk(e){return typeof e=="function"?e.call(new __):(typeof e=="string"&&(e=JSON.parse(e)),new __().fromRecipe(e))}Ql.makeRecipe=wk;var{makeRecipe:Sk}=Ql,xk=Sk(["grammar",{source:`BuiltInRules {

  alnum  (an alpha-numeric character)
    = letter
    | digit

  letter  (a letter)
    = lower
    | upper
    | unicodeLtmo

  digit  (a digit)
    = "0".."9"

  hexDigit  (a hexadecimal digit)
    = digit
    | "a".."f"
    | "A".."F"

  ListOf<elem, sep>
    = NonemptyListOf<elem, sep>
    | EmptyListOf<elem, sep>

  NonemptyListOf<elem, sep>
    = elem (sep elem)*

  EmptyListOf<elem, sep>
    = /* nothing */

  listOf<elem, sep>
    = nonemptyListOf<elem, sep>
    | emptyListOf<elem, sep>

  nonemptyListOf<elem, sep>
    = elem (sep elem)*

  emptyListOf<elem, sep>
    = /* nothing */

  // Allows a syntactic rule application within a lexical context.
  applySyntactic<app> = app
}`},"BuiltInRules",null,null,{alnum:["define",{sourceInterval:[18,78]},"an alpha-numeric character",[],["alt",{sourceInterval:[60,78]},["app",{sourceInterval:[60,66]},"letter",[]],["app",{sourceInterval:[73,78]},"digit",[]]]],letter:["define",{sourceInterval:[82,142]},"a letter",[],["alt",{sourceInterval:[107,142]},["app",{sourceInterval:[107,112]},"lower",[]],["app",{sourceInterval:[119,124]},"upper",[]],["app",{sourceInterval:[131,142]},"unicodeLtmo",[]]]],digit:["define",{sourceInterval:[146,177]},"a digit",[],["range",{sourceInterval:[169,177]},"0","9"]],hexDigit:["define",{sourceInterval:[181,254]},"a hexadecimal digit",[],["alt",{sourceInterval:[219,254]},["app",{sourceInterval:[219,224]},"digit",[]],["range",{sourceInterval:[231,239]},"a","f"],["range",{sourceInterval:[246,254]},"A","F"]]],ListOf:["define",{sourceInterval:[258,336]},null,["elem","sep"],["alt",{sourceInterval:[282,336]},["app",{sourceInterval:[282,307]},"NonemptyListOf",[["param",{sourceInterval:[297,301]},0],["param",{sourceInterval:[303,306]},1]]],["app",{sourceInterval:[314,336]},"EmptyListOf",[["param",{sourceInterval:[326,330]},0],["param",{sourceInterval:[332,335]},1]]]]],NonemptyListOf:["define",{sourceInterval:[340,388]},null,["elem","sep"],["seq",{sourceInterval:[372,388]},["param",{sourceInterval:[372,376]},0],["star",{sourceInterval:[377,388]},["seq",{sourceInterval:[378,386]},["param",{sourceInterval:[378,381]},1],["param",{sourceInterval:[382,386]},0]]]]],EmptyListOf:["define",{sourceInterval:[392,434]},null,["elem","sep"],["seq",{sourceInterval:[438,438]}]],listOf:["define",{sourceInterval:[438,516]},null,["elem","sep"],["alt",{sourceInterval:[462,516]},["app",{sourceInterval:[462,487]},"nonemptyListOf",[["param",{sourceInterval:[477,481]},0],["param",{sourceInterval:[483,486]},1]]],["app",{sourceInterval:[494,516]},"emptyListOf",[["param",{sourceInterval:[506,510]},0],["param",{sourceInterval:[512,515]},1]]]]],nonemptyListOf:["define",{sourceInterval:[520,568]},null,["elem","sep"],["seq",{sourceInterval:[552,568]},["param",{sourceInterval:[552,556]},0],["star",{sourceInterval:[557,568]},["seq",{sourceInterval:[558,566]},["param",{sourceInterval:[558,561]},1],["param",{sourceInterval:[562,566]},0]]]]],emptyListOf:["define",{sourceInterval:[572,682]},null,["elem","sep"],["seq",{sourceInterval:[685,685]}]],applySyntactic:["define",{sourceInterval:[685,710]},null,["app"],["param",{sourceInterval:[707,710]},0]]}]),Dk=df;Dk.BuiltInRules=xk;var{makeRecipe:bk}=Ql,Ak=bk(["grammar",{source:`OperationsAndAttributes {

  AttributeSignature =
    name

  OperationSignature =
    name Formals?

  Formals
    = "(" ListOf<name, ","> ")"

  name  (a name)
    = nameFirst nameRest*

  nameFirst
    = "_"
    | letter

  nameRest
    = "_"
    | alnum

}`},"OperationsAndAttributes",null,"AttributeSignature",{AttributeSignature:["define",{sourceInterval:[29,58]},null,[],["app",{sourceInterval:[54,58]},"name",[]]],OperationSignature:["define",{sourceInterval:[62,100]},null,[],["seq",{sourceInterval:[87,100]},["app",{sourceInterval:[87,91]},"name",[]],["opt",{sourceInterval:[92,100]},["app",{sourceInterval:[92,99]},"Formals",[]]]]],Formals:["define",{sourceInterval:[104,143]},null,[],["seq",{sourceInterval:[118,143]},["terminal",{sourceInterval:[118,121]},"("],["app",{sourceInterval:[122,139]},"ListOf",[["app",{sourceInterval:[129,133]},"name",[]],["terminal",{sourceInterval:[135,138]},","]]],["terminal",{sourceInterval:[140,143]},")"]]],name:["define",{sourceInterval:[147,187]},"a name",[],["seq",{sourceInterval:[168,187]},["app",{sourceInterval:[168,177]},"nameFirst",[]],["star",{sourceInterval:[178,187]},["app",{sourceInterval:[178,186]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[191,223]},null,[],["alt",{sourceInterval:[207,223]},["terminal",{sourceInterval:[207,210]},"_"],["app",{sourceInterval:[217,223]},"letter",[]]]],nameRest:["define",{sourceInterval:[227,257]},null,[],["alt",{sourceInterval:[242,257]},["terminal",{sourceInterval:[242,245]},"_"],["app",{sourceInterval:[252,257]},"alnum",[]]]]}]),hf=U_,Ek=io;Ek.awaitBuiltInRules(e=>{let t=Ak;Tk(e),Fk(t)});function Tk(e){let t={empty(){return this.iteration()},nonEmpty(i,o,n){return this.iteration([i].concat(n.children))}};hf.BuiltInSemantics=hf.createSemantics(e,null).addOperation("asIteration",{emptyListOf:t.empty,nonemptyListOf:t.nonEmpty,EmptyListOf:t.empty,NonemptyListOf:t.nonEmpty})}function Fk(e){hf.prototypeGrammarSemantics=e.createSemantics().addOperation("parse",{AttributeSignature(t){return{name:t.parse(),formals:[]}},OperationSignature(t,i){return{name:t.parse(),formals:i.children.map(o=>o.parse())[0]||[]}},Formals(t,i,o){return i.asIteration().children.map(n=>n.parse())},name(t,i){return this.sourceString}}),hf.prototypeGrammar=e}var{makeRecipe:Ok}=Ql,kk=Ok(["grammar",{source:`Ohm {

  Grammars
    = Grammar*

  Grammar
    = ident SuperGrammar? "{" Rule* "}"

  SuperGrammar
    = "<:" ident

  Rule
    = ident Formals? ruleDescr? "="  RuleBody  -- define
    | ident Formals?            ":=" OverrideRuleBody  -- override
    | ident Formals?            "+=" RuleBody  -- extend

  RuleBody
    = "|"? NonemptyListOf<TopLevelTerm, "|">

  TopLevelTerm
    = Seq caseName  -- inline
    | Seq

  OverrideRuleBody
    = "|"? NonemptyListOf<OverrideTopLevelTerm, "|">

  OverrideTopLevelTerm
    = "..."  -- superSplice
    | TopLevelTerm

  Formals
    = "<" ListOf<ident, ","> ">"

  Params
    = "<" ListOf<Seq, ","> ">"

  Alt
    = NonemptyListOf<Seq, "|">

  Seq
    = Iter*

  Iter
    = Pred "*"  -- star
    | Pred "+"  -- plus
    | Pred "?"  -- opt
    | Pred

  Pred
    = "~" Lex  -- not
    | "&" Lex  -- lookahead
    | Lex

  Lex
    = "#" Base  -- lex
    | Base

  Base
    = ident Params? ~(ruleDescr? "=" | ":=" | "+=")  -- application
    | oneCharTerminal ".." oneCharTerminal           -- range
    | terminal                                       -- terminal
    | "(" Alt ")"                                    -- paren

  ruleDescr  (a rule description)
    = "(" ruleDescrText ")"

  ruleDescrText
    = (~")" any)*

  caseName
    = "--" (~"\\n" space)* name (~"\\n" space)* ("\\n" | &"}")

  name  (a name)
    = nameFirst nameRest*

  nameFirst
    = "_"
    | letter

  nameRest
    = "_"
    | alnum

  ident  (an identifier)
    = name

  terminal
    = "\\"" terminalChar* "\\""

  oneCharTerminal
    = "\\"" terminalChar "\\""

  terminalChar
    = escapeChar
      | ~"\\\\" ~"\\"" ~"\\n" "\\u{0}".."\\u{10FFFF}"

  escapeChar  (an escape sequence)
    = "\\\\\\\\"                                     -- backslash
    | "\\\\\\""                                     -- doubleQuote
    | "\\\\\\'"                                     -- singleQuote
    | "\\\\b"                                      -- backspace
    | "\\\\n"                                      -- lineFeed
    | "\\\\r"                                      -- carriageReturn
    | "\\\\t"                                      -- tab
    | "\\\\u{" hexDigit hexDigit? hexDigit?
             hexDigit? hexDigit? hexDigit? "}"   -- unicodeCodePoint
    | "\\\\u" hexDigit hexDigit hexDigit hexDigit  -- unicodeEscape
    | "\\\\x" hexDigit hexDigit                    -- hexEscape

  space
   += comment

  comment
    = "//" (~"\\n" any)* &("\\n" | end)  -- singleLine
    | "/*" (~"*/" any)* "*/"  -- multiLine

  tokens = token*

  token = caseName | comment | ident | operator | punctuation | terminal | any

  operator = "<:" | "=" | ":=" | "+=" | "*" | "+" | "?" | "~" | "&"

  punctuation = "<" | ">" | "," | "--"
}`},"Ohm",null,"Grammars",{Grammars:["define",{sourceInterval:[9,32]},null,[],["star",{sourceInterval:[24,32]},["app",{sourceInterval:[24,31]},"Grammar",[]]]],Grammar:["define",{sourceInterval:[36,83]},null,[],["seq",{sourceInterval:[50,83]},["app",{sourceInterval:[50,55]},"ident",[]],["opt",{sourceInterval:[56,69]},["app",{sourceInterval:[56,68]},"SuperGrammar",[]]],["terminal",{sourceInterval:[70,73]},"{"],["star",{sourceInterval:[74,79]},["app",{sourceInterval:[74,78]},"Rule",[]]],["terminal",{sourceInterval:[80,83]},"}"]]],SuperGrammar:["define",{sourceInterval:[87,116]},null,[],["seq",{sourceInterval:[106,116]},["terminal",{sourceInterval:[106,110]},"<:"],["app",{sourceInterval:[111,116]},"ident",[]]]],Rule_define:["define",{sourceInterval:[131,181]},null,[],["seq",{sourceInterval:[131,170]},["app",{sourceInterval:[131,136]},"ident",[]],["opt",{sourceInterval:[137,145]},["app",{sourceInterval:[137,144]},"Formals",[]]],["opt",{sourceInterval:[146,156]},["app",{sourceInterval:[146,155]},"ruleDescr",[]]],["terminal",{sourceInterval:[157,160]},"="],["app",{sourceInterval:[162,170]},"RuleBody",[]]]],Rule_override:["define",{sourceInterval:[188,248]},null,[],["seq",{sourceInterval:[188,235]},["app",{sourceInterval:[188,193]},"ident",[]],["opt",{sourceInterval:[194,202]},["app",{sourceInterval:[194,201]},"Formals",[]]],["terminal",{sourceInterval:[214,218]},":="],["app",{sourceInterval:[219,235]},"OverrideRuleBody",[]]]],Rule_extend:["define",{sourceInterval:[255,305]},null,[],["seq",{sourceInterval:[255,294]},["app",{sourceInterval:[255,260]},"ident",[]],["opt",{sourceInterval:[261,269]},["app",{sourceInterval:[261,268]},"Formals",[]]],["terminal",{sourceInterval:[281,285]},"+="],["app",{sourceInterval:[286,294]},"RuleBody",[]]]],Rule:["define",{sourceInterval:[120,305]},null,[],["alt",{sourceInterval:[131,305]},["app",{sourceInterval:[131,170]},"Rule_define",[]],["app",{sourceInterval:[188,235]},"Rule_override",[]],["app",{sourceInterval:[255,294]},"Rule_extend",[]]]],RuleBody:["define",{sourceInterval:[309,362]},null,[],["seq",{sourceInterval:[324,362]},["opt",{sourceInterval:[324,328]},["terminal",{sourceInterval:[324,327]},"|"]],["app",{sourceInterval:[329,362]},"NonemptyListOf",[["app",{sourceInterval:[344,356]},"TopLevelTerm",[]],["terminal",{sourceInterval:[358,361]},"|"]]]]],TopLevelTerm_inline:["define",{sourceInterval:[385,408]},null,[],["seq",{sourceInterval:[385,397]},["app",{sourceInterval:[385,388]},"Seq",[]],["app",{sourceInterval:[389,397]},"caseName",[]]]],TopLevelTerm:["define",{sourceInterval:[366,418]},null,[],["alt",{sourceInterval:[385,418]},["app",{sourceInterval:[385,397]},"TopLevelTerm_inline",[]],["app",{sourceInterval:[415,418]},"Seq",[]]]],OverrideRuleBody:["define",{sourceInterval:[422,491]},null,[],["seq",{sourceInterval:[445,491]},["opt",{sourceInterval:[445,449]},["terminal",{sourceInterval:[445,448]},"|"]],["app",{sourceInterval:[450,491]},"NonemptyListOf",[["app",{sourceInterval:[465,485]},"OverrideTopLevelTerm",[]],["terminal",{sourceInterval:[487,490]},"|"]]]]],OverrideTopLevelTerm_superSplice:["define",{sourceInterval:[522,543]},null,[],["terminal",{sourceInterval:[522,527]},"..."]],OverrideTopLevelTerm:["define",{sourceInterval:[495,562]},null,[],["alt",{sourceInterval:[522,562]},["app",{sourceInterval:[522,527]},"OverrideTopLevelTerm_superSplice",[]],["app",{sourceInterval:[550,562]},"TopLevelTerm",[]]]],Formals:["define",{sourceInterval:[566,606]},null,[],["seq",{sourceInterval:[580,606]},["terminal",{sourceInterval:[580,583]},"<"],["app",{sourceInterval:[584,602]},"ListOf",[["app",{sourceInterval:[591,596]},"ident",[]],["terminal",{sourceInterval:[598,601]},","]]],["terminal",{sourceInterval:[603,606]},">"]]],Params:["define",{sourceInterval:[610,647]},null,[],["seq",{sourceInterval:[623,647]},["terminal",{sourceInterval:[623,626]},"<"],["app",{sourceInterval:[627,643]},"ListOf",[["app",{sourceInterval:[634,637]},"Seq",[]],["terminal",{sourceInterval:[639,642]},","]]],["terminal",{sourceInterval:[644,647]},">"]]],Alt:["define",{sourceInterval:[651,685]},null,[],["app",{sourceInterval:[661,685]},"NonemptyListOf",[["app",{sourceInterval:[676,679]},"Seq",[]],["terminal",{sourceInterval:[681,684]},"|"]]]],Seq:["define",{sourceInterval:[689,704]},null,[],["star",{sourceInterval:[699,704]},["app",{sourceInterval:[699,703]},"Iter",[]]]],Iter_star:["define",{sourceInterval:[719,736]},null,[],["seq",{sourceInterval:[719,727]},["app",{sourceInterval:[719,723]},"Pred",[]],["terminal",{sourceInterval:[724,727]},"*"]]],Iter_plus:["define",{sourceInterval:[743,760]},null,[],["seq",{sourceInterval:[743,751]},["app",{sourceInterval:[743,747]},"Pred",[]],["terminal",{sourceInterval:[748,751]},"+"]]],Iter_opt:["define",{sourceInterval:[767,783]},null,[],["seq",{sourceInterval:[767,775]},["app",{sourceInterval:[767,771]},"Pred",[]],["terminal",{sourceInterval:[772,775]},"?"]]],Iter:["define",{sourceInterval:[708,794]},null,[],["alt",{sourceInterval:[719,794]},["app",{sourceInterval:[719,727]},"Iter_star",[]],["app",{sourceInterval:[743,751]},"Iter_plus",[]],["app",{sourceInterval:[767,775]},"Iter_opt",[]],["app",{sourceInterval:[790,794]},"Pred",[]]]],Pred_not:["define",{sourceInterval:[809,824]},null,[],["seq",{sourceInterval:[809,816]},["terminal",{sourceInterval:[809,812]},"~"],["app",{sourceInterval:[813,816]},"Lex",[]]]],Pred_lookahead:["define",{sourceInterval:[831,852]},null,[],["seq",{sourceInterval:[831,838]},["terminal",{sourceInterval:[831,834]},"&"],["app",{sourceInterval:[835,838]},"Lex",[]]]],Pred:["define",{sourceInterval:[798,862]},null,[],["alt",{sourceInterval:[809,862]},["app",{sourceInterval:[809,816]},"Pred_not",[]],["app",{sourceInterval:[831,838]},"Pred_lookahead",[]],["app",{sourceInterval:[859,862]},"Lex",[]]]],Lex_lex:["define",{sourceInterval:[876,892]},null,[],["seq",{sourceInterval:[876,884]},["terminal",{sourceInterval:[876,879]},"#"],["app",{sourceInterval:[880,884]},"Base",[]]]],Lex:["define",{sourceInterval:[866,903]},null,[],["alt",{sourceInterval:[876,903]},["app",{sourceInterval:[876,884]},"Lex_lex",[]],["app",{sourceInterval:[899,903]},"Base",[]]]],Base_application:["define",{sourceInterval:[918,979]},null,[],["seq",{sourceInterval:[918,963]},["app",{sourceInterval:[918,923]},"ident",[]],["opt",{sourceInterval:[924,931]},["app",{sourceInterval:[924,930]},"Params",[]]],["not",{sourceInterval:[932,963]},["alt",{sourceInterval:[934,962]},["seq",{sourceInterval:[934,948]},["opt",{sourceInterval:[934,944]},["app",{sourceInterval:[934,943]},"ruleDescr",[]]],["terminal",{sourceInterval:[945,948]},"="]],["terminal",{sourceInterval:[951,955]},":="],["terminal",{sourceInterval:[958,962]},"+="]]]]],Base_range:["define",{sourceInterval:[986,1041]},null,[],["seq",{sourceInterval:[986,1022]},["app",{sourceInterval:[986,1001]},"oneCharTerminal",[]],["terminal",{sourceInterval:[1002,1006]},".."],["app",{sourceInterval:[1007,1022]},"oneCharTerminal",[]]]],Base_terminal:["define",{sourceInterval:[1048,1106]},null,[],["app",{sourceInterval:[1048,1056]},"terminal",[]]],Base_paren:["define",{sourceInterval:[1113,1168]},null,[],["seq",{sourceInterval:[1113,1124]},["terminal",{sourceInterval:[1113,1116]},"("],["app",{sourceInterval:[1117,1120]},"Alt",[]],["terminal",{sourceInterval:[1121,1124]},")"]]],Base:["define",{sourceInterval:[907,1168]},null,[],["alt",{sourceInterval:[918,1168]},["app",{sourceInterval:[918,963]},"Base_application",[]],["app",{sourceInterval:[986,1022]},"Base_range",[]],["app",{sourceInterval:[1048,1056]},"Base_terminal",[]],["app",{sourceInterval:[1113,1124]},"Base_paren",[]]]],ruleDescr:["define",{sourceInterval:[1172,1231]},"a rule description",[],["seq",{sourceInterval:[1210,1231]},["terminal",{sourceInterval:[1210,1213]},"("],["app",{sourceInterval:[1214,1227]},"ruleDescrText",[]],["terminal",{sourceInterval:[1228,1231]},")"]]],ruleDescrText:["define",{sourceInterval:[1235,1266]},null,[],["star",{sourceInterval:[1255,1266]},["seq",{sourceInterval:[1256,1264]},["not",{sourceInterval:[1256,1260]},["terminal",{sourceInterval:[1257,1260]},")"]],["app",{sourceInterval:[1261,1264]},"any",[]]]]],caseName:["define",{sourceInterval:[1270,1338]},null,[],["seq",{sourceInterval:[1285,1338]},["terminal",{sourceInterval:[1285,1289]},"--"],["star",{sourceInterval:[1290,1304]},["seq",{sourceInterval:[1291,1302]},["not",{sourceInterval:[1291,1296]},["terminal",{sourceInterval:[1292,1296]},`
`]],["app",{sourceInterval:[1297,1302]},"space",[]]]],["app",{sourceInterval:[1305,1309]},"name",[]],["star",{sourceInterval:[1310,1324]},["seq",{sourceInterval:[1311,1322]},["not",{sourceInterval:[1311,1316]},["terminal",{sourceInterval:[1312,1316]},`
`]],["app",{sourceInterval:[1317,1322]},"space",[]]]],["alt",{sourceInterval:[1326,1337]},["terminal",{sourceInterval:[1326,1330]},`
`],["lookahead",{sourceInterval:[1333,1337]},["terminal",{sourceInterval:[1334,1337]},"}"]]]]],name:["define",{sourceInterval:[1342,1382]},"a name",[],["seq",{sourceInterval:[1363,1382]},["app",{sourceInterval:[1363,1372]},"nameFirst",[]],["star",{sourceInterval:[1373,1382]},["app",{sourceInterval:[1373,1381]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[1386,1418]},null,[],["alt",{sourceInterval:[1402,1418]},["terminal",{sourceInterval:[1402,1405]},"_"],["app",{sourceInterval:[1412,1418]},"letter",[]]]],nameRest:["define",{sourceInterval:[1422,1452]},null,[],["alt",{sourceInterval:[1437,1452]},["terminal",{sourceInterval:[1437,1440]},"_"],["app",{sourceInterval:[1447,1452]},"alnum",[]]]],ident:["define",{sourceInterval:[1456,1489]},"an identifier",[],["app",{sourceInterval:[1485,1489]},"name",[]]],terminal:["define",{sourceInterval:[1493,1531]},null,[],["seq",{sourceInterval:[1508,1531]},["terminal",{sourceInterval:[1508,1512]},'"'],["star",{sourceInterval:[1513,1526]},["app",{sourceInterval:[1513,1525]},"terminalChar",[]]],["terminal",{sourceInterval:[1527,1531]},'"']]],oneCharTerminal:["define",{sourceInterval:[1535,1579]},null,[],["seq",{sourceInterval:[1557,1579]},["terminal",{sourceInterval:[1557,1561]},'"'],["app",{sourceInterval:[1562,1574]},"terminalChar",[]],["terminal",{sourceInterval:[1575,1579]},'"']]],terminalChar:["define",{sourceInterval:[1583,1660]},null,[],["alt",{sourceInterval:[1602,1660]},["app",{sourceInterval:[1602,1612]},"escapeChar",[]],["seq",{sourceInterval:[1621,1660]},["not",{sourceInterval:[1621,1626]},["terminal",{sourceInterval:[1622,1626]},"\\"]],["not",{sourceInterval:[1627,1632]},["terminal",{sourceInterval:[1628,1632]},'"']],["not",{sourceInterval:[1633,1638]},["terminal",{sourceInterval:[1634,1638]},`
`]],["range",{sourceInterval:[1639,1660]},"\0","\u{10FFFF}"]]]],escapeChar_backslash:["define",{sourceInterval:[1703,1758]},null,[],["terminal",{sourceInterval:[1703,1709]},"\\\\"]],escapeChar_doubleQuote:["define",{sourceInterval:[1765,1822]},null,[],["terminal",{sourceInterval:[1765,1771]},'\\"']],escapeChar_singleQuote:["define",{sourceInterval:[1829,1886]},null,[],["terminal",{sourceInterval:[1829,1835]},"\\'"]],escapeChar_backspace:["define",{sourceInterval:[1893,1948]},null,[],["terminal",{sourceInterval:[1893,1898]},"\\b"]],escapeChar_lineFeed:["define",{sourceInterval:[1955,2009]},null,[],["terminal",{sourceInterval:[1955,1960]},"\\n"]],escapeChar_carriageReturn:["define",{sourceInterval:[2016,2076]},null,[],["terminal",{sourceInterval:[2016,2021]},"\\r"]],escapeChar_tab:["define",{sourceInterval:[2083,2132]},null,[],["terminal",{sourceInterval:[2083,2088]},"\\t"]],escapeChar_unicodeCodePoint:["define",{sourceInterval:[2139,2243]},null,[],["seq",{sourceInterval:[2139,2221]},["terminal",{sourceInterval:[2139,2145]},"\\u{"],["app",{sourceInterval:[2146,2154]},"hexDigit",[]],["opt",{sourceInterval:[2155,2164]},["app",{sourceInterval:[2155,2163]},"hexDigit",[]]],["opt",{sourceInterval:[2165,2174]},["app",{sourceInterval:[2165,2173]},"hexDigit",[]]],["opt",{sourceInterval:[2188,2197]},["app",{sourceInterval:[2188,2196]},"hexDigit",[]]],["opt",{sourceInterval:[2198,2207]},["app",{sourceInterval:[2198,2206]},"hexDigit",[]]],["opt",{sourceInterval:[2208,2217]},["app",{sourceInterval:[2208,2216]},"hexDigit",[]]],["terminal",{sourceInterval:[2218,2221]},"}"]]],escapeChar_unicodeEscape:["define",{sourceInterval:[2250,2309]},null,[],["seq",{sourceInterval:[2250,2291]},["terminal",{sourceInterval:[2250,2255]},"\\u"],["app",{sourceInterval:[2256,2264]},"hexDigit",[]],["app",{sourceInterval:[2265,2273]},"hexDigit",[]],["app",{sourceInterval:[2274,2282]},"hexDigit",[]],["app",{sourceInterval:[2283,2291]},"hexDigit",[]]]],escapeChar_hexEscape:["define",{sourceInterval:[2316,2371]},null,[],["seq",{sourceInterval:[2316,2339]},["terminal",{sourceInterval:[2316,2321]},"\\x"],["app",{sourceInterval:[2322,2330]},"hexDigit",[]],["app",{sourceInterval:[2331,2339]},"hexDigit",[]]]],escapeChar:["define",{sourceInterval:[1664,2371]},"an escape sequence",[],["alt",{sourceInterval:[1703,2371]},["app",{sourceInterval:[1703,1709]},"escapeChar_backslash",[]],["app",{sourceInterval:[1765,1771]},"escapeChar_doubleQuote",[]],["app",{sourceInterval:[1829,1835]},"escapeChar_singleQuote",[]],["app",{sourceInterval:[1893,1898]},"escapeChar_backspace",[]],["app",{sourceInterval:[1955,1960]},"escapeChar_lineFeed",[]],["app",{sourceInterval:[2016,2021]},"escapeChar_carriageReturn",[]],["app",{sourceInterval:[2083,2088]},"escapeChar_tab",[]],["app",{sourceInterval:[2139,2221]},"escapeChar_unicodeCodePoint",[]],["app",{sourceInterval:[2250,2291]},"escapeChar_unicodeEscape",[]],["app",{sourceInterval:[2316,2339]},"escapeChar_hexEscape",[]]]],space:["extend",{sourceInterval:[2375,2394]},null,[],["app",{sourceInterval:[2387,2394]},"comment",[]]],comment_singleLine:["define",{sourceInterval:[2412,2458]},null,[],["seq",{sourceInterval:[2412,2443]},["terminal",{sourceInterval:[2412,2416]},"//"],["star",{sourceInterval:[2417,2429]},["seq",{sourceInterval:[2418,2427]},["not",{sourceInterval:[2418,2423]},["terminal",{sourceInterval:[2419,2423]},`
`]],["app",{sourceInterval:[2424,2427]},"any",[]]]],["lookahead",{sourceInterval:[2430,2443]},["alt",{sourceInterval:[2432,2442]},["terminal",{sourceInterval:[2432,2436]},`
`],["app",{sourceInterval:[2439,2442]},"end",[]]]]]],comment_multiLine:["define",{sourceInterval:[2465,2501]},null,[],["seq",{sourceInterval:[2465,2487]},["terminal",{sourceInterval:[2465,2469]},"/*"],["star",{sourceInterval:[2470,2482]},["seq",{sourceInterval:[2471,2480]},["not",{sourceInterval:[2471,2476]},["terminal",{sourceInterval:[2472,2476]},"*/"]],["app",{sourceInterval:[2477,2480]},"any",[]]]],["terminal",{sourceInterval:[2483,2487]},"*/"]]],comment:["define",{sourceInterval:[2398,2501]},null,[],["alt",{sourceInterval:[2412,2501]},["app",{sourceInterval:[2412,2443]},"comment_singleLine",[]],["app",{sourceInterval:[2465,2487]},"comment_multiLine",[]]]],tokens:["define",{sourceInterval:[2505,2520]},null,[],["star",{sourceInterval:[2514,2520]},["app",{sourceInterval:[2514,2519]},"token",[]]]],token:["define",{sourceInterval:[2524,2600]},null,[],["alt",{sourceInterval:[2532,2600]},["app",{sourceInterval:[2532,2540]},"caseName",[]],["app",{sourceInterval:[2543,2550]},"comment",[]],["app",{sourceInterval:[2553,2558]},"ident",[]],["app",{sourceInterval:[2561,2569]},"operator",[]],["app",{sourceInterval:[2572,2583]},"punctuation",[]],["app",{sourceInterval:[2586,2594]},"terminal",[]],["app",{sourceInterval:[2597,2600]},"any",[]]]],operator:["define",{sourceInterval:[2604,2669]},null,[],["alt",{sourceInterval:[2615,2669]},["terminal",{sourceInterval:[2615,2619]},"<:"],["terminal",{sourceInterval:[2622,2625]},"="],["terminal",{sourceInterval:[2628,2632]},":="],["terminal",{sourceInterval:[2635,2639]},"+="],["terminal",{sourceInterval:[2642,2645]},"*"],["terminal",{sourceInterval:[2648,2651]},"+"],["terminal",{sourceInterval:[2654,2657]},"?"],["terminal",{sourceInterval:[2660,2663]},"~"],["terminal",{sourceInterval:[2666,2669]},"&"]]],punctuation:["define",{sourceInterval:[2673,2709]},null,[],["alt",{sourceInterval:[2687,2709]},["terminal",{sourceInterval:[2687,2690]},"<"],["terminal",{sourceInterval:[2693,2696]},">"],["terminal",{sourceInterval:[2699,2702]},","],["terminal",{sourceInterval:[2705,2709]},"--"]]]}]),Pk=X_,Lm=df,Am=E_,Y_=Te,ql=ls,Mm=Yo,Rm=io,Ik=_k,{makeRecipe:Bk}=Ql,pf,sm=Object.create(Mm.PExpr.prototype),Lk=e=>!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e);function jm(e,t,i){let o=new Pk,n,s,r,a=!1;return(i||pf).createSemantics().addOperation("visit",{Grammars(c){return c.children.map(h=>h.visit())},Grammar(c,h,d,g,m){let y=c.visit();n=o.newGrammar(y,t),h.child(0)&&h.child(0).visit(),g.children.map(w=>w.visit());let C=n.build();if(C.source=this.source.trimmed(),y in t)throw ql.duplicateGrammarDeclaration(C,t);return t[y]=C,C},SuperGrammar(c,h){let d=h.visit();if(d==="null")n.withSuperGrammar(null);else{if(!t||!(d in t))throw ql.undeclaredGrammar(d,t,h.source);n.withSuperGrammar(t[d])}},Rule_define(c,h,d,g,m){s=c.visit(),r=h.children.map(F=>F.visit())[0]||[],!n.defaultStartRule&&n.ensureSuperGrammar()!==Lm.ProtoBuiltInRules&&n.withDefaultStartRule(s);let y=m.visit(),C=d.children.map(F=>F.visit())[0],w=this.source.trimmed();return n.define(s,r,y,C,w)},Rule_override(c,h,d,g){s=c.visit(),r=h.children.map(C=>C.visit())[0]||[];let m=this.source.trimmed();n.ensureSuperGrammarRuleForOverriding(s,m),a=!0;let y=g.visit();return a=!1,n.override(s,r,y,null,m)},Rule_extend(c,h,d,g){s=c.visit(),r=h.children.map(C=>C.visit())[0]||[];let m=g.visit(),y=this.source.trimmed();return n.extend(s,r,m,null,y)},RuleBody(c,h){return o.alt(...h.visit()).withSource(this.source)},OverrideRuleBody(c,h){let d=h.visit(),g=d.indexOf(sm);if(g>=0){let m=d.slice(0,g),y=d.slice(g+1);return y.forEach(C=>{if(C===sm)throw ql.multipleSuperSplices(C)}),new Mm.Splice(n.superGrammar,s,m,y).withSource(this.source)}else return o.alt(...d).withSource(this.source)},Formals(c,h,d){return h.visit()},Params(c,h,d){return h.visit()},Alt(c){return o.alt(...c.visit()).withSource(this.source)},TopLevelTerm_inline(c,h){let d=s+"_"+h.visit(),g=c.visit(),m=this.source.trimmed(),y=!(n.superGrammar&&n.superGrammar.rules[d]);a&&!y?n.override(d,r,g,null,m):n.define(d,r,g,null,m);let C=r.map(w=>o.app(w));return o.app(d,C).withSource(g.source)},OverrideTopLevelTerm_superSplice(c){return sm},Seq(c){return o.seq(...c.children.map(h=>h.visit())).withSource(this.source)},Iter_star(c,h){return o.star(c.visit()).withSource(this.source)},Iter_plus(c,h){return o.plus(c.visit()).withSource(this.source)},Iter_opt(c,h){return o.opt(c.visit()).withSource(this.source)},Pred_not(c,h){return o.not(h.visit()).withSource(this.source)},Pred_lookahead(c,h){return o.lookahead(h.visit()).withSource(this.source)},Lex_lex(c,h){return o.lex(h.visit()).withSource(this.source)},Base_application(c,h){let d=h.children.map(g=>g.visit())[0]||[];return o.app(c.visit(),d).withSource(this.source)},Base_range(c,h,d){return o.range(c.visit(),d.visit()).withSource(this.source)},Base_terminal(c){return o.terminal(c.visit()).withSource(this.source)},Base_paren(c,h,d){return h.visit()},ruleDescr(c,h,d){return h.visit()},ruleDescrText(c){return this.sourceString.trim()},caseName(c,h,d,g,m){return d.visit()},name(c,h){return this.sourceString},nameFirst(c){},nameRest(c){},terminal(c,h,d){return h.children.map(g=>g.visit()).join("")},oneCharTerminal(c,h,d){return h.visit()},escapeChar(c){try{return Y_.unescapeCodePoint(this.sourceString)}catch(h){throw h instanceof RangeError&&h.message.startsWith("Invalid code point ")?ql.invalidCodePoint(c):h}},NonemptyListOf(c,h,d){return[c.visit()].concat(d.children.map(g=>g.visit()))},EmptyListOf(){return[]},_terminal(){return this.sourceString}})(e).visit()}function Mk(e,t){let i=pf.match(e,"Grammars");if(i.failed())throw ql.grammarSyntaxError(i);return jm(i,t)}function Rk(e,t){let i=V_(e,t),o=Object.keys(i);if(o.length===0)throw new Error("Missing grammar definition");if(o.length>1){let s=i[o[1]].source;throw new Error(Rm.getLineAndColumnMessage(s.sourceString,s.startIdx)+"Found more than one grammar definition -- use ohm.grammars() instead.")}return i[o[0]]}function V_(e,t){let i=Am.extend(Am.asNamespace(t));if(typeof e!="string")if(Lk(e))e=e.toString();else throw new TypeError("Expected string as first argument, got "+Y_.unexpectedObjToString(e));return Mk(e,i),i}function jk(e){throw new Error("grammarFromScriptElement was removed in Ohm v16.0. See https://ohmjs.org/d/gfs for more info.")}function Nk(e){throw new Error("grammarsFromScriptElements was removed in Ohm v16.0. See https://ohmjs.org/d/gfs for more info.")}ff.exports={createNamespace:Am.createNamespace,grammar:Rk,grammars:V_,grammarFromScriptElement:jk,grammarsFromScriptElements:Nk,makeRecipe:Bk,ohmGrammar:null,pexprs:Mm,util:Rm,version:Ik};ff.exports._buildGrammar=jm;Rm.announceBuiltInRules(Lm.BuiltInRules);ff.exports.ohmGrammar=pf=kk;Lm.initApplicationParser(pf,jm);var q_=ff.exports,{assert:Ho}=Te;function Uk(e,t,i){return i(t[e])}function zk(e,t,i){return t[e].map(i)}function w_(e){let t=e.split(/ ?\[\]/);return t.length===2?zk.bind(null,t[0]):Uk.bind(null,e)}function S_(e,t,i){return e.map(o=>o(t,i))}function Wk(e){return typeof e=="string"?S_.bind(null,[w_(e)]):Array.isArray(e)?S_.bind(null,e.map(w_)):(Ho(typeof e=="function","Expected a string, Array, or function"),Ho(e.length===2,"Expected a function of arity 2, got "+e.length),e)}function x_(e){return/^[a-zA-Z_][0-9a-zA-Z_]*$/.test(e)}function D_(e){return e.trim()}function Gk(e){let t=e.split(/[()]/).map(D_);if(t.length===3&&t[2]===""){let i=t[0],o=[];if(t[1].length>0&&(o=t[1].split(",").map(D_)),x_(i)&&o.every(x_))return{name:i,formals:o}}throw new Error("Invalid operation signature: "+e)}function gf(e){this._shapes=e.shapes,this._getTag=e.getTag,this.Adapter=function(t,i){this._adaptee=t,this._family=i},this.Adapter.prototype.valueOf=function(){throw new Error("heeey!")},this.operations={},this._arities=Object.create(null),this._getChildren=Object.create(null),Object.keys(this._shapes).forEach(t=>{let i=this._shapes[t];this._getChildren[t]=Wk(i),typeof i!="function"&&(this._arities[t]=Array.isArray(i)?i.length:1)}),this._wrap=t=>new this.Adapter(t,this)}gf.prototype.wrap=function(e){return this._wrap(e)};gf.prototype._checkActionDict=function(e){Object.keys(e).forEach(t=>{Ho(t in this._getChildren,"Unrecognized action name '"+t+"'");let i=e[t];if(Ho(typeof i=="function","Key '"+t+"': expected function, got "+i),t in this._arities){let o=this._arities[t],n=e[t].length;Ho(n===o,"Action '"+t+"' has the wrong arity: expected "+o+", got "+n)}})};gf.prototype.addOperation=function(e,t){let i=Gk(e),{name:o}=i;this._checkActionDict(t),this.operations[o]={name:o,formals:i.formals,actions:t};let n=this;return this.Adapter.prototype[o]=function(...s){let r=n._getTag(this._adaptee);Ho(r in n._getChildren,"getTag returned unrecognized tag '"+r+"'"),Ho(r in t,"No action for '"+r+"' in operation '"+o+"'");let a=Object.create(null);for(let[c,h]of Object.entries(s))a[i.formals[c]]=h;let l=this.args;this.args=a;let u=t[r].apply(this,n._getChildren[r](this._adaptee,n._wrap));return this.args=l,u},this};var Hk=gf,$_={_terminal(){return this.sourceString},_nonterminal(...e){let{ctorName:t}=this._node,{mapping:i}=this.args;if(!Object.prototype.hasOwnProperty.call(i,t)){if(this.isLexical())return this.sourceString;let s=e.filter(r=>!r.isTerminal());if(s.length===1)return s[0].toAST(i)}if(typeof i[t]=="number")return e[i[t]].toAST(i);let o=i[t]||e,n={type:t};for(let s in o){let r=i[t]&&i[t][s];typeof r=="number"?n[s]=e[r].toAST(i):typeof r=="string"||typeof r=="boolean"||r===null?n[s]=r:typeof r=="object"&&r instanceof Number?n[s]=Number(r):typeof r=="function"?n[s]=r.call(this,e):r===void 0&&(e[s]&&!e[s].isTerminal()?n[s]=e[s].toAST(i):delete n[s])}return n},_iter(...e){return this._node.isOptional()?this.numChildren===0?null:e[0].toAST(this.args.mapping):e.map(function(t){return t.toAST(this.args.mapping)},this)},NonemptyListOf(e,t,i){return[e.toAST(this.args.mapping)].concat(i.toAST(this.args.mapping))},EmptyListOf(){return[]}};function Xk(e,t){if(typeof e.failed!="function"||e.failed())throw new Error("toAST() expects a succesful MatchResult as first parameter");t=Object.assign({},t);let i=Object.assign({},$_);for(let s in t)typeof t[s]=="function"&&(i[s]=t[s],delete t[s]);return e._cst.grammar.createSemantics().addOperation("toAST(mapping)",i)(e).toAST(t)}function Yk(e){if(typeof e.createSemantics!="function")throw new Error("semanticsToAST() expects a Grammar as parameter");return e.createSemantics().addOperation("toAST(mapping)",$_)}var b_={helper:Xk,semantics:Yk},g3={VisitorFamily:Hk,semanticsForToAST:b_.semantics,toAST:b_.helper};var C3=q_.grammar(String.raw`
    StrRegArray {
        Exp = listOf<StrOrRegex, separator> separator*
        separator = (whitespace)* "," (whitespace)*
        StrOrRegex = (Regex | Str | "")
        Str = "\'" seqStr "\'"
        Regex =  "/" seqReg "/" (letter|lineTerminator)*
        seqReg = (("\\/" |"\\\\"|~("/")  any))+
        seqStr = (("\\\\"|"\\'"| ~("\'")  any))*
            
        // External rules
        whitespace = "\t"
                   | "\x0B"    -- verticalTab
                   | "\x0C"    -- formFeed
                   | " "
                   | "\u00A0"  -- noBreakSpace
                   | "\uFEFF"  -- byteOrderMark
                   | unicodeSpaceSeparator
         unicodeSpaceSeparator = "\u2000".."\u200B" | "\u3000"
         lineTerminator = "\n" | "\r" | "\u2028" | "\u2029"
      }`);var Vk=Mi(Ea());var qk=Mi(Ea());var K_=Mi(Ea());var nS=Mi(Gw());var nI=Mi(Hw()),Zw=Mi(Xw());function TP(e){for(var t=e.length,i=5381,o=52711,n;t--;)n=e.charCodeAt(t),i=i*33^n,o=o*33^n;return(i>>>0)*4096+(o>>>0)}var ec="|",FP=/\[object ([HTML|SVG](.*)Element)\]/,OP={"[object Arguments]":0,"[object Array]":1,"[object ArrayBuffer]":2,"[object AsyncFunction]":3,"[object AsyncGeneratorFunction]":4,"[object BigInt]":5,"[object BigInt64Array]":6,"[object BigUint64Array]":7,"[object Boolean]":8,"[object DataView]":9,"[object Date]":10,"[object DocumentFragment]":11,"[object Error]":12,"[object Event]":13,"[object Float32Array]":14,"[object Float64Array]":15,"[object Function]":16,"[object Generator]":17,"[object GeneratorFunction]":18,"[object Int8Array]":19,"[object Int16Array]":20,"[object Map]":21,"[object Number]":22,"[object Object]":23,"[object Promise]":24,"[object RegExp]":25,"[object Set]":26,"[object SharedArrayBuffer]":27,"[object String]":28,"[object Uint8Array]":29,"[object Uint8ClampedArray]":30,"[object Uint16Array]":31,"[object Uint32Array]":32,"[object WeakMap]":33,"[object WeakRef]":34,"[object WeakSet]":35,CUSTOM:36,ELEMENT:37},kP={"[object Arguments]":1,"[object Array]":2},Kw={"[object Generator]":1,"[object Promise]":2,"[object WeakMap]":3,"[object WeakRef]":4,"[object WeakSet]":5},PP={"[object AsyncFunction]":1,"[object AsyncGeneratorFunction]":2,"[object Boolean]":3,"[object Function]":4,"[object GeneratorFunction]":5,"[object Number]":6,"[object String]":7},IP={"[object BigInt64Array]":1,"[object BigUint64Array]":2,"[object Float32Array]":3,"[object Float64Array]":4,"[object Int8Array]":5,"[object Int16Array]":6,"[object Uint8Array]":7,"[object Uint8ClampedArray]":8,"[object Uint16Array]":9,"[object Uint32Array]":10},BP={"[object Arguments]":1,"[object Array]":2,"[object ArrayBuffer]":3,"[object BigInt64Array]":4,"[object BigUint64Array]":5,"[object DataView]":6,"[object Float32Array]":7,"[object Float64Array]":8,"[object Int8Array]":9,"[object Int16Array]":10,"[object Map]":11,"[object Object]":12,"[object Set]":13,"[object SharedArrayBuffer]":14,"[object Uint8Array]":15,"[object Uint8ClampedArray]":16,"[object Uint16Array]":17,"[object Uint32Array]":18,CUSTOM:19},tc={bigint:"i",boolean:"b",empty:"e",function:"g",number:"n",object:"o",string:"s",symbol:"s"};function LP(e,t){return e[0]>t[0]}function Jw(e,t){return e>t}function Km(e,t){for(var i,o,n=0;n<e.length;++n){for(o=e[n],i=n-1;~i&&t(e[i],o);--i)e[i+1]=e[i];e[i+1]=o}return e}function mi(e,t){return tc.object+ec+OP[e]+ec+t}var Yw=new WeakMap,MP=0;function $m(e,t){var i=Yw.get(e);if(i)return i;var o=mi(t,"NOT_ENUMERABLE"+ec+MP++);return Yw.set(e,o),o}var RP=Object.prototype.toString;function jP(e,t,i){if(BP[t])return Vw(t,e,i);if(t==="[object Date]")return mi(t,e.getTime());if(t==="[object RegExp]")return mi(t,e.toString());if(t==="[object Event]")return mi(t,[e.bubbles,e.cancelBubble,e.cancelable,e.composed,e.currentTarget,e.defaultPrevented,e.eventPhase,e.isTrusted,e.returnValue,e.target,e.type].join());if(t==="[object Error]")return mi(t,e.message+ec+e.stack);if(t==="[object DocumentFragment]")return mi(t,GP(e));var o=t.match(FP);return o?mi("ELEMENT",o[1]+ec+e.outerHTML):Kw[t]?$m(e,t):PP[t]?mi(t,e.toString()):Vw("CUSTOM",e,i)}function Vw(e,t,i){var o=i.cache.get(t);return o?mi(e,"RECURSIVE~"+o):(i.cache.set(t,++i.id),e==="[object Object]"?t[Symbol.iterator]?$m(t,e):mi(e,$w(t,i)):kP[e]?mi(e,NP(t,i)):e==="[object Map]"?mi(e,HP(t,i)):e==="[object Set]"?mi(e,XP(t,i)):IP[e]?mi(e,t.join()):e==="[object ArrayBuffer]"?mi(e,qw(t)):e==="[object DataView]"?mi(e,qw(t.buffer)):Kw[e]?$m(t,e):mi("CUSTOM",$w(t,i)))}function NP(e,t){for(var i=e.length,o=new Array(i);--i>=0;)o[i]=fu(e[i],t);return o.join()}function UP(e){return Buffer.from(e).toString("utf8")}function zP(e){return String.fromCharCode.apply(null,new Uint16Array(e))}function WP(){return"UNSUPPORTED"}function GP(e){for(var t=e.children,i=t.length,o=new Array(i);--i>=0;)o[i]=t[i].outerHTML;return o.join()}var qw=typeof Buffer<"u"&&typeof Buffer.from=="function"?UP:typeof Uint16Array=="function"?zP:WP;function HP(e,t){var i=new Array(e.size),o=0;for(e.forEach(function(n,s){i[o++]=[fu(s,t),fu(n,t)]}),Km(i,LP);--o>=0;)i[o]="["+i[o][0]+","+i[o][1]+"]";return"["+i.join()+"]"}function $w(e,t){for(var i=Km(Object.getOwnPropertyNames(e),Jw),o=i.length,n=new Array(o),s=o;--s>=0;)n[s]=i[s]+":"+fu(e[i[s]],t);return"{"+n.join()+"}"}function XP(e,t){var i=new Array(e.size),o=0;return e.forEach(function(n){i[o++]=fu(n,t)}),"["+Km(i,Jw).join()+"]"}function fu(e,t){var i=typeof e;return e==null||i==="undefined"?tc.empty+e:i==="object"?jP(e,RP.call(e),t||{cache:new WeakMap,id:1}):i==="function"||i==="symbol"?tc[i]+e.toString():i==="boolean"?tc.boolean+ +e:tc[i]+e}function Qw(e){return TP(fu(e,void 0))}function ee(e){return Qw(e)}var ic=Mi(uf());var Cf=Mi(uf());function du(e){return Cf.default.get(e,"uuid['$uuid$']",null)||Cf.default.get(e,"uuid.Wd",null)||Cf.default.get(e,"uuid",null)||null}var ie=new Map,hn=new Zw.default,tS;(r=>{class e{static async getBlock(l,u={}){if(l=typeof l=="string"?l.toLowerCase():l,ie.has(ee({operation:"getBlock",parameters:{srcBlock:l,opts:u}})))return ie.get(ee({operation:"getBlock",parameters:{srcBlock:l,opts:u}}));if(ie.has(ee({operation:"getBlock",parameters:{srcBlock:l,opts:ic.default.extend({includeChildren:!0},u)}})))return ie.get(ee({operation:"getBlock",parameters:{srcBlock:l,opts:ic.default.extend({includeChildren:!0},u)}}));let c=null;await hn.acquireAsync();try{c=await logseq.Editor.getBlock(l,u),ie.set(ee({operation:"getBlock",parameters:{srcBlock:l,opts:u}}),c);let h=null,d=null;if(c&&(h=du(c),d=c.id||null),c&&h!=null&&ie.set(ee({operation:"getBlock",parameters:{srcBlock:h,opts:u}}),c),c&&d!=null&&ie.set(ee({operation:"getBlock",parameters:{srcBlock:d,opts:u}}),c),c&&u&&u.includeChildren){let g=[...c.children];for(;g.length>0;){let m=g.pop();if(m==null)continue;let y=du(m),C=m.id||null;y!=null&&ie.set(ee({operation:"getBlock",parameters:{srcBlock:y,opts:u}}),m),C!=null&&ie.set(ee({operation:"getBlock",parameters:{srcBlock:C,opts:u}}),m),g.push(...m.children)}}}catch(h){console.error(h)}finally{hn.release()}return c}static async getBlocks(l){l=l.map(d=>typeof d=="string"?d.toLowerCase():d);let u=[],c=[];for(let d=0;d<l.length;d++)ie.has(ee({operation:"getBlock",parameters:{srcBlock:l[d],opts:{}}}))?u[d]=ie.get(ee({operation:"getBlock",parameters:{srcBlock:l[d],opts:{}}})):c.push(l[d]);c=[...new Set(c)];let h;c.length>0&&(h=await r.DB.datascriptQueryBlocks(`
                [:find (pull ?b [*])
                :where
                [?b :block/uuid ?uuid]
                [(contains? #{${c.map(d=>`#uuid "${d}" `)}} ?uuid)]
                ]`));for(let d=0,g=0;d<l.length&&g<h.length;d++)h[g][0]!=null&&u[d]==null&&(u[d]=h[g][0],g++);return u}static async getPage(l){if(l=typeof l=="string"?l.toLowerCase():l,ie.has(ee({operation:"getPage",parameters:{srcPage:l}})))return ie.get(ee({operation:"getPage",parameters:{srcPage:l}}));let u=null;await hn.acquireAsync();try{if(typeof l=="number"){u=await logseq.Editor.getPage(l),u=await logseq.Editor.getPage(u.name),ie.set(ee({operation:"getPage",parameters:{srcPage:l}}),u);let c=ic.default.get(u,"originalName",null)||ic.default.get(u,"name",null);c=c.toLowerCase(),ie.set(ee({operation:"getPage",parameters:{srcPage:c}}),u)}else u=await logseq.Editor.getPage(l),ie.set(ee({operation:"getPage",parameters:{srcPage:l}}),u)}catch(c){console.error(c)}finally{hn.release()}return u}static async getPageBlocksTree(l){if(l=typeof l=="string"?l.toLowerCase():l,ie.has(ee({operation:"getPageBlocksTree",parameters:{srcPage:l}})))return ie.get(ee({operation:"getPageBlocksTree",parameters:{srcPage:l}}));let u=null;await hn.acquireAsync();try{u=await logseq.Editor.getPageBlocksTree(l),ie.set(ee({operation:"getPageBlocksTree",parameters:{srcPage:l}}),u)}catch(c){console.error(c)}finally{hn.release()}return u}static async upsertBlockProperty(l,u,c){await hn.acquireAsync();try{await logseq.Editor.upsertBlockProperty(l,u,c)}catch(h){console.error(h)}finally{hn.release()}}static async createPageSilentlyIfNotExists(l){await hn.acquireAsync();try{await logseq.Editor.getPage(l)==null&&await logseq.Editor.createPage(l,{},{redirect:!1})}catch(u){console.error(u)}finally{hn.release()}}}r.Editor=e;class t{static async datascriptQuery(l,...u){let c;await hn.acquireAsync();try{c=await logseq.DB.datascriptQuery(l,...u)}catch(h){console.error(h)}finally{hn.release()}return c}static async datascriptQueryBlocks(l,...u){let c=[];await hn.acquireAsync();try{c=await logseq.DB.datascriptQuery(l,...u);for(let h of c){if(h=h[0],h==null||h==null)continue;let d=du(h),g=h.id||null;d!=null&&!ie.has(ee({operation:"getBlock",parameters:{srcBlock:d,opts:{}}}))&&ie.set(ee({operation:"getBlock",parameters:{srcBlock:d,opts:{}}}),h),g!=null&&!ie.has(ee({operation:"getBlock",parameters:{srcBlock:g,opts:{}}}))&&ie.set(ee({operation:"getBlock",parameters:{srcBlock:g,opts:{}}}),h)}}catch(h){console.error(h)}finally{hn.release()}return c}static{this.registeredDBListeners=[]}static registerDBChangeListener(l){this.registeredDBListeners.push(l)}}r.DB=t;class i{static useSettingsSchema(l){logseq.useSettingsSchema(l)}static{this.registeredSettingsChangeListeners=[]}static registerSettingsChangeListener(l){this.registeredSettingsChangeListeners.push(l)}}r.Settings=i;class o{static{this.registeredGraphChangeListeners=[]}static registerGraphChangeListener(l){this.registeredGraphChangeListeners.push(l)}static{this.registeredGraphIndexedListeners=[]}static registerGraphIndexedListener(l){this.registeredGraphIndexedListeners.push(l)}static{this.registerPluginUnloadListeners=[]}static registerPluginUnloadListener(l){this.registerPluginUnloadListeners.push(l)}}r.App=o;class n{static clear(){ie.clear()}static has(l){return ie.has(l)}}r.Cache=n;function s(){logseq.DB.onChanged(async({blocks:a,txData:l,txMeta:u})=>{for(let c of r.DB.registeredDBListeners)c({blocks:[...a],txData:l,txMeta:u})}),logseq.onSettingsChanged((a,l)=>{for(let u of r.Settings.registeredSettingsChangeListeners)u(a,l)}),logseq.App.onCurrentGraphChanged(a=>{for(let l of r.App.registeredGraphChangeListeners)l(a)}),logseq.App.onCurrentGraphIndexed(a=>{for(let l of r.App.registeredGraphIndexedListeners)l(a)}),logseq.beforeunload(async()=>{for(let a of r.App.registerPluginUnloadListeners)a()}),r.DB.registerDBChangeListener(async({blocks:a,txData:l,txMeta:u})=>{if(!logseq.settings.cacheLogseqAPIv1){r.Cache.clear();return}logseq.settings.debug.includes("blockAndPageHashCache.ts")&&console.log("Maintaining LogseqProxy Cache",[...a],l,u);for(let h of l){let[d,g,...m]=h;if(g!="left"&&g!="parent")continue;let y=await logseq.Editor.getBlock(d);y!=null&&a.push(y),y=await logseq.Editor.getBlock(m[0]),y!=null&&a.push(y)}let c=new Set;for(;a.length>0;){let h=a.pop();if(!c.has(h.id)){if(c.add(h.id),h.uuid=du(h),h.uuid!=null&&(h.uuid=h.uuid.toString().toLowerCase(),ie.delete(ee({operation:"getBlock",parameters:{srcBlock:h.uuid,opts:{}}})),ie.delete(ee({operation:"getBlock",parameters:{srcBlock:h.uuid,opts:{includeChildren:!0}}})),ie.delete(ee({operation:"getPage",parameters:{srcPage:h.uuid}})),ie.delete(ee({operation:"getPageBlocksTree",parameters:{srcPage:h.uuid}}))),h.page!=null&&h.page.id!=null){ie.delete(ee({operation:"getPage",parameters:{srcPage:h.page.id}})),ie.delete(ee({operation:"getPageBlocksTree",parameters:{srcPage:h.page.id}}));let d=await logseq.Editor.getPage(h.page.id);d.originalName!=null&&(d.originalName=d.originalName.toLowerCase(),ie.delete(ee({operation:"getPage",parameters:{srcPage:d.originalName}})),ie.delete(ee({operation:"getPageBlocksTree",parameters:{srcPage:d.originalName}}))),d.name!=null&&(d.name=d.name.toLowerCase(),ie.delete(ee({operation:"getPage",parameters:{srcPage:d.name}})),ie.delete(ee({operation:"getPageBlocksTree",parameters:{srcPage:d.name}})))}if(h.originalName!=null&&(h.originalName=h.originalName.toLowerCase(),ie.delete(ee({operation:"getPage",parameters:{srcPage:h.originalName}})),ie.delete(ee({operation:"getPageBlocksTree",parameters:{srcPage:h.originalName}}))),h.name!=null&&(h.name=h.name.toLowerCase(),ie.delete(ee({operation:"getPage",parameters:{srcPage:h.name}})),ie.delete(ee({operation:"getPageBlocksTree",parameters:{srcPage:h.name}}))),h.id!=null&&(ie.delete(ee({operation:"getBlock",parameters:{srcBlock:h.id,opts:{includeChildren:!0}}})),ie.delete(ee({operation:"getBlock",parameters:{srcBlock:h.id,opts:{}}})),ie.delete(ee({operation:"getPage",parameters:{srcPage:h.id}})),ie.delete(ee({operation:"getPageBlocksTree",parameters:{srcPage:h.id}}))),h.parent!=null&&h.parent.id!=null){let d=await logseq.Editor.getBlock(h.parent.id);d!=null&&a.push(d)}}}}),r.Settings.registerSettingsChangeListener((a,l)=>{a.cacheLogseqAPIv1||r.Cache.clear()}),r.App.registerGraphChangeListener(a=>{r.Cache.clear()}),r.App.registerGraphIndexedListener(a=>{r.Cache.clear()}),window.addEventListener("syncLogseqToAnkiComplete",()=>{logseq.settings.cacheLogseqAPIv1||r.Cache.clear()})}r.init=s})(tS||={});if(!window.parent.fabric){let e=window.parent.document.createElement("script");e.innerHTML=iS.default,window.parent.document.body.appendChild(e)}function Jm(e=0,t=0,i=80,o=40,n=0,s=1){let r=new window.parent.fabric.Rect({fill:"#FFEBA2",stroke:"#000",strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:.8,width:i,height:o,originX:"center",originY:"center"}),a=new window.parent.fabric.Text(`${s}`,{originX:"center",originY:"center"});return a.scaleToHeight(o),new window.parent.fabric.Group([r,a],{left:e,top:t,width:i,height:o,originX:"center",originY:"center",angle:n})}var t0=Mi(im()),Qm=()=>{if(!document.getElementsByClassName("anki-card-front-side")[0]){console.log("Not front side of anki card");return}$P(),KP(),JP()};function $P(){if(window.type!=="image_occlusion")return;let e="-1";for(let r=1;r<=9;r++)document.getElementById(`c${r}`)&&(e=`${r}`);if(console.log(`Current cloze id: ${e}`),e=="-1"||!document.getElementById("localImgBasePath"))return;let t=document.getElementById("localImgBasePath").src;t=t.substring(0,t.lastIndexOf("/"));let i={},o=Array.from(document.getElementsByTagName("img"));for(let r of o){r.style.visibility="hidden";let a=document.createElement("canvas");a.width=r.width,a.height=r.height;let l=new Zm.fabric.Canvas(a,{imageSmoothingEnabled:!1}),u=new Image;u.src=r.src,u.onload=function(){let c=new Zm.fabric.Image(u),h=l.width/c.width,d=l.height/c.height;l.setViewportTransform([h,0,0,d,0,0]),l.setBackgroundImage(c,l.renderAll.bind(l),{scaleX:1,scaleY:1})},a.style.position="relative",r.replaceWith(a),i[r.src]==null&&(i[r.src]=[]),i[r.src].push(l)}document.getElementById("main-content").style.visibility="visible";let n=JSON.parse(document.getElementById("imgToOcclusionDataHashMap").innerHTML);for(let r in n){let a=n[r].elements,l=n[r].config;console.log(l),a.forEach(u=>{let c=i[t+"/"+t0.default.basename(r)]||i[encodeURI(t+"/"+t0.default.basename(r))]||i[r]||i[encodeURI(r)]||[];u.cId==e?c.forEach(h=>{let d=Jm(u.left,u.top,u.width,u.height,u.angle,u.cId);d._objects[0].set("opacity",1),h.add(d),h.renderAll()}):u.cId!=e&&l.hideAllTestOne==!0&&c.forEach(h=>{let d=Jm(u.left,u.top,u.width,u.height,u.angle,u.cId);d._objects[0].set("opacity",1),d._objects[0].set("fill","#3b4042"),d._objects[0].set("stroke","#2a3942"),d._objects[1].set("opacity",0),h.add(d),h.renderAll()})})}let s=Array.from(document.getElementsByTagName("canvas"));for(let r of s)r.classList.contains("lower-canvas")&&(r.style["user-select"]="inherit",r.style["touch-action"]="inherit")}function KP(){window.type!=="multiline_card"&&window.type!=="cloze"||document.getElementById("tags").getAttribute("tags_name").split(" ").includes("hide-all-test-one")&&[...document.getElementsByClassName("cloze-inactive")].forEach(e=>{function t(n){n.classList.contains("cloze-inactive-hidden")||(n.classList.add("cloze-inactive-hidden"),n.setAttribute("data-html-content",n.innerHTML),n.innerHTML="[...]",n.style.color="rgb(115, 115, 115)",n.style.cursor="pointer")}function i(n){n.classList.contains("cloze-inactive-hidden")&&(n.classList.remove("cloze-inactive-hidden"),n.innerHTML=n.getAttribute("data-html-content"))}function o(n){n.classList.contains("cloze-inactive-hidden")?i(n):t(n)}e.onclick=function(){o(e)},t(e)})}function JP(){localStorage.setItem("logseq-prev-typeans","");let e=document.getElementById("typeans");if(e==null)return;try{e.focus(),e.click()}catch{}try{let i=!1;e.addEventListener("focusin",async o=>{if(AnkiDroidJS&&(i||window.addEventListener("resize",()=>{i=!0}),await new Promise(n=>setTimeout(n,200)),!i)){let n=document.createElement("div");n.style.color="red",n.style.fontSize="small",n.style.marginTop="5px",n.style.textAlign="left",n.style.float="left",n.innerHTML=`Ankidroid doesn't support virtual keyboard by default. Please go to Settings > Advanced and enable "Type answer into the card".`,e.parentNode.appendChild(n)}})}catch{}let t=i=>{localStorage.setItem("logseq-prev-typeans",e.value)};e.onchange=t,e.onkeyup=t}document.readyState==="complete"&&Qm(),window.addEventListener("load",Qm);})();
/*! Bundled license information:

fabric/dist/fabric.js:
  (*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) *)

object-assign/index.js:
  (*
  object-assign
  (c) Sindre Sorhus
  @license MIT
  *)

react/cjs/react.production.min.js:
  (** @license React v17.0.2
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (** @license React v0.20.2
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (** @license React v17.0.2
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

fabric/dist/fabric.js:
  (*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) *)

@logseq/libs/dist/lsplugin.user.js:
  (*! For license information please see lsplugin.user.js.LICENSE.txt *)
*/
